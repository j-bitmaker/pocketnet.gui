
 /*_____*/ 
var terms=function(){function t(n){var e,n=deep(n,"history");return{primary:n,getdata:function(n){n({})},destroy:function(){e={}},init:function(n){(e={}).c=n.el.find("#"+o.map.id),o.shell({name:o.app.localization.key,el:e.c,data:{}},function(n){}),n.clbk(null,n)},wnd:{class:"withoutButtons allscreen black a100"}}}var o=new nModule,a={};return o.run=function(n){var e=o.addEssense(a,t,n);o.init(e,n)},o.stop=function(){_.each(a,function(n){n.destroy()})},o}();"undefined"!=typeof module?module.exports=terms:(app.modules.terms={},app.modules.terms.module=terms);
 /*_____*/ 
var about=function(){function n(e){function t(){d.whitepaper()}function n(){d.join()}function a(){var e=$(this).attr("answer");e&&l.send(e,function(){u.survey()})}var i,o,s,e=deep(e,"history"),c=null,l=null,d={videoWidth:function(e){var t=e.width(),n=t/(560/315);e.find("iframe").width(t),e.find("iframe").height(n)},time:function(){today=new Date,today=Math.floor((o-today)/1e3),tsec=today%60,today=Math.floor(today/60),tsec<0?tsec="00":tsec<10&&(tsec="0"+tsec),tmin=today%60,today=Math.floor(today/60),tmin<0?tmin="00":tmin<10&&(tmin="0"+tmin),thour=today%24,today=Math.floor(today/24),thour<0&&(thour="00"),today<0&&(today="00"),i.days.html(today),i.seconds.html(tsec),i.minutes.html(tmin),i.hours.html(thour)},fixed:function(){var e=$(window).scrollTop();i.main.offset().top+i.main.height()<e?i.fixed.addClass("active"):i.fixed.removeClass("active")},explore:function(){var e=i.c.find(".faq");_scrollToTop(e)},validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,t,n,a){a=a||"4",(t={Email:e,Name:t}).Action||(t.Action="ADDTOMAILLIST"),t.TemplateID||(t.TemplateID=a),$.ajax({type:"POST",url:f.app.options.server,data:t,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){f.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){f.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".email"),e=e.el.find(".name"),t=t.val(),e=e.val();if(d.validateEmail(t)&&e)return d.saveEmail(t,e),d.joinSuccess(t,e),!0},clbk:function(e){function t(){var e=a.val(),t=n.val();return d.validateEmail(e)&&t?(i.removeClass("disabled"),!0):(i.addClass("disabled"),!1)}var n=e.find(".name"),a=e.find(".email"),i=e.find(".btn1");i.addClass("disabled"),i.on("click",function(){}),n.focus(),n.on("change",t),n.on("keyup",t),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})},{action:e})},whitepaperSuccess:function(){f.fastTemplate("whitepaperSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})})},whitepaper:function(){f.fastTemplate("whitepaper",function(e){dialog({html:e,wrap:!0,success:function(e){if(e=e.el.find("input").val(),d.validateEmail(e))return d.saveEmail(e,"",null,"5"),d.whitepaperSuccess(),!0},clbk:function(e){function t(){var e=$(this).val();return d.validateEmail(e)?(n.removeClass("disabled"),!0):(n.addClass("disabled"),!1)}var n=e.find(".btn1");n.addClass("disabled"),n.on("click",function(){}),(e=e.find("input")).focus(),e.on("change",t),e.on("keyup",t)},class:"one joinbeta"})})}},r=[{name:"Twitter",icon:'<i class="fab fa-twitter"></i>',href:"https://twitter.com/Pocket_Net"},{name:"Telegram",icon:'<i class="fab fa-telegram"></i>',href:"https://t.me/PocketRep"},{name:"Facebook",icon:'<i class="fab fa-facebook"></i>',href:"https://www.facebook.com/PocketNet"},{name:"Minds",image:"https://cdn-assets.minds.com/front/dist/assets/logos/bulb.svg",href:"https://www.minds.com/PocketNet"},{name:"Linkedin",icon:'<i class="fab fa-linkedin"></i>',href:"https://www.linkedin.com/company/cryptolo-io"},{name:"Mastodon",icon:'<i class="fab fa-mastodon"></i>',href:"https://mastodon.social/@PocketRep"},{name:"Gab",image:"https://gab.com/assets/img/logo-dec.png",href:"https://gab.com/PocketNet"},{name:"Sola",image:"https://web.solacore.net/img/logo_medium-3_mNF.png",href:"https://sola.ai/cryptolo_io"},{name:"Medium",icon:'<i class="fab fa-medium"></i>',href:"https://medium.com/@cryptolo.io"}],u={survey:function(t){f.shell({name:"survey",el:i.survey,data:{survey:l},animation:"fadeIn"},function(e){e.el.find(".sendanswer").on("click",a),e.el.find(".resultpercent").each(function(){var e=$(this);e.animate({width:e.attr("w")+"%"},130)}),t&&t()})},tes:function(){var e=i.c.find(".tes");lazyEach({array:e,sync:!0,action:function(e){var t=$(e.item),n=t.attr("time")||600;t.addClass("show"),setTimeout(function(){e.success()},n)}})},lenta:function(){f.nav.api.load({open:!0,id:"lenta",el:i.lenta,animation:!1,mid:"about",essenseData:{author:"PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd",byauthor:!0,authAction:function(e){d.join(e)},notscrollloading:!0},clbk:function(e,t){c=t}})}};return{primary:e,getdata:function(e){c=null,l=new sQuestion({id:"pocketnetlanding",ajax:f.app.ajax,question:"Are you fed up with traditional social media like Facebook, Twitter and others?",answers:[{t:"Yes, very",v:1},{t:"Yes, somewhat",v:2},{t:"Facebook and Twitter are just great",v:3}]}),e({socials:r,survey:l})},destroy:function(){s&&clearInterval(s),c&&(c.destroy(),c=null),window.removeEventListener("scroll",d.fixed),i={}},init:function(e){(i={}).c=e.el.find("#"+f.map.id),i.lenta=e.el.find(".lenta"),i.main=i.c.find(".main"),i.fixed=i.c.find(".fixedButton"),i.join=i.c.find(".ejoin"),i.whitepaper=i.c.find(".whitepaper"),i.days=e.el.find(".days"),i.seconds=e.el.find(".seconds"),i.minutes=e.el.find(".minutes"),i.hours=e.el.find(".hours"),i.survey=e.el.find(".survey"),o=new Date(2019,0,23,23,59),s=setInterval(d.time,1e3),i.join.on("click",n),i.whitepaper.on("click",t),i.c.find(".exploremore").on("click",d.explore),window.addEventListener("scroll",d.fixed),u.tes(),u.lenta(),l.init(function(){u.survey()}),d.videoWidth(i.c.find(".videoContent")),e.clbk(null,e)}}}var f=new nModule,a={};return f.run=function(e){var t=f.addEssense(a,n,e);f.init(t,e)},f.stop=function(){_.each(a,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=about:(app.modules.about={},app.modules.about.module=about);
 /*_____*/ 
var applications=function(){function o(n){var d,r,n=deep(n,"history"),s={os:function(e,n,o){var i;e.hidden||(i=o?e.id:".currentos",u.shell({turi:"registration",name:"os",el:d.c.find(i),data:{os:e,last:!1}},function(n){n.el.find(".downloadOs").on("click",function(){var o,t;t=function(n){d.c.find(i+" .os").addClass("rundownloading"),d.c.find(i+" .skipositem").html('<div><a href="'+n+'"><b>'+u.app.localization.e("e13012")+"</b></a></div>")},(o=e)&&o.github&&$.get(o.github.url,{},function(n){var e=deep(n,"assets")||[];(n=_.find(e,function(n){return n.name==o.github.name}))&&((e=document.createElement("a")).setAttribute("href",n.browser_download_url),e.setAttribute("download","download"),e.click(),t&&t(n.browser_download_url))})})}))}};return{primary:n,getdata:function(n,e){(r=deep(e,"settings.essenseData")||{}).key||(r.key="ui"),n({})},destroy:function(){d={}},init:function(n){var e,o,t,i,a;(d={}).c=n.el.find("#"+u.map.id),o=os(),t=u.app.platform.applications[r.key],i=Object.keys(t),a=t[o],i=i.filter(function(n){return n!==o}),o&&a&&"undefined"==typeof _Electron&&!window.cordova&&!isInStandaloneMode()?(s.os(a,e),i.forEach(function(n){s.os(t[n],e,!0)})):e&&e(),n.clbk(null,n)}}}var u=new nModule,t={};return u.run=function(n){var e=u.addEssense(t,o,n);u.init(e,n)},u.stop=function(){_.each(t,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=applications:(app.modules.applications={},app.modules.applications.module=applications);
 /*_____*/ 
var registration=function(){function i(n){var c,i,t,e=deep(n,"history"),o={last:!1,end:!1},s=null,a={type:"STRING",name:"keyInput",id:"keyInput",placeholder:g.app.localization.e("confirmkey"),autoSearch:function(e,n,i){var t;0==o.mnemonicKey.indexOf(e)&&" "!=e[e.length-1]&&((e=e.split(" "))[t=e.length-1],i(_.filter(o.mnemonicContent,function(e,n){if(n<=t)return!0}).join(" ")))}};isMobile()&&delete a.autoSearch;function r(){m.registration()}function l(){m.generate()}function d(){$(this).hasClass("disabled")||m.continue()}function u(){m.repeat()}function f(){m.download(function(e){c.c.find(".osStep").addClass("rundownloading"),c.c.find(".skipositem").html('<div class="downloadstart">'+g.app.localization.e("e13011")+'</div><div><a href="'+e+'"><b>'+g.app.localization.e("e13012")+"</b></a></div>")})}var p=new Parameter(a),m={download:function(i){o.os&&o.os.github&&$.get(o.os.github.url,{},function(e){var n=deep(e,"assets")||[];(e=_.find(n,function(e){return e.name==o.os.github.name}))&&((n=document.createElement("a")).setAttribute("href",e.browser_download_url),n.setAttribute("download","download"),n.click(),i&&i(e.browser_download_url))})},validation:function(){var e=trim(p.value);return e!=o.mnemonicKey&&e!=o.mk?(c.c.find(".note").html(g.app.localization.e("keysnotmatch")),c.c.addClass("error"),!1):(c.c.removeClass("error"),c.c.find(".note").html(""),!0)},registration:function(){m.validation()&&(localStorage.stay="1",g.app.user.stay=1,g.user.signin(o.mnemonicKey,function(e){return e?(o.end=!0,void v.confirm(function(){v.success(function(){setTimeout(function(){var e;"_this"==deep(i,"successHref")?g.app.user.validate()?((e=deep(t,"container.close"))&&e(),i.signInClbk&&i.signInClbk()):g.nav.api.loadSameThis("filluser",n):(console.log("essenseData.nav",i.nav),i.nav||(i.nav={}),i.nav.history=!0,i.nav.reload=!1,g.app.reload({href:i.successHref||"filluser",nav:i.nav}))},2e3)})})):(c.c.find.note.html(g.app.localization.e("id98")),void c.c.addClass("error"))}))},generate:function(){c.c.removeClass("begin");var n=bitcoin.bip39.generateMnemonic();m.testqrcodeandkey(n,function(e){e?(o.mnemonicKey=n,o.mnemonicMask=_.shuffle(indexArray(o.mnemonicKey.length)),o.mnemonicContent=o.mnemonicKey.split(" "),e=g.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnet(e.publicKey).address,o.mk=e.privateKey.toString("hex"),v.key()):m.generate()})},repeat:function(){o.last=!1,v.confirm(function(){v.tips(function(){setTimeout(function(){c.c.removeClass("last"),setTimeout(function(){m.generate()},300)},300)})})},continue:function(){var e=c.c.find(".mnemonicKey");c.c.find(".keyStep").removeClass("showedPanel"),v.mnemonicEffect(e,!0,function(){o.last=!0,v.key(function(){setTimeout(function(){v.tips(),c.c.addClass("last"),setTimeout(function(){v.confirm()},300)},300)})})},removeDisabled:function(e){e.find(".continue").removeClass("disabled"),e.find(".preloader").remove(),e.find(".save").addClass("black"),e.find(".copy").addClass("black")},testqrcodeandkey:function(e,n){e=g.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=v.qrcode(c.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg"),grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?n&&n(!1):n&&n(!0)},qrscanner.q.decode(e)})}},v={os:function(n){var e=os();e&&g.app.platform.applications[e]&&"undefined"==typeof _Electron&&!window.cordova?(o.os=g.app.platform.applications[e],v.step("os",function(e){e.el.find(".downloadOs").on("click",f),e.el.find(".skip").on("click",function(){n&&n()})})):n()},step:function(e,n){g.shell({name:e,el:c.c.find("."+e+"Step"),data:o,animation:{id:"slide"}},function(e){n&&n(e)})},success:function(n){v.step("success",function(e){n&&n()})},tips:function(n){v.step("tips",function(e){e.el.find(".generate").on("click",l),n&&n()})},confirm:function(n){p.value="",o.keyInput=p,v.step("confirm",function(e){e.el.find(".repeat").on("click",u),e.el.find(".registrationButton").on("click",r),n?n():(ParametersLive([p],e.el),_scrollTo(e.el,s),initUpload({el:e.el.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:c.c.find(".confirm"),action:function(e,n){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?c.c.find(".note").html(g.app.localization.e("filedamaged")):(p.value=trim(e),p.el.val(p.value),m.registration())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(p.value=trim(e[1]),p.el.val(p.value),m.registration()):c.c.find(".note").html(g.app.localization.e("filedamaged")))}}),setTimeout(function(){e.el.find('input[type="text"]').on("focus",function(){e.el.find(".inputTable").addClass("typeactive")}),e.el.find('input[type="text"]').on("blur",function(){e.el.find(".inputTable").removeClass("typeactive")}),isMobile()||e.el.find(".autosearchInputCnt input").focus()},600))})},qrcode:function(e,n){return new QRCode(e[0],{text:n,width:256,height:256})},key:function(a){v.step("key",function(n){var e=n.el.find(".mnemonicKey"),i=c.c.find(".keyStep");i.removeClass("showedPanel");var t,o=n.el.find(".hiddenMnemonicKey").html();o&&(o=g.app.user.keysFromMnemo(trim(o)).privateKey.toString("hex"),t=v.qrcode(n.el.find(".qrcode"),o)),v.mnemonicEffect(e,!1,function(){i.addClass("showedPanel")}),n.el.find(".continue").on("click",d),setTimeout(function(){m.removeDisabled(n.el)},2e3),g.app.platform.clbks._focus.registration=function(){m.removeDisabled(n.el)},n.el.find(".copy").on("click",function(){copyText(n.el.find(".hiddenMnemonicKey")),sitemessage(g.app.localization.e("successfullycopied")),m.removeDisabled(n.el)}),n.el.find(".save").on("click",function(){var e=n.el.find(".qrcode img").attr("src");saveAs({file:e,format:"png",name:"pocketnetkey"})}),window.cordova&&n.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:"Save key on device",class:"itemmain",action:function(e){var n=b64toBlob(t._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(n,"pkey"+g.app.platform.currentTime()+".png",function(){e()})}}]})}),a?a():_scrollTo(n.el,s)})},mnemonicEffect:function(i,e,n){var t=indexArray(101);e&&t.reverse();var o=i.height();i.css("min-height",o+"px"),lazyEach({array:t,sync:!0,action:function(e){var n=e.item;i.html(v.mnemonic(n)),o=i.height(),i.css("min-height",o+"px"),setTimeout(e.success,rand(1,5))},all:{success:function(){i.css("min-height","0px"),n&&n()}}})},mnemonic:function(e){var i="",t=(o.mnemonicMask.length*e/100).toFixed(0);return _.each(o.mnemonicKey,function(e,n){n=_.indexOf(o.mnemonicMask,n),i+=n<t||" "==e?e:g.app.platform.values.alph[rand(0,g.app.platform.values.alph.length-1)]}),i}};return{primary:e,getdata:function(e,n){g.nav.api.load({open:!0,href:"filluserfast"})},destroy:function(){delete g.app.platform.clbks._focus.registration,c={}},init:function(e){var n;(c={}).c=e.el.find("#"+g.map.id),c.registrationButton=c.c.find(".registrationButton"),c.toAuthorization=c.c.find(".toAuthorization"),c.login=c.c.find(".loginValue"),c.ler=c.c.find(".ler"),c.key=c.c.find(".key"),i=e.essenseData||{},t=e,(s=c.c.closest(".wndcontent")).length||(s=null),v.os(function(){v.tips()}),n=e,c.toAuthorization.on("click",function(){g.nav.api.loadSameThis("authorization",n)}),e.clbk(null,e)},wnd:{class:"withoutButtons allscreen"}}}var g=new nModule,t={};return g.run=function(e){var n=g.addEssense(t,i,e);g.init(n,e)},g.stop=function(){_.each(t,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=registration:(app.modules.registration={},app.modules.registration.module=registration);
 /*_____*/ 
var anothersite=function(){function t(e){e=deep(e,"history");return{primary:e,getdata:function(e,n){e({link:n.settings.essenseData.link})},destroy:function(){},init:function(e){e.el.find("#"+i.map.id),e.clbk(null,e)},wnd:{header:"Another site",class:"transparent small anothersite"}}}var i=new nModule,o={};return i.run=function(e){var n=i.addEssense(o,t,e);i.init(n,e)},i.stop=function(){_.each(o,function(e){e.destroy()})},i}();"undefined"!=typeof module?module.exports=anothersite:(app.modules.anothersite={},app.modules.anothersite.module=anothersite);
 /*_____*/ 
var pkview=function(){function i(n){var e,n=deep(n,"history"),t={},a={qrcode:function(n,e){return new QRCode(n[0],{text:e,width:256,height:256})},mnemonic:function(n){var i,o="";return t.mnemonicMask?(i=(t.mnemonicMask.length*n/100).toFixed(0),_.each(t.mnemonicKey,function(n,e){e=_.indexOf(t.mnemonicMask,e),o+=e<i||" "==n?n:c.app.platform.values.alph[rand(0,c.app.platform.values.alph.length-1)]})):o=t.mnemonicKey,o},mnemonicEffect:function(i,n,e){var o=indexArray(101);n&&o.reverse(),lazyEach({array:o,sync:!0,action:function(n){var e=n.item;i.html(a.mnemonic(e)),h=i.height(),setTimeout(n.success,rand(1,5))},all:{success:function(){e&&e()}}})},key:function(o){c.shell({name:"key",el:e.c.find(".keywrapper"),data:t,animation:{id:"slide"}},function(e){var n=e.el.find(".mnemonicKey");a.mnemonicEffect(n,!1,function(){});var i=a.qrcode(e.el.find(".qrcode"),t.mk);e.el.find(".copy").on("click",function(){copyText(e.el.find(".hiddenMnemonicKey")),sitemessage(c.app.localization.e("successfullycopied"))}),e.el.find(".save").on("click",function(){var n=e.el.find(".qrcode img").attr("src");saveAs({file:n,format:"png",name:"pocketnetkey"})}),window.cordova&&e.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:c.app.localization.e("e13145"),class:"itemmain",action:function(n){var e=b64toBlob(i._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(e,"pkey"+c.app.platform.currentTime()+".png",function(){n()})}}]})}),o&&o(e)})},dontshowagain:function(){e&&e.c&&e.c.find(".dontshowagain").addClass("active")}};return{primary:n,getdata:function(n,e){n({})},destroy:function(){e={}},init:function(n){(e={}).c=n.el.find("#"+c.map.id),e.c.find(".dontshowagain").on("click",function(){c.closeContainer(),c.app.platform.sdk.registrations.donotshowprivate(),isMobile()&&c.app.nav.api.load({open:!0,href:"index",history:!0})}),function(){t={};var n=localStorage.mnemonic;n&&c.app.platform.cryptography.api.aeswc.decryption(n,c.app.options.fingerPrint,{},function(n){var e;n&&(bitcoin.bip39.validateMnemonic(n)?(e=c.app.user.keysFromMnemo(trim(n)),t.mk=e.privateKey.toString("hex")):t.mk=n,t.mnemonicKey=n,t.mnemonicMask=_.shuffle(indexArray(t.mnemonicKey.length)),t.mnemonicContent=t.mnemonicKey.split(" "),a.key(),setTimeout(function(){a.dontshowagain()},2e3))})}(),n.clbk(null,n)},wnd:{class:"allscreen black withoutButtons pkviewwnd"}}}var c=new nModule,o={};return c.run=function(n){var e=c.addEssense(o,i,n);c.init(e,n)},c.stop=function(){_.each(o,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=pkview:(app.modules.pkview={},app.modules.pkview.module=pkview);
 /*_____*/ 
var token=function(){function n(e){function o(){var e=parameters().token||null;return{type:parameters().type||null,token:e}}e=deep(e,"history");return{primary:e,getdata:function(t){var e,n=o();"activate"!=n.type?a.app.platform.ws.addBlock():(delete(e=a.app.platform.ws.messages.CUSTOMER.ACTIVE).clbks.successDialog,e.clbks.success=function(){var e=deep(a,"app.modules.menu.module");e&&e.restart()}),a.app.platform.sdk.tokens.check(n.token,function(e){n.result=e,t(n)})},destroy:function(){a.app.platform.ws.removeBlock()},init:function(e){o(),e.el.find("#"+a.map.id),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=token:(app.modules.token={},app.modules.token.module=token);
 /*_____*/ 
var page404=function(){function o(n){n=deep(n,"history");return{primary:n,getdata:function(n){n({})},destroy:function(){},init:function(n){n.el.find("#"+t.map.id),n.clbk(null,n)}}}var t=new nModule,u={};return t.run=function(n){var e=t.addEssense(u,o,n);t.init(e,n)},t.stop=function(){_.each(u,function(n){n.destroy()})},t}();"undefined"!=typeof module?module.exports=page404:(app.modules.page404={},app.modules.page404.module=page404);
 /*_____*/ 
var test=function(){function n(e){function a(){f.signout()}function n(){f.save()}function s(){f.cancel()}function r(){var e=h.app.platform.sdk.address.pnet();topPreloader(30),h.app.platform.sdk.node.account.import(e.address,function(){topPreloader(100),sitemessage("Address "+e.address+" was successfully imported")})}var t,o,d,i,p=deep(e,"history"),l=!1,u={language:h.app.localization.key||"en"},c=!1,f={saveemail:function(e,n){var a,s={Email:e,Lang:h.app.localization.key||"en"};s.Action||(s.Action="ADDTOMAILLIST"),s.TemplateID="1005",s.ref="",a=function(e){var a="";e&&(s.ref+=e,a+='<p><a href="https://'+h.app.options.url+"/author?address="+h.app.ref+'">Referrer: '+e+"</a></p>"),(e=deep(document,"referrer"))&&(a+='<p><a href="'+e+'">From: '+e+"</a></p>"),s.body=encodeURIComponent(a),$.ajax({type:"POST",url:"https://"+h.app.options.url+"/Shop/AJAXMain.aspx",data:s,dataType:"json",success:function(){n&&n()}})},h.app.ref?h.sdk.users.get(h.app.ref,function(){var e=deep(h,"sdk.users.storage."+h.app.ref+".name");a(e)}):a(null)},valid:function(e,a){if(!f.equal(e,a)&&trim(e.name)&&e.image)return!0},equal:function(e,a){function n(e){return"name:"+(trim(e.name)||"")+"image:"+(e.image||"")+"about:"+(trim(e.about)||"")+"site:"+(trim(e.site)||"")+"language:"+(e.language||"")+"addresses:"+JSON.stringify(e.addresses||[])}return n(e)==n(a)},cancel:function(){f.userOptions(),f.upanel(),k.icon(),k.options()},ref:function(e){d&&l&&(localStorage[h.app.platform.sdk.address.pnet().address+"subscribeRef"]=d.address)},save:function(e){var r;c||(c=!0,r=function(){t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100),c=!1,p?h.nav.api.go({href:"index",history:!0,open:!0}):o.success?o.success():e&&e()},h.sdk.users.checkFreeRef(h.app.platform.sdk.address.pnet()?h.app.platform.sdk.address.pnet().address:"",function(n,e){if(t.c.find(".userPanel").hasClass("loading"))c=!1;else{if(f.equal(u,h.app.platform.sdk.user.storage.me))return sitemessage(h.app.localization.e("uchanges")),void(c=!1);if(!f.valid(u,h.app.platform.sdk.user.storage.me))return sitemessage(h.app.localization.e("uchangesvalid")),trim(u.name)?u.image||(a=t.c.find(".fileUploader"),_scrollTo(a)):((a=t.c.find('[parameter="name"] input')).focus(),_scrollTo(a)),void(c=!1);var a,s=new UserInfo;if(s.name.set(trim(u.name)),s.language.set(u.language),s.about.set(trim(u.about)),s.site.set(trim(u.site)),s.image.set(u.image),s.addresses.set(u.addresses),s.ref.set(deep(d,"address")||""),e=s.validation())return t.c.find(".errorname").fadeIn(),"namelength"==e&&t.c.find(".errorname span").html("The name length can be more than 20 symbols"),"pocketnet"==e&&t.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved"),(a=t.c.find('[parameter="name"] input')).focus(),_scrollTo(a),c=!1;topPreloader(30),t.c.find(".userPanel").addClass("loading"),t.upanel.addClass("loading"),h.app.platform.sdk.users.nameExist(s.name.v,function(e){!e||h.app.platform.sdk.address.pnet()&&e==h.app.platform.sdk.address.pnet().address?(topPreloader(50),o.presave(function(){s.keys.set(_.map(h.app.user.cryptoKeys(),function(e){return e.public})),t.c.find(".errorname").fadeOut(),topPreloader(70),s.uploadImage(h.app,function(e){return e?(topPreloader(100),t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),sitemessage("An error occurred while loading images"),void(c=!1)):o.makeuser?(topPreloader(100),t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),o.makeuser(s),void(c=!1)):((e=u.email)&&f.saveemail(e),void h.sdk.node.transactions.create.commonFromUnspent(s,function(e,a){console.log("error",a,e),e?(successCheck(),delete h.sdk.usersl.storage[h.app.platform.sdk.address.pnet().address],delete h.sdk.users.storage[h.app.platform.sdk.address.pnet().address],h.app.platform.sdk.user.storage.me=e,u=_.clone(h.app.platform.sdk.user.storage.me),f.upanel(),f.ref(n),h.closeContainer(),h.app.platform.sdk.users.getone(h.app.platform.sdk.address.pnet().address,function(){h.app.reloadModules(function(){o.presuccess?o.presuccess(r):r()})})):(h.app.platform.errorHandler(a,!0),t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100))},{relay:!!o.relay&&o.relay()}))})})):(c=!1,t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100),t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("This username is taken in Pocketnet"))})}}))},upload:function(e,s){topPreloader(20);var a=[{original:e.base64,index:0}];h.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:0,images:a,apply:!0,crop:{aspectRatio:1,style:"round apply",autoCropArea:.9},success:function(e,n){resize(a[0].original,100,100,function(e){var a=e.split(",");n(),a[1]?(u.image=e,k.icon(),f.upanel(),s&&s()):topPreloader(100)})}}})},upanel:function(){t.upanel&&(0<_.toArray(h.app.platform.sdk.node.transactions.temp.userInfo||{}).length||h.app.platform.sdk.address.pnet()&&0<deep(h.sdk.relayTransactions.storage,h.app.platform.sdk.address.pnet().address+".userInfo.length")&&!o.failedrelay?(t.upanel.addClass("wait"),t.c.find(".caption").remove()):(t.upanel.removeClass("wait"),f.equal(u,h.app.platform.sdk.user.storage.me)||!f.valid(u,h.app.platform.sdk.user.storage.me)?t.upanel.removeClass("changes"):t.upanel.addClass("changes")))},clear:function(){f.userOptions(),k.caption()},userOptions:function(){u=_.clone(h.app.platform.sdk.user.storage.me),_.each(m,function(a,n){var e=h.app.platform.sdk.user.storage.me[a.id];"addresses"==n&&(e=_.clone(h.app.platform.sdk.user.storage.me[a.id])),a.value=e||a.defaultValue||"",u[a.id]=a.value,a._onChange=function(e){if(u[a.id]="addresses"==n?_.clone(e):trim(e),f.upanel(),"language"!=n||(e=h.app.localization.available[e])&&e.key!=h.app.localization.key&&h.app.localization.lightSet(e.key),"name"==n){if(-1<u[a.id].toLowerCase().replace(/[^a-z]/g,"").indexOf("pocketnet"))return t.c.find(".errorname").fadeIn(),void t.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved");20<u[a.id].length?(t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("The name length can be more than 20 symbols")):h.app.platform.sdk.users.nameExist(u[a.id],function(e){!e||h.app.platform.sdk.address.pnet()&&e==h.app.platform.sdk.address.pnet().address?t.c.find(".errorname").fadeOut():(t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("This username is taken in Pocketnet"))})}}})},signout:function(){h.app.user.signout(),h.app.reload({href:"authorization"})}},m={name:new Parameter({name:h.app.localization.e("unickname"),id:"name",type:"NICKNAME",require:!0}),email:new Parameter({name:"Email",id:"email",type:"EMAIL",onType:!0}),language:new Parameter({name:h.app.localization.e("ulanguage"),id:"language",type:"VALUES",defaultValue:h.app.localization.key||"en",possibleValues:["en","ru"],possibleValuesLabels:["English","Русский"]}),about:new Parameter({name:h.app.localization.e("uabout"),id:"about",type:"TEXT",onType:!0,placeholder:h.app.localization.e("e133512")}),site:new Parameter({name:h.app.localization.e("uwebsite"),id:"site",type:"STRINGANY",onType:!0,value:""}),addresses:new function(){var n=this;return n.id="addresses",n.name=h.app.localization.e("uaddresesd"),n.value=[],n.defaultValue=[],n.remove=function(e,a){removeEqual(n.value,{currency:e,address:a}),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.add=function(e){n.value.push(e),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.addDialog=function(){function r(e,a){return 0<a.length}y.fastTemplate("addaddress",function(e){dialog({html:e,wrap:!0,success:function(e){var a=e.el.find(".currency").val();if(r(0,e=e.el.find(".address").val()))return n.add({currency:a,address:e}),!0},clbk:function(e){var a=e.find(".currency"),n=e.find(".address"),s=e.find(".btn1"),e=function(){return a.val(),r(0,n.val())?(s.removeClass("disabled"),!0):(s.addClass("disabled"),!1)};n.focus(),n.on("change",e),n.on("keyup",e),a.on("change",e),a.on("keyup",e),e()},class:"one addaddressDialog zindex"})},{})},n.removeEvent=function(){var e=$(this).closest(".addedAddress").attr("currency"),a=$(this).closest(".addedAddress").attr("address");n.remove(e,a)},n.addedAddresses=function(){var a="";_.each(n.value,function(e){e&&e.currency&&(a+='<div class="addedAddressWrapper">',a+='<div class="addedAddress table" currency="'+e.currency+'" address="'+e.address+'">',a+='<div class="currencyWrapper">',a+=e.currency.toUpperCase(),a+="</div>",a+='<div class="addressWrapper">',a+=e.address,a+="</div>",a+='<div class="panelWrapper">',a+='<div class="item remove">',a+='<i class="far fa-times-circle"></i>',a+="</div>",a+="</div>",a+="</div>",a+="</div>")}),n.el.find(".addedAddressesWrapper").html(a),n.el.find(".addedAddressesWrapper .remove").on("click",n.removeEvent)},n.init=function(e){n.defaultValue=[],n.el=e.find(".adressesInput"),n.addedAddresses(),n.el.find(".addaddress").on("click",n.addDialog)},n.input=function(){return'<div class="adressesInput"><div class="addaddressWrapper"><div class="addaddress"><i class="fas fa-plus"></i></div></div><div class="addedAddressesWrapper"></div></div>'},n}},g=null,v=null,k={options:function(a){h.shell({name:"options",el:t.options,data:{tempInfo:u,userOptions:m}},function(e){ParametersLive(_.toArray(m),e.el),m.addresses.init(e.el),a&&a()})},icon:function(a){h.shell({name:"icon",el:t.icon,data:{tempInfo:u,ed:o}},function(e){initUpload({el:e.el.find(".pgroup"),ext:["png","jpeg","jpg","webp","jfif"],dropZone:t.c,multiple:!1,action:function(e,a){f.upload(e,function(){i&&i.destroy(),_scrollTo(t.c.find(".nickname input").focus()),a&&a()})},onError:function(e,a,n){sitemessage(n)}}),o.wizard&&!u.image&&(i=h.app.platform.api.plissing({el:e.el.find(".iconWrapper"),text:"Upload Profile Image"})),a&&a()})},unspent:function(e,a){h.shell({name:"unspent",el:t.unspent,data:{unspent:e}},function(e){a&&a()})},caption:function(e,a){},address:function(){t.c.find(".adr").html(bitcoin.payments[h.app.platform.addressType]({pubkey:h.app.user.key.value}))}};return{primary:p,getdata:function(s,e){d=null,(o=e.settings.essenseData||{}).presave||(o.presave=function(e){e&&e()}),h.app.platform.sdk.user.get(function(){var e,a;_.isEmpty(h.app.platform.sdk.user.storage.me)&&(l=!0,(a=h.app.ref)&&a!=h.app.platform.sdk.address.pnet()&&(d=a)),e=_.map(h.app.platform.nodes,function(e,a){return a.toString()}),a=_.map(h.app.platform.nodes,function(e,a){return e.full}),(g=new Parameter({type:"VALUES",name:"setNode",id:"setNode",possibleValues:e,possibleValuesLabels:a,defaultValue:"1"})).value=h.app.platform.nodeid,g._onChange=function(e){h.app.platform.nodeid=e,h.app.platform.state.save()},(v=new Parameter({type:"VALUES",name:"setAddressType",id:"setAddressType",possibleValues:h.app.platform.addressTypes,possibleValuesLabels:["P2PKH","P2SH"],defaultValue:"p2sh"})).value=h.app.platform.addressType,v._onChange=function(e){h.app.platform.addressType=e,h.app.platform.state.save(),h.user.address.set(h.app.platform.sdk.address.pnet().address),h.app.reload()},f.userOptions();var n={};n.p2pkh=h.app.platform.sdk.address.pnet(),n.setNode=g,n.setAddressType=v,n.userOptions=m,n.tempInfo=u,n.firstTime=l,n.ref=d,n.caption=o.caption,d?h.sdk.users.get(d,function(){var e=d;(d=h.sdk.users.storage[e]||null)&&(d.address=e),n.ref=d,s(n)}):s(n)})},destroy:function(){return c=!(t={}),u={language:h.app.localization.key||"en"},null},init:function(e){(t={}).c=e.el.find("#"+h.map.id),t.transaction=e.el.find(".transactionInfo"),t.unspent=e.el.find(".unspentlist"),t.showhidetestpanel=e.el.find(".showhidetestpanel"),t.import=e.el.find(".import"),t.caption=t.c.find(".bgCaption"),t.icon=t.c.find(".pgroupIconWrapper"),t.usericon=t.c.find(".usericon"),t.options=t.c.find(".optionsParameters"),t.upanel=o.panel||t.c.find(".upanel"),t.signout=t.c.find(".signout"),t.import.on("click",r),t.showhidetestpanel.on("click",function(){$(this).closest(".testPanel").toggleClass("active")}),t.upanel.find(".cancel").on("click",s),t.upanel.find(".save").on("click",n),ParametersLive([g,v],t.c),t.signout.on("click",a),t.c.find(".refRemove").on("click",function(){d=null,delete localStorage.ref,t.c.find(".referalMaketWrapper").remove()}),f.upanel(),k.caption(),k.icon(),k.options(),h.sdk.node.transactions.get.unspent(function(e){k.unspent(e)}),h.app.platform.ws.messages.transaction.clbks.utemp=function(e){e.temp&&"userInfo"==e.temp.type&&f.upanel()},e.clbk(null,e)},wnd:{class:"withoutButtons allscreen testwindow"}}}var h=new nModule,y=h,s={};return h.run=function(e){var a=h.addEssense(s,n,e);h.init(a,e)},h.stop=function(){var a=null;if(_.each(s,function(e){(e=e.destroy())&&(a=e)}),a)return{action:a}},h}();"undefined"!=typeof module?module.exports=test:(app.modules.test={},app.modules.test.module=test);
 /*_____*/ 
var usersettings=function(){function s(e){var t,a,e=deep(e,"history"),o=!1,n={options:function(){i.shell({name:"options",el:t.options,data:{composed:a.c,themes:i.app.platform.sdk.theme.all,current:i.app.platform.sdk.theme.current}},function(s){ParametersLive(a.o,s.el),s.el.find(".themewrapper").on("click",function(){var e,t=$(this);t.hasClass("active")||(e=t.attr("theme"),s.el.find(".themewrapper").removeClass("active"),t.addClass("active"),i.app.platform.sdk.theme.set(e))});var e=s.el.find(".parameterMaketWrapper[parameter=telegram] input");e.on("change",function(e){var t=i.sdk.usersettings.meta,e=e.target.value;t.tgfrom[e]&&t.tgfrom[e].possibleValues?(t.tgfrom.possibleValues=t.tgfrom[e].possibleValues,t.tgfrom.possibleValuesLabels=t.tgfrom[e].possibleValuesLabels,t.tgfrom.value=t.tgfrom[e].value):(t.tgfrom.possibleValues=[],t.tgfrom.possibleValuesLabels=[],t.tgfrom.value=""),t.tgto[e]&&t.tgto[e].possibleValues?(t.tgto.possibleValues=t.tgto[e].possibleValues,t.tgto.possibleValuesLabels=t.tgto[e].possibleValuesLabels,t.tgto.value=t.tgto[e].value):(t.tgto.possibleValues=[],t.tgto.possibleValuesLabels=[],t.tgto.value=""),a=i.app.platform.sdk.usersettings.compose(l),i.sdk.usersettings.save(),l()}),e=e.val(),i.app.platform.sdk.system.get.telegramGetMe(e,!0,l,r)})},cache:function(){var e=i.app.platform.sdk.node.transactions.temp,s=[];_.each(e,function(e,t){_.each(e,function(e){s.push(e)})}),i.shell({name:"cache",el:t.cache,data:{temp:s,checking:o}},function(e){e.el.find(".check").on("click",function(){$(this).hasClass("disabled")||(o=!0,n.cache(),i.app.platform.sdk.node.transactions.checkTemps(function(){setTimeout(function(){o=!1,n.cache()},100)}))}),e.el.find(".clear").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear temporary application information? You balance can has changed on several minutes.",btn1text:i.app.localization.e("dyes"),btn2text:i.app.localization.e("dno"),success:function(){i.app.platform.sdk.node.transactions.clearTempHard(),n.cache()}})})})}},l=function(){n.options(),n.cache(),i.app.platform.sdk.node.transactions.clbks.settings=n.cache},r=function(e){var t=(e,t)=>{const s=document.createElement("div");s.classList.add("iWrapper");const a=document.createElement("i"),o=document.querySelector("div[parameter='telegram']");o&&(o.setAttribute("style","display: flex"),s.classList="tokenResult "+t,a.classList.add("fa"),a.classList.add(e),s.appendChild(a),o.appendChild(s))};e?t("fa-check-circle","success"):t("fa-times","failed")};return{primary:e,getdata:function(e){a=i.app.platform.sdk.usersettings.compose(l),e({})},destroy:function(){t={},delete i.app.platform.sdk.node.transactions.clbks.settings,i.app.user.features.telegram&&(controller.abort(),controller=new AbortController,i.app.platform.sdk.system.get.telegramUpdates())},init:function(e){(t={}).c=e.el.find("#"+i.map.id),t.options=t.c.find(".options"),t.cache=t.c.find(".cache"),controller=i.app.platform.sdk.system.get.telegramUpdateAbort,controller.abort(),i.app.platform.sdk.system.get.telegramUpdateAbort=new AbortController,l(),e.clbk(null,e)}}}var i=new nModule,a={};return i.run=function(e){var t=i.addEssense(a,s,e);i.init(t,e)},i.stop=function(){_.each(a,function(e){e.destroy()})},i}();"undefined"!=typeof module?module.exports=usersettings:(app.modules.usersettings={},app.modules.usersettings.module=usersettings);
 /*_____*/ 
var uploadpeertube=function(){function d(e){var d,a,r,e=deep(e,"history"),l={};return{primary:e,getdata:function(e,o){s=o.settings.essenseData,l=s.actions,e({})},destroy:function(){d={}},init:function(e){(d={}).c=e.el.find("#"+n.map.id),d.videoInput=d.c.find(".upload-video-file"),d.videoWallpaper=d.c.find(".upload-video-wallpaper"),d.videoError=d.c.find(".file-type-error"),d.wallpaperError=d.c.find(".wallpaper-type-error"),d.videoLabel=d.c.find(".upload-video-file-label"),d.wallpaperLabel=d.c.find(".upload-video-wallpaper-label"),d.uploadProgress=d.c.find(".upload-progress-container"),d.importUrl=d.c.find(".import-container"),d.uploadButton=d.c.find(".uploadButton"),d.cancelButton=d.c.find(".cancelButton"),d.header=d.c.find(".upload-header"),d.preloaderElement=d.c.find(".iconwr"),d.videoInput.change(async function(e){var o=e.target.files[0].name;return d.videoError.text(o.slice(0,20)+(20<o.length?"...":"")),d.videoError.removeClass("error-message"),e=d.videoInput.prop("files"),o=a.find(".upload-video-name").val(),a.find(".name-type-error").text(""),e[0]?e[0].type.includes("video")?(s.uploadInProgress=!0,d.header.removeClass("activeOnRolled"),d.uploadButton.prop("disabled",!0),d.uploadProgress.removeClass("hidden"),e={video:e[0]},o&&(e.name=o),o={progress:function(e){"100.00"===(e=(.9*e).toFixed(2))&&d.preloaderElement.hasClass("hidden")&&d.preloaderElement.removeClass("hidden"),d.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),d.uploadProgress.find(".upload-progress-percentage").text(e+"%")},cancel:function(e){s.cancelCloseFunction=()=>{"function"==typeof e&&e(),r.close()},d.cancelButton.on("click",()=>{d.uploadProgress.addClass("hidden"),d.cancelButton.addClass("hidden"),d.importUrl.removeClass("hidden"),s.uploadInProgress=!1,e()}),d.cancelButton.removeClass("hidden")}},d.importUrl.addClass("hidden"),n.app.peertubeHandler.api.videos.upload(e,o).then(e=>{d.uploadButton.prop("disabled",!1),d.header.addClass("activeOnRolled"),d.uploadProgress.addClass("hidden"),d.preloaderElement.addClass("hidden"),s.uploadInProgress=!1,e.error||(e.split("/").pop(),l.added(e,a.find(".upload-video-name").val()),r.close())}).catch(e=>{console.log("ERROR",e),d.videoInput.val(""),d.wallpaperError.text(""),d.uploadButton.prop("disabled",!1),d.header.addClass("activeOnRolled"),d.uploadProgress.addClass("hidden"),e.cancel?sitemessage("Uploading canceled"):(e=e.text||findResponseError(e)||"Uploading error",sitemessage(e))}),void console.log(e,o)):(d.videoError.text("Incorrect video format"),void d.videoError.addClass("error-message")):(d.videoError.text("No video selected"),void d.videoError.addClass("error-message"))}),d.importUrl.click(()=>{inputDialogNew({caption:n.app.localization.e("importHeading"),class:"importVideoDialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:n.app.localization.e("importInputPlaceholder"),label:n.app.localization.e("importInputLabel")}],success:function(e){d.videoInput.prop("disabled",!0),s.uploadInProgress=!0,d.header.removeClass("activeOnRolled"),d.uploadButton.prop("disabled",!0),d.uploadProgress.removeClass("hidden");var o={progress:function(e){"100.00"===(e=(.9*e).toFixed(2))&&d.preloaderElement.hasClass("hidden")&&d.preloaderElement.removeClass("hidden"),d.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),d.uploadProgress.find(".upload-progress-percentage").text(e+"%")},cancel:function(e){s.cancelCloseFunction=()=>{"function"==typeof e&&e(),r.close()},d.cancelButton.on("click",()=>{d.uploadProgress.addClass("hidden"),d.cancelButton.addClass("hidden"),d.importUrl.removeClass("hidden"),d.videoInput.prop("disabled",!1),s.uploadInProgress=!1,e()}),d.cancelButton.removeClass("hidden")}};d.importUrl.addClass("hidden"),n.app.peertubeHandler.api.videos.import({data:{targetUrl:e[0]}},o).then(e=>{e.error||(e.split("/").pop(),l.added(e,a.find(".upload-video-name").val()),s.uploadInProgress=!1,r.close())}).catch(e=>{d.videoInput.val(""),d.wallpaperError.text(""),d.uploadButton.prop("disabled",!1),d.header.addClass("activeOnRolled"),d.uploadProgress.addClass("hidden"),d.importUrl.removeClass("hidden"),d.videoInput.prop("disabled",!1),s.uploadInProgress=!1,e.cancel?sitemessage("Uploading canceled"):(e=e.text||findResponseError(e)||"Uploading error",sitemessage(e))})}})}),e.clbk(null,e)},wnd:{header:"",close:function(){s.closeClbk&&s.closeClbk()},postRender:function(e,o,d){r=o,a=e,d&&d()},offScroll:!0,noInnerScroll:!0,class:"uploadpeertube",allowHide:!0,noCloseButton:!0,noButtons:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var n=new nModule,a={},s={};return n.run=function(e){var o=n.addEssense(a,d,e);n.init(o,e)},n.stop=function(){_.each(a,function(e){e.destroy()})},n}();"undefined"!=typeof module?module.exports=uploadpeertube:(app.modules.uploadpeertube={},app.modules.uploadpeertube.module=uploadpeertube);
 /*_____*/ 
var accounts=function(){function s(e){function o(s){f.app.platform.sdk.pool.expand(c,function(e){var a=_.indexOf(e.addresses,s);-1<a&&(a=e.private[a],u.dumpkey(s,a))})}function n(){5<=deep(c,"addresses.length")?sitemessage("You have reached a maximum of 5 accounts. No more can be added "):f.app.nav.api.load({open:!0,id:"addaccount",inWnd:!0,essenseData:{success:function(a){console.log("mnemonic",a),f.app.platform.sdk.pool.expand(c,function(e){console.log("IMHERE",a),f.app.platform.sdk.pool.add(e,a,function(e,a){console.log("IMHERE",e),a?dialog({html:f.app.localization.e("aused"),class:"one"}):f.app.platform.sdk.pool.export(e,function(e){console.log("HERE"),f.app.platform.sdk.pool.current.packs[l]=e,f.app.platform.sdk.pool.save(),c=e,f.app.platform.sdk.pool.info(e,function(){u.addresses()})})})})}}})}function t(){i.dumpkey.html(""),i.c.find(".dumpaddress").html(""),i.c.removeClass("privatedump")}function s(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to see your private key?",btn1text:"See Private Key",btn2text:"Cancel",class:"zindex",success:function(){o(e)}})}function d(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to remove this address from this device?",btn1text:"Remove",btn2text:"Cancel",class:"zindex",success:function(){f.app.platform.sdk.pool.remove(c,e),f.app.platform.sdk.pool.save(),u.addresses()}})}function p(){var n,e=$(this).closest(".addressTable").attr("address");n=e,f.app.platform.sdk.pool.expand(c,function(e){var a,s,o=_.indexOf(e.addresses,n);-1<o?(a=e.private[o],s=f.app.user.stay,f.app.user.signout(function(){f.app.user.stay=s,f.user.signin(a,function(e){f.app.reloadLight(function(){var e="userpage?id=accounts&s="+makeid(),a=!1;f.app.user.validate()||(e="filluser",a=!0),f.app.nav.api.load({open:!0,href:e,history:a})})})})):console.log("INDEX",o)})}var i,c,l,r,e=deep(e,"history"),u={qrcode:function(e,a){new QRCode(e[0],{text:a,width:256,height:256})},dumpkeyabout:function(){},dumpkey:function(e,a){var s="";i.c.addClass("privatedump"),i.c.find(".dumpaddress").html(e);try{s=f.app.user.keysPairFromPrivate(a).toWIF().toString("hex")}catch(e){console.log("ER",e)}f.shell({name:"dumpkey",el:i.dumpkey,data:{private:a,address:e,privateWif:s},animation:"fadeIn"},function(e){u.qrcode(e.el.find(".code"),a),e.el.find(".copyvalue").on("click",function(){var e=$(this).closest(".infotable").find(".value");copyText(e),sitemessage("Value was successfully copied")})})},addresses:function(a){f.shell({name:"addresses",el:i.addresses,data:{current:f.app.platform.sdk.address.pnet().address,pack:c},animation:"fadeIn"},function(e){e.el.find(".remove").on("click",d),e.el.find(".dumpkey").on("click",s),e.el.find(".ncurrent .label").on("click",p),a&&a()})}};return{primary:e,getdata:function(e,a){r=deep(a,"settings.essenseData")||{},l=c=null,e({})},destroy:function(){i={}},init:function(e){var a,s;(i={}).c=e.el.find("#"+f.map.id),i.addresses=i.c.find(".addresses"),i.dumpkey=i.c.find(".dumpkey"),i.c.find(".add").on("click",n),i.c.find(".back").on("click",t),a=f.app.platform.sdk.address.pnet().address,(s=f.app.platform.sdk.pool.getPack(a))?(c=s[0],l=s[1],f.app.platform.sdk.pool.info(c,function(){u.addresses(function(){r.dumpkey&&o(a)})})):sitemessage("ERROR"),e.clbk(null,e)}}}var f=new nModule,o={};return f.run=function(e){var a=f.addEssense(o,s,e);f.init(a,e)},f.stop=function(){_.each(o,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=accounts:(app.modules.accounts={},app.modules.accounts.module=accounts);
 /*_____*/ 
var filluser=function(){function t(e){function s(n){g.app.ref?g.sdk.users.get(g.app.ref,function(){var e=deep(g,"sdk.users.storage."+g.app.ref+".name");n&&n(e)}):n&&n(null)}function c(){var e=g.app.ref||"",n="Overall";return-1<e.indexOf("author")&&(n="Account"),-1<e.indexOf("&s=")||-1<e.indexOf("&v=")?"Post":n}function i(n){return _.findIndex(m,function(e){return e==n})}function n(){var e,n;u&&(e=d[u],n=r.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=r.c.find(".stepsWrapperLine"),n=n.closest(".stepsWrapper").width(),r.c.find(".step").width(n),e.css("margin-left","-"+i(u)*n+"px"),e.width(n*_.toArray(d).length))}var r,o,a,t,e=deep(e,"history"),l=null,p=!1,f=!1,d={captcha:{id:"captcha",render:"captcha",nextindex:"email",prev:function(t){var e=g.sdk.address.pnet().address;g.app.settings.get(e,"request")?v.next():k.check(function(e){e?v.next():g.sdk.captcha.get(function(e,n){n?v.to("network"):e.done?(v.next(),k.request()):(d.captcha.current=e,t())},!0)},!0)},after:function(e,n){var t=e.find(".ucaptchainput"),a=e.find(".redo"),o=e.find(".addCaptcha");function i(e){return/^[a-zA-Z0-9]{4,}$/.test(e)}setTimeout(function(){t.focus()},150),t.on("keyup",function(){i($(this).val())?o.removeClass("disabled"):o.addClass("disabled")}),o.on("click",function(){var e=t.val();i(e)&&g.sdk.captcha.make(e,function(e,n){return"captchashots"==e?(sitemessage(g.app.localization.e("e13118")),void v.redo()):void(e?sitemessage(g.app.localization.e("e13118")):n.done&&(v.next(),k.request()))},!0)}),a.one("click",function(){v.redo()})}},email:{id:"email",nextindex:"money",prev:function(e){h.referral(),localStorage.uei?v.next():e()},render:"email",after:function(e,n,t){function a(e){return/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)}var o=e.find(".uemailinput"),i=e.find(".skip"),r=e.find(".addEmail");o.focus(),o.on("keyup",function(){a($(this).val())?(r.removeClass("disabled"),i.addClass("hidden"),r.html(g.app.localization.e("e13119"))):(r.addClass("disabled"),i.removeClass("hidden"),r.html(g.app.localization.e("e13113")))}),r.on("click",function(){var e=o.val();a(e)&&(v.next(),localStorage.uei=!0,function(e){topPreloader(20);var t={Email:e,Lang:g.app.localization.key||"en"};t.Action||(t.Action="ADDTOMAILLIST"),t.TemplateID="1005",t.ref="",s(function(e){var n="";t.ref+=c(),e&&(t.ref+=", "+e,n+='<p><a href="https://'+g.app.options.url+"/author?address="+g.app.ref+'">Referrer: '+e+"</a></p>"),(e=deep(document,"referrer"))&&(n+='<p><a href="'+e+'">From: '+e+"</a></p>"),t.body=encodeURIComponent(n),$.ajax({type:"POST",url:"https://"+g.app.options.url+"/Shop/AJAXMain.aspx",data:t,dataType:"json",success:function(){topPreloader(100)}})})}(e))}),i.one("click",function(){localStorage.uei=!0,v.next()})}},money:{id:"money",nextindex:"settings",prev:function(n){k.check(function(e){e?v.next():p?v.to("captcha"):f?v.to("moneyfail"):n()})},ret:!1,render:"money",after:function(n,t,e){v.timer(n.find(".time"),e||59,function(){k.check(function(e){!e||"money"!=u&&"captcha"!=u?(n.find(".subcaption").html(g.app.localization.e("wesentmoneydelay")),d.money.after(n,t,30)):v.next()},!0)})}},settings:{id:"settings",nextindex:"welcome",prev:function(e){e()},render:"settings",after:function(e,n){},next:!0},welcome:{id:"welcome",prev:function(e){e()},render:"welcome",after:function(e){setTimeout(function(){g.nav.api.go({href:"index?r=recommended",history:!0,open:!0})},1500),e.find(".welcome").on("click",function(){var e;"_this"==deep(a,"successHref")?((e=deep(t,"container.close"))&&e(),a.signInClbk&&a.signInClbk()):g.nav.api.go({href:"index?r=recommended",history:!0,open:!0})})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){g.app.errors.clbks.filluser=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=u||g.app.platform.loadingWithErrors||v.to("captcha"),delete g.app.errors.clbks.filluser)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(n){function t(){g.app.platform.sdk.node.transactions.get.allBalance(function(e){n.find(".balance").html("Balance: "+g.app.platform.mp.coin(e)+" PKOIN")})}t(),n.find(".check").on("click",function(){topPreloader(20),g.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),0<e&&("moneyfail"==u&&v.to("settings"),delete g.app.platform.sdk.node.transactions.clbks.moneyfail),t()}),g.app.platform.sdk.node.transactions.clbks.moneyfail=function(){g.app.platform.sdk.node.transactions.get.allBalance(function(e){0<e&&("moneyfail"==u&&v.to("settings"),delete g.app.platform.sdk.node.transactions.clbks.moneyfail)})}})}}},u=null,m=_.map(d,function(e,n){return n}),h={referral:function(){s(function(e){c(),deep(document,"referrer")})}},k={request:function(o){g.sdk.users.requestFreeMoney(function(e,n){var t=g.sdk.address.pnet().address,a=g.app.settings.get(t,"request")||"";e||a?(g.app.settings.set(t,"request","true"),k.follow(),o&&o(!0)):("captcha"==n&&(p=!0,"money"!=u&&"captcha"!=u||v.to("captcha")),"error"==n&&(f=!0,"money"!=u&&"captcha"!=u||v.to("captcha")),o&&o(!1,"err"))})},check:function(n,e){g.app.platform.sdk.node.transactions.get.allBalance(function(e){n&&n(0<e)},e)},follow:function(){g.app.platform.sdk.node.transactions.clbks.filluser||(g.app.platform.sdk.node.transactions.clbks.filluser=function(){delete g.app.platform.sdk.node.transactions.clbks.filluser,k.check(function(e){e?"money"==u&&v.next():k.follow()})})}},v={to:function(e,n){u=e,v.makeStep(n)},redo:function(e){v.makeStep(function(){})},next:function(e){(u=u?d[u].nextindex:d.captcha.id)&&v.makeStep(function(){})},makeStep:function(e){var t=d[u];t&&t.prev(function(){r.c&&(r.c.attr("step",t.id),y.panel(t,function(n){y.step(t,function(e){_scrollTop(e,l),n.find(".elpanel").addClass("active"),t.after(e,n)})}))})},timer:function(t,a,e){var o=new CircularProgress({radius:120,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 56px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#5D5D5D",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});function n(e){var n=secInTime(e/1e3).split(":");t.find(".t .min").html(n[0]),t.find(".t .sec").html(n[1]),o.options.text={value:""},o.update(e=(e=100*(1-e/(1e3*a)))<0?0:e)}t.find(".circle").html(o.el),timer=new Timer({ontick:function(){n(timer.getDuration())},onend:function(){e&&e()}}),timer.start(a),n(timer.getDuration())}},y={step:function(e,t){r.c.find(".step").removeClass("active");var n=r.c.find('.step[step="'+e.id+'"] .stepBody'),a=n.closest(".step"),o=r.c.find(".stepsWrapperLine");y[e.render](n,function(e){var n=a.closest(".stepsWrapper").width();r.c.find(".step").width(n),o.width(n*_.toArray(d).length),n="-"+i(u)*n+"px",o.css("margin-left",n),a.closest(".step").addClass("active"),t&&t(e)})},panel:function(e,n){g.shell({name:"panel",el:r.panel,data:{step:e}},function(e){n&&n(e.el)})},captcha:function(e,n){g.shell({name:"captcha",el:e,data:{captcha:d.captcha.current}},function(e){n&&n(e.el)})},email:function(e,n){g.shell({name:"email",el:e,data:{}},function(e){n&&n(e.el)})},welcome:function(e,n){g.shell({name:"welcome",el:e,data:{}},function(e){n&&n(e.el)})},moneyfail:function(e,n){g.shell({name:"moneyfail",el:e,data:{}},function(e){n&&n(e.el)})},network:function(e,n){g.shell({name:"network",el:e,data:{}},function(e){n&&n(e.el)})},money:function(e,n){g.shell({name:"money",el:e,data:{}},function(e){n&&n(e.el)})},settings:function(t,a,e){g.nav.api.load({open:!0,id:"test",el:t,essenseData:{wizard:!0,panel:r.panel,success:function(){v.next()}},clbk:function(e,n){o=n,a&&a(t)}})}};return{primary:e,getdata:function(n,e){f=p=!1,a=e.settings.essenseData||{},u=null;var t={steps:d};g.app.user.validate()?g.app.nav.api.load({open:!0,href:"index",history:!0}):g.app.errors.connection()?g.app.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):g.fastTemplate("panel",function(e){n(t)})},destroy:function(){window.removeEventListener("resize",n),o&&o.destroy(),o=null,r={},$("html").removeClass("fillinguser")},init:function(e){(r={}).c=e.el.find("#"+g.map.id),r.panel=r.c.find(".panelWrapper"),window.addEventListener("resize",n),t=e,v.next(),(l=r.c.closest(".wndcontent")).length||(l=null),$("html").addClass("fillinguser"),e.clbk(null,e)}}}var g=new nModule,a={};return g.run=function(e){var n=g.addEssense(a,t,e);g.init(n,e)},g.stop=function(){_.each(a,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=filluser:(app.modules.filluser={},app.modules.filluser.module=filluser);
 /*_____*/ 
var filluserfast=function(){function t(e){function s(n){return _.findIndex(d,function(e){return e==n})}function n(){var e,n;c&&(e=l[c],n=i.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=i.c.find(".stepsWrapperLine"),n=n.closest(".stepsWrapper").width(),i.c.find(".step").width(n),e.css("margin-left","-"+s(c)*n+"px"),e.width(n*_.toArray(l).length))}var i,t,a,e=deep(e,"history"),o={},r=null,c=null,l={settings:{id:"settings",nextindex:"captcha",prev:function(e){e()},render:"settings",after:function(e,n){},next:!0},captcha:{id:"captcha",render:"captcha",nextindex:"welcome",prev:function(t){var e=k.sdk.address.pnet().address,e=k.app.settings.get(e,"request")||"";console.log("requested"),e?f.next():p.check(function(e){console.log("result",e),e?f.next():k.sdk.captcha.get(function(e,n){console.log("errorerrorerror",n),n?f.to("network"):e.done?p.request(function(e){e&&f.next()}):(l.captcha.current=e,t())},!0)},!0)},after:function(e,n){var t=e.find(".ucaptchainput"),a=e.find(".redo"),o=e.find(".addCaptcha");function s(e){return/^[a-zA-Z0-9]{4,}$/.test(e)}t.focus(),t.on("keyup",function(){s($(this).val())?o.removeClass("disabled"):o.addClass("disabled")}),o.on("click",function(){var e=t.val();s(e)&&k.sdk.captcha.make(e,function(e,n){return"captchashots"==e?(sitemessage(k.app.localization.e("e13118")),void f.redo()):void(e?sitemessage(k.app.localization.e("e13118")):n.done&&p.request(function(e){e&&f.next()}))},!0)}),a.one("click",function(){f.redo()})}},welcome:{id:"welcome",prev:function(e){t.welcomepart&&t.welcomepart(),e()},render:"welcome",after:function(e){function n(){var e;"_this"==deep(t,"successHref")?((e=deep(a,"container.close"))&&e(),t.signInClbk&&t.signInClbk()):k.nav.api.go({href:"index?r=recommended",history:!0,open:!0}),isMobile()?k.app.platform.ui.showmykey():k.app.platform.ui.showmykeyfast()}setTimeout(function(){n()},1500),e.find(".welcome").on("click",function(){n()})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){k.app.errors.clbks.filluserfast=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=c||k.app.platform.loadingWithErrors||f.to("captcha"),delete k.app.errors.clbks.filluserfast)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(n){function t(){k.app.platform.sdk.node.transactions.get.allBalance(function(e){n.find(".balance").html("Balance: "+k.app.platform.mp.coin(e)+" PKOIN"),0<e&&((e=app.platform.sdk.registrations.storage[a])&&2==e&&k.sdk.registrations.add(a,3),"moneyfail"==c&&setTimeout(function(){f.to("welcome")},100),delete k.app.platform.sdk.node.transactions.clbks.moneyfail)})}var a=k.sdk.address.pnet().address;t(),n.find(".tryagain").on("click",function(){p.request(function(e){e&&f.next()})}),n.find(".check").on("click",function(){console.log("allBalanceCheck"),k.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),console.log("allBalance",e),t()},!0)}),k.app.platform.sdk.node.transactions.clbks.moneyfail=t}}},d=_.map(l,function(e,n){return n}),p={request:function(o){k.sdk.users.requestFreeMoney(function(e,n){var t=k.sdk.address.pnet().address,a=k.app.settings.get(t,"request")||"";e||a?(k.app.settings.set(t,"request","true"),k.sdk.registrations.add(t,3),o&&o(!0)):("captcha"==n&&("money"!=c&&"captcha"!=c||f.to("captcha")),console.log("err",n),"error"!=n&&"iplimit"!=n||"money"!=c&&"captcha"!=c||f.to("moneyfail"),_.isEmpty(n)&&f.to("moneyfail"),o&&o(!1,"err"))})},check:function(n,e){k.app.platform.sdk.node.transactions.get.allBalance(function(e){n&&n(0<e)},e)},follow:function(){k.app.platform.sdk.node.transactions.clbks.filluser||(k.app.platform.sdk.node.transactions.clbks.filluser=function(){delete k.app.platform.sdk.node.transactions.clbks.filluser,p.check(function(e){e?"money"==c&&f.next():p.follow()})})}},f={preloader:function(e){e?i.c.addClass("loading"):i.c.removeClass("loading")},signin:function(n){k.user.signin(o.mnemonicKey,function(e){n&&n()})},to:function(e,n){c=e,f.makeStep(n)},redo:function(e){f.makeStep(function(){})},next:function(e){var n;(c=c?l[c].nextindex:((n=deep(app,"platform.sdk.user.storage.me"))&&n.relay?l.captcha:l.settings).id)&&f.makeStep(function(){})},makeStep:function(e){var t=l[c];t&&(f.preloader(!0),t.prev(function(){i.c&&(i.c.attr("step",t.id),u.panel(t,function(n){u.step(t,function(e){f.preloader(!1),_scrollTop(e,scrollel),n.find(".elpanel").addClass("active"),t.after(e,n)})}))}))},testqrcodeandkey:function(e,n){e=k.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=u.qrcode(i.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg"),grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?n&&n(!1):n&&n(!0)},qrscanner.q.decode(e)})},generate:function(n){var t;o.mnemonicKey?n&&n():(t=bitcoin.bip39.generateMnemonic(),f.testqrcodeandkey(t,function(e){e?(o.mnemonicKey=t,e=k.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnetsimple(e.publicKey).address,o.mk=e.privateKey.toString("hex"),n&&n()):f.generate()}))},waitgeneration:function(e){retry(function(){if(o.mnemonicKey||o.mk)return!0},e,40)}},u={qrcode:function(e,n){return new QRCode(e[0],{text:n,width:256,height:256})},step:function(e,t){i.c.find(".step").removeClass("active");var n=i.c.find('.step[step="'+e.id+'"] .stepBody'),a=n.closest(".step"),o=i.c.find(".stepsWrapperLine");u[e.render](n,function(e){var n=a.closest(".stepsWrapper").width();i.c.find(".step").width(n),o.width(n*_.toArray(l).length),n="-"+s(c)*n+"px",o.css("margin-left",n),a.closest(".step").addClass("active"),t&&t(e)})},panel:function(e,n){k.shell({name:"panel",el:i.panel,turi:"filluser",data:{step:e}},function(e){n&&n(e.el)})},captcha:function(e,n){k.shell({name:"captcha",el:e,turi:"filluser",data:{captcha:l.captcha.current}},function(e){n&&n(e.el)})},email:function(e,n){k.shell({name:"email",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},welcome:function(e,n){k.shell({name:"welcome",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},moneyfail:function(e,n){k.shell({name:"moneyfail",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},network:function(e,n){k.shell({name:"network",el:e,turi:"filluser",data:{}},function(e){n&&n(e.el)})},money:function(e,n){k.shell({name:"money",el:e,data:{}},function(e){n&&n(e.el)})},settings:function(t,a,e){k.nav.api.load({open:!0,id:"test",el:t,essenseData:{wizard:!0,panel:i.panel,presave:function(n){f.waitgeneration(function(){k.app.user.isState(function(e){k.sdk.registrations.add(o.mainAddress,1),e?(k.sdk.registrations.add(o.mainAddress,1),n&&n()):f.signin(function(){n&&n()})})})},relay:function(){return o.mainAddress},success:function(e){o.info=e,k.sdk.registrations.add(o.mainAddress,2),m.save(),console.log("actions.next()",e),f.next()}},clbk:function(e,n){r=n,a&&a(t)}})}},m={save:function(){},load:function(){}};return{primary:e,getdata:function(e,n){!n.state||k.user.validateVay()?(o={},t=deep(n,"settings.essenseData")||{},c=null,e({steps:l,inauth:deep(n,"settings.essenseData.inauth")||!1})):k.app.nav.api.load({open:!0,href:"index",history:!0})},destroy:function(){window.removeEventListener("resize",n),delete k.app.platform.sdk.node.transactions.clbks.moneyfail,delete k.app.errors.clbks.filluserfast,delete k.app.platform.sdk.node.transactions.clbks.filluser,r&&r.destroy(),r=null,o={},i={}},init:function(e){m.load(),(i={}).c=e.el.find("#"+k.map.id),i.panel=i.c.find(".panelWrapper"),a=e,scrollel=i.c.closest(".wndcontent"),scrollel.length||(scrollel=null),window.addEventListener("resize",n),k.app.user.isState(function(e){e?((o={}).mainAddress=k.app.user.address.value,o.mk=k.app.user.private.value.toString("hex"),console.log(o.mainAddress)):setTimeout(function(){f.generate(function(){})},1e3),f.next()}),e.clbk(null,e)}}}var k=new nModule,a={};return k.run=function(e){var n=k.addEssense(a,t,e);k.init(n,e)},k.stop=function(){_.each(a,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=filluserfast:(app.modules.filluserfast={},app.modules.filluserfast.module=filluserfast);
 /*_____*/ 
var streampeertube=function(){function r(e){function t(){i.copyButton.each((e,t)=>{var r=(t=$(t)).attr("linkType");t.on("click",()=>{var e=i.c.find(`.${r}`);copyText(e),sitemessage("Link was copied to clipboard")})}),i.c.find(".closewindowaction").on("click",function(){n.close()})}var i,d,n,e=deep(e,"history"),l={};return{primary:e,getdata:function(r,e){var t;o=e.settings.essenseData,l=o.actions,c.app.peertubeHandler.checklink(o.currentLink)?(e=(t=c.app.peertubeHandler.parselink(o.currentLink)).id)?c.app.peertubeHandler.api.videos.getLiveInfo({id:e},{host:t.host}).then(e=>{var t;e.error?(t=deep(e,"error.responseJSON.errors")||{},t=(Object.values(t)[0]||{}).msg,sitemessage(t||"Server error")):(u=!0,s={rtmpUrl:e.rtmpUrl,streamKey:e.streamKey}),r({})}):r({}):(s=null,u=!1,r({}))},destroy:function(){i={}},init:function(e){(i={}).c=e.el.find("#"+c.map.id),i.videoInput=i.c.find(".upload-video-file"),i.videoWallpaper=i.c.find(".upload-video-wallpaper"),i.videoError=i.c.find(".file-type-error"),i.wallpaperError=i.c.find(".wallpaper-type-error"),i.uploadProgress=i.c.find(".upload-progress-container"),i.contentSection=i.c.find(".content-section"),i.resultSection=i.c.find(".result-section"),i.dateInput=i.c.find("#dtBox"),i.streamButton=i.c.find(".streamButton"),i.copyButton=i.c.find(".copyStreamInfo"),s?(u=!0,i.contentSection.addClass("hidden"),i.resultSection.removeClass("hidden"),i.resultSection.find(".result-video-rtmp").val(s.rtmpUrl),i.resultSection.find(".result-video-streamKey").val(s.streamKey),i.streamButton.html('<i class="fas fa-check"></i> Stream Created'),i.streamButton.addClass("successButton"),t(),e.clbk(null,e)):function(s){if(u)return u=!1,n.close();var e=d.find(".content-section"),a=d.find(".preloader-section");i.streamButton.addClass("disabledButton"),i.streamButton.text("Starting..."),e.addClass("hidden"),a.removeClass("hidden"),i.videoWallpaper.prop("files");var t=d.find(".upload-video-name").val();(e=(d.find(".name-type-error"),{})).name=t,c.app.peertubeHandler.api.videos.live(e).then(n=>{var o=d.find(".result-section");c.app.peertubeHandler.api.videos.getLiveInfo({id:n.uuid},{host:n.host}).then(e=>{var t,r;a.addClass("hidden"),n.error?(t=deep(n,"error.responseJSON.errors")||{},r=(Object.values(t)[0]||{}).msg,sitemessage(r||"Uploading error")):(u=!0,o.removeClass("hidden"),i.streamButton.html('<i class="fas fa-check"></i> Stream Created'),i.streamButton.removeClass("disabledButton"),i.streamButton.addClass("successButton"),t=o.find(".result-video-rtmp"),r=o.find(".result-video-streamKey"),t.val(e.rtmpUrl),r.val(e.streamKey),l.added(n.formattedLink),s())})})}(()=>{t(),e.clbk(null,e)})},wnd:{header:"",close:function(){o.closeClbk&&o.closeClbk()},postRender:function(e,t,r){n=t,d=e,r&&r()},offScroll:!0,noInnerScroll:!0,class:"streampeertube",allowHide:!0,noCloseButton:!0,noButtons:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var c=new nModule,n={},o={},u=!1,s=null;return c.run=function(e){var t=c.addEssense(n,r,e);c.init(t,e)},c.stop=function(){_.each(n,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=streampeertube:(app.modules.streampeertube={},app.modules.streampeertube.module=streampeertube);
 /*_____*/ 
var taginput=function(){function e(a){var o,s,a=deep(a,"history"),i={initsearch:function(){search(o.tagSearch,{placeholder:s.placeholder||g.app.localization.e("addtagsCategories"),clbk:function(a){},time:0,events:{fastsearch:function(e,n,a){if(a&&(a=String.fromCharCode(a.keyCode||a.which),/[,.!?;:() ]/.test(a)))return r.addTag(e.replace(/#/g,"").replace(/ /g,"")),o.tagSearch.find("input").val("").focus(),void n(null);g.app.platform.sdk.tags.search(e,function(a){var t=_.map(a,function(a){return{tag:a,name:"#"+a}}),a=g.app.platform.sdk.categories.search(e,i.language());s.addonlytags&&(a=[]),t=_.map(a,function(a){return{id:a.id,name:a.name}}).concat(t),c.tagsResults(t,function(a){n(a,function(a,t){a.find(".result").on("click",function(){t.closeResults(),t.clear(),r.add($(this))}),a.find(".empty").on("click",function(){var a=trim(o.tagSearch.find("input").val());a&&(t.closeResults(),t.clear(),r.addTag(a))})})})})},search:function(a,t,e){a=(a=a.replace(/#/g," ")).split(" "),1==(a=_.filter(a,function(a){return a})).length&&(a=a[0]),r.addTag(a),e.clear(),t&&t()}},last:{get:function(){var a=g.app.platform.sdk.categories.get(i.language())||[],t=_.map(g.app.platform.sdk.categories.getaddedtags(i.language()),function(a){return{tag:a,name:"#"+a}}),e=[g.app.localization.e("tnews"),g.app.localization.e("timages"),g.app.localization.e("tvideos"),g.app.localization.e("tmarket"),g.app.localization.e("tsport")],e=_.map(e,function(a){return{tag:a,name:"#"+a}});return(a=s.addonlytags?[]:a).concat(t,e)},tpl:function(a,t){c.tagsResults(a,function(a){t(a,function(a,t){a.find(".result").on("click",function(){t.closeResults(),t.clear(),r.add($(this))})})})}}})},language:function(){return s.language?s.language():null}},r={add:function(a){var t=a.attr("tag");(a=a.attr("category"))?(a=g.app.platform.sdk.categories.getbyid(a,i.language()),r.addTags(a.tags)):r.addTag(t),isMobile()&&setTimeout(function(){o.tagSearch&&o.tagSearch.find("input").focus()},500)},remove:function(){var a=$(this).closest(".wrps").attr("tag"),t=$(this).closest(".wrps").attr("category");t&&(t=g.app.platform.sdk.categories.getbyid(t,i.language()),r.removeTags(t.tags)),a&&r.removeTag(a),$(this).closest(".wrps").remove()},removeTag:function(a){s.removeTag&&s.removeTag(a)},removeTags:function(a){s.removeTags&&s.removeTags(a)},addTag:function(a){s.addTag&&s.addTag(a)},addTags:function(a){s.addTags&&s.addTags(a)}},c={tags:function(t){var a,e;o.tags&&(o.tags.find(".tag").remove(),a=s.tags?s.tags():[],e=g.app.platform.sdk.categories.fromTags(a,i.language()),s.addonlytags&&(e={tags:a,categories:[]}),g.shell({name:"tags",el:o.tags,data:{tags:s.tags?s.tags():[],bycategories:e}},function(a){a.el&&a.el.find(".remove").on("click",r.remove),t&&t()}))},tagsResults:function(a,t){g.shell({name:"tagsResult",data:{results:a}},function(a){t&&t(a.rendered)})}};return{primary:a,getdata:function(a,t){s=t.settings.essenseData||{},a({})},destroy:function(){o={}},init:function(a){(o={}).c=a.el.find("#"+g.map.id),o.tags=o.c.find(".tagsCont"),o.tagSearch=o.c.find(".searchWrapper"),i.initsearch(),c.tags(),a.clbk(null,a)}}}var g=new nModule,n={};return g.run=function(a){var t=g.addEssense(n,e,a);g.init(t,a)},g.stop=function(){_.each(n,function(a){a.destroy()})},g}();"undefined"!=typeof module?module.exports=taginput:(app.modules.taginput={},app.modules.taginput.module=taginput);
 /*_____*/ 
var tagcloud=function(){function e(t){function s(){r.app.platform.sdk.categories.gettags(null,"onlytags").length?c.cleartags.addClass("showed"):c.cleartags.removeClass("showed")}var c,l,t=deep(t,"history"),d=!1,i={showhide:function(){d?c.c.addClass("showedalltags"):c.c.removeClass("showedalltags")},tags:function(e,a){var s=r.app.platform.sdk.categories.gettagsmap(),n=[];_.each(s,function(t,a){-1==_.indexOf(e,a)&&n.push({tag:a,count:0})}),e=e.concat(n),_.each(e,function(t){t.count=Number(t.count||0)});var o=0;_.each(e,function(t){t.count>o&&(o=t.count)}),o++,e=_.sortBy(e,function(t){var a=1,e=t.count+1;return s[t.tag]&&(e=o+(t.count+1),a=100,s[t.tag].fixed&&(a=2)),-e*a}),(e=_.uniq(e,function(t){return t.tag})).length?(c.c.removeClass("hidden"),r.shell({name:"tags",el:c.tags,data:{tags:e,tagsmap:s}},function(t){i.showhide(),t.el.find(".showhidealltags").on("click",function(){d=!d,i.showhide(),l.renderclbk&&l.renderclbk()}),t.el.find(".tagcheckgl").on("click",function(){var t=$(this).closest(".tg");t.hasClass("fixed")||(t=t.attr("tag"),r.app.platform.sdk.categories.tag(t))}),l.renderclbk&&l.renderclbk(),a&&a()})):c.c.addClass("hidden")}},n=function(){var e=function(t,a){a&&(r.iclbks.maintag=n),i.tags(t),s()};r.app.platform.sdk.tags.cloud(function(t,a){t=r.app.platform.sdk.tags.filterEx(t),e(t,a)})};return{primary:t,getdata:function(t,a){l=a.settings.essenseData||{},t({})},destroy:function(){delete r.iclbks.maintag,delete r.app.platform.sdk.categories.clbks.tags.tagsmodule,delete r.app.platform.sdk.categories.clbks.selected.tagsmodule,c={}},init:function(t){(c={}).c=t.el.find("#"+r.map.id),c.tags=c.c.find(".tags"),c.cleartags=c.c.find(".cleartags"),r.app.platform.sdk.categories.clbks.selected.tagsmodule=function(t,a,e){n()},r.app.platform.sdk.categories.clbks.tags.tagsmodule=function(t,a,e){t=c.c.find('.tg[tag="'+t+'"]'),s(),a?t.addClass("selected"):t.removeClass("selected")},c.cleartags.on("click",function(){dialog({class:"zindex",html:"Do you really want to clear tags filters?",btn1text:r.app.localization.e("dyes"),btn2text:r.app.localization.e("dno"),success:function(){r.app.platform.sdk.categories.clear(null,!0),n()}})}),n(),t.clbk(null,t)}}}var r=new nModule,s={};return r.run=function(t){var a=r.addEssense(s,e,t);r.init(a,t)},r.stop=function(){_.each(s,function(t){t.destroy()})},r}();"undefined"!=typeof module?module.exports=tagcloud:(app.modules.tagcloud={},app.modules.tagcloud.module=tagcloud);
 /*_____*/ 
var staking=function(){function a(e){function n(t){k.app.api.fetch("exchanges/history").then(e=>{r=e.prices,t&&t()})}function a(){return[{name:"Coins",color:"#00A3F7",data:h.prices()}]}var i,r,e=deep(e,"history"),o=null,l=1e3,p=null,c="USD",s="bilaxy",u={mercatox:"last_price",bilaxy:"close"},d={},f={USD:{id:"USD",key:"USD",view:function(e){return k.app.platform.mp.dollars(e,{prefix:""})}},USDT:{id:"USDT",key:"USDT",view:function(e){return k.app.platform.mp.dollars(e,{prefix:""})}},BTC:{id:"BTC",key:"BTC",view:function(e){return k.app.platform.mp.acoin(e)}}},t=[{block:0,label:"Now",id:"now"},{block:30.5,label:"1 Month",id:"1m"},{block:182.5,label:"6 Months",id:"6m"},{block:365,label:"1 Year",id:"1y"}],m={currency:new Parameter({name:k.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"USD",possibleValuesLabels:["USD","USDT","BTC"],possibleValues:["USD","USDT","BTC"],format:{right:!0}})},h={netstakeweight:function(){return(deep(o,"netstakeweight")||0xabe8ad706f5a)/1e8},point:function(e){return h.netstakeweight(),l*Math.pow(1+3600/h.netstakeweight(),e)},price:function(e){if(e=e||0,r&&r[s]&&r[s].length>e){var t=r[s][r[s].length-1+e];if(t&&t.prices[c])return Number(t.prices[c].data[u[s]]||"0");if(t&&!t.prices[c])return 0<=(t=(e=Object.keys(u)).indexOf(s))&&e.splice(t,1),(e=e.map(e=>{var t=r[e][r[e].length-1];return Number(t.prices[c].data[u[e]]||"0")})).push(0),Math.max.apply(null,e)}return 0},prevprice:function(){for(var e=-1,t=0,a=this.price();t=this.price(e),e--,0<t&&t-a==0;);return t},prices:function(){var e=[];return r&&r[s]&&r[s].length&&(e=_.filter(r[s],function(e){return e}),e=_.map(e,function(e){if(e.prices[c])return{x:fromutc(new Date(e.date)),y:Number(e.prices[c].data[u[s]])}})),e}},b={prepare:function(e){return(e=new k.app.platform.objects.graph({el:e,shell:k.shell,chart:{caption:"Coins",height:70,width:70,type:"spline",xtype:"datetime",removeLegend:!0,disableYLabels:!0,disableXLabels:!0,yGridLineWidth:0,ypadding:0,disableTooltip:!0}})).series=a(),e},graph:function(e,t){p?(p.chart.update({series:a()}),t&&t(p,e)):(p=b.prepare(e)).render({maxPointsCount:10,prepareOptions:function(e){e.plotOptions.series={states:{inactive:{opacity:1},enableMouseTracking:!1,hover:{halo:{size:0},enabled:!1}}},e.plotOptions.spline={animation:!1,lineWidth:1,marker:{enabled:!1},states:{hover:{lineWidth:1,lineWidthPlus:0,marker:{fillColor:"#000",lineColor:"#000"},halo:{opacity:0}}}}}},function(){t&&t(p,e)})},pricechart:function(){}},g={updateValues:function(){this.updateValue(t[2]),this.updateValue(t[3]),this.updateValue(t[0])},updateValue:function(e){var t=i.c.find('.blv[item="'+e.id+'"]'),a=Number((t.text()||"0").replace(/,/g,""));a<0&&(a=0),e=h.point(e.block),t.animateNumber({number:e-a,numberStep:function(e,t){e=Number(a+e).toFixed(8),$(t.elem).text(k.app.platform.mp.coin(e=e<0?-e:e))}},rand(400,1200),function(){})},lastPrice:function(){p=null;var e="",t=h.price(0),a=h.prevprice(0),n={value:0,percent:0};t&&(e=f[c].view(t)),a&&t&&(n.value=a=t-a,n.percent=a/t),k.shell({inner:html,name:"lastprice",data:{price:e,currency:f[c],change:n},el:i.c.find(".lastpriceCnt")},function(e){g.pricechart()})},pricechart:function(){var e=i.c.find(".chart"),t=$("<div></div>",{class:"chartWrapper"});e.html(t),b.graph(t,function(e){})},updateTotal:function(e,t){g.datasets(e),d[e.id].update(),i.c.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(k.app.platform.mp.coinwithsmall(h.point(e.block))),t&&t()}},v=function(){var a;n(function(){g.lastPrice()}),a=function(e){e&&(k.iclbks.mainstacking=v),g.updateValues()},o?a(o):k.app.platform.sdk.node.get.info(function(e,t){e&&(o=e),a(e)})};return{primary:e,getdata:function(e){e({amount:l,parameters:m})},destroy:function(){delete k.iclbks.mainstacking,p=null,d={},i={}},init:function(e){var t;(i={}).c=e.el.find("#"+k.map.id),i.calculator=i.c.find(".calculator"),i.am=i.c.find(".amredits"),i.am.on("keyup",function(){var e=$(this).val()||"";5e5<(l=(l=Number(e.replace(/,/g,"")))<50?50:l)&&(l=5e5),g.updateValues()}),i.am.on("change",function(){var e=$(this).val()||"";5e5<(l=(l=Number(e.replace(/,/g,"")))<50?50:l)&&(l=5e5),$(this).val(l),g.updateValues()}),ParametersLive(_.toArray(m),i.c),m.currency._onChange=function(e){c=e,n(function(){g.lastPrice()})},i.c.find(".earnlabel").on("click",function(){var e="https://"+k.app.options.url;k.app.platform.sdk.address.pnet()&&(e+="?&ref="+k.app.platform.sdk.address.pnet().address),k.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:e,style:"smallcaption",caption:"The best way to earn Pocketcoin (PKOIN) is to invite people to the platform. You will get 20% of their PKOIN earnings for the first three months. Send the link below to anyone via email, social media, messenger."}})}),0<(t={alias:"numeric",groupSeparator:",",radixPoint:".",digits:0,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(t.placeholder="0"),i.am.inputmask(t),i.am.blur(),v(),e.clbk(null,e)}}}var k=new nModule,n={};return k.run=function(e){var t=k.addEssense(n,a,e);k.init(t,e)},k.stop=function(){_.each(n,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=staking:(app.modules.staking={},app.modules.staking.module=staking);
 /*_____*/ 
var articles=function(){function e(a){function e(){l.nav.api.load({open:!0,href:"article?aid="+makeid(),inWnd:!0,history:!0,essenseData:{save:function(t){l.app.platform.sdk.articles.storage||(l.app.platform.sdk.articles.storage=[]),_.find(l.app.platform.sdk.articles.storage,function(a){if(t.id==a.id)return!0})||l.app.platform.sdk.articles.storage.unshift(t),l.app.platform.sdk.articles.save()},close:function(){c.articles()},complete:function(){l.closeContainer()},closeContainer:function(){l.closeContainer()}}})}function n(a){l.nav.api.load({open:!0,href:"article?aid="+a.id,inWnd:!0,history:!0,essenseData:{art:a,save:function(a){l.app.platform.sdk.articles.save()},close:function(){c.articles()},complete:function(){l.closeContainer()},closeContainer:function(){l.closeContainer()}}})}function t(){var t=$(this).closest(".art").attr("art");dialog({html:l.app.localization.e("e13018"),btn1text:l.app.localization.e("dyes"),btn2text:l.app.localization.e("dno"),class:"zindex",success:function(){var a;a=t,removeEqual(l.app.platform.sdk.articles.storage,{id:a}),s.c.find('.art[art="'+a+'"]').remove(),l.app.platform.sdk.articles.save(),c.ini()}})}function i(){e()}function r(){var t=$(this).closest(".art").attr("art"),a=_.find(l.app.platform.sdk.articles.storage,function(a){return a.id==t});n(a)}function o(){l.nav.api.load({open:!0,href:"author?address="+l.app.user.address.value.toString("hex"),history:!0}),l.closeContainer()}var s,a=deep(a,"history"),c={ini:function(){l.app.platform.sdk.articles.storage.length?s.c.removeClass("initial"):s.c.addClass("initial")},articles:function(){c.ini(),l.shell({name:"articles",el:s.articles.find(".artwrapper"),data:{articles:l.app.platform.sdk.articles.storage}},function(a){a.el.find(".artcnt").on("click",r),a.el.find(".remove").on("click",t)})}};return{primary:a,auto:function(){var t=parameters(),a=null;t.marticle&&!l.app.nav.wnds.article&&((a=t.aid?_.find(l.app.platform.sdk.articles.storage,function(a){return a.id==t.aid}):a)?n(a):e())},getdata:function(a){a({})},destroy:function(){s={}},init:function(a){(s={}).c=a.el.find("#"+l.map.id),s.articles=s.c.find(".articles"),s.add=s.c.find(".add"),s.add.on("click",i),s.c.find(".top").on("click",o),c.articles(),a.clbk(null,a)},wnd:{class:"allscreen a100 article "}}}var l=new nModule,n={};return l.run=function(a){var t=l.addEssense(n,e,a);l.init(t,a)},l.stop=function(){_.each(n,function(a){a.destroy()})},l}();"undefined"!=typeof module?module.exports=articles:(app.modules.articles={},app.modules.articles.module=articles);
 /*_____*/ 
var system16=function(){function n(e){function n(){s&&(delete s.clbks.changednode.components,delete s.clbks.changed.components,delete s.clbks.tick.components,delete s.system.clbks.tick.components)}function i(e,t){return"function"==typeof x[e]?x[e](t):x[e]}function r(e,t){var o=[],n=e.series;return _.each(n,function(n){var a={color:n.color,data:[],name:n.name,type:n.type||e.meta.type};_.each(t,function(e){var t=deep(e.info,n.path)||0;a.data.push({y:t,x:new Date(e.time)})}),o.push(a)}),o}var l,e=deep(e,"history"),d=null,s=null,c=null,p=[],o=null,u=[],f={},m=["#F0810F","#011A27","#4897D8","#E6DF44","#063852","#486824"],a=null,h={server:{}},g={charts:{nodes:{type:"rating"},server:{type:"responses"},wallets:{type:"distribution"},peertube:{type:"allcount"}}},y={unableProxyConnect:{icon:'<i class="fas fa-wifi"></i>',text:"Unable to Connect to Proxy"},undefinedError:{icon:'<i class="fas fa-exclamation-triangle"></i>',text:"Undefined Error"}},t={firebase:function(){var e=h.server.firebase||o.firebase;inputDialogNew({caption:"Proxy Firebase Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Upload New Firebase Admin SDK",placeholder:"Upload file with .json extension",upload:{ext:["json"]}},{defValue:e.id,validate:"empty",label:"Application Id",placeholder:"Application Id"}],success:function(e){var t={};return t.key=deep(e,"0.base64"),t.id=e[1],t.key||t.id?(h.server.firebase=t,P.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},certificate:function(){h.server.ssl;var t={};inputDialogNew({caption:"Proxy SSL Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Certificate",placeholder:"Upload file with .pem extension",upload:{ext:["pem"]}},{defValue:"",validate:"empty",placeholder:"Upload file with .pem extension",label:"Certificate Key",upload:{ext:["pem"]}},{defValue:"",validate:"empty",label:"Password",placeholder:"Certificate Password"}],success:function(e){return t.cert=deep(e,"0.base64"),t.key=deep(e,"1.base64"),t.passphrase=e[2],t.name=deep(e,"0.file.name"),t.cert&&t.key&&t.passphrase&&t.name?(h.server.ssl=t,P.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},serverenabled:function(e){h.server.enabled=!JSON.parse(e.attr("value")),h.server.enabled==o.server.enabled&&delete h.server.enabled,P.webserveradmin(l.c)},nodeenabled:function(){var e=o.node.enabled?[{text:"Disable Pocketnet Node",action:function(t){return s.system.request("set.node.enabled",{enabled:!1}).then(e=>{t(),b.refresh().then(e=>{b.refreshsystem()})})}}]:[{text:"Enable Pocketnet Node",action:function(t){return s.system.request("set.node.enabled",{enabled:!0}).then(e=>{b.refresh().then(e=>{b.refreshsystem()}),t()})}}];menuDialog({items:e})},binPath:function(){return globalpreloader(!0),s.system.request("set.node.binPath",{}).then(e=>{b.refresh().then(e=>{b.refreshsystem(),globalpreloader(!1)})}).catch(e=>{globalpreloader(!1)})},ndataPath:function(){return globalpreloader(!0),s.system.request("set.node.ndataPath",{}).then(e=>{globalpreloader(!1),b.refresh().then(e=>{b.refreshsystem()})}).catch(e=>{globalpreloader(!1)})}},b={convertTime:function(e){_.each(e,function(e){e.time=fromutc(new Date(e.time))})},updateNode:function(){s.fetchauth("manage",{action:"node.update",data:{all:"all"}}).then(e=>{b.refresh().then(e=>{P.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),b.refresh().then(e=>{P.allsettings()}),topPreloader(100)})},installNode:function(){s.fetchauth("manage",{action:"node.install",data:{}}).then(e=>{b.refresh().then(e=>{P.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),b.refresh().then(e=>{P.allsettings()}),topPreloader(100)})},removeNode:function(e){s.fetchauth("manage",{action:"node.delete",data:{all:e}}).then(e=>{b.refresh().then(e=>{P.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),b.refresh().then(e=>{P.allsettings()}),topPreloader(100)})},admin:function(){var e=D.app.platform.sdk.address.pnet();return!!e&&(s&&c?s.direct||-1<_.indexOf(c.admins,e.address):void 0)},removeBot:function(t){topPreloader(30),s.fetchauth("manage",{action:"bots.remove",data:{address:t}}).then(e=>{u=_.filter(u,function(e){return e!=t}),P.botscontent(l.c),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),topPreloader(100)})},removeAdmin:function(e){topPreloader(30),s.fetchauth("manage",{action:"set.admins.remove",data:{address:e}}).then(e=>{b.refresh(),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),topPreloader(100)})},dust:function(e,t,n,a){D.app.platform.sdk.wallet.sendmanyoutputs(e,t,n,2,function(e,t){e&&D.app.platform.errorHandler(e,!0),a(e)})},ticksettings:function(e,t,n){n&&(o=e),P.allsettings()},refreshsystem:function(){return s.system.api.get.settings().then(e=>{o=e,l.c&&P.allsettings()})},refresh:function(){return s.get.info().then(e=>(this.tick(e.info),Promise.resolve()))},tick:function(e){c=e,(!(e=p[p.length-1])||new Date(e.time).addSeconds(10)<new Date)&&(p.push({info:c,time:new Date}),p=lastelements(p,1e3),l.c&&(P.nodecontentstate(l.c),P.nodescontenttable(l.c),P.peertubeinstancestable(l.c),P.webadminscontent(l.c),P.webdistributionwallets(l.c),P.webserverstatus(l.c)),setTimeout(function(){z.stats(!0)},200))},addnode:function(s,e){var i=!1,t="create",n=D.app.localization.e("e13044"),a=D.app.localization.e("add");s&&(i=!0,t="update",n=D.app.localization.e("e13062"),a=D.app.localization.e("save")),s=s||{};var r={host:new Parameter({type:"STRING",name:D.app.localization.e("nodehost"),id:"host",defaultValue:s.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:D.app.localization.e("e13063"),id:"port",defaultValue:s.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:D.app.localization.e("e13064"),id:"ws",defaultValue:s.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:D.app.localization.e("e13065"),id:"nodename",defaultValue:(s.nodename||(D.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:D.app.localization.e("e13066"),require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> '+D.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(e,n){var a,o=_.clone(s);s.host=r.host.value,s.port=r.port.value,s.ws=r.ws.value,s.nodename=r.nodename.value,s.rpcuser="",s.rpcpwd="","locally"==r.saveto.value?(s.rpcuser=r.rpcuser.value||"",s.rpcpwd=r.rpcpwd.value||"",s.locally=!0):(delete s.rpcuser,delete s.rpcpwd),s.host&&s.port&&s.ws&&s.nodename?(delete(a=_.clone(s)).addedby,delete a.date,a.locally||delete a.locally,D.app.platform.sdk.node.sys[t+r.saveto.value](a,function(e,t){e?(s=_.clone(o),sitemessage(e)):(i?(l.list.html(""),P.nodes(D.app.platform.nodes)):(D.app.platform.nodes||(D.app.platform.nodes=[]),D.app.platform.nodes.push(t),P.nodes([t])),D.app.platform.nodeid&&D.app.platform.nodeid.host!=a.host?n.close():b.connectnode(a,function(){n.close()}),P.active())})):sitemessage(D.app.localization.e("e13071"))}}};i&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+D.app.localization.e("delete"),fn:function(e,n){dialog({class:"zindex",html:D.app.localization.e("e13072"),success:function(){var e=s.locally?"revokelocally":"revokeproxy";D.app.platform.sdk.node.sys[e]({host:s.host},function(e,t){e?sitemessage(e):(l.list.find('.node[host="'+s.host+'"]').closest(".nodewrapepr").remove(),P.empty(),s.host==D.app.platform.nodeid.host?b.connectnode(null,function(){n.close()}):n.close())})}})}}),D.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:r},wnd:{header:n,buttons:a,noInnerScroll:!0,class:"addnodewnd"}},function(e){ParametersLive(_.toArray(r),e.el)})},settings:function(e){e.find("[sys]").on("click",function(){var e=$(this).attr("sys");!e||(e=deep(t,e))&&e($(this))})},node:{test:function(n){var e=_.map([{name:"Pageload",key:"pageload"},{name:"Limits",key:"limits"}],function(t){return{text:t.name,action:function(e){s.fetchauth("nodes/test",{scenario:t.key,node:n.key}).catch(e=>{sitemessage(e)}),e()}}});menuDialog({items:e})}},proxy:{selectWatch:function(){k.proxieslist(s,"Watch Proxy",function(e){C(e)})},selectUsing:function(){var e=d.get.current();k.proxieslist(e,"Select Proxy that using Interface",function(e){d.set.current(e.id,!0).then(e=>{C(d.get.current())})})},add:function(t){k.addproxy(null,function(e){t&&t()})},edit:function(e,t){k.addproxy(e,function(e){t&&t()})}}},v={nodes:{responsetime:{caption:"Nodes Response Time",series:[{name:"Median Response Time",path:"statistic.time",id:"ct"}]},rate:{caption:"Rate",series:[{name:"Requestes per seconds",path:"statistic.rate",id:"cr"}]},probability:{caption:"Probability",series:[{name:"Probability to select",path:"probability",id:"spr"}]},difference:{caption:"Block Height Difference",series:[{name:"Difference",path:"status.difference",id:"cd"}]},rating:{caption:"Rating",series:[{name:"Rating",path:"rating",id:"cr"}]},wsc:{caption:"Websocket Connections",series:[{name:"Websocket",path:"users",id:"wsc"}]},allcount:{caption:"Count of requestes",series:[{name:"Count of requestes",path:"statistic.allcount",type:"spline",id:"cr"},{name:"Success Count",path:"statistic.success",type:"areaspline",id:"cp"}]}},peertube:{responsetime:{caption:"Instance Median Response Time",series:[{name:"Median Response Time",path:"stats.averageTime",id:"sa"}]},allcount:{caption:"Count of requestes",series:[{name:"Count of requestes",path:"stats.count",type:"spline",id:"sc"},{name:"Success Count",path:"stats.success",type:"areaspline",id:"ss"}]},total:{caption:"Total count of videos",series:[{name:"Videos count",path:"stats.total",type:"spline",id:"sc"}]}},server:{connections:{caption:"Connections",series:[{path:"wss.users",name:"Websocket Connections",id:"wss"},{path:"server.middle.requestsIp",name:"Https requests IP",id:"requests"}]},memory:{caption:"Memory",series:[{path:"memory.rss",name:"RSS",id:"rss"}]},signatures:{caption:"Signed requests",objects:"server.middle.signatures",series:[{path:"length",namePath:"code",name:"Signature",id:"count"}]},responses:{caption:"Responses",objects:"server.middle.responses",series:[{path:"length",namePath:"code",name:"Code",id:"count"}]},rmts:{caption:"RMTS",series:[{path:"remote.size",name:"RMTS",id:"rmts"}]},cache:{caption:"Cache Size",objects:"server.cache.meta",series:[{path:"size",name:"Size",id:"size"}]}},wallets:{distribution:{caption:"Registration Address Distribution",series:[{path:"wallet.addresses.registration.queue",name:"Users Queue Size",id:"queue"},{path:"wallet.addresses.registration.unspents",name:"Unspents Count",id:"unspents"}]},balance:{caption:"Registration Address Balance",series:[{path:"wallet.addresses.registration.balance",name:"Address Balance",id:"balance"}]}}},x={server:function(e){var t=g.charts.server.type,a=v.server[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},s=0,t=[c];return a.objects&&(t=deep(c,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:m[s%m.length],type:e.type},s++})}),{meta:n,series:o}},nodes:function(e){var t=g.charts.nodes.type,n=v.nodes[t],t={type:"spline",xtype:"datetime",caption:n.caption},a={},o=0;return c.nodeManager&&_.each(c.nodeManager.nodes,function(e,t){_.each(n.series,function(e){a[e.id+t]={name:e.name+": "+t,path:"nodeManager.nodes.'"+t+"'."+e.path,color:m[o%m.length],type:e.type},o++})}),{meta:t,series:a}},peertube:function(e){var t=g.charts.peertube.type,n=v.peertube[t],t={type:"spline",xtype:"datetime",caption:n.caption},a={},o=0;return c.peertube&&_.each(c.peertube,function(e,t){_.each(n.series,function(e){a[e.id+t]={name:e.name+": "+t,path:"peertube.'"+t+"'."+e.path,color:m[o%m.length],type:e.type},o++})}),console.log("series",a),{meta:t,series:a}},wallets:function(e){var t=g.charts.wallets.type,a=v.wallets[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},s=0,t=[c];return a.objects&&(t=deep(c,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:m[s%m.length],type:e.type},s++})}),{meta:n,series:o}}},w={prepare:function(e,t,n){var a=i(e,t),e=_.clone(a.meta),t=r(a,t);return(e=new D.app.platform.objects.graph({el:n,shell:D.shell,chart:e})).series=t,e},graph:function(a,e,t,n){var o=w.prepare(a,e,t);i(a,e),o.render({height:250,maxPointsCount:50},function(){g.charts[a].showed&&t.find(".graphWrapper").addClass("showed"),t.find(".showgraphwrapper").on("click",function(){t.find(".graphWrapper").toggleClass("showed"),g.charts[a].showed=t.find(".graphWrapper").hasClass("showed"),o.chart.reflow()}),t.find(".subcaptiongraph").on("click",function(){var n=[];_.each(v[a],function(e,t){n.push({text:e.caption,action:function(e){g.charts[a].type=t,w.make(a,p),e()}})}),menuDialog({items:n})}),n&&n(o,t)})},make:function(t,e,n,a){var o,s;l.c&&(f[t]&&a?(o=i(t,e),s=r(o,e),s=f[t].rarefied(s,50),D.app.platform.focus&&(console.log("focus"),f[t].chart.update({series:s}))):(o=l.c.find("."+t+"chart"),s=$("<div></div>",{class:"chartWrapper"}),o.html(s),w.graph(t,e,s,function(e){f[t]=e,n&&n()},a)))}},k={addproxy:function(i,r){var l=!1,e=D.app.localization.e("e13054"),t=D.app.localization.e("add");i&&(l=i.id,e=D.app.localization.e("e13055"),t=D.app.localization.e("save")),i=i||{};var c={host:new Parameter({type:"STRING",name:D.app.localization.e("e13056"),id:"host",defaultValue:i.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:i.port||"8899",placeholder:"8899",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"wss",defaultValue:i.wss||"8099",placeholder:"8099",require:!0})},t={close:{class:"close",html:'<i class="fas fa-times"></i> '+D.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+t,fn:function(n,a){var o,t={},s=!0;_.each(c,function(e){t[e.id]=e.value||i[e.id],e.value||(s=!1)}),s?(t.user=!0,o=new Proxy16(t,D.app),D.app.api.get.byid(o.id)?sitemessage(D.app.localization.e("e13058")):(n.find(".addproxy").addClass("loading"),o.api.ping().then(e=>{var t;(t=l?D.app.api.editproxy(l,o.export()):D.app.api.addproxy(o.export()))?(r&&r(t),a.close()):sitemessage("Unable to add Proxy"),n.find(".addproxy").removeClass("loading")}).catch(e=>{n.find(".addproxy").removeClass("loading"),sitemessage("Unable to connect")}))):sitemessage(D.app.localization.e("e13057"))}}};l&&(t.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+D.app.localization.e("delete"),fn:function(e,t){dialog({class:"zindex",html:D.app.localization.e("e13059"),success:function(){var e=l.id==d.get.current().id;D.app.api.removeproxy(i.id),r&&r(null,e),t.close()}})}}),D.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:c},wnd:{header:e,buttons:t,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(c),e.el),e.el.find(".host input").focus()})},proxieslist:function(o,s,i){o=o||{};var e=D.app.api.get.proxies(),t={close:{class:"close",html:'<i class="fas fa-times"></i> '+D.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+D.app.localization.e("e13054"),fn:function(e,t){b.proxy.add(function(e){t.close(),k.proxieslist(o,s,i)})}}},e={destroy:function(){},name:"proxieslist",data:{proxies:e,proxy:o},wnd:{header:s,noInnerScroll:!0,class:"proxieslistwnd",buttons:t},insert:"wnd"};D.fastTemplate("proxieslist",function(e){new wnd({content:e,app:D.app,header:s,noInnerScroll:!0,class:"proxieslistwnd",buttons:t,clbk:function(a){a.el.find(".proxy").length?a.el.find(".proxieslist").removeClass("empty"):a.el.find(".proxieslist").addClass("empty"),a.el.find(".name").on("click",function(){var e=$(this).closest(".proxy").hasClass("active"),t=$(this).closest(".proxy").attr("pid");e||((t=D.app.api.get.byid(t))?i&&(i(t),a.close()):sitemessage("Error"))}),a.el.find(".delete").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=D.app.api.get.byid(e),n=d.get.current().id==e;t&&dialog({class:"zindex",html:D.app.localization.e("e13059"),success:function(){D.app.api.removeproxy(t.id),n&&C(d.get.current()),a.close(),k.proxieslist(o,s,i)}})}),a.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=D.app.api.get.byid(e),n=d.get.current().id==e;t&&b.proxy.edit(t,function(e){n&&C(d.get.current()),a.close(),k.proxieslist(o,s,i)})})}})},e.data)},addbotlist:function(){console.log("addbots");var n=inputDialogNew({caption:"Add Address to Proxy Bot List",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Addresses",label:"Bots addresses",text:!0}],success:function(e){var t=e[0].split(/[ \t\n\r]+/g);if(!(t=_.filter(t,function(e){var t=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){t=!1}return console.log("address",e,t),t})).length)return sitemessage("Addresses is not valid"),!1;topPreloader(30),s.fetchauth("manage",{action:"bots.addlist",data:{addresses:t}}).then(e=>{_.each(t,function(e){u.push(e)}),P.botscontent(l.c),n.destroy(),topPreloader(100)}).catch(e=>{console.log("E",e),sitemessage(D.app.localization.e("e13293")),topPreloader(100)})}})},addbot:function(){console.log("addbots");var a=inputDialogNew({caption:"Add Address to Proxy Bot List",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Address",label:"Bot address"}],success:function(e){var t=e[0];if(t){var n=!0;try{bitcoin.address.fromBase58Check(t)}catch(e){n=!1}}if(!n)return sitemessage("Address is not valid"),!1;topPreloader(30),s.fetchauth("manage",{action:"bots.add",data:{address:t}}).then(e=>{u.push(t),P.botscontent(l.c),a.destroy(),topPreloader(100)}).catch(e=>{console.log("E",e),sitemessage(D.app.localization.e("e13293")),topPreloader(100)})}})},addadmin:function(){var n=inputDialogNew({caption:"Add Admin to Proxy",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Address",label:"Admin address"}],success:function(e){if(e=e[0]){var t=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){t=!1}}if(!t)return sitemessage("Address is not valid"),!1;topPreloader(30),s.fetchauth("manage",{action:"set.admins.add",data:{address:e}}).then(e=>{b.refresh(),n.destroy(),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),topPreloader(100)})}})}},P={allsettings:function(){l.c&&(P.nodecontentmanage(l.c),P.nodecontentstate(l.c))},proxycurrent:function(t){var e=d.get.current();D.shell({inner:html,name:"proxycurrent",data:{proxies:d.get.proxies(),current:s,using:e,admin:b.admin()},el:l.proxycurrent},function(e){e.el.find(".current").on("click",b.proxy.selectWatch),e.el.find(".selectusing").on("click",b.proxy.selectUsing),t&&t()})},error:function(e,t,n){D.shell({inner:html,name:"error",data:{error:y[e]||y.undefinedError},el:t},function(e){e.el.find(".refreshpage").on("click",function(){C(s)}),n&&n()})},proxycontent:function(t){c?D.shell({inner:html,name:"proxycontent",data:{info:c,proxy:s,admin:b.admin()},el:l.proxycontent},function(e){P.servercontent(e.el),P.nodescontent(e.el),P.peertubecontent(l.c),P.nodecontent(e.el),P.bots(e.el),t&&t()}):P.error("unableProxyConnect",l.proxycontent)},bots:function(t,n){b.admin()&&D.shell({inner:html,name:"webbots",data:{admin:b.admin()},el:t.find(".botsWrapper")},function(e){e.el.find(".addbot").on("click",k.addbot),e.el.find(".addbotlist").on("click",k.addbotlist),P.botscontent(t),n&&n()})},botscontent:function(e,t){D.app.platform.sdk.users.get(u||[],function(){D.shell({inner:html,name:"webbotsContent",data:{admin:b.admin(),bots:u},el:e.find(".webbotsContentWrapper")},function(e){e.el.find(".exportlist").on("click",function(){text=u.join("\r\n"),copycleartext(text),sitemessage(D.app.localization.e("successcopied"))}),e.el.find(".removefromlist").on("click",function(){var e=$(this).attr("bot");e&&dialog({class:"zindex",html:"Do you really want to remove selected bot from Proxy server bot list?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){b.removeBot(e)}})}),t&&t()})})},servercontent:function(e,t){c?D.shell({inner:html,name:"servercontent",data:{info:c,proxy:s,admin:b.admin()},el:e.find(".serverWrapper")},function(){P.webservercontent(e),P.webadminscontent(e),P.webdistributioncontent(e),t&&t()}):t&&t()},webserverstatus:function(e,t){c?D.shell({inner:html,name:"webserverstatus",data:{info:c,proxy:s,admin:b.admin()},el:e.find(".webserverstatusWrapper")},function(e){t&&t()}):t&&t()},webservercontent:function(e,t){c?D.shell({inner:html,name:"webservercontent",data:{info:c,proxy:s,admin:b.admin()},el:e.find(".webServerWrapper")},function(e){P.webserverstatus(e.el),P.webserveradmin(e.el),t&&t()}):t&&t()},webserveradmin:function(t,n){b.admin()&&o?D.shell({inner:html,name:"webserveradmin",data:{admin:b.admin(),system:o,proxy:s,changes:h.server},el:t.find(".adminPanelWrapper")},function(e){b.settings(e.el),e.el.find(".todefaultcert").on("click",function(){dialog({class:"zindex",html:"Do you really want to cancel Certificate changes and set Default self-signed Certificate?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){s.fetchauth("manage",{action:"set.server.defaultssl",data:{}}).catch(e=>Promise.resolve()).then(e=>{C(s||d.get.current()),topPreloader(100)})}})}),e.el.find(".save").on("click",function(){function e(){globalpreloader(!0),s.fetchauth("manage",{action:"set.server.settings",data:{settings:h.server}}).catch(e=>(globalpreloader(!1),Promise.resolve())).then(e=>{h.server={},C(s||d.get.current()),globalpreloader(!1),topPreloader(100)})}(h.server.https||h.server.wss)&&(h.server.ports={https:h.server.https,wss:h.server.wss}),void 0!==h.server.enabled||h.server.https||h.server.wss||h.server.ssl?dialog({class:"zindex",html:"Do you really want to change this settings?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){e()}}):e()}),e.el.find(".clearfirebase").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear all firebase settings?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){s.fetchauth("manage",{action:"set.server.firebase.clear",data:{}}).then(e=>{C(s||d.get.current())}).catch(e=>{sitemessage(D.app.localization.e("e13293"))})}})}),e.el.find("[remove]").on("click",function(){var e=$(this).attr("remove");e&&delete h.server[e],P.webserveradmin(t)}),e.el.find(".discard").on("click",function(){h.server={},P.webserveradmin(t)}),e.el.find(".domain").on("change",function(){var e=$(this).val();$(this).val(e),e==o.server.domain?delete h.server.domain:h.server.domain=e,P.webserveradmin(t)}),e.el.find(".httpsport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==o.server.https?delete h.server.https:h.server.https=e,P.webserveradmin(t)}),e.el.find(".wsssport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==o.server.wss?delete h.server.wss:h.server.wss=e,P.webserveradmin(t)}),n&&n()}):n&&n()},webadminscontent:function(e,t){D.app.platform.sdk.users.get(c.admins,function(){D.shell({inner:html,name:"webadminscontent",data:{admins:c.admins,info:c,proxy:s,admin:b.admin()},el:e.find(".webAdminsWrapper")},function(e){e.el.find(".addadmin").on("click",k.addadmin),e.el.find(".remove").on("click",function(){var e,t=$(this).attr("address");t&&(e="Do you really want to remove selected admin from Proxy server admin list?",t==D.app.platform.sdk.address.pnet().address&&(e="Do you really want to remove Your account from Proxy server admin list?"),dialog({class:"zindex",html:e,btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){b.removeAdmin(t)}}))}),t&&t()})})},webdistributionwallets:function(e,t){D.shell({inner:html,name:"webdistributionwallets",data:{wallets:c.wallet,info:c,proxy:s,admin:b.admin()},el:e.find(".webdistributionwalletsWrapper")},function(e){e.el.find(".coins").on("click",function(){var t,e=$(this).closest(".wallet").attr("key");console.log("key",e,c.wallet),!e||(t=deep(c.wallet,"addresses."+e+".address"))&&dialog({class:"zindex",html:"Do you really want to send 1 PKOIN to this coin distribution address?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){topPreloader(30);var e=D.app.user.private.value.toString("hex");b.dust(e,t,2,function(e){b.refresh(),topPreloader(100),e||dialog({class:"one",html:"Pocketcoins sent to address. They will be available in several minutes"})})}})}),e.el.find(".settings").on("click",function(){var t,n=$(this).closest(".wallet").attr("key");n&&(t=inputDialogNew({caption:"Add Private Key To Coins Distribution",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Private Key (WIF Format)",label:"Private Key"}],success:function(e){e=e[0],topPreloader(30),s.fetchauth("manage",{action:"set.wallet.setkey",data:{key:n,privatekey:e}}).then(e=>{b.refresh(),t.destroy(),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),topPreloader(100)})}}))}),e.el.find(".remove").on("click",function(){var e=$(this).closest(".wallet").attr("key");e&&dialog({class:"zindex",html:"Do you really want to remove this private key from coins distribution process?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){topPreloader(30),s.fetchauth("manage",{action:"set.wallet.removeKey",data:{key:e}}).then(e=>{b.refresh(),topPreloader(100)}).catch(e=>{sitemessage(D.app.localization.e("e13293")),topPreloader(100)})}})}),t&&t()})},webdistributioncontent:function(e,t){D.shell({inner:html,name:"webdistributioncontent",data:{wallets:c.wallet,info:c,proxy:s,admin:b.admin()},el:e.find(".webDistributionWrapper")},function(e){P.webdistributionwallets(e.el),t&&t()})},peertubecontent:function(e,t){c?D.shell({inner:html,name:"peertubecontent",data:{info:c,proxy:s,admin:b.admin()},el:e.find(".peertubeWrapper")},function(){P.peertubeinstancestable(e),t&&t()}):t&&t()},peertubeinstancestable:function(e,t){console.log("info",c),D.shell({inner:html,name:"peertubeinstancestable",data:{info:c,proxy:s,admin:b.admin(),fixedinstance:null,currentinstance:null},el:e.find(".peertubeWrapper .instances")},function(e){t&&t()})},nodescontent:function(e,t){c?D.shell({inner:html,name:"nodescontent",data:{info:c,manager:c.nodeManager,proxy:s,admin:b.admin()},el:e.find(".nodesWrapper")},function(){e.find(".addnode").on("click",function(){b.addnode()}),P.nodescontenttable(e),t&&t()}):t&&t()},nodescontenttable:function(a,t){var e=d.get.current(),o=null;e.id==s.id&&s.current&&(o=s.current.key),D.shell({inner:html,name:"nodescontenttable",data:{info:c,manager:c.nodeManager,proxy:s,admin:b.admin(),currentnode:o,fixednode:d.get.fixednode()},el:a.find(".nodesWrapper .nodes")},function(e){e.el.find(".use").on("click",function(){var t,e=$(this).closest(".node").attr("node"),n=(t=$(this).closest(".node").attr("node"),_.find(c.nodeManager.nodes,function(e){return e.node.key==t}));"tmp"!=$(this).closest(".nodeWrapper").attr("key")&&n&&(e==o?d.get.fixednode()==e?(d.set.fixednode(null),P.nodescontenttable(a)):dialog({class:"zindex",html:"Do you really want to fix selected Pocketnet Node?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){d.set.fixednode(e),P.nodescontenttable(a)}}):dialog({class:"zindex",html:"Do you really want reconnect to selected Pocketnet Node?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){d.set.fixednode(null),s.changeNode(n.node),P.nodescontenttable(a)}}))}),e.el.find(".name").on("click",function(){}),t&&t()})},nodecontent:function(e,t){b.admin()?D.shell({inner:html,name:"nodecontent",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,proxy:s,admin:b.admin()},el:e.find(".localnodeWrapper")},function(){P.nodecontentstate(e),t&&t()}):t&&t()},nodecontentmanagestacking:function(e,t){b.admin()&&a&&D.shell({inner:html,name:"nodecontentmanagestacking",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:s,admin:b.admin(),system:o,stacking:a},el:e.find(".stacking")},function(e){e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(D.app.localization.e("successcopied"))}),t&&t()})},nodecontentmanage:function(e,n){var t,a;b.admin()&&(a=!1,(t=deep(c,"nodeControl.state.timestamp"))&&(a=new Date<fromutc(new Date(t).addSeconds(60))),D.shell({inner:html,name:"nodecontentmanage",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:s,admin:b.admin(),system:o,dis:a},el:e.find(".localnodeWrapper .manage")},function(e){function t(){e.el.find(".nodecontentmanage").addClass("lock")}console.log("info.nodeControl.state",c.nodeControl.state,c.nodeControl),z.stacking(),b.settings(e.el),e.el.find(".refreshstacking").on("click",function(){z.stacking(!0)}),e.el.find(".addstacking").on("click",function(){var o=inputDialogNew({caption:"Add Private Key To Address Stacking",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Private Key (WIF Format)",label:"Private Key"}],success:function(e){function t(){n||(clearTimeout(a),n=!0,z.stacking(!0),o.destroy(),topPreloader(100))}var e=e[0],n=!1,a=setTimeout(function(){t(),sitemessage("Stacking address will be added soon")},2e3);return topPreloader(30),s.fetchauth("manage",{action:"set.node.stacking.import",data:{privatekey:e}}).then(e=>{t()}).catch(e=>{n||(clearTimeout(a),sitemessage(deep(e,"message")||D.app.localization.e("e13293")),topPreloader(100))}),!1}})}),e.el.find(".updatenode").on("click",function(){dialog({class:"zindex",html:"Do you really want to Stop Pocketnet Node and Update It?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){t(),b.updateNode()}})}),e.el.find(".removenodeall").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove Pocketnet Node and All Blockchain Data?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){t(),b.removeNode(!0)}})}),e.el.find(".removenode").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove Pocketnet Node Daemon?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){t(),b.removeNode()}})}),e.el.find(".install").on("click",()=>{topPreloader(20),dialog({class:"zindex",html:"Do you really want to install Pocketnet Node?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){t(),b.installNode()}})}),e.el.find(".toDefaultPath").on("click",function(){dialog({class:"zindex",html:"Do you really want to set Pocketnet Node Path to Default path?",btn1text:D.app.localization.e("dyes"),btn2text:D.app.localization.e("dno"),success:function(){globalpreloader(!0),s.fetchauth("manage",{action:"set.node.defaultPaths",data:{}}).then(e=>{b.refresh().then(e=>{b.refreshsystem(),globalpreloader(!1)})}).catch(e=>{globalpreloader(!1),sitemessage(D.app.localization.e("e13293"))})}})}),e.el.find(".refreshother").on("click",function(){globalpreloader(!0),s.fetchauth("manage",{action:"set.node.check",data:{}}).then(e=>{b.refresh().then(e=>{b.refreshsystem(),setTimeout(function(){globalpreloader(!1)},300)})}).catch(e=>{setTimeout(function(){globalpreloader(!1)},300),sitemessage(D.app.localization.e("e13293"))})}),n&&n()}))},nodecontentstate:function(e,t){b.admin()&&D.shell({inner:html,name:"nodecontentstate",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:s,admin:b.admin()},el:e.find(".localnodeWrapper .state")},function(){t&&t()})}},z={stacking:function(t){b.admin()&&(!a||t)&&deep(c,"nodeControl.enabled")?s.fetchauth("manage",{action:"set.node.stacking.addresses",data:{}}).then(e=>{a=e,P.nodecontentmanagestacking(l.c),topPreloader(100)}).catch(e=>{t&&sitemessage(deep(e,"message")||D.app.localization.e("e13293")),topPreloader(100)}):P.nodecontentmanagestacking(l.c)},panel:function(){P.nodecontentmanage(l.c),P.nodecontentstate(l.c),P.nodescontenttable(l.c),P.peertubeinstancestable(l.c),P.webadminscontent(l.c),P.webdistributionwallets(l.c),P.webserveradmin(l.c)},stats:function(e){p&&(w.make("server",p,null,e),w.make("nodes",p,null,e),w.make("wallets",p,null,e),w.make("peertube",p,null,e))},proxycurrent:function(){P.proxycurrent(function(){z.proxycontent()})},proxycontent:function(){P.proxycontent(function(){})}},C=function(e){n(),s=e,c=null,p=[],u=[],f={};var t=l.c.find(".collapsepart").map(function(){return $(this).hasClass("expanded")});s?(s.clbks.changed.components=()=>{C(d.get.current())},s.clbks.changednode.components=()=>{P.nodescontenttable(l.c)},s.clbks.tick.components=b.tick,s.system.clbks.tick.components=b.ticksettings,s.get.info().then(e=>((c=e.info).server.listening&&c.wss.listening&&(g.charts.server.showed=!0),b.admin()&&(g.charts.nodes.showed=!0),p=[{info:c,time:utcnow()}],z.proxycurrent(),s.get.stats())).then(e=>{if(p=e.stats,p=lastelements(p,1e3),b.convertTime(p),setTimeout(function(){z.stats(),z.panel(),P.webserveradmin(l.c)},500),b.admin())return s.system.request("get.settings").then(e=>(o=e,P.allsettings(),Promise.resolve())).then(e=>s.system.request("bots.get")).then(e=>{u=e.bots||[],P.bots(l.c),l.c.find(".collapsepart").each(function(e){t[e]&&$(this).addClass("expanded")})})}).catch(e=>{z.proxycurrent()})):P.proxycurrent()};return{primary:e,getdata:function(e){d=D.app.api,e({})},destroy:function(){n(),l={}},init:function(e){(l={}).c=e.el.find("#"+D.map.id),l.proxycurrent=l.c.find(".proxycurrentWrapper"),l.proxycontent=l.c.find(".proxycontentWrapper"),l.c.on("click",".collapsepart .subcaption",function(){$(this).closest(".collapsepart").toggleClass("expanded")}),C(d.get.current()),e.clbk(null,e),D.app.errors.clbks.system16=function(){c||D.app.errors.state.proxy||!s||C(s)}}}}var D=new nModule,a={};return D.run=function(e){var t=D.addEssense(a,n,e);D.init(t,e)},D.stop=function(){_.each(a,function(e){e.destroy()})},D}();"undefined"!=typeof module?module.exports=system16:(app.modules.system16={},app.modules.system16.module=system16);
 /*_____*/ 
var categories=function(){function t(e){function n(){p.app.platform.sdk.categories.gettags().length?s.clearcategories.addClass("showed"):s.clearcategories.removeClass("showed")}function t(e){var t=!!e,n={name:(e=e||{name:"",tags:[],id:makeid(!0)}).name,tags:_.clone(e.tags),id:e.id};p.fastTemplate("addcategory",function(e){var a=dialog({html:e,class:"addcategorydialog",header:p.app.localization.e("addcategory"),btn1text:p.app.localization.e("dcancel"),btn2text:p.app.localization.e("save"),wrap:!0,clbk:function(e,a){r.tagsinput(e,n),e.find(".name").on("keyup",function(){n.name=flb($(this).val().replace(/[^a-zA-Zа-яА-Я0-9_ ]/g,""))}),e.find(".removecat").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove this category?",btn1text:p.app.localization.e("dyes"),btn2text:p.app.localization.e("dno"),success:function(){p.app.platform.sdk.categories.remove(n.id),g(),a.destroy()}})})},success:function(){return!0},fail:function(){var e=p.app.platform.sdk.categories.add(n);return e?("name"==e&&(a.el.find(".name").focus(),sitemessage(p.app.localization.e("emptycategoryname"))),"doublename"==e&&(a.el.find(".name").focus(),sitemessage(p.app.localization.e("doublename"))),"tags"==e&&(a.el.find(".sminput").focus(),sitemessage(p.app.localization.e("emptytags"))),!1):(t||p.app.platform.sdk.categories.select(n.id),g(),!0)}})},{category:n,hasc:t})}function o(e,a){e=e.toLowerCase(),-1<_.indexOf(a.tags,e)||a.tags.push(e)}function c(a,e){e.tags=_.filter(e.tags,function(e){return e!=a})}var s,i,l,e=deep(e,"history"),d=!1,r={tagsinput:function(a,t){p.nav.api.load({open:!0,id:"taginput",el:a.find(".tagswrapper"),eid:"addcategorytags",animation:!1,essenseData:{tags:function(){return t.tags},removeTag:function(e){c(e,t),r.tagsinput(a,t)},removeTags:function(e){_.each(tags,function(e){c(e,t)}),r.tagsinput(a,t)},addTag:function(e){o(e,t),r.tagsinput(a,t)},addTags:function(e){_.each(e,function(e){o(e,t)}),r.tagsinput(a,t)},addonlytags:!0,placeholder:p.app.localization.e("addtags")},clbk:function(e,a){s.c&&(l=a)}})},showhide:function(){d?s.c.addClass("showedallcats"):s.c.removeClass("showedallcats")},categories:function(e,a){s.c&&(e.length?(s.c.removeClass("hidden"),e=_.sortBy(e,function(e){return e.added?-1:e.selected?0:1}),p.shell({name:"categories",el:s.cats,data:{cats:e}},function(e){r.showhide(),e.el.find(".showhideallcats").on("click",function(){d=!d,r.showhide(),i.renderclbk&&i.renderclbk()}),e.el.find(".catcheckgl").on("click",function(){var e=$(this).closest(".tg").attr("category");p.app.platform.sdk.categories.select(e)}),e.el.find(".catedit").on("click",function(){var e=$(this).closest(".tg").attr("category"),e=p.app.platform.sdk.categories.getbyid(e);t(e)}),i.renderclbk&&i.renderclbk(),a&&a()})):s.c.addClass("hidden"))}},g=function(){var e=function(e,a){a&&(p.iclbks.maincat=g),r.categories(e),n()};cats=p.app.platform.sdk.categories.getwithselected(),e(cats)};return{primary:e,getdata:function(e,a){i=a.settings.essenseData||{},(a={}).video=!!parameters().video,e(a)},destroy:function(){delete p.iclbks.maincat,l&&(l.destroy(),l=null),delete p.app.platform.sdk.categories.clbks.selected.mainmodule,s={}},init:function(e){(s={}).c=e.el.find("#"+p.map.id),s.cats=s.c.find(".cats"),s.addcategory=s.c.find(".addcategory"),s.clearcategories=s.c.find(".clearcategories"),p.app.platform.sdk.categories.clbks.tags.mainmodule=p.app.platform.sdk.categories.clbks.selected.mainmodule=function(e,a,t){e&&(e=s.c.find('.tg[category="'+e+'"]'),a?e.addClass("selected"):e.removeClass("selected"),n())},s.c.find(".addcategory").on("click",function(){t()}),s.c.find(".clearcategories").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear category filters?",btn1text:p.app.localization.e("dyes"),btn2text:p.app.localization.e("dno"),success:function(){p.app.platform.sdk.categories.clear(),g()}})}),g(),e.clbk(null,e)}}}var p=new nModule,n={};return p.run=function(e){var a=p.addEssense(n,t,e);p.init(a,e)},p.stop=function(){_.each(n,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=categories:(app.modules.categories={},app.modules.categories.module=categories);
 /*_____*/ 
var article=function(){function t(e){var s,o,c,a,t,n,i=deep(e,"history"),r=/[,.!?;:()<> \n\r]/g,p={message:f.app.localization.e("emptymessage"),tags:f.app.localization.e("emptytags")},d={newart:function(){return f.app.platform.sdk.articles.empty()},complete:function(){c.save&&c.save(o),u.close(),c.complete&&c.complete(o)},change:function(e){o.content=e,o.time=Math.floor((new Date).getTime()/1e3),c.save&&c.save(o)},changecaption:function(e){o.caption.value=e,o.time=Math.floor((new Date).getTime()/1e3),c.save&&c.save(o)},trx:function(n,i){s.c&&s.c.addClass("loading"),c.share&&(n.aliasid=c.share.aliasid),console.log("share",n),f.sdk.node.transactions.create.commonFromUnspent(n,function(e,a){if(console.log("_alias",e),topPreloader(100),s.c&&s.c.removeClass("loading"),e)try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,n.aliasid&&(t.edit="true"),f.app.platform.sdk.node.shares.add(t),o.txid=t.txid,o.ptime=Math.floor((new Date).getTime()/1e3),d.complete()}catch(e){console.log(e)}else i?i(!1,p[a]):(a=f.app.platform.errorHandler(a,!0))&&sitemessage(a)},e)},fromShare:function(e){var a=f.app.platform.sdk.articles.empty();return a.caption.value=e.caption.v,a.content=[{value:e.message.v}],a.tags=_.clone(e.tags.v),a},add:function(){var e=new Share(f.app.localization.key),a=f.app.platform.sdk.articles.echo(o);(new Date).getTime(),e.message.set(a),e.caption.set(o.caption.value),e.images.set(f.app.platform.sdk.articles.getImages(a)),e.tags.set(o.tags||[]),e.settings.v="a",e.settings.videos=f.app.platform.sdk.articles.getVideos(a);var t=e.validation();console.log("ERROR",t),t?p[t]&&sitemessage(p[t]):(t="Do you really want to publish this article?",c.share&&(t="Do you really want to change and publish this article?"),dialog({html:t,btn1text:f.app.localization.e("dyes"),btn2text:f.app.localization.e("dno"),class:"zindex",success:function(){a=filterXSS(a,{stripIgnoreTag:!0,whiteList:{a:["href","title","target"],br:["style"],b:["style"],span:["style"],figure:["style"],figcaption:["style","class"],i:["style"],img:["src","width","height"],div:["class","data-plyr-provider","data-plyr-embed-id"],p:[],ul:[],ol:[],li:[],h2:[],h1:[],h3:[],h4:[],h5:[],em:[],u:[],blockquote:[],strong:[],picture:["img-type"],source:["srcset","type"],strike:[]}}),e.message.set(a),d.trx(e)}}))},tagsFromText:function(e){var e=e.split(r),t=_.filter(e,function(e){if("#"==e[0])return!!e.replace(/#/g,"")});return _.each(t,function(e,a){t[a]=e.replace(/\#/g,"")}),t},_addtag:function(e){return o.tags.length<5&&(removeEqual(o.tags,e),o.tags.push(e),!0)},addTags:function(e){_.find(e,function(e){if(!d._addtag(e))return sitemessage(f.app.localization.e("e13162")),!0}),c.save&&c.save(o)},addTag:function(e){d._addtag(e)?c.save&&c.save(o):sitemessage(f.app.localization.e("e13162"))},_removetag:function(e){removeEqual(o.tags,e)},removeTags:function(e){_.each(e,function(e){d._removetag(e)}),c.save&&c.save(o)},removeTag:function(e){d._removetag(e),c.save&&c.save(o)}},u={authorclose:function(){f.nav.api.load({open:!0,href:"author?address="+f.app.user.address.value.toString("hex"),history:!0}),f.closeContainer(),c.closeContainer&&c.closeContainer()},changecaption:function(){var e=$(this).val();d.changecaption(e)},change:function(){t=slowMade(function(){var e=f.app.platform.sdk.articles.lightVideo(a.serialize());d.change(e)},t,300)},close:function(){c.close&&c.close(),f.closeContainer()},add:function(){d.add()},goto:function(){o.txid&&(f.closeContainer(),c.closeContainer&&c.closeContainer(),f.nav.api.load({open:!0,href:"index?s="+o.txid,history:!0}))}},g={art:function(e,a){s.caption.val(e.caption.value)},tgs:function(t){f.nav.api.load({open:!0,id:"taginput",el:s.tgsWrapperMain,eid:"articletags",animation:!1,essenseData:{tags:function(){return o.tags||[]},removeTag:function(e){d.removeTag(e),g.tgs()},removeTags:function(e){d.removeTags(e),g.tgs()},addTag:function(e){d.addTag(e),g.tgs()},addTags:function(e){d.addTags(e),g.tgs()}},clbk:function(e,a){s.c&&(n=a,t&&t())}})}};return{primary:i,getdata:function(e,a){c=a.settings.essenseData||{},o=c.art||d.newart(parameters().aid),c.share&&(o=d.fromShare(c.share)),console.log("ed",c),o.tags||(o.tags=[]),console.log("art",o),e({art:o,ed:c})},destroy:function(){f.app.nav.api.history.removeParameters(["aid"]),n&&(n.destroy(),n=null),s={}},init:function(e){(s={}).c=e.el.find("#"+f.map.id),s.caption=s.c.find(".caption"),s.content=s.c.find(".content"),s.back=s.c.find(".back"),s.add=s.c.find(".add"),s.goto=s.c.find(".goto"),s.tgsWrapperMain=s.c.find(".tgsWrapperMain"),s.back.on("click",u.close),s.caption.on("keyup",u.changecaption),s.add.on("click",u.add),s.goto.on("click",u.goto),s.c.find(".uic").on("click",u.authorclose),s.c.find(".username").on("click",u.authorclose),g.tgs(),a=new MediumEditor(".edt",{delay:500,targetBlank:!0,toolbar:{buttons:["bold","italic","underline","anchor","quote"],diffLeft:25,diffTop:10},anchor:{placeholderText:"Type a link",customClassOption:"btn",customClassOptionText:"Create Button"},paste:{cleanPastedHTML:!0,cleanAttrs:["style","dir"],cleanTags:["label","meta"]},anchorPreview:{hideDelay:300},placeholder:{text:"Text",hideOnClick:!1}}),$(function(){$(".edt").mediumInsert({editor:a,addons:{images:{label:'<span class="fas fa-camera"></span>',deleteScript:function(e,a){f.sdk.imagesH.delete(e)},fileDeleteOptions:{},preview:!0,captions:!0,captionPlaceholder:f.app.localization.e("e13013"),autoGrid:3,formData:{},upload:function(e,t){resize(e,1080,1080,function(e){var a=e.split(",");a[1]&&f.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:a[1]},success:function(e){var a=deep(e,"data.link");a?(e=deep(e,"data.deletehash"))&&f.sdk.imagesH.add(a,e):a="https://"+f.app.options.url+"/img/imagenotuploaded.jpg",t&&t(a)},fail:function(e){app.ajax.run({type:"POST",up1:!0,data:{file:a[1]},success:function(e){e="https://"+f.app.options.url+":8092/i/"+deep(e,"data.ident"),t&&t(e)},fail:function(e){l="https://"+f.app.options.url+"/img/imagenotuploaded.jpg",t&&t(l)}})}})})},fileUploadOptions:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}},messages:{acceptFileTypesError:f.app.localization.e("e13014")+" ",maxFileSizeError:f.app.localization.e("e13015")+" "},uploadCompleted:function(e,a){u.change()},uploadFailed:function(e,a){}},embeds:{label:'<span class="fas fa-play"></span>',placeholder:f.app.localization.e("e13016"),styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}}}}}),a.subscribe("editableKeyup",function(){u.change()}),a.subscribe("editablePaste",function(){u.change()}),a.subscribe("editableBlur",function(){u.change()}),g.art(o),Plyr.setup(".js-player",function(e){})}),e.clbk(null,e)},wnd:{class:"allscreen a100 article articlebtn"}}}var f=new nModule,n={};return f.run=function(e){var a=f.addEssense(n,t,e);f.init(a,e)},f.stop=function(){_.each(n,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=article:(app.modules.article={},app.modules.article.module=article);
 /*_____*/ 
var lastcomments=function(){function s(e){function s(){var e=$(this).attr("id"),n=$(this).attr("pid"),s=$(this).closest(".commentgroup").attr("share");l.app.platform.app.nav.api.load({open:!0,href:"post?s="+s,inWnd:!0,history:!0,clbk:function(e,n){app.nav.wnds.post=n},essenseData:{share:s,hr:"index?",reply:{answerid:e,parentid:n||"",noaction:!0}}})}var t,e=deep(e,"history"),o=null,a=function(){var c=function(e,n){if(t.c){if(n)return l.iclbks.main=a,void t.c.addClass("hidden");t.c.removeClass("hidden"),l.shell({name:"lastcommentslist",el:t.c,data:{comments:e}},function(e){e.el.find(".comment").on("click",s),e.el.find(".image").imagesLoaded({background:!0},function(e){o.renderclbk&&o.renderclbk()}),o.renderclbk&&o.renderclbk()})}};l.app.platform.sdk.comments.last(function(n,o){var a=group(n,function(e){return e.txid}),e=_.map(a,function(e,n){return n});l.app.platform.sdk.node.shares.getbyid(e,function(e,s){var t=[];_.each(n,function(e){var n=app.platform.sdk.node.shares.storage.trx[e.txid];n&&e&&(t.push(n.address),t.push(e.address))}),t=_.uniq(t),l.sdk.users.get(t,function(e,n){c(a,o||s||n)},!0)})})};return{primary:e,getdata:function(e,n){o=n.settings.essenseData||{},e({})},destroy:function(){t={},console.log("DESTROYED"),delete l.app.platform.ws.messages.newblocks.clbks.lastcomments,delete l.app.platform.ws.messages["new block"].clbks.lastcomments,delete l.app.platform.clbks._focus.lastcomments},init:function(e){(t={}).c=e.el.find("#"+l.map.id),l.app.platform.ws.messages.newblocks.clbks.lastcomments=l.app.platform.ws.messages["new block"].clbks.lastcomments=function(e,n){console.log("CLBKS"),a()},l.app.platform.clbks._focus.lastcomments=function(e){120<e&&"undefined"!=typeof _Electron&&(console.log("CLBKS2"),a())},a(),e.clbk(null,e)}}}var l=new nModule,t={};return l.run=function(e){var n=l.addEssense(t,s,e);l.init(n,e)},l.stop=function(){_.each(t,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=lastcomments:(app.modules.lastcomments={},app.modules.lastcomments.module=lastcomments);
 /*_____*/ 
var video=function(){function n(e){function i(){a.join()}var t,l,e=deep(e,"history"),r=[{key:"gMrKZfHJSxA",width:560,height:315,source:"youtube",loc:{en:{title:"Pocketnet - Decentralized Social Network on the Blockchain",id:"gMrKZfHJSxA",description:"Pocketnet is a fully decentralized publishing and social platform. Based on the blockchain technology, it runs on a set of computers around the world, not controlled by any single entity.No corporation behind it to take fruits of your labor. All advertising revenue is split equally between node operators and those who publish highly rated content. Your subscribers always see your content, unless they decide to unsubscribe. Pocketnet is self-policed by the platform participants with good reputation. Nobody records your keystrokes, viewing habits or searches. Join The New Peer-To-Peer Internet: Go to Pocketnet.app and join for free now"}}}],a={validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,i,n,o){o=o||"4",(i={Email:e,Name:i,Lang:c.app.localization.key||"en"}).Action||(i.Action="ADDTOMAILLIST"),i.TemplateID||(i.TemplateID=o),$.ajax({type:"POST",url:"https://"+c.app.options.url+"/Shop/AJAXMain.aspx",data:i,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){c.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){c.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var i=e.el.find(".email"),e=e.el.find(".name"),i=i.val(),e=e.val();if(a.validateEmail(i)&&e)return a.saveEmail(i,e),a.joinSuccess(i,e),!0},clbk:function(e){function i(){var e=o.val(),i=n.val();return a.validateEmail(e)&&i?(t.removeClass("disabled"),!0):(t.addClass("disabled"),!1)}var n=e.find(".name"),o=e.find(".email"),t=e.find(".btn1");t.addClass("disabled"),t.on("click",function(){}),n.focus(),n.on("change",i),n.on("keyup",i),o.on("change",i),o.on("keyup",i)},class:"one joinbeta"})},{action:e})}};return{primary:e,getdata:function(e,i){var n=parameters();function o(){c.nav.api.load({open:!0,href:"page404",history:!0})}n.v||(n.v="gMrKZfHJSxA");var t,a=_.find(r,function(e){return e.key==n.v});a?(c.app.el.menu.addClass("logoview").addClass("landing"),t=l=_.clone(a),(a=deep(t,"loc.en")||null)&&_.extend(t,a),l.id?e(l):o()):o()},destroy:function(){t={},c.app.el.menu.removeClass("logoview").removeClass("landing"),c.app.el.app.removeClass("videoActive")},init:function(o){(t={}).c=o.el.find("#"+c.map.id),t.container=t.c.find(".container"),t.c.click&&t.c.click(),c.app.el.app.addClass("videoActive"),t.c.find(".joinbeta").on("click",i),setTimeout(function(){var e,i,n;n='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+l.id+'?rel=0&amp;autoplay=1" frameborder="0" allow="autoplay;" allowfullscreen></iframe>',"vimeo"==l.source&&(n='<iframe src="https://player.vimeo.com/video/'+l.id+'?title=0&byline=0&portrait=0" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),"bitchute"==l.source&&(n='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://www.bitchute.com/embed/'+l.id+'/"></iframe>'),"peertube"==l.source&&(n='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://pocketnetpeertube1.nohost.me/videos/embed/'+l.id+'/"></iframe>'),t.c.find(".container").html(n),l.description&&t.c.find(".description").html(l.description),e=l,e=(n=(i=t.container).width())/(e.width/e.height),i.find("iframe").width(n),i.find("iframe").height(e),t.container.find("iframe").fadeIn(200),t.c.find(".description").fadeIn(200),o.clbk(null,o)},100)},animation:!1}}var c=new nModule,o={};return c.run=function(e){var i=c.addEssense(o,n,e);c.init(i,e)},c.stop=function(){_.each(o,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=video:(app.modules.video={},app.modules.video.module=video);
 /*_____*/ 
var proxylogs=function(){function n(t){function o(t){t.find(".expandall").on("click",function(){$(this).closest(".report").toggleClass("active")})}var r,t=deep(t,"history"),a={requests:{ws:{path:"ws",name:"Websocket connections",color:"#006CFF"},requests:{path:"requestsIp",name:"Https requests ip",color:"#FF004E"}},blacklists:{black:{path:"iplimiter.black",name:"Black list ip count",color:"#20C02B"},tblack:{path:"iplimiter.black",name:"Temp Black list ip count",color:"#00C0FF"}}},l={prepare:function(t,s,n){var o,r,e,l,e=(l={type:"spline",xtype:"datetime"},"requests"==(e=t)&&(l.caption="Connections"),"blacklists"==e&&(l.caption="Black list"),l),l=(o=s,r=[],_.each(a[t],function(n){var e={color:n.color,data:[],name:n.name};_.each(o,function(t){var s=deep(t,n.path)||0;e.data.push({y:s,x:new Date(t.time)})}),r.push(e)}),r);return console.log(t,l,s),(e=new c.app.platform.objects.graph({el:n,shell:c.shell,chart:e})).series=l,e},make:function(t,s,n,e){var o=l.prepare(t,s,n);o.render({maxPointsCount:100},function(){e&&e(o)})}},i={users:function(t){var s=[],n=t.find(".loadaddress");n.each(function(){var t=$(this).attr("address");t&&s.push(t)}),s.length&&c.shell({name:"user",data:{}},function(t){console.log(t),c.app.platform.sdk.users.get(s,function(t,s){n.each(function(){var t=$(this).attr("address");t&&($(this).removeAttr("address"),c.shell({name:"user",data:{address:t},el:$(this)},function(t){}))})})})},logs:function(e,s){c.shell({name:"logs",data:{logs:e},el:r.logs},function(t){o(t.el),t.el.find(".expand").on("click",function(){var t=$(this).closest(".log"),s=t.attr("ip"),n=_.find(e,function(t){return t.ip==s});t.hasClass("active")?t.toggleClass("active"):i.wslogs(t.find(".wslogswrp"),deep(n,"ws"),function(){t.toggleClass("active")},!0)}),s&&s()})},ws:function(s,n){c.shell({name:"ws",data:{ws:s},el:r.ws},function(t){o(t.el),i.wslogs(t.el.find(".wslogswrp"),s),n&&n()})},block:function(t,s){c.shell({name:"block",data:{block:t},el:r.block},function(t){o(t.el),s&&s()})},wslogs:function(t,s,n,e){c.shell({name:"wslogs",data:{ws:s,users:e},el:t},function(t){e&&i.users(t.el),t.el.find(".clickload").on("click",function(){i.users($(this).closest(".address"))}),n&&n()})},error:function(s){c.shell({name:"error",data:{},el:r.error},function(t){s&&s()})},stats:function(s,n){c.shell({name:"stats",data:{stats:s},el:r.stats},function(t){i.statsChart("requests",s,t.el.find(".chartswrapper")),i.statsChart("blacklists",s,t.el.find(".chartswrapper")),n&&n()})},statsChart:function(t,s,n,e){var o=$("<div></div>",{class:"chartWrapperbs"});n.append(o),l.make(t,s,o,e)}};return{primary:t,getdata:function(t){t({})},destroy:function(){r={}},init:function(t){var n;(r={}).c=t.el.find("#"+c.map.id),r.logs=t.el.find(".logsWrapper"),r.ws=t.el.find(".wsWrapper"),r.block=t.el.find(".blockWrapper"),r.stats=t.el.find(".statsWrapper"),r.error=t.el.find(".errorWrapper"),n=function(s){var n;s&&i.stats(s),n=function(t){t&&(i.logs(t.logs),i.ws(t.ws),i.block(t.blocks)),s||t||i.error()},c.app.platform.sdk.system.get.info(function(t,l){var a,s;console.log(t),l?(a=[],s={},t=group(l.logs,function(t){return t.ip}),_.each(t,function(t,n){var s=_.filter(l.ws,function(t){if(t.ip==n)return t.using=!0}),s=_.sortBy(s,function(t){return-(t.ws_clients+t.ws_nodes)}),e=_.find(l.iplimiter,function(t,s){if(s==n)return t.using=!0}),o={},r=group(t,function(t){return t.s});_.each(r,function(t,s){o[s]=group(t,function(t){return deep(t,"p.method")||deep(t,"pn")||"others"})}),a.push({ws:s,requests:o,ip:n,block:e,count:t.length})}),a=_.sortBy(a,function(t){return-(t.count+10*t.ws.length)}),s.logs=a,s.ws=_.filter(l.ws,function(t){return!t.using}),s.ws=_.sortBy(s.ws,function(t){return-(t.ws_clients+t.ws_nodes)}),s.blocks=_.filter(l.iplimiter,function(t,s){return t.ip=s,!t.using}),n&&n(s)):n&&n(null)})},c.app.platform.sdk.system.get.stats(function(t,s){t?n&&n(null):n&&n(s)}),t.clbk(null,t)}}}var c=new nModule,e={};return c.run=function(t){var s=c.addEssense(e,n,t);c.init(s,t)},c.stop=function(){_.each(e,function(t){t.destroy()})},c}();"undefined"!=typeof module?module.exports=proxylogs:(app.modules.proxylogs={},app.modules.proxylogs.module=proxylogs);
 /*_____*/ 
var help=function(){function o(e){var o,n,a,e=deep(e,"history"),t={};t.roadmap=[{d:"February 2019",n:"Social Network Beta Test Starts",r:!0},{d:"March 2019",n:"Windows Desktop App",r:!0},{d:"March 2019",n:"Search users, posts",r:!0},{d:"July 2019",n:"Linux Desktop App",r:!0},{d:"July 2019",n:"Android App",r:!0},{d:"August 2019",n:"Search by tags, recommended users, poll transactions",r:!0},{d:"August 2019",n:"Personal link "+d.app.options.url+"/username plus history of personal posts and ability to search users’ posts (decentralized free blog hosting on Pocketnet blockchain)",r:!0},{d:"June 2020",n:"Running a node from the desktop app",r:!0},{d:"August 2020",n:"Pocketcoin listed on two exchanges: BTCPOP and Mercatox",r:!0},{d:"January 2021",n:"Full decentralization: all apps can speak directly to the nodes, desktop app can work without the website "+d.app.options.url,r:!0},{d:"May 2021",n:"Integration of PeerTube into Pocketnet, upload of videos and live streams",r:!1},{d:"June 2021",n:"Rewrite of the backend to move to sqlite from Reindexer to make the node light on RAM use",r:!1},{d:"June 2021",n:"Boost posts for Pocketcoin",r:!1},{d:"June 2021",n:"Peer-to-peer encrypted chat, including group chat",r:!1},{d:"July 2021",n:"Livestream Pocketcoin dondations",r:!1},{d:"July 2021",n:"Pocketnet NFT 3.0",r:!1},{d:"October 2021",n:"Decentralized reputation platform and crypto store",r:!1},{d:"December 2021",n:"Decentralized alternative to adwords advertising through smart contracts",r:!1},{d:"2022",n:"Ability to fork Pocketcoin to create a diverse set of Dapps for users using Pocketnet platform i.e. Pocketnet as an alternative Appstore",r:!1}],t.pkoin={loading:!0,emission:{api:"emission",result:null},blockhash:{api:"blockhash/12000.json",result:{}},emission2:{api:"emission/1000000.json",result:{}},topaddresses:{api:"topaddresses/10.json",result:[]}},t.topaddresses=[];function i(e){a&&(a.destroy(),a=null),o.menuitem.removeClass("active"),o.c.find('.tipitem[page="'+e+'"]').addClass("active"),n=e,p.save(),r[e]?r[e](e):r.page(e)}function s(){var e=$(this).attr("page");i(e)}var r={applications:function(e){this.page(e,function(e){d.nav.api.load({open:!0,id:"applications",el:e.find(".applicationsWrapper"),clbk:function(e,n){a=n}})})},faq:function(e){this.page(e,function(e){d.nav.api.load({open:!0,id:"faq",el:e.find(".faqWrapper"),clbk:function(e,n){a=n}})})},node:function(e){this.page(e,function(e){d.app.platform.papi.post("d85a0e1146e89ad6303cc8a081f1fb04da01ab21af913fa9e762de0d7972eaa6",e.find(".lenta"),function(e,n){a=n})})},videos:function(e){this.page(e,function(e){d.nav.api.load({open:!0,id:"lenta",el:e.find(".lenta"),animation:!1,mid:"videos",essenseData:{byauthor:!0,notscrollloading:!0,nocomments:!0,txids:["9f73a1efbfb4b0feb88c134740afa0ab293f8072a80ecbe9fe65ed85591910e6","ad9067c72a7be97c1752a00566940f372e5b526291278cf9bc203b99f81bbaf0","df4064b9e2c8b311fd097804f36802ceb68337dca396bfdea732c0f94c977a3a"]},clbk:function(e,n){a=n}})})},page:function(e,n){d.shell({name:e,el:o.page,data:{c:t}},function(e){n&&n(e.el)})},pkoin:function(e){this.page(e,function(n){t.pkoin.loading=!0,console.log("this.page",n);var o="https://explorer."+d.app.options.url+"/rest/",e=[t.pkoin.blockhash.api,t.pkoin.emission.api,t.pkoin.emission2.api,t.pkoin.topaddresses.api].map(function(e){return fetch(o+e)});Promise.all(e).then(function(e){return Promise.all(e.map(function(e,n){return 0===n?e.text():e.json()}))}).then(function(e){t.pkoin.blockhash.result=JSON.parse(e[0]),t.pkoin.emission.result=e[1],t.pkoin.emission2.result=e[2],t.pkoin.topaddresses.result=e[3],t.pkoin.loading=!1,r.page("pkoin"),n.find(".copyaddress").on("click",function(){copyText($(this).find(".adr")),sitemessage(d.app.localization.e("waddresswascop"))})})})}},p={save:function(){d.app.nav.api.history.addParameters({page:n})},load:function(){n=parameters().page||"faq"}};return{primary:e,getdata:function(e){p.load();var n=null;e({version:n="undefined"!=typeof _Electron?require("electron").remote.app.getVersion():n})},destroy:function(){a&&(a.destroy(),a=null),o={}},init:function(e){p.load(),(o={}).c=e.el.find("#"+d.map.id),o.page=o.c.find(".page"),o.menuitem=o.c.find(".tipitem"),o.caption=o.c.find(".bgCaption"),o.menuitem.on("click",s),o.caption.find(".checkversion").on("click",function(){var e;"undefined"!=typeof _Electron&&(o.caption.find(".checking").addClass("active"),e=require("electron"),setTimeout(function(){e.ipcRenderer.send("electron-checkForUpdates"),e.ipcRenderer.on("updater-message",function(e,n){("update-downloaded"==n.msg||"update-not-available"==n.msg||(n.linux||n.macos)&&"update-available"==n.msg)&&o.caption.find(".checking").removeClass("active")})},100))}),i(n),e.clbk(null,e)}}}var d=new nModule,a={};return d.run=function(e){var n=d.addEssense(a,o,e);d.init(n,e)},d.stop=function(){_.each(a,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=help:(app.modules.help={},app.modules.help.module=help);
 /*_____*/ 
var connection=function(){function o(e){function c(e,a){var o,l;o=function(e){e?a&&a(!0):(dialog({html:f.app.localization.e("e13052"),class:"one zindex"}),a&&a(!1))},l=f.app.platform.apiproxy,f.app.platform.apiproxy=e,f.app.platform.sdk.proxy.info(function(e,a){o&&o(!a)}),f.app.platform.nodeid=l}function l(e,a){var o,l;o=function(e){e?a&&a(!0):(dialog({html:f.app.localization.e("e13053"),class:"one zindex"}),a&&a(!1))},l=f.app.platform.nodeid,f.app.platform.nodeid=e,f.app.platform.sdk.node.get.time(function(e,a){o&&o(!a)}),f.app.platform.nodeid=l}function a(){f.app.platform.dontuseapiproxy?r.using(!f.app.platform.dontuseapiproxy):dialog({html:f.app.localization.e("e13073"),class:"zindex",success:function(){r.using(!f.app.platform.dontuseapiproxy)}})}function o(){r.proxieslist()}function n(){r.addnode()}function t(){var a=$(this).closest(".node").attr("host"),o="true"==$(this).closest(".node").attr("locally"),e=_.find(f.app.platform.nodes,function(e){return e.host==a&&e.locally==o});e&&r.addnode(e)}function p(){var a,o,e=$(this).closest(".node");e.hasClass("active")||(a=e.attr("host"),o="true"==e.attr("locally"),e=_.find(f.app.platform.nodes,function(e){return e.host==a&&e.locally==o}),r.connectnode(e))}var i,e=deep(e,"history"),r={preloader:function(e){e?i.c.addClass("loading"):i.c.removeClass("loading")},addproxy:function(t,p){var s=!1,i="create",e=f.app.localization.e("e13054"),a=f.app.localization.e("add");t&&(s=!0,i="update",e=f.app.localization.e("e13055"),a=f.app.localization.e("save")),t=t||{};var r={host:new Parameter({type:"STRING",name:f.app.localization.e("e13056"),id:"host",defaultValue:t.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:t.port||"8888",placeholder:"8888",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"ws",defaultValue:t.ws||"8088",placeholder:"8088",require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> '+f.app.localization.e("close"),fn:function(e,a){a.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(a,o){var e,l={},n=!0;_.each(r,function(e){l[e.id]=e.value||t[e.id],e.value||(n=!1)}),n?(l.user=!0,l.id=f.app.platform.sdk.proxy.makeid(l),e=f.app.platform.sdk.proxy.all(),_.find(e,function(e){return e.id==l.id})?sitemessage(f.app.localization.e("e13058")):(a.find(".addproxy").addClass("loading"),c(l,function(e){a.find(".addproxy").removeClass("loading"),e&&(e=f.app.platform.sdk.proxy[i](l,t.id),s||(f.app.platform.apiproxy=l,e=!0),p&&p(l,e),o.close())}))):sitemessage(f.app.localization.e("e13057"))}}};s&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+f.app.localization.e("delete"),fn:function(e,a){dialog({class:"zindex",html:f.app.localization.e("e13059"),success:function(){var e=f.app.platform.sdk.proxy.remove(t.id);p&&p(null,e),a.close()}})}}),f.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:r},wnd:{header:e,buttons:a,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(r),e.el),e.el.find(".host input").focus()})},proxieslist:function(e,n){function t(e){e.close(),r.connectproxy()}var a=f.app.platform.sdk.proxy.all(),o={close:{class:"close",html:'<i class="fas fa-times"></i> '+f.app.localization.e("close"),fn:function(e,a){console.log("close"),a.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+f.app.localization.e("e13054"),fn:function(o,l){r.addproxy(null,function(e,a){a?t(l):d.proxieslist(o,l)})}}},p={destroy:function(){},name:"proxieslist",data:{proxies:a,proxy:f.app.platform.apiproxy,ele:r.ele()},wnd:{header:f.app.localization.e("e13060"),noInnerScroll:!0,class:"proxieslistwnd",buttons:o}};e?p.el=e:p.insert="wnd",f.shell(p,function(l){l.el.find(".proxy").length?l.el.find(".proxieslist").removeClass("empty"):l.el.find(".proxieslist").addClass("empty"),l.el.find(".name").on("click",function(){var a,e=$(this).closest(".proxy").hasClass("active"),o=$(this).closest(".proxy").attr("pid");e||("none"==o?dialog({html:f.app.localization.e("e13061"),class:"zindex",success:function(){r.using(!0),d.active(),(l.container||n).close()}}):(a=f.app.platform.sdk.proxy.find(o),l.el.find(".proxieslist").addClass("loading"),c(a,function(e){l.el.find(".proxieslist").removeClass("loading"),e&&f.app.platform.sdk.proxy.changeWithDialog(a,function(){(l.container||n).close(),d.proxy(),d.active()})})))}),l.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid");(e=f.app.platform.sdk.proxy.find(e))&&r.addproxy(e,function(e,a){a?t(l.container||n):r.proxieslist(p.el)})})})},addnode:function(t,e){var p=!1,a="create",o=f.app.localization.e("e13044"),l=f.app.localization.e("add");t&&(p=!0,a="update",o=f.app.localization.e("e13062"),l=f.app.localization.e("save")),t=t||{};var s={saveto:new Parameter({type:"VALUES",name:f.app.localization.e("save"),id:"saveto",defaultValue:"proxy",possibleValues:["proxy","locally"],possibleValuesLabels:[f.app.localization.e("onproxy"),f.app.localization.e("locally")],require:!0}),host:new Parameter({type:"STRING",name:f.app.localization.e("nodehost"),id:"host",defaultValue:t.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:f.app.localization.e("e13063"),id:"port",defaultValue:t.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:f.app.localization.e("e13064"),id:"ws",defaultValue:t.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:f.app.localization.e("e13065"),id:"nodename",defaultValue:(t.nodename||(f.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:f.app.localization.e("e13066"),require:!0}),rpcuser:new Parameter({type:"STRING",name:f.app.localization.e("e13067"),id:"rpcuser",placeholder:f.app.localization.e("e13068"),defaultValue:t.rpcuser||"",require:!0}),rpcpwd:new Parameter({type:"STRING",name:f.app.localization.e("e13069"),id:"rpcpwd",defaultValue:t.rpcpwd||"",placeholder:f.app.localization.e("e13070"),require:!0})};!f.app.platform.dontuseapiproxy&&f.app.platform.apiproxy||(s.saveto=new Parameter({type:"VALUES",name:f.app.localization.e("save"),id:"saveto",defaultValue:"locally",possibleValues:["locally"],possibleValuesLabels:[f.app.localization.e("locally")],require:!0})),console.log("ap",s),l={close:{class:"close",html:'<i class="fas fa-times"></i> '+f.app.localization.e("close"),fn:function(e,a){a.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+l,fn:function(e,o){var l,n=_.clone(t);t.host=s.host.value,t.port=s.port.value,t.ws=s.ws.value,t.nodename=s.nodename.value,t.rpcuser="",t.rpcpwd="","locally"==s.saveto.value?(t.rpcuser=s.rpcuser.value||"",t.rpcpwd=s.rpcpwd.value||"",t.locally=!0):(delete t.rpcuser,delete t.rpcpwd),t.host&&t.port&&t.ws&&t.nodename?(delete(l=_.clone(t)).addedby,delete l.date,l.locally||delete l.locally,f.app.platform.sdk.node.sys[a+s.saveto.value](l,function(e,a){e?(t=_.clone(n),sitemessage(e)):(p?(i.list.html(""),d.nodes(f.app.platform.nodes)):(f.app.platform.nodes||(f.app.platform.nodes=[]),f.app.platform.nodes.push(a),d.nodes([a])),f.app.platform.nodeid&&f.app.platform.nodeid.host!=l.host?o.close():r.connectnode(l,function(){o.close()}),d.active())})):sitemessage(f.app.localization.e("e13071"))}}},p&&(s.host.disabled=!0,s.saveto.hidden=!0,t.locally?s.saveto.value="locally":s.saveto.value="proxy",l.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+f.app.localization.e("delete"),fn:function(e,o){dialog({class:"zindex",html:f.app.localization.e("e13072"),success:function(){var e=t.locally?"revokelocally":"revokeproxy";f.app.platform.sdk.node.sys[e]({host:t.host},function(e,a){e?sitemessage(e):(i.list.find('.node[host="'+t.host+'"]').closest(".nodewrapepr").remove(),d.empty(),t.host==f.app.platform.nodeid.host?r.connectnode(null,function(){o.close()}):o.close())})}})}}),f.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:s},wnd:{header:o,buttons:l,noInnerScroll:!0,class:"addnodewnd"}},function(e){function a(){e.el.find(".addnode").attr("saveto",s.saveto.value)}ParametersLive(_.toArray(s),e.el),a(),s.saveto._onChange=function(){a()}})},connectproxy:function(e){f.app.platform.nodeid=null,f.app.platform.nodes=null,f.app.errors.clear(),f.app.platform.state.save(),f.app.platform.restart(function(){app.reload(function(){}),e&&e()})},connectnode:function(a,o){r.preloader(!0),l(a,function(e){e?(f.app.platform.nodeid=a,f.app.platform.state.save(),d.active(),f.app.errors.clear(),f.app.platform.restart(function(){r.preloader(!1),app.reload(function(){}),o&&o()})):r.preloader(!1)})},ele:function(){return"undefined"!=typeof _Electron},using:function(e){f.app.platform.dontuseapiproxy=e,f.app.platform.sdk.proxy.save(),d.proxy(),r.connectproxy()}},d={nodes:function(e,a){f.shell({inner:append,name:"nodes",data:{nodes:e},el:i.list},function(){d.empty(),d.active(),a&&a()})},empty:function(){i.list.find(".node").length?i.nodes.removeClass("empty"):i.nodes.addClass("empty")},active:function(){i.list.find(".node").removeClass("active"),f.app.platform.nodeid&&i.list.find('.node[host="'+f.app.platform.nodeid.host+'"][locally="'+(f.app.platform.nodeid.locally||"false")+'"]').addClass("active")},proxy:function(){f.app.platform.dontuseapiproxy?(i.cc.removeClass("useproxy"),i.cc.addClass("shownodes"),i.currentproxy.html(f.app.localization.e("e13051"))):(i.cc.addClass("useproxy"),f.app.platform.apiproxy?(i.cc.addClass("shownodes"),i.currentproxy.html("https://"+app.platform.apiproxy.host+":"+app.platform.apiproxy.port+"; wss:"+app.platform.apiproxy.ws)):(i.cc.removeClass("shownodes"),i.currentproxy.html(f.app.localization.e("notselected"))))}};return{primary:e,getdata:function(e){var a={ele:r.ele()};window.cordova,e(a)},destroy:function(){i={}},init:function(e){(i={}).c=e.el.find("#"+f.map.id),i.list=i.c.find(".list"),i.add=i.c.find(".addnewNode"),i.nodes=i.c.find(".nodespart"),i.cc=i.c.find(".connection"),i.currentproxy=i.c.find(".current"),i.add.on("click",n),i.c.on("click",".edit",t),i.c.on("click",".connectnode",p),i.c.find(".openproxielist").on("click",o),i.c.find(".usingproxy").on("click",a),d.proxy(),i.nodes.addClass("loading"),f.app.platform.sdk.system.get.nodes(!0,function(){i.nodes.removeClass("loading"),d.nodes(f.app.platform.nodes)}),e.clbk(null,e)}}}var f=new nModule,l={};return f.run=function(e){var a=f.addEssense(l,o,e);f.init(a,e)},f.stop=function(){_.each(l,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=connection:(app.modules.connection={},app.modules.connection.module=connection);
 /*_____*/ 
var donations=function(){function e(n){function t(){u.donate()}var s,n=deep(n,"history"),e=["PHdW4pwWbFdoofVhSEfPSHgradmrvZdbE5","PTziv8ym7eJRUfyfAFBejJgEYemTdUgFzH","PBE1MLbsFoY3o1YW6t3Goi6spS1y9GY1vj","PRV1eoYkhA5PGkASm2tyD12xwdQnigbpkp","PRCeHituQ5WN2EXRZz4t9qTYyCBqTc4g4M","P9V67HjuApdEhj4DZxNnibxEqSnmCPbxvB","PA57U1QmmowNzSaz6ThG2EPs34QCsLyksL","PL7RNWypccYBPsDAygW3H4aKfzGBwMeWyt","PDUGAwFmRRSnSVTtcAuyVrTLAREm6HN2BC","PPvPW1sUAA1KPxcwbVKVk2EEp3uWkAKn2U","PWkUgSod6FEyVq8Ve1dWChWMC8HcXJcLro"],a={amount:new Parameter({name:r.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:r.app.localization.e("wsamountof"),format:{Precision:6}})},o=[{id:"btc",name:"Bitcoin",action:function(n){u.ways.ltcbtc(n)},qrname:"bitcoin"},{id:"ltc",name:"Litecoin",qrname:"litecoin",action:function(n){u.ways.ltcbtc(n)}}],i={},c=null,u={checkFunds:function(n,t,e){u.status(n,t,function(n,t){e&&e(t)})},waitfunds:function(t,e,a,o){i[t]=e,l.save(),d.address(t,e,o,a,function(n){c=setInterval(function(){u.checkFunds(t,e,function(n){"AWAITINGFUNDS"!=n.Status&&"AWAITINGDONATION"!=n.Status&&(clearInterval(c),c=null),"AWAITINGFUNDS"==n.Status||"AWAITINGDONATION"==n.Status||"EXPIREDAWAITINGFUNDS"==n.Status?d.address(t,e,o,n):d.thankyou(o,!1,a)})},6e4)})},ways:{ltcbtc:function(e){var a=e.id;i[a]?u.status(a,i[a],function(n,t){"AWAITINGFUNDS"==t.Status||"AWAITINGDONATION"==t.Status?u.waitfunds(a,i[a],t,e):"EXPIREDAWAITINGFUNDS"==t.Status?u.address(a,function(n,t){u.waitfunds(a,n,t,e)}):(delete i[a],l.save(),d.thankyou(e,!0,t))}):u.address(a,function(n,t){u.waitfunds(a,n,t,e)})},xmr:function(n){d.xmraddress(n,function(n){})},paypal:function(n){window.open("https://www.paypal.me/pocketnet","_blank").focus(),d.thankyou(n)}},donate:function(){u.hidepage(function(){d.ways()})},hidepage:function(n){s.c.find(".hideprocess").fadeOut(200,n)},showpage:function(n){s.c.find(".hideprocess").fadeIn(200,n)},status:function(n,t,e){r.app.platform.sdk.exchanges.status(n,t,e)},address:function(n,e){r.app.ajax.run({data:{Action:"GETADDRESSFORDONATION",Currency:n.toUpperCase()},success:function(n){var t=deep(n,"Address.Address");t?e&&e(t,n.Address):sitemessage(r.app.localization.e("e13094"))},fail:function(){sitemessage(r.app.localization.e("e13094"))}})}},d={thankyou:function(t,e,n){_scrollTop(0),a.amount.value=deep(n,"Amount")||0,r.shell({name:"thankyou",inner:html,el:s.process.find(".step"),data:{second:e,curobj:t,info:n,parameters:a}},function(n){ParametersLive(_.toArray(a),n.el),n.el.find(".send").on("click",function(){0<a.amount.value?$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:{Action:"ADDTOMAILLIST",Lang:r.app.localization.key||"en",TemplateID:100,Email:r.app.platform.sdk.address.pnet().address,Name:(t.name||"NAN0")+", "+(a.amount.value||0)},dataType:"json",success:function(){n.el.html(""),setTimeout(function(){u.showpage()},100),dialog({html:r.app.localization.e("e13095"),class:"one"})}}):sitemessage(r.app.localization.e("e13096"))}),n.el.find(".back").on("click",function(){e?(n.el.html(""),setTimeout(function(){t.action(t)},100)):(n.el.html(""),setTimeout(function(){u.showpage()},100))})})},xmraddress:function(t,e){_scrollTop(0),r.shell({name:"xmraddress",inner:html,el:s.process.find(".step"),data:{curobj:t}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){d.ways()},100)}),n.el.find(".next").on("click",function(){d.thankyou(t,!0)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(r.app.localization.e("waddresswascop"))}),e&&e(n.el)})},address:function(e,a,o,i,t){r.shell({name:"address",inner:html,el:s.process.find(".step"),data:{curobj:o,address:a,currency:e,info:i}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){d.ways()},100),c&&(clearInterval(c),c=null)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(r.app.localization.e("waddresswascop"))}),n.el.find(".reactivate").on("click",function(){r.app.platform.sdk.exchanges.reactivate({address:a,currency:e},function(n,t){n?sitemessage(r.app.localization.e("e13097")):u.waitfunds(e,a,i,o)})}),n.el.find(".next").on("click",function(){d.thankyou(o,!0),c&&(clearInterval(c),c=null)}),t&&t(n.el)})},ways:function(t){_scrollTop(0),r.shell({name:"ways",inner:html,el:s.process.find(".step"),data:{ways:o}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){u.showpage()},100)}),n.el.find(".way").on("click",function(){var t=$(this).attr("way"),n=_.find(o,function(n){return n.id==t});n&&n.action(n)}),t&&t()})}},l={save:function(){r.app.settings.set(r.map.uri,"storage",JSON.stringify(i))},load:function(){i=JSON.parse(r.app.settings.get(r.map.uri,"storage")||"{}")}};return{primary:n,getdata:function(n){l.load(),r.sdk.users.get(e,function(){n({donated:e})},!0)},destroy:function(){c&&(clearInterval(c),c=null),s={}},init:function(n){(s={}).c=n.el.find("#"+r.map.id),s.process=s.c.find(".process"),s.donate=s.c.find(".donate"),s.donate.on("click",t),n.clbk(null,n)}}}var r=new nModule,a={};return r.run=function(n){var t=r.addEssense(a,e,n);r.init(t,n)},r.stop=function(){_.each(a,function(n){n.destroy()})},r}();"undefined"!=typeof module?module.exports=donations:(app.modules.donations={},app.modules.donations.module=donations);
 /*_____*/ 
var userpage=function(){function n(e){function i(){var e=$(this).closest("[levelid]").attr("levelid");o.closeGroup(e)}function a(){var e=$(this).attr("rid");isMobile()&&v.contents(null,e),o.openReport(e,!0)}var r,s,p,e=deep(e,"history"),l=null,c=null,u=!1,d=null,f=[],m={eachReport:function(a,e,t){var r=function(e,o,i){o=o||0,i=i||"",_.each(e,function(e,t){var n=i;n&&(n+="_"),n+=e.id,e.reports?a.group(e,o,n,function(){r(e.reports,o+1,n)},t):a.report(e,o,n)})};r(e=e||f,0,t)},findReport:function(e){var o=function(e,t){var n=t.split("_");return n.length?(t=n[0],(e=_.find(e||[],function(e){return e.id==t}))?(n.splice(0,1),(t=n.join("_"))&&e.reports?o(e.reports,t):e):null):null};return o(f,e)},mobileReports:function(){var i=[];return m.eachReport({group:function(e,t,n,o){e.mobile&&i.push(e),o()},report:function(e){e.mobile&&i.push(e)}}),i.push({name:b.app.localization.e("signout"),id:"signout"}),i},selector:function(){var e=m.mobileReports(),t=_.map(e,function(e){return e.id}),e=_.map(e,function(e){return e.text||e.name});return(e=new Parameter({type:"VALUES",name:b.app.localization.e("e13187"),id:"contents",possibleValues:t,possibleValuesLabels:e,defaultValue:t[0]})).value=parameters().id||t[0],e._onChange=function(e){var t;"signout"==e?o.signout():(t=m.findReport(e),(e=parameters()).report=t.report,e.id=t.id,e="userpage"+collectParameters(e),b.nav.api.load({open:!0,href:e,history:!0}))},e}},o={closeGroup:function(e){var t=m.findReport(e);t&&(t.active=!t.active,e=r.c.find('[levelid="'+e+'"]'),t.active?e.addClass("active"):e.removeClass("active"))},openTree:function(a){m.eachReport({group:function(e,t,n,o){var i=r.c.find('[levelid="'+n+'"]');0==a.indexOf(n)?(e.active=!0,i.addClass("active"),o()):(e.active=!1,i.find(".openReport").removeClass("active"))},report:function(e,t,n){var o=r.c.find('[id="'+n+'"]');a==n?(e.active=!0,o.addClass("active")):(e.active=!1,o.removeClass("active"))}})},closeReport:function(){r.report.html("")},openReport:function(e,t){r.c.find(".openReport").removeClass("active"),r.c.find('[rid="'+e+'"]').addClass("active"),o.openTree(e),v.report(e);var n=m.findReport(e);n&&n.rh||t&&(b.nav.api.history.addParameters({id:e},{removefromback:!1}),b.app.nav.clbks.history.navigation&&b.app.nav.clbks.history.navigation())},signout:function(){function e(){b.app.user.signout(),b.app.reload({href:"authorization"})}b.app.platform.sdk.address.pnet()&&b.app.platform.sdk.registrations.showprivate()?b.app.platform.ui.showmykey({text:b.app.localization.e("e13188"),faillabel:b.app.localization.e("e13189"),fail:function(){e()}}):e()}},v={bgcaption:function(e){m.selector(),r&&r.bgcaption&&(b.app.user.validate()?b.shell({name:"bgcaption",el:r.bgcaption,data:{}},function(e){console.log(e.el),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(b.app.localization.e("successcopied"))})}):r.bgcaption.html('<div class="bgCaptionSpacer"></div>'))},contents:function(t,e){var n,o;r.contents&&(n=m.selector(),o=function(){b.shell({name:"contents",el:r.contents,data:{reports:f,each:m.eachReport,selector:n}},function(e){e.el.find(".groupNamePanelWrapper").on("click",i),e.el.find(".openReport").on("click",a),ParametersLive([n],e.el),_scrollTop(0),u&&r.contents.hcSticky("refresh"),t&&t()})},e&&isMobile()?(r.contents.html(""),t&&t()):b.app.user.isState(function(e){isMobile()&&e?b.app.platform.sdk.node.transactions.get.allBalance(function(e){var t=b.app.platform.sdk.node.transactions.tempBalance();p=e+t,o()}):o()}))},userslist:function(e,t,n,o,i){b.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:t,empty:n,caption:o},clbk:function(e,t){i&&i(e,t)}})},followers:function(e,t){var n,o,i,a=deep(b,"app.user.address.value");a&&(n=deep(b,"sdk.users.storage."+a),i=_.map(deep(n,"subscribers")||[],function(e){return e}),o=deep(n,"blocking")||[],i=_.filter(i,function(e){return-1==_.indexOf(o,e)}),a=b.app.localization.e("anofollowers"),b.user.isItMe(n.address)&&(a=b.app.localization.e("aynofollowers")),v.userslist(e,i,a,b.app.localization.e("followers"),t))},following:function(e,t){var n,o,i,a=deep(b,"app.user.address.value");a&&(n=deep(b,"sdk.users.storage."+a),i=_.map(deep(n,"subscribes")||[],function(e){return e.adddress}),o=deep(n,"blocking")||[],i=_.filter(i,function(e){return-1==_.indexOf(o,e)}),a=b.app.localization.e("anofollowing"),b.user.isItMe(n.address)&&(a=b.app.localization.e("aynofollowing")),v.userslist(e,i,a,b.app.localization.e("following"),t))},fillUser:function(e,t){b.shell({name:"fillUser",el:e,data:{}},function(e){t&&t()})},authorization:function(e,t){b.nav.api.go({href:"authorization",history:!0,open:!0})},registration:function(e,t){b.nav.api.go({href:"registration",history:!0,open:!0})},report:function(e,n){function o(e,t){_scrollTop(0),l=t,c&&c.apply(),n&&n()}l&&l.destroy();var t=m.findReport(e);t.rh?v[t.report]():b.shell({name:"report",el:r.report,data:{}},function(e){v[t.report]?(v[t.report](e.el.find(".reportCnt"),o),u&&r.contents.hcSticky("refresh")):b.nav.api.load({open:!0,id:t.report,el:e.el.find(".reportCnt"),animation:!1,primary:!0,essenseData:{sub:t.sub,dumpkey:s.dumpkey},clbk:function(e,t){o(0,t),u&&r.contents.hcSticky("refresh")}})})}};function t(e){var t=parameters().id;isMobile()||(t=t||(b.app.user.validate()?"ustate":"test")),v.contents(function(){t?o.openReport(t):o.closeReport(),e&&e()},t)}b.authclbk=function(){v.bgcaption()};var n=function(e){v.bgcaption(),t(e),b.app.user.validate()||(r.c.addClass("validate"),b.app.errors.connectionRs()&&(b.iclbks.mn=function(){delete b.iclbks.mn,n()})),isMobile()||(r.contents.hcSticky({stickTo:"#userpagestick",top:77,bottom:177}),u=!0)};return{primary:e,parametersHandler:function(){t()},getdata:function(t,e){var n;s=deep(e,"settings.essenseData")||{},f=[],b.app.user.getstate()?b.app.user.validate()||(n=b.app.localization.e("e13184"),b.app.errors.connection()&&(n=b.app.localization.e("e13185")),f.push({name:n,id:"test",report:"fillUser",mobile:!0})):(f.push({name:b.app.localization.e("signin"),id:"authorization",report:"authorization",mobile:!0,rh:!0}),f.push({name:b.app.localization.e("createnew"),id:"registration",report:"registration",mobile:!0,rh:!0})),f.push({name:b.app.localization.e("notifications"),id:"notifications",report:"notifications",mobile:!0}),f.push({name:b.app.localization.e("rstate"),id:"ustate",report:"ustate",mobile:!0,add:function(){if(isMobile()&&deep(d,"reputation"))return d.reputation.toFixed(1)}}),f.push({name:b.app.localization.e("rwallet"),id:"wallet",report:"wallet",mobile:!0,add:function(){if(isMobile()&&p)return b.app.platform.mp.coin(p)}}),f.push({name:b.app.localization.e("followers"),id:"followers",report:"followers",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(b,"app.user.address.value");if(e&&(e=deep(b,"sdk.users.storage."+e+".subscribers.length"),isMobile()&&e))return e}}),f.push({name:b.app.localization.e("following"),id:"following",report:"following",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(b,"app.user.address.value");if(e&&(e=deep(b,"sdk.users.storage."+e+".subscribes.length"),isMobile()&&e))return e}}),b.app.user.validate()&&f.push({name:b.app.localization.e("e13186"),id:"test",report:"test",mobile:!0}),f.push({name:b.app.localization.e("rsettings"),id:"usersettings",report:"usersettings",mobile:!0}),f.push({name:b.app.localization.e("raccounts"),id:"accounts",report:"accounts",mobile:!0}),f.push({name:b.app.localization.e("rsystem"),id:"system16",report:"system16",mobile:!1}),f.push({name:"Pocketcoin",id:"staking",report:"staking",mobile:!0,if:function(){return isMobile()}});var o={},e=parameters();o.p2pkh=b.app.platform.sdk.address.pnet(),b.app.platform.sdk.ustate.me(function(e){d=e,t(o)})},destroy:function(){delete b.iclbks.mn,u=!1,l&&l.destroy(),l=null,c&&c.destroy(),c=null,$("#menu").removeClass("abs"),r={}},init:function(e){(r={}).c=e.el.find("#"+b.map.id),r.contents=r.c.find(".contents"),r.report=r.c.find(".report"),r.bgcaption=r.c.find(".bgCaptionWrapper"),$("#menu").addClass("abs"),new Caption({container:r.c,caption:r.c.find(".captionfwrapper"),offset:[0,0]}).init(),r.c.on("click",".signout",function(){o.signout()}),n(function(){e.clbk(null,e)})}}}var b=new nModule,o={};return b.run=function(e){var t=b.addEssense(o,n,e);b.init(t,e)},b.stop=function(){_.each(o,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=userpage:(app.modules.userpage={},app.modules.userpage.module=userpage);
 /*_____*/ 
var faq=function(){function o(e){var o,e=deep(e,"history"),t=[{name:"Technical",id:"technical",group:[{id:"downloadclient",q:"Where do I download the client?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.gui/releases/latest">https://github.com/pocketnetteam/pocketnet.gui/releases/latest</a></div><div>Click on PocketnetSetup.exe</div>'},{id:"downloadclient",q:"Where do I download the node?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.core/releases/latest">https://github.com/pocketnetteam/pocketnet.core/releases/latest</a></div><div>With any questions email core@pocketnet.app</div>'}]},{name:"Pocketnet",id:"roadmap",group:[{id:"walletaddresses",q:"I see a PN address and a wallet address... are both these addresses on the PN blockchain?",a:"<div>PN address is the one used for posting content and using social network in general. It also keeps coins that you win for your highly rated posts.</div><div>Wallet addresses are to keep the rest of coins.</div>"},{id:"linktoprofile",q:'Can I link to my profile? or my "page"? So that i can post it into my community to bring members over.',a:"<div>In the browser, go to your profile by clicking on avatar in the upper right and just copy the browser address, everyone who will sign up from that link will follow you automatically and you will actually get rewards.</div>\t\t\t\t\t\t\t<div>On the desktop,  from a desktop application go to your profile,  once there, there will be three icons to the right of your avatar first there will be a wallet with number of coins, then a bell with notifications and a third is a green cross icon click on that green cross  and click copy,  send that link around everyone who subscribes will follow you and you will get rewards.</div>"},{id:"starsystem",q:"The star system. Is there a limit on how many stars a person has to give people?",a:"<div>There are some limits. But as your reputation grows you can upvote more and more. This is done, so bots don&rsquo;t break down our blockchain. Initially you get 100 ratings every 24 hours. As your reputation grows (that happens by posting and getting rated), then you do 200 ratings a day.</div>"},{id:"updateprofiletime",q:"How long until I am able to update my profile? ",a:"<div>You are able to update your profile once every hour.</div>"},{id:"savevideo",q:"Where do you save the video content?",a:"<div>Pocketnet uses open source platform called PeerTube. PeerTube is fully integrated with Pocketnet authorization, each video server is registered on the blockchain. Details of the algorithm are coming.</div>"},{id:"mobileapp",q:"Is there a mobile app?",a:"<div>There is an Android app, you can download it here: https://play.google.com/store/apps/details?id=pocketnet.app  iPhone app is not available, because Apple required us to remove any content on 24 hour notice. We refused, so you can use the mobile web app.</div>"},{id:"postinglimit",q:"Can you tell me what is the limit for posting each day or hour?",a:"<div>We do have some limitations, but after testing it we have increased our limits. At the outset you can make 15 posts and issue 100 ratings every 24 hours. Once your reputation grows above 50, you will be able to make up to 30 posts and 200 ratings every 24 hours.</div>"},{id:"reputation",q:"What is reputation and how is it calculated?",a:"<div>Your reputation is the sum of your ratings calculated in the following way. Note, that users with reputation below 50 do not affect anyone's reputation or coin winnings. They can rate the content, but it does not affect reputation.</div>\t\t\t\t\t\t<div>5=2<br>4=1<br>3=0<br>2=-1<br>1=-2</div><div>So, if you have two 5 start ratings and one 1 star rating, the total will be 2+2-2=2</div>"},{id:"deletepostoruser",q:"Is there a way to delete or edit a post?",a:"<div>Not at this point, as it is baked into blockchain. However, we are working on a feature to create an overwrite transaction as well &#10075;hide&#10076; transaction, which would effectively translate to edit or delete.</div>"},{id:"usersearch",q:"Is there a way to search for a user?",a:"<div>Click the search magnifying glass on the top and search by username or by keywords.</div>"},{id:"follow",q:"How do you follow someone?",a:"<div>Next to post author (on top of post) there is a Follow link, you can find his posts in Top posts (red flame on top of the page). You will also soon see Subscriptions feed, which is going to be different from the main feed. The main feed will be everything that anyone posts chronologically, but Subscriptions feed will only contain posts from people you follow. So, you will go into general feed in search of good content, though you may not like everything. Then select those you want to keep. Kind of like fishing :)</div>"},{id:"otherbrowsers",q:"Can it be used on Brave or Duck Duck go browsers?",a:"<div>Pocketnet should work on those browsers. It is fully functional on Chrome and Firefox. But we strongly encourage everyone to download the desktop app (grab PocketnetSetup.exe here: https://github.com/pocketnetteam/pocketnet.gui/releases/tag/v0.0.33-beta). It cannot be blocked ever (even if pocketnet.app is down or blocked for some reason). This is a serious consideration in totalitarian and quasi-totalitarian countries which, if you think about it, is beginning to include more and more of the globe.</div>"},{id:"replypost",q:"Can we reply to our own/and other&rsquo;s posts?",a:"<div>Yes, commenting is live below each post..</div>"},{id:"addtags",q:"How to add a tag to a post?",a:"<div>Just type in the field tag and press enter. No need to specify #, it will be added automatically.</div>"},{id:"usepublicaddress",q:"How can I use the public address?",a:"<div>Your public address is what Pocketnet uses to verify your identity. Essentially, your private key is a really large number (that can be represented with a 12 word sequence or a QR code). This number gets multiplied by another that everyone knows (called a base point) and we get a public key. When you enter your private key, we can multiply it by the base point to get your public key and we can match it against public address. If they match, we know it is you. It is impossible to go back i.e. to divide public key by the base point to get your private key. The way multiplication in cryptography works is it is only one way and cannot be reversed, so your key is safe. Pocketnet uses the same exact cryptography as Bitcoin.</div>"},{id:"desktopmac",q:"Will there be a downloadable executable for Mac?",a:"<div>Yes - we are working of Mac platform. Target is for mid-April.</div>"},{id:"dark-mode",q:"How do I change the theme to Dark Mode?",a:"<div>If you're on browser click your profile picture > Manage > Settings. If you're on mobile click the three lines on the bottom right > Settings </div>"},{id:"banning",q:"Can people be banned?",a:"<div>If a someone is posting unorthodox content then people will rate their content low causing their reputation to fall, if their reputation is less than -50 then they will be shadow banned. This means they can still post but no one can see their content unless directly on their page.</div>"},{id:"app-store",q:"What can be expected to purchase with PKOIN?",a:"<div>Soon there will be a way to boost posts in the feed and to Top Posts. Also, there will be special emojis and color of page, and badges.</div>"},{id:"Apple App",q:"When will PocketNet be added to Apple?",a:"<div>2-3 months</div>"},{id:"Missing PKCOIN",q:"Help! I am missing my PKOIN!",a:'<div>If for some reason it seems like your PKOIN has gone missing, please first check the blockexplorer via<a href="https://'+r.app.options.url+'/blockexplorer/">BlockExplorer.</a> to that your coins are still there. Just search your wallet address in the search bar and it will show you the balance of your account. </div>'}]},{name:"Pocketcoin",id:"pocketcoin",group:[{id:"pocketcoin",q:"What can I do with Pocketcoin?",a:"<div>Currently you can win it or send as a gift. However, when Pocketnet takes off, Pocketcoin will be the main method of buying advertising on the platform. Advertisers will be able to easily find content authors with the right audience and then offer them advertising opportunities. This will be a trustless endeavor (i.e. neither side can cheat), because of something called multi-signature contracts. Multisig contract requires a digital signature of both parties to be valid. When advertiser offers an ad to the content creator, he creates the first of two required signatures. He signs the actual ad and the amount bid. Content creator reviews this partially signed multisig and if it is accepted, then he appends the second signature. When a blockchain sees both signatures, content creator is automatically paid and an ad is automatically shown on creator’s channel. These transactions will only be done through Pocketcoin. Thus, if Pocketcoin becomes big, it will be an immensely valuable token.</div>"},{id:"pocketcoinstock",q:"Is Pocketcoin like a share of stock in Pocketnet?",a:"<div>Definitely no. Pocketnet is not even a corporation and does not have any ownership. It is an open source code that anyone can copy and run. Pocketcoin is a token that facilitates value exchange, specifically advertising transactions. In addition, Pocketnet will include a marketplace where goods and services will be sold directly for Pocketcoin</div>"},{id:"pocketcoinbuy",q:"Can I buy additional Pocketcoin?",a:"<div>Yes, currently you can buy Pocketcoin on the following exchanges: Bilaxy, Mercatox, BTCPOP.</div>"},{id:"pocketcoinbuyfiat",q:"Can I buy Pocketcoin for US Dollars or other fiat currency?",a:"<div>Some exchanges allow that.</div>"}]},{name:"Privacy",id:"privacy",group:[{id:"anonymous",q:"Are people who do not enter their real names anonymous?",a:"<div>Yes - no names, phones, email is NOT connected to your account in any way, it is just optionally entered to receive newsletter updates.</div>"},{id:"viewoutside",q:"Can someone view a profile (someone&rsquo;s posts) outside the garden? Is it a walled garden?",a:"<div>Since the whole blockchain and all the posts are in opensource anyone can have access to your posts and profile. They just know that it is linked to your public address. In practice, you can have multiple accounts. You can use some with your real name and others anonymously. Anonymity is a great tool to protect free speech from abuse of power.</div>"},{id:"walletid",q:"Is my public key like a wallet ID that I enter on my profile and people can send points to?",a:"<div>Exactly. And it is safe to reveal. But not a secret phrase - keep it safe!</div>"},{id:"runnode",q:"Can I run a node on my headless server?",a:"<div>We will put the node&rsquo;s sources into GitHub. Instructions for running a node will be made available in early April.</div>"},{id:"signback",q:"How can I sign back in?",a:"<div>You can use your private 12-word key or a QR code to sign in.</div>"}]},{name:"Curation of content",id:"curation",group:[{id:"content",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>This is a very important question and we will be releasing many videos and articles about it, as well as looking for your input. To begin with, not all types of content are allowed. However, and this is crucial, the enforcement is transparent and up to the community in the way we will explain below. Enforcement is done by the community and is in the open with no hidden shadow bans or selective banning practiced by the Silicon Valley.</div>"},{id:"specific",q:"Specifics of curation on Pocketnet.",a:"<div>When your reputation gets to 100 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. When someone has more than 2 posts that are voted off the platform in 24 hours, they cannot post for another 48 hours after the second post. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div> "},{id:"racism",q:"Important Note on Racism.",a:"<div>Free thought and free speech is under attack on mainstream social platforms and in the media. We need to speak the truth and this platform is non-corporate and decentralized for that very reason. But we ask everyone make your point without attacking people&rsquo;s nationality or race. You can make your point based on evidence. We cannot afford to turn Pocketnet into a marginal platform. Speak the truth, but please avoid racism and attacks against specific nationalities on the whole. We know that Silicon Valley and MSM has turned the issue of racism into their playing card and they constantly cry wolf. Even more the reason for us to be measured and evidence based and not let them smear us with that. If we are not, we are not allowing most of the population to weigh the evidence of MSM corruption presented on Pocketnet. Please keep that in mind, so that free speech can thrive and we can beat the facebokks of the world.</div><div>Ultimately, it is the community that will determine the direction of the platform. Having a bunch of snowflakes that complain about stuff that offends them is equally as bad as when people want to voice direct violent threats. However, the first indication is that early users of the platform are generally intelligent and evidence based, so the future looks incredibly bright. Pocketnet team has noticed after a few days of the beta test, that we stopped reading even alternative news, because there was so much interesting content on Pocketnet. Keep it up!</div><div>Please get involved in the discussion on these topics. This is a community platform. We are always eager to improve transparency of the platform and you should let us know how we can improve our content curation and policing. Use group chat or email support(at)pocketnet*dot*app or make full posts on this topic.</div>"}]},{name:"Specifics of curation on Pocketnet.",id:"specificscuration",group:[{id:"trolls",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>Sometimes we can have a user who comes in with a specific purpose to attack Pocketnet by posting a series of vile images. To protect against that we have a following mechanism. If someone’s reputation reaches -50 (negative 50), their account is automatically blocked. Getting a reputation of -50 is equivalent to having 25 one star ratings and no four or five star ratings. This is nearly impossible to achieve without having lots of bad posts.</div>"},{id:"flagging",q:"Flagging a specific post",a:"<div>When your reputation gets to 50 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div>"}]},{name:"How is Pocketnet different from...",id:"differents",group:[{id:"differents1",q:"Twitter, Facebook, Reddit & other centralized platforms?",a:"<div>There is no central authority or corporation. Platform is run by equal nodes on a blockchain. All revenue is split between node operators and content creators. Node operators stake Pocketcoin in order to mint blocks with rewards and transactions fees. Half of rewards in each block go to content creators based on ratings their content gathers from users.</div>"},{id:"differents2",q:"Decentralized platforms like Minds.com and Sola?",a:"<div>Both of those platforms, while great, are not self-contained. Both are highly dependent on the Ethereum platform, because their tokens are based on ERC-20 Ethereum standard. That means that operations with tokens carry Ether gas fees. Also, those entities have corporations behind them and a corporation will always be a point of centralization due to its economic logic of growing profits. In addition, corporations are exceedingly easy to censor.</div>"},{id:"differents3",q:"From Steemit?",a:"<div>Steemit has its own blockchain, but is a corporate entity with all of the centralization that comes from that.</div>"},{id:"differents4",q:"Decentralized platforms like Mastodon and others?",a:"<div>While Mastodon is a fully decentralized platform, it requires a great deal of technical knowledge to use. This presents a great hindrance to potential widespread acceptance. Pocketnet features a web and desktop applications and users can log in from any device, pull in their personal settings from the blockchain and start using the platform immediately without any technial knowledge.</div>"}]},{name:"Pocketnet ecosystem",id:"ecosystem",group:[{id:"ecosystem1",q:"How is Pocketnet development funded?",a:"<div>Pocketnet is open sourced and is currently run by the group of volunteers with some serious programming and math skills. After launch Pocketnet will attract top programming talent based on its promise of creating a decentralized fair social network. Programmers and marketers working on Pocketcoin receive 5% of emission. The awards to developers and marketers will be assigned by nodes voting in a transparent manner.</div>"},{id:"ecosystem2",q:"What is Pocketcoin?",a:"<div>Pocketcoin is a network token. It is used exclusively to buy advertising from Pocketnet contributors and to pay transaction fees for such payments. Pocketcoin emission depends on the number of users of Pocketnet and has inherent algorithmic factors tying its long term value to Annual Revenue Per User (ARPU). ARPU is a term in digital advertising which signifies the total amount of revenue platform receives for one active user per year. In Pocketent all of the revenue is split between content creators and nodes.</div>"},{id:"ecosystem3",q:"How are content creators and node operators rewarded?",a:"<div>Pocketnet features unique Direct Marketplace where content creators can sell advertising to ad buyers. Content creators set their price and can accept mass-produced ads or can offer highly valued custom placements (creators pitching the product in their own way). Direct Marketplace is essentially an exchange for advertising that allows ad buyers target specific audiences without any intermediaries. All ad buys and ads themselves are linked on the blockchain, therefore ad buying is completely trustless.</div>"},{id:"ecosystem4",q:"What if users post illegal content, pornography and SPAM?",a:"<div>Pocketnet is not a darknet platform or some sort of pornhub. While it is decentralized and censorship resistant, it is policed by the users. Any illegal content is flagged and removed from the platform using the Wikipedia model. This means that users with highest reputation can police the platform. However, there are safeguards in place (within the open source code) from same or very similar group(s) of people repeatedly voting content off the platform. Also, users are explicitly encouraged to flag illegal content OR content that threatens mass adoption of Pocketnet, not simply the content they find offensive. To make sure that Pocketnet is a free speech platform, we encourage you to start participate, grow your reputation and police the platform properly without the censorship currently prevalent in centralized social media.</div>"},{id:"ecosystem5",q:"Who runs the Pocketnet?",a:"<div>There is no corporate entity or single individual who owns or controls the Pocketnet.</div></div>"}]}];window.cordova||t[0].group.splice(1,0,{id:"downloadandroid",q:r.app.localization.e("e14109"),a:`<div><a href="https://play.google.com/store/apps/details?id=pocketnet.app">https://play.google.com/store/apps/details?id=pocketnet.app</a></div><div>${r.app.localization.e("e14110")}</div>`});function a(){var e=$(window).height()/4,t=inView(o.c.find(".faqcnt .group"),{offsetTop:e,offsetBottom:e,mode:"line"});0<t.length&&(e=$(t[0]).attr("group"),o.contens.removeClass("active"),o.c.find('.contens .item[group="'+e+'"]').addClass("active"))}function i(){var e=$(this).attr("group");_scrollToTop(o.c.find('.faqcnt .group[group="'+e+'"]'),null,null,-110)}function n(){!function(e){var t=s[e],o="https://"+r.app.options.url+"/help?page=faq&id="+e;r.app.platform.sdk.address.pnet()&&(o+="&ref="+r.app.platform.sdk.address.pnet().address);var a=t.q,e=filterXSS(t.a,{whiteList:[],stripIgnoreTag:!0});r.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:o,sharing:{image:"",images:[],title:a,html:{body:t.a,preview:trimHtml(t.a,160)},text:{body:e,preview:trimHtml(e,160)}},caption:"Share FAQ answer in social networks"}})}($(this).closest(".question").attr("question"))}var s={};return{primary:e,getdata:function(e){s={},_.each(t,function(e){_.each(e.group,function(e){s[e.id]=e})}),e({groups:t})},destroy:function(){window.removeEventListener("scroll",a),o={}},init:function(e){(o={}).c=e.el.find("#"+r.map.id),o.contens=o.c.find(".contens .item"),o.contens.on("click",i),o.c.find(".share").on("click",n),o.c.find(".question .questionName").on("click",function(){$(this).closest(".question").toggleClass("opened")}),window.addEventListener("scroll",a),o.c.find(".contens").hcSticky({stickTo:"#faq",top:65});var t=parameters().id;t&&_scrollToTop(o.c.find('.faqcnt .question[question="'+t+'"]'),null,null,-110),e.clbk(null,e)}}}var r=new nModule,a={};return r.run=function(e){var t=r.addEssense(a,o,e);r.init(t,e)},r.stop=function(){_.each(a,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=faq:(app.modules.faq={},app.modules.faq.module=faq);
 /*_____*/ 
var wallet=function(){function t(e){function t(e,i){lazyEach({array:_.toArray(p),sync:!0,action:function(l){var o=l.item,e=o.addresses();b.app.platform.sdk.node.transactions.get.balance(function(r){b.app.platform.sdk.node.transactions.get.canSpend(e,function(e,a){var t="#414244",s=100,n=b.app.platform.sdk.node.transactions.tempBalance();a&&(s=100*e/(a="pnetwallet"==o.id||"total"==o.id?n+a:a),t="#0F8623"),t={positive:{summary:s,color:t}},e<a&&(t.neutral={summary:100-s,color:"#414244"}),"pnetwallet"!=o.id&&"total"!=o.id||(r=n+r),g.total({label:o.label,id:o.id,balance:r,move:t,update:i},l.success)})},e)},all:{success:function(){e&&e()}}})}function l(e){var a=[g.send,g.deposit,g.addresses];console.log("essenseData",d),d.api&&d.action&&(a=[g[d.action]]),i.c.addClass("loading"),console.log("actions",a),lazyActions(a,function(){e()})}function o(){w.addaddress()}function n(){$(this).closest(".actionbody").html("")}var i,e=deep(e,"history"),c={},d={},p={pnetwallet:{label:b.app.localization.e("tacaddress"),alabel:b.app.localization.e("tacaddress"),id:"pnetwallet",addresses:function(){return[b.app.platform.sdk.address.pnet().address]}},wallet:{label:b.app.localization.e("twallet"),id:"wallet",addresses:function(){return b.app.platform.sdk.addresses.storage.addresses||[]},caption:b.app.localization.e("twalletaddresses")},total:{label:b.app.localization.e("tTotal"),id:"total",addresses:function(){return[b.app.platform.sdk.address.pnet().address].concat(b.app.platform.sdk.addresses.storage.addresses||[])}}},u={parameters:{source:new Parameter({name:b.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress"),b.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:b.app.localization.e("wsselect")}),reciever:new Parameter({name:b.app.localization.e("wsreciever"),type:"VALUESCUSTOM",id:"reciever",possibleValuesLabels:[],possibleValues:[],placeholder:b.app.localization.e("wsenter"),onType:!0,labelToInput:function(e){return _.isObject(e)?e.name:e},defaultValueTemplate:function(e,a,t,s){if(_.isObject(e)){var n="";return n+='<div class="table walletuservalue" firstdef="'+s+'">',n+='<div class="iconcell">',n+='<img src="'+e.image+'">',n+="</div>",n+='<div class="namecell">',n+=e.name,(n+="</div>")+"</div>"}return'<div class="walletdfvalue"><span>'+e+"</span></div>"}}),amount:new Parameter({name:b.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),message:new Parameter({name:b.app.localization.e("message"),id:"message",type:"stringany",placeholder:b.app.localization.e("yourmessage"),format:{Length:80}}),fees:new Parameter({name:b.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[b.app.localization.e("wsrecieverpay"),b.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},m={parameters:{source:new Parameter({name:b.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress"),b.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:b.app.localization.e("wsselect")}),amount:new Parameter({name:b.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),fees:new Parameter({name:b.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[b.app.localization.e("wsrecieverpay"),b.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},a={wallet:b.app.localization.e("twallet"),pnetwallet:b.app.localization.e("tacaddress")},s={active:!1,parameters:{deposit:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"deposit",defaultValue:"wallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress")],possibleValues:["wallet","pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),depositamount:new Parameter({name:b.app.localization.e("wdamount"),id:"depositamount",type:"NUMBER",placeholder:b.app.localization.e("wdenteramount"),onType:!0,format:{Precision:6}}),message:new Parameter({name:b.app.localization.e("wdmessage"),id:"message",type:"TEXT",placeholder:b.app.localization.e("wdmessageplaceholder"),onType:!0}),label:new Parameter({name:b.app.localization.e("wdlabel"),id:"label",type:"STRING",onType:!0})}},r={active:!1,parameters:{reciever:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"reciever",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("tacaddress")],possibleValues:["pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),amount:new Parameter({name:b.app.localization.e("e13214"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),currency:new Parameter({name:b.app.localization.e("currency"),id:"currency",type:"VALUES",defaultValue:"btc",possibleValuesLabels:["BTC","LTC"],possibleValues:["btc","ltc"],placeholder:b.app.localization.e("e13215")}),currencyAmount:new Parameter({name:b.app.localization.e("e13216"),id:"currencyAmount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}})},segments:[{id:"AWAITINGFUNDS",time:180,exclude:"all",label:function(e,a,t){if(e==this.id)return'<div class="todeal">'+t.currency.toUpperCase()+": "+a.Address+' <i class="fas fa-chevron-circle-right"></i> </div>'},currentLabel:function(e){return"Awaitng Funds. Address will be valid for <b>"+e.MinutesLeft+" minutes</b>"}},{id:"EXPIREDAWAITINGFUNDS",class:"bad",finish:!0,exclude:"all",label:function(e,a){return b.app.localization.e("e13217")},currentLabel:function(e){return b.app.localization.e("e13217")+' <div class="reactivate">'+b.app.localization.e("reactivate")+"</div>"}},{id:"CONFIRMATIONS0",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (0/4)"}},{id:"CONFIRMATIONS1",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (1/4)"}},{id:"CONFIRMATIONS2",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (2/4)"}},{id:"CONFIRMATIONS3",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (3/4)"}},{id:"POCSENT",time:4,currentLabel:function(e){return b.app.localization.e("e13219")}},{id:"POCDELEVERED",finish:!0,currentLabel:function(e){return b.app.localization.e("e13220")}}]},f=[],v=[],h=0,w={showCrInStep:function(a,e,t,s){g.step(function(e){g.crowdfunding(function(e){a&&w[a](e,s),g.stepC(e,t)},e)},e,{class:"crowdfunding",view:a})},olddeal:function(e,a){g.crDeal(a,b.app.platform.sdk.exchanges.info[a.info.address],e.find(".actionbody"))},newdeal:function(s){var e={currency:r.parameters.currency.value,address:r.parameters.reciever.value,amount:r.parameters.amount.value,currencyAmount:r.parameters.currencyAmount.value};w.pocAddress(e,function(e,a,t){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0003)"):g.crDeal(a,t,s.find(".actionbody"))})},showListcount:function(t){b.app.platform.sdk.exchanges.statuses(function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0004)"):g.showListcount(a,t.find(".actionbody"))})},status:function(){},pocAddress:function(e,s){(e=e||{}).reciever&&"pnetwallet"!=e.reciever||(e.address=b.app.platform.sdk.address.pnet().address),"wallet"==e.reciever&&(e.address=b.app.platform.sdk.addresses.storage.addresses[0]),e.currency&&e.address?b.app.platform.sdk.exchanges.address(e,function(e,a,t){e?s&&s("fail",null):s&&s(null,a,t)}):s&&s("no data",null)},sendAddresses:function(){var e=u.parameters.source.value;return p[e].addresses()},canChangeSend:function(){if(u.parameters.reciever.value){var t=null;if(_.find(a,function(e,a){return t=a,u.parameters.reciever.value==e||u.parameters.reciever.value==a}))return t}return null},htlsParameters:function(){m.parameters.source.value;var e=w.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){m.parameters.amount.value>e&&(m.parameters.amount.value=e)},e,null,!0)},sendParameters:function(){var t=u.parameters.source.value;u.parameters.reciever.possibleValues=[],u.parameters.reciever.possibleValuesLabels=[],_.each(a,function(e,a){a!=t&&"total"!=t&&(u.parameters.reciever.possibleValues.push(a),u.parameters.reciever.possibleValuesLabels.push(e))}),"total"==t&&_.find(a,function(e,a){return u.parameters.reciever.value==e||u.parameters.reciever.value==a})&&(u.parameters.reciever.value=""),_.each(b.sdk.activity.latest,function(a,e){_.each(a,function(e){7<a||"user"==e.type&&e.id!=b.app.platform.sdk.address.pnet().address&&(a++,u.parameters.reciever.possibleValues.push(e.id),u.parameters.reciever.possibleValuesLabels.push(e.data))})}),u.parameters.reciever.value!=t&&u.parameters.reciever.value!=a[t]||(u.parameters.reciever.value=u.parameters.reciever.possibleValuesLabels[0]),u.parameters.reciever.possibleValues.length?u.parameters.reciever.placeholder=b.app.localization.e("wrenteraddressselect"):u.parameters.reciever.placeholder=b.app.localization.e("wrenteraddress");var e=w.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){u.parameters.amount.value>e&&(u.parameters.amount.value=e)},e,null,!0)},addaddress:function(){var e=b.app.platform.sdk.addresses.storage.addresses.length;b.app.platform.sdk.addresses.addWalletAddress(e),b.app.platform.sdk.addresses.save(),topPreloader(0),k(function(){topPreloader(100)})},linkValidation:function(){return 0<s.parameters.depositamount.value&&trim(s.parameters.message.value)&&trim(s.parameters.label.value)},linkValidationQr:function(){return 0<s.parameters.depositamount.value},showDepositInStep:function(a,e,t){g.step(function(e){g.deposit(function(e){w[a](e),g.stepB(e,t)},e)},e,{class:"deposit"})},showQrResult:function(e){s.address&&w.linkValidationQr()&&g.qrResultForDeposit(s.address,e.find(".actionbody"))},showLinkResult:function(e){s.address&&w.linkValidation()&&g.linkResultForDeposit(s.address,e.find(".actionbody"))},showLinkMaker:function(e){s.address&&g.linkMakerForDeposit(s.address,e.find(".actionbody"))},showQrMaker:function(e){s.address&&g.qrMakerForDeposit(s.address,e.find(".actionbody"))},showDeposit:function(a){s.address="";var e=s.parameters.deposit.value,t="";if(s.active=!0,"pnetwallet"==e)return t=b.app.platform.sdk.address.pnet().address,s.address=t,void g.addressForDeposit(t,a.find(".actionbody"));"wallet"==e&&b.app.platform.sdk.addresses.addNewWalletAddress(function(e){b.app.platform.sdk.addresses.save(),t=e,s.address=t,g.addresses(),g.addressForDeposit(t,a.find(".actionbody"))})},showSendInStep:function(a,e,t,s){g.step(function(e){g.send(function(e){w[a](e),g.stepB(e,t),s&&s()},e)},e,{class:"send"})},showHtlsInStep:function(a,e,t,s){var n=i.c.find(".htlsnoredraw");n.length?(h=e,console.log("ACTION",a),w[a](n),g.stepB(n,t),s&&s()):g.step(function(e){g.htls(function(e){w[a](e),g.stepB(e,t),s&&s()},e)},e,{class:"htls"})},calculateFee:function(a){b.app.platform.sdk.node.fee.estimate(function(e){g.sendFees(a.find(".actionbody"),e)})},calculateFeeHtls:function(a){console.log("calculateFeeHtls"),b.app.platform.sdk.node.fee.estimate(function(e){console.log(a,e),g.htlsFees(a.find(".actionbody"),e)})},validHtls:function(){var e=m.parameters.amount.value;return console.log("htls.parameters.amount.value",m.parameters.amount.value),0<e},validSend:function(){var e=u.parameters.amount.value,a=u.parameters.reciever.value;return!!(0<e&&a)},prepareTransactionCommon:function(a,e,t,l,s,o){function n(s,n,r){b.app.platform.sdk.wallet.txbase(s,_.clone(n),0,r,function(e,a,t){e?sitemessage(e):(t=b.app.platform.sdk.node.transactions.create.wallet(a,t),t=Math.min(t.virtualSize()*l,.0999),o&&o(s,n,t,r))})}var r=w.sendAddresses(),i=[];if("pnetwallet"==e||e==b.app.localization.e("tacaddress"))return i.push({address:b.app.platform.sdk.address.pnet().address,amount:a}),void n(r,i,t);"wallet"!=e&&e!=b.app.localization.e("twallet")?(i.push({address:e,amount:a}),b.sdk.wallet.embed(i,s),n(r,i,t)):b.app.platform.sdk.addresses.getFirstRandomAddress(function(e){i.push({address:e,amount:a}),b.app.platform.sdk.addresses.save(),n(r,i,t)})},prepareTransaction:function(e,a){var t=u.parameters.amount.value,s=u.parameters.fees.value,n=u.parameters.message.value,r=u.parameters.reciever.value;w.prepareTransactionCommon(t,r,s,e,n,a)},prepareTransactionHlts:function(n,e,r){var t=m.parameters.amount.value,l=m.parameters.fees.value,o=w.sendAddresses(),i=[];b.app.platform.sdk.address.pnet().address,i.push({amount:t,key:"htlc"}),b.app.platform.sdk.wallet.txbase(o,_.clone(i),e,l,function(e,s,a){e?sitemessage(e):b.sdk.node.transactions.htls.plcreate(d.htls,t,s,a,function(e,a){var t=e.build(),e=Math.min(t.virtualSize()*n,.0999);r&&r(o,i,s,e,l,a,t)})})}},g={clearMain:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElement",timeouts:150},clear:!0,el:i.c.find(".animationWrapper")},e)},clearStep:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElementStep",timeouts:150},clear:!0,el:i.step},e)},mainWithClear:function(e){f=[],v=[],g.clearStep(function(){g.main(function(){k()})})},main:function(e){b.shell({name:"main",el:i.main,data:{},animation:"fadeIn"},function(){i.total=i.c.find(".total .tttl"),i.totaler=i.c.find(".total .tttlforerror"),i.addresses=i.c.find(".addresses"),i.send=i.c.find(".send"),i.deposit=i.c.find(".deposit"),i.crowdfunding=i.c.find(".crowdfunding"),i.htls=i.c.find(".htls"),console.log("el.htls",i.htls),b.iclbks.main=function(){b.app.errors.connection()?i.totaler.addClass("active"):i.totaler.removeClass("active")},e&&e()})},stepC:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},stepB:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},step:function(a,e,t){t=t||{},h==e?a&&a(i.c.find(".step")):(f[h=e]=a,v[e]=t,g.clearMain(function(){_scrollToTop(i.step,0,200,-70),setTimeout(function(){b.shell({name:"step",el:i.step,data:{},animation:"fadeIn"},function(e){e=e.el.find(".step"),t.class&&e.addClass(t.class),t.view?e.attr("view",t.view):e.removeAttr("view"),a&&a(e)})},200)}))},showListcount:function(e,a){var t=b.app.platform.sdk.exchanges.get();b.shell({name:"listcr",el:a,data:{list:t,c:r}},function(s){function n(e,a){b.app.platform.sdk.exchanges.remove(e.currency,e.info.address),a.remove(),(t=b.app.platform.sdk.exchanges.get()).length||g.step(f[h-1],h-1,v[h-1])}s.el.find(".removecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),s=b.app.platform.sdk.exchanges.find(e);b.app.platform.sdk.exchanges.status(s.currency,s.info.address,function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0006)"):"AWAITINGFUNDS"==a.Status||"EXPIREDAWAITINGFUNDS"==a.Status?n(s,t):dialog({html:b.app.localization.e("e13221"),success:function(){n(s,t)}})})}),s.el.find(".updatecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),s=b.app.platform.sdk.exchanges.find(e);s?b.app.platform.sdk.exchanges.status({address:s.info.address,currency:s.currency},function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0002)"):g.crStatus(s,a,t.find(".status"))}):sitemessage(b.app.localization.e("errorreload")+" (error: 0001)")}),s.el.on("click",".todeal",function(){var e=$(this).closest(".item").attr("item"),e=b.app.platform.sdk.exchanges.find(e);w.showCrInStep("olddeal",h+1,"Deal",e)}),lazyEach({array:t,action:function(e){var a=e.item,t=s.el.find('[item="'+a.info.address+'"] .status'),e=b.app.platform.sdk.exchanges.info[a.info.address];g.crStatus(a,e,t)}})})},listcount:function(e){var a=b.app.platform.sdk.exchanges.get(),t=e.find(".listcountWrapper");0<a.length?(a="("+a.length+")",e.find(".listcount").html(a),t.fadeIn()):t.fadeOut()},crdealstatusstep:function(e,a,t){b.shell({name:"crdealstatusstep",el:t,data:{addressobject:e,info:a}},function(e){})},crDeal:function(s,n,e){b.shell({name:"crdeal",el:e,data:{addressobject:s}},function(t){g.crStatus(s,n,t.el.find(".status")),g.crdealstatusstep(s,n,t.el.find(".crdealstatusstep")),t.el.on("click",".copyaddress1",function(){copyText(t.el.find(".forcopyaddress1")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".copyaddress2",function(){copyText(t.el.find(".forcopyaddress2")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".reactivate",function(){b.app.platform.sdk.exchanges.reactivate({address:s.info.address,currency:s.currency},function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0002)"):(n=a,g.crStatus(s,n,t.el.find(".status")),g.crdealstatusstep(s,n,t.el.find(".crdealstatusstep")))})})})},applyStatus:function(s,n){_.find(r.segments,function(e){var a=n.find('.segment[segment="'+e.id+'"]');if(e.id==s.Status){var t=100*Math.min((Number(e.time)-Number(s.MinutesLeft))/Number(e.time),.99);return a.find(".line").css("width",t+"%"),a.addClass("active"),e.class&&a.addClass(e.class),e.finish&&(a.addClass("ended"),a.find(".line").css("width","100%")),!e.finish&&"all"!=e.exclude||n.find(".current").html(e.currentLabel(s)),!0}a.addClass("ended"),a.find(".line").css("width","100%")})},crStatus:function(e,a,t,s){b.shell({name:"pocstatus",el:t,data:{addressobject:e,info:a,segments:r.segments}},function(e){g.applyStatus(a,t),s&&s()})},crowdRate:function(e,a,t){e.find(".rate .value").html("<b>1 PKOIN = "+a[t].toFixed(6)+" "+t.toUpperCase()+"</b>")},crowdCurrencyLabel:function(e,a){e.find(".currencyAmountLabel").html(a.toUpperCase()+" "+b.app.localization.e("amount")+"</b>")},crowdfunding:function(e,a){2==h&&(f[1]=function(e){w.showCrInStep("",1,"")},v[1]={class:"crowdfunding"}),r.parameters.currency||(r.parameters.currency.value="btc"),b.app.platform.sdk.exchanges.rates(function(s){b.app.platform.sdk.node.transactions.get.balance(function(t){t=Math.min(t/3,1e3),b.shell({name:"crowdfunding",el:a||i.crowdfunding,data:{d:r,amount:t}},function(a){ParametersLive(_.toArray(r.parameters),a.el),a.el.on("click",".closeAdditional",n),g.crowdRate(a.el,s,r.parameters.currency.value),g.crowdCurrencyLabel(a.el,r.parameters.currency.value),g.listcount(a.el),r.parameters.amount._onChange=function(e){r.parameters.amount.value<0&&(r.parameters.amount.value=0),r.parameters.amount.value>t&&(r.parameters.amount.value=t),r.parameters.currencyAmount.value=r.parameters.amount.value*s[r.parameters.currency.value],r.parameters.amount.el.closest(".inputWrapper").html(r.parameters.amount.input()),r.parameters.currencyAmount.el.closest(".inputWrapper").html(r.parameters.currencyAmount.input()),ParametersLive([r.parameters.amount,r.parameters.currencyAmount],a.el)},r.parameters.currency._onChange=function(e){b.app.platform.sdk.exchanges.rates(function(e){s=e,g.crowdRate(a.el,s,r.parameters.currency.value),g.crowdCurrencyLabel(a.el,r.parameters.currency.value)})},r.parameters.currencyAmount._onChange=function(e){r.parameters.currencyAmount.value<0&&(r.parameters.currencyAmount.value=0),r.parameters.currencyAmount.value/s[r.parameters.currency.value]>t&&(r.parameters.currencyAmount.value=Number((t*s[r.parameters.currency.value]).toFixed(6))),r.parameters.amount.value=r.parameters.currencyAmount.value/s[r.parameters.currency.value],r.parameters.amount.el.closest(".inputWrapper").html(r.parameters.amount.input()),r.parameters.currencyAmount.el.closest(".inputWrapper").html(r.parameters.currencyAmount.input()),ParametersLive([r.parameters.amount,r.parameters.currencyAmount],a.el)},a.el.find(".listcountWrapper").on("click",function(){w.showCrInStep("showListcount",2,"List of deals")}),a.el.find(".newdeal").on("click",function(){0<r.parameters.amount.value?(w.showCrInStep("newdeal",2,"Deal"),a.el.find(".required").addClass("hidden")):a.el.find(".required").removeClass("hidden")}),e&&e(a.el)})},"PFF7PevK753eYTwWBScdEAbWQrgu36AdUA",!0,!0)})},qrResultForDeposit:function(e,a,t){b.shell({name:"depositqrresult",el:a,data:{address:e,d:s}},function(e){})},linkResultForDeposit:function(e,a,t){b.shell({name:"depositlinkresult",el:a,data:{address:e,d:s}},function(e){e.el.find(".copylink").on("click",function(){copyText(e.el.find(".linkInTextArea")),sitemessage(b.app.localization.e("waddresswascop"))})})},linkMakerForDeposit:function(e,a,t){b.shell({name:"depositlinkmaker",el:a,data:{address:e,d:s}},function(e){var a=e.el.find(".getlink"),t=[s.parameters.depositamount,s.parameters.message,s.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){w.linkValidation()?a.removeClass("disabled"):a.addClass("disabled")}}),w.linkValidation()&&a.removeClass("disabled"),a.on("click",function(){w.linkValidation()&&w.showDepositInStep("showLinkResult",3,b.app.localization.e("linkCreated"))})})},qrMakerForDeposit:function(e,a,t){b.shell({name:"depositqrmaker",el:a,data:{address:e,d:s}},function(e){var a=e.el.find(".getlink"),t=[s.parameters.depositamount,s.parameters.message,s.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){w.linkValidationQr()?a.removeClass("disabled"):a.addClass("disabled")}}),w.linkValidationQr()&&a.removeClass("disabled"),a.on("click",function(){w.linkValidationQr()&&w.showDepositInStep("showQrResult",3,b.app.localization.e("wqrcodecreated"))})})},addressForDeposit:function(e,a,t){b.shell({name:"depositaddress",el:a,data:{address:e,d:s}},function(e){e.el.find(".getlink").on("click",function(){w.showDepositInStep("showLinkMaker",2,b.app.localization.e("wlinkcreating"))}),e.el.find(".qrcode").on("click",function(){w.showDepositInStep("showQrMaker",2,b.app.localization.e("wqrcodecreating"))}),e.el.find(".copyaddress").on("click",function(){copyText(e.el.find(".adr")),sitemessage(b.app.localization.e("waddresswascop"))})})},deposit:function(e,a){b.shell({name:"deposit",el:a||i.deposit,data:{d:s}},function(a){ParametersLive([s.parameters.deposit],a.el),s.parameters.deposit._onChange=function(e){b.app.settings.set(b.map.uri,"deposit",e),e=s.parameters.deposit.labelByValue(e),a.el.find(".type").html(e),w.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))},a.el.find(".recieveaddress").on("click",function(){w.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))}),a.el.on("click",".closeAdditional",n),e&&e(a.el)})},embeddingcode:function(e){var a={comments:"no",footer:"no"},a=hexEncode(JSON.stringify(a)),t=rand(1e4,99999);return'<div id="pocketnet_'+t+'"></div><script src="https://'+b.app.options.url+'/js/widgets.js"><\/script><script type="text/javascript">(new window.PNWIDGETS()).make('+t+', "lenta", "'+e+'", "'+a+'")<\/script>'},htlsFees:function(l,e,a){var i;console.log("el, fees",l,e),w.validHtls()&&(i=e.feerate||1e-6,console.log("htlsFees",i),w.prepareTransactionHlts(i,0,function(e,a,t,s,n,r){console.log("prepareTransactionHlts",s),b.shell({name:"htlsFees",el:l,data:{fees:s,d:m,meta:r}},function(a){function o(e){e?a.el.find(".sendtransaction").addClass("loading"):a.el.find(".sendtransaction").removeClass("loading")}ParametersLive([m.parameters.fees],a.el),m.parameters.fees._onChange=function(e){b.app.settings.set(b.map.uri,"feesModehtls",e)},a.el.find(".sendtransaction").on("click",function(){$(this).hasClass("loading")||(o(!0),w.prepareTransactionHlts(i,s,function(e,t,s,a,n,r,l){console.log("TX",l),_.each(s,function(e){e.cantspend=!0}),b.app.platform.sdk.node.transactions.send(l,function(e,a){console.log("err",a),a?(b.app.platform.sdk.node.transactions.releaseCS(s),o(!1),b.app.platform.errorHandler(a,!0)):(a=_.map(s,function(e){return e.txid}),b.app.platform.sdk.node.transactions.clearUnspents(a),h=0,g.mainWithClear(),b.app.platform.sdk.wallet.saveTempInfoWallet(e,s,t),o(!1),sitemessage(b.app.localization.e("wssuccessfully")))})}))})})}))},htls:function(e,a){console.log("el.htls",i.htls),w.htlsParameters(),b.shell({name:"htls",el:a||i.htls,data:{d:m,ed:d}},function(t){ParametersLive(_.toArray(m.parameters),t.el),m.parameters.amount._onChange=function(e){var a=w.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){m.parameters.amount.value<0&&(m.parameters.amount.value=0),m.parameters.amount.value>e&&(m.parameters.amount.value=e),m.parameters.amount.el.closest(".inputWrapper").html(m.parameters.amount.input()),ParametersLive([m.parameters.amount],t.el),console.log("MODE",h),1==h&&w.showHtlsInStep("calculateFeeHtls",1,"htls")},a,null,!0)},t.el.find(".calculateFee").on("click",function(){w.validHtls()?(w.showHtlsInStep("calculateFeeHtls",1,"htls"),t.el.find(".required").addClass("hidden")):t.el.find(".required").removeClass("hidden")}),d.htls&&t.el.find(".htlsWrapper").html(g.embeddingcode(d.htls)),e&&e(t.el)})},sendFees:function(n,e,a){var r;w.validSend()&&(r=e.feerate||1e-6,w.prepareTransaction(r,function(e,a,t,s){b.shell({name:"sendfees",el:n,data:{fees:t,d:u}},function(a){function n(e){e?a.el.find(".sendtransaction").addClass("loading"):a.el.find(".sendtransaction").removeClass("loading")}ParametersLive([u.parameters.fees],a.el),u.parameters.fees._onChange=function(e){b.app.settings.set(b.map.uri,"feesMode",e)},a.el.find(".sendtransaction").on("click",function(){$(this).hasClass("loading")||(n(!0),w.prepareTransaction(r,function(e,a,t,s){b.app.platform.sdk.wallet.txbase(e,_.clone(a),t,s,function(e,t,s){return e?(n(!1),void sitemessage(e.text||e)):(e=b.app.platform.sdk.node.transactions.create.wallet(t,s),_.each(t,function(e){e.cantspend=!0}),void b.app.platform.sdk.node.transactions.send(e,function(e,a){console.log("err",a),a?(b.app.platform.sdk.node.transactions.releaseCS(t),n(!1),sitemessage(a.text||a)):(a=_.map(t,function(e){return e.txid}),b.app.platform.sdk.node.transactions.clearUnspents(a),h=0,g.mainWithClear(),b.app.platform.sdk.wallet.saveTempInfoWallet(e,t,s),n(!1),sitemessage(b.app.localization.e("wssuccessfully")),b.app.platform.matrixchat.transaction(e,d.roomid),d.sendclbk&&d.sendclbk({txid:e}))}))})}))})})}))},send:function(a,e){w.sendParameters(),b.shell({name:"send",el:e||i.send,data:{d:u}},function(t){function s(){w.canChangeSend()?e.removeClass("hidden"):e.addClass("hidden")}ParametersLive(_.toArray(u.parameters),t.el);var e=t.el.find(".change");u.parameters.amount._onChange=function(e){var a=w.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){u.parameters.amount.value<0&&(u.parameters.amount.value=0),u.parameters.amount.value>e&&(u.parameters.amount.value=e),u.parameters.amount.el.closest(".inputWrapper").html(u.parameters.amount.input()),ParametersLive([u.parameters.amount],t.el),1==h&&w.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},a,null,!0)},u.parameters.source._onChange=function(e){w.sendParameters(),u.parameters.reciever.el.closest(".inputWrapper").html(u.parameters.reciever.input()),u.parameters.amount.el.closest(".inputWrapper").html(u.parameters.amount.input()),ParametersLive([u.parameters.reciever,u.parameters.amount],t.el),s(),1==h&&w.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},u.parameters.reciever._onChange=function(e){if(s(),!w.canChangeSend()&&e){var a=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){a=!1}a?(t.el.find(".notvalidaddress").html(""),e[0]):t.el.find(".notvalidaddress").html(b.app.localization.e("wsaddressnotv"))}else t.el.find(".notvalidaddress").html("")},e.on("click",function(){var e=w.canChangeSend();e&&(u.parameters.source.value=e,u.parameters.source._onChange(),u.parameters.source.el.closest(".inputWrapper").html(u.parameters.source.input()),ParametersLive([u.parameters.source],t.el))}),t.el.find(".calculateFee").on("click",function(){w.validSend()?(w.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees")),t.el.find(".required").addClass("hidden")):t.el.find(".required").removeClass("hidden")}),s(),a&&a(t.el)})},addresses:function(s){var n=p.total.addresses(),r={};b.app.platform.sdk.node.transactions.get.unspents(function(t){b.app.platform.sdk.node.transactions.get.balance(function(e){_.each(t,function(e,a){r[a]=_.reduce(e,function(e,a){return e+Number(a.amount)},0)});var a=[p.pnetwallet,p.wallet],a=_.map(a,function(e){var a=_.map(e.addresses(),function(e){return{balance:r[e],address:e}});return{caption:e.caption,details:a,label:e.alabel}},n);b.shell({name:"addresses",el:i.addresses,data:{addressesGroup:a,total:e}},function(e){e.el.find(".addaddress").on("click",o),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(b.app.localization.e("successcopied"))}),s&&s()})},n)},n)},updateTotal:function(e,a){g.datasets(e,c[e.id].data.datasets),c[e.id].update(),i.total&&i.total.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(b.app.platform.mp.coinwithsmall(e.balance)),a&&a()},datasets:function(e,a){var t=[],s=_.map(e.move,function(e){return t.push(e.color),Number(e.summary||0)}),n=[],r=[],l=[],o=[],i="#F1F1F1";$("html").hasClass("stblack")&&(i="#112035"),_.each(e.move,function(e){_.each(e.items,function(e){n.push(Number(e.value)),r.push(e.color),l.push(i),o.push(8)})});var c=[{data:s,backgroundColor:t,borderColor:[i,i],borderWidth:[8,8]},{data:n,backgroundColor:r,borderColor:l,borderWidth:o}];return _.each(a,function(e,a){e.data=c[a].data}),c},total:function(a,t){a.update?g.updateTotal(a,t):b.shell({name:"total",el:i.total,inner:append,data:{item:a}},function(e){e=e.el.find("#chart"+a.id)[0].getContext("2d"),c[a.id]=new Chart(e,{type:"doughnut",data:{datasets:g.datasets(a)},options:{rotation:.5*Math.PI,cutoutPercentage:85}}),t&&t()})}},k=function(a){i.total.html(""),t(function(){var e=[g.send,g.deposit,g.addresses];lazyActions(e,a),b.app.platform.sdk.node.transactions.clbks.circles=function(){t(null,!0)},b.app.platform.sdk.node.transactions.clbks.walletaddresses=function(){g.addresses()}}),b.app.platform.sdk.node.transactions.get.allBalance(null,!0)};return{primary:e,getdata:function(e,a){var t={};t.p2pkh=b.app.platform.sdk.address.pnet(),d=a.settings.essenseData||{},s.parameters.deposit.value=b.app.settings.get(b.map.uri,"deposit")||s.parameters.deposit.defaultValue,u.parameters.source.value=b.app.settings.get(b.map.uri,"source")||u.parameters.source.defaultValue,u.parameters.reciever.value="",u.parameters.fees.value=b.app.settings.get(b.map.uri,"feesMode")||u.parameters.fees.defaultValue,m.parameters.fees.value=b.app.settings.get(b.map.uri,"feesModehtls")||m.parameters.fees.defaultValue,s.active=!1,h=0,f=[],v=[],e(t)},destroy:function(){delete b.app.platform.sdk.node.transactions.clbks.circles,delete b.app.platform.sdk.node.transactions.clbks.walletaddresses,delete b.iclbks.main,i={}},init:function(e){var t,s,a,n=_.extend(parameters(),d);c={},(i={}).c=e.el.find("#"+b.map.id),i.step=i.c.find(".actionstep"),i.main=i.c.find(".mainstep"),i.c.on("click","._stepclose",function(){h=0,g.mainWithClear()}),i.c.on("click","._stepback",function(){1<h?g.step(f[h-1],h-1,v[h-1]):(h=0,g.mainWithClear())}),isMobile()&&(t=i.c.find(".circularprogress"),(s=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),i.c.find(".circularprogressWrapper").html(s.el),a=$(window),d.api||new SwipeParallaxNew({el:i.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var a=Math.abs(e)/80;console.log("PX",e),0<=e?(s.options.text={value:""},t.fadeIn(1),s.update(100*a),t.height(220*a+"px")):(s.renew(),t.fadeOut(1))},constraints:function(){if(a.scrollTop()<=0)return!0},restrict:!0,trueshold:80,clbk:function(){s.update(0),t.fadeOut(1),b.app.platform.sdk.notifications.getNotifications(),b.app.platform.sdk.node.transactions.get.allBalanceUpdate(function(){k()})}}}}).init()),d.class&&i.c.addClass(d.class);var r=k;n.api&&(r=l),g.main(function(){r(function(){console.log("_p",n),n.action&&("send"==n.action&&(u.parameters.amount.value=Number((n.amount||"0").replace(/,/g,"")),u.parameters.reciever.value=n.address||"",u.parameters.message.value=n.message||"",u.parameters.amount._onChange(),w.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"),function(){i.c.removeClass("loading")})),"htls"==n.action&&(console.log("actions.showSendInStep"),w.showHtlsInStep("calculateFeeHtls",1,"HTLS",function(){i.c.removeClass("loading")})),"recieve"==n.action&&w.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))),e.clbk(null,e)})})},wnd:{class:"withoutButtons walletwindow"}}}var b=new nModule,s={};return b.run=function(e){var a=b.addEssense(s,t,e);b.init(a,e)},b.stop=function(){_.each(s,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=wallet:(app.modules.wallet={},app.modules.wallet.module=wallet);
 /*_____*/ 
var share=function(){function t(e){var s,o,n,i=/[,.!?;:() \n\r]/g,a=deep(e,"history"),r=null,l=!1,c=null,p={},t=v.app.localization.e("e13160"),d={resizeImage:function(e,a={}){var i=[{original:e,index:0}];return new Promise((t,n)=>{v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:0,images:i,apply:!0,crop:{aspectRatio:a.aspectRatio||16/9,style:"apply",autoCropArea:.95},success:function(e,a){resize(i[0].original,1920,1080,function(e){e.split(",")[1]?(a(),t(e)):n("error")})}}})})},uploadVideoWallpaper:function(a){var t=(r.url||{}).v||"",n={thumbnailfile:a},i={};return v.app.platform.sdk.videos.info([t]).then(()=>(v.app.platform.sdk.videos.storage[t]||{}).data).then((e={})=>(i.aspectRatio=e.aspectRatio,toDataURL(a))).then(e=>d.resizeImage(e,i)).then(e=>{var a=v.app.peertubeHandler.parselink(t).host||null;return n.image={data:e},v.app.peertubeHandler.api.videos.update(t,n,{host:a})}).catch(e=>{e=e.text||findResponseError(e)||"Updating error",sitemessage(e)})},language:function(n){var e=[];_.each(v.app.localization.available,function(t){e.push({text:t.name,action:function(e){var a=app.localization.findByName(t.name);a&&a.key!=r.language.v&&r.language.set(a.key),e(),g.postline(),n&&n()}})}),menuDialog({items:e})},toggleTimesDisplay:function(){var e=r.message.v||r.caption.v||r.repost.v||r.url.v||r.images.v.length||r.tags.v.length;s.times&&(e&&s.times.removeClass("hide"),e||s.times.addClass("hide"))},tooltips:function(){d.tooltip},tooltip:function(){},unfocus:function(){s.c&&s.c.addClass("unfocus").removeClass("focus")},waitActions:function(){v.app.platform.sdk.user.waitActions(function(e){s.c&&(e&&"inf"!=e?s.c.addClass("waitActions"):s.c.removeClass("waitActions"))})},autoFilled:function(){d.filled("i",0!=r.images.v.length),d.filled("u",r.url.v),d.filled("t",0!=r.tags.v.length),d.filled("cm",r.message.v||r.caption.v),d.filled("p",r.poll.v.list)},filled:function(e,a){e=s.c.find('.draggablepart[part="'+e+'"]'),a?e.addClass("filled"):e.removeClass("filled")},checkUrlForImage:function(a){if(a=a.split("?")[0].toLowerCase(),_.find(["jpg","gif","png","jpeg","webp","jfif"],function(e){if(-1<a.indexOf(e))return!0}))return!0},embeding20:function(e){var a=r.export(!0);v.nav.api.load({open:!0,id:"embeding20",inWnd:!0,essenseData:{storage:a,value:e,on:{added:function(e){"url"==type&&e&&d.checkUrlForImage(e)&&(type="images"),r[type].set(e),g[type]&&g[type]()}}}})},embeding:function(n,e){var a=r.export(!0);"addVideo"!==n&&"addStream"!==n||g.streamPage({value:e,storage:a,type:n}),"article"!=n?"times"!=n?"url"!=n&&"images"!=n||(l=!0,v.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:n,storage:a,value:e,on:{added:function(e){var t=!0;"url"==n&&e&&d.checkUrlForImage(e)&&(n="images"),_.isArray(e)||(e=[e]),_.each(e,function(e,a){t=r[n].set(e),o.share||f.save()}),!t&&m[n]&&sitemessage(m[n]),"url"==n?g.all():g[n]&&g[n]()}}},clbk:function(e,a){c=a}})):dialog({html:v.app.localization.e("e14002"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),class:"zindex",success:function(){var e=r.url.v;v.app.peertubeHandler.checklink(e)&&d.removevideo(e),r.clear(),r.language.set(v.app.localization.key),h()},fail:function(){}}):v.nav.api.load({open:!0,id:"articles",inWnd:!0,history:!0,essenseData:{storage:a,value:e,on:{added:function(e){}}},clbk:function(e){c=e}})},addTags:function(e){_.find(e,function(e){return r.tags.set(e)?(s.error.html(""),void(o.share||f.save())):(s.error.html(v.app.localization.e("e13162")),!0)})},addTag:function(e){r.tags.set(e)?(s.error.html(""),o.share||f.save()):s.error.html(v.app.localization.e("e13162"))},removeTags:function(e){var a=s.eMessage[0].emojioneArea.getText();_.each(e,function(e){r.tags.remove(e),a=a.split("#"+e).join(e)}),s.eMessage[0].emojioneArea.setText(a),o.share||f.save()},removeTag:function(e){r.tags.remove(e);var a=(a=s.eMessage[0].emojioneArea.getText()).split("#"+e).join(e);s.eMessage[0].emojioneArea.setText(a),o.share||f.save()},editImage:function(e){var a=_.map(r.images.v,function(e,a){return{original:e,index:a}}),n=_.filter(a,function(e){if(-1<e.original.indexOf("data:image"))return!0});l=!0,v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:n,close:function(){setTimeout(function(){l=!1},200)},success:function(e,a){_.each(r.images.v,function(e,a){var t=_.find(n,function(e){if(e.index==a)return!0});t&&(r.images.v[a]=t.original)}),o.share||f.save(),g.images(a)}}})},removeImage:function(t){var e=r.images.v.splice(t,1)[0];s.c.find(".imageContainer").each(function(){var e=$(this),a=e.attr("value");t<a&&e.attr("value",a-1),a==t&&e.remove()}),s.c.find(".imagesEmbWr").isotope();var a=(a=s.eMessage[0].emojioneArea.getText()).split(e).join("");s.eMessage[0].emojioneArea.setText(a),o.share||f.save()},removePoll:function(){r.poll.set(),o.share||f.save()},removevideo:function(a){r.settings.a=r.default.a,v.app.peertubeHandler.api.videos.remove(a).then(e=>{v.app.platform.sdk.videos.clearstorage(a)})},removelink:function(){var e=r.url.v;r.url.set();var a=(a=s.eMessage[0].emojioneArea.getText()).split(e).join("");s.eMessage[0].emojioneArea.setText(a),v.app.peertubeHandler.checklink(e)&&(d.removevideo(e),h()),o.share||f.save()},applyText:function(e){r.message.set(e)},caption:function(e){r.caption.set(e)},linksFromText:function(e){r.url.v||(e=e.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%|_\+.~#/?&//=]*)?/gi))&&0<e.length&&_.each(e,function(e){d.checkUrlForImage(e)?-1==r.images.v.indexOf(e)&&(r.images.set(e),g.images()):r.url.v||(r.url.set(e),g.url(),g.postline())})},tagsFromText:function(e){e=e.split(i),(e=_.filter(e,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))&&!r.tags.have(e)})).length&&(_.each(e,function(e){e=e.replace(/\#/g,""),r.tags.set(e)}),g.tgs())},post:function(n,a){if(s.postWrapper.removeClass("showError"),o.hash==r.shash())return s.postWrapper.addClass("showError"),void s.error.html(v.app.localization.e("e13163"));function e(){r.language.set(v.app.localization.key),r.uploadImages(v.app,function(){if(r.checkloaded()){var e=v.app.platform.errorHandler("imageerror",!0);return topPreloader(100),s.c.removeClass("loading"),void(e&&sitemessage(e))}v.sdk.node.transactions.create.commonFromUnspent(r,function(e,a){if(topPreloader(100),s.c.removeClass("loading"),e){try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,r.aliasid&&(t.edit="true"),r.time&&(t.time=r.time),v.app.platform.sdk.node.shares.add(t),o.notClear||(r.clear(),v.app.nav.api.history.removeParameters(["repost"]),v.closeContainer(),o.share||f.save(),h())}catch(e){console.log(e)}v.app.platform.sdk.user.get(function(e){e.postcnt++}),o.post?o.post():isMobile()?v.app.nav.api.load({open:!0,href:"index",history:!0}):_scrollTop(0),n&&n(!0),d.unfocus(),successCheck()}else n?n(!1,m[a]):(s.postWrapper.addClass("showError"),(a=v.app.platform.errorHandler(a,!0))&&s.error.html(a))},a)})}if(s.c.addClass("loading"),topPreloader(50),r.itisvideo()){const i={};r.message.v&&(i.description=`Watch more exciting videos at https://pocketnet.app/! \n ${r.message.v}`),r.caption.v&&(i.name=r.caption.v);var t=v.app.peertubeHandler.parselink(r.url.v);return i.host=t.host,v.app.peertubeHandler.api.videos.update(r.url.v,i).then(e).catch(e=>{e=e.text||findResponseError(e)||"Updating error",sitemessage(e),s.c.removeClass("loading"),topPreloader(100)})}e()},error:function(e){var a=r.validation();return d.toggleTimesDisplay(),a&&!e?(s.postWrapper&&s.postWrapper.addClass("showError"),s.error.html(m[a]),"message"==a&&s.c.find(".emojionearea-editor").focus(),"tags"==a&&s.c.find(".tgs input").focus(),"videocaption"==a&&s.caption.focus(),!0):(s.postWrapper&&s.postWrapper.removeClass("showError"),s.error&&s.error.html(""),!1)},eTextChange:function(e){e=e.getText(),d.tagsFromText(e),d.applyText(e),d.linksFromText(e),g.caption(),o.share||f.save()}},m={message:v.app.localization.e("emptymessage"),tags:v.app.localization.e("emptytags"),images:v.app.localization.e("maximages"),url:v.app.localization.e("e13164"),error_video:v.app.localization.e("e13165"),videocaption:v.app.localization.e("entervideocaption")},u={unfocus:function(e){s.c.hasClass("focus")&&!l&&0===s.c.has(e.target).length&&d.unfocus()},selectTime:function(){var e={day:null,hour:(e=(e=new Date).addMinutes(10)).getHours(),minutes:e.getMinutes()};o.time&&(e.day=o.time.yyyymmdd(),e.hour=o.time.getHours(),e.minutes=o.time.getMinutes()),v.fastTemplate("sharedate",function(e){dialog({html:e,btn1text:v.app.localization.e("daccept"),class:"one sharedate",clbk:function(e){},wrap:!0,success:function(e){var a=e.el.find(".day").val(),t=e.el.find(".hours").val(),e=e.el.find(".minutes").val();return a=(a=(a=strToDateSmall(a)).addHours(t)).addMinutes(e),new Date<a?(o.time=a,s.selectTime.find(".selectedTime").html(convertDate(dateToStr(a))),o.selectTime&&o.selectTime(a),!0):(sitemessage(v.app.localization.e("pastdate")),!1)}})},{date:e})},changePostTime:function(){var e=$(this),a=$(this).val();"p"!=a?("t"==a&&(d.error()?e.val("w"):o.time&&o.time<new Date&&(o.time=null,s.selectTime.find(".selectedTime").html(v.app.localization.e("timenotselected")),o.selectTime&&o.selectTime(null))),a=$(this).val(),o.type&&o.type(a)):dialog({html:v.app.localization.e("sharenow"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),success:function(){o.type&&o.type(a)},fail:function(){e.val("w")}})},changeAddress:function(){var e=$(this).val(),a=s.c.find(".usericon"),t=deep(app,"platform.sdk.users.storage."+e+".image")||"";t?(a.html(""),a.attr("image",t),bgImages(s.c.find(".icon"))):(a.html('<svg width="30" height="30" data-jdenticon-value="'+e+'"></svg>'),a.attr("image",""),a.css("background","#F9F6F6"),a.css("background-image",""),a.css("background-size",""),a.css("background-position",""),a.css("background-repeat",""),s.c.find("[data-jdenticon-value]").each(function(){var e=$(this),a=e.data("jdenticon-value");e.html(jdenticon.toSvg(a,e.width()))})),o.address&&o.address(e)},change:function(){d.error(!0),d.autoFilled()},post:function(){var e=d.error();p.uploadInProgress?dialog({html:"Video is still uploading. Do you want to cancel it?",btn1text:"Wait",btn2text:"Cancel uploading",class:"videoCaution",success:()=>{},fail:()=>{p.cancelCloseFunction&&p.cancelCloseFunction()}}):e||d.post()},embeding:function(){var e=$(this).attr("embeding");"language"!=e?"poll"!=e?"embeding20"==e?d.embeding20():d.embeding(e):dialog({header:"Create new poll",class:"one joinbeta",poll:!0,btn1text:"Create",success:function(){var e=(a=$(".dialog .poll")).find(".title .input").val(),a=a.find(".poll-item .input").map(function(e,a){return $(a).val()}).filter(function(e,a){return a}),a=Array.from(a);r.poll.set({title:e,list:a}),g.poll()}}):d.language()},caption:function(){var e=$(this).val();d.caption(e)},eTextChange:function(e,a){d.eTextChange(this)},textChange:function(){var e=$(this).val();d.tagsFromText(e),d.applyText(e),d.linksFromText(e),g.caption()},eText:function(e,a){var t=String.fromCharCode(a.keyCode||a.which),a=this.getText();i.test(t)&&(d.tagsFromText(a),d.linksFromText(a)),d.applyText(a),g.caption(),o.share||f.save()},text:function(e){var a=String.fromCharCode(e.keyCode||e.which),e=$(this).val();i.test(a)&&(d.tagsFromText(e),d.linksFromText(e)),d.applyText(e),g.caption()},removelink:function(){d.removelink(),g.all()},removePoll:function(){d.removePoll(),g.poll()}},g={postline:function(a){v.app.platform.sdk.ustate.me(function(e){v.shell({name:"postline",el:s.postline,data:{share:r,essenseData:o,lkey:v.app.localization.key,u:e}},function(e){s.panel=s.c.find(".panel .item"),s.postWrapper=s.c.find(".postWrapper"),s.changePostTime=s.c.find(".postTime"),s.selectTime=s.c.find(".selectedTimeWrapper"),s.post=s.c.find(".post"),s.times=s.c.find(".panel .times"),s.changePostTime.on("change",u.changePostTime),s.selectTime.on("click",u.selectTime),s.panel.on("click",u.embeding),s.post.on("click",u.post),s.peertube=s.c.find(".peertube"),s.peertubeLiveStream=s.c.find(".peertubeLiveStream"),e.el.find(".cancelediting").on("click",function(){v.closeContainer(),p.cancelCloseFunction&&p.cancelCloseFunction(),o.close&&o.close()}),d.toggleTimesDisplay(),a&&a()})})},tgs:function(t){r.repost.value?t&&t():v.nav.api.load({open:!0,id:"taginput",el:s.tgsWrapperMain,eid:"sharetags",animation:!1,essenseData:{tags:function(){return r.tags.get()},removeTag:function(e){d.removeTag(e),g.tgs()},removeTags:function(e){d.removeTags(e),g.tgs()},addTag:function(e){d.addTag(e),g.tgs()},addTags:function(e){d.addTags(e),g.tgs()},language:function(){return r.language.get()}},clbk:function(e,a){s.c&&(n=a,t&&t())}})},all:function(){g.body(function(){s.eMessage[0].emojioneArea.setText(r.message.v),s.cpt.find("input").val(r.caption.v||""),s.cpt.val(),g.tgs(),g.url(),g.caption(),g.images(),g.poll(),g.repost(),g.postline()})},caption:function(){r.caption.v||r.itisvideo()?s.cpt.hasClass("active")||s.cpt.addClass("active"):s.cpt.removeClass("active")},streamPage(a={}){var e,t={addVideo:"uploadpeertube",addStream:"streampeertube"}[a.type];c&&c.id==t?c.container.show():(c&&c.container.close(),globalpreloader(!0),e=r.url?v.app.peertubeHandler.parselink(r.url.v).host:null,v.app.peertubeHandler.api.user.auth(e||v.app.peertubeHandler.active(),!0).then(e=>{globalpreloader(!1),v.nav.api.load({open:!0,id:t,inWnd:!0,history:!1,essenseData:{storage:a.storage,value:a.value,currentLink:r.url?r.url.v:"",actions:{added:function(e,a){e=r.url.set(e),r.settings.a=["i","u","cm","p"],r.caption.set(a),r.images.set(),r.repost.set(),o.share||f.save(),!e&&m.url&&sitemessage(m.url),h()}},closeClbk:function(){v.app.peertubeHandler.checklink(r.url.v)||s.peertube&&s.peertubeLiveStream,c=null,"streampeertube"!=t&&h()}},clbk:function(e,a){p=(c=a).essenseData,console.log("external",a)}})}).catch(e=>(console.log("E",e),globalpreloader(!1),sitemessage(e.text||"Undefined Error"))))},url:function(e){var a=r.url.v,i=v.app.platform.parseUrl(a),o=v.app.platform.sdk.remote.storage[a],t=()=>v.shell({name:"url",inner:html,el:s.urlWrapper,data:{url:r.url.v,og:o,remove:!0,share:r}},function(t){var n;r.url.v&&!o?"youtube"==i.type||"vimeo"==i.type||"bitchute"==i.type||"peertube"==i.type?(Plyr.setup("#"+v.map.id+" .js-player",function(e){e.muted=!1},{denyPeertubeAutoPlay:!0}),t.el.find(".removepeertube").on("click",function(){dialog({html:v.app.localization.e("removeVideoDialog"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),class:"zindex",success:function(){u.removelink()},fail:function(){}})}),t.el.find(".streaminfo").on("click",()=>{var e=r.export(!0);g.streamPage({storage:e,type:"addStream"})}),initUpload({el:s.urlWrapper.find(".uploadpeertubewp"),ext:["png","jpeg","jpg","webp","jfif"],dropZone:s.urlWrapper,multiple:!1,action:function(e,a){d.uploadVideoWallpaper(e.file).then(e=>{v.app.platform.sdk.videos.clearstorage(r.url.v),g.url()})},onError:function(e,a,t){sitemessage(t)}})):v.app.platform.sdk.remote.get(i.url,function(e){e&&g.url()}):o&&(n=t.el.find("img"),t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,a){e.isLoaded?($(n[a]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(n[a]).closest(".image").css("display","none")})}),t.el.find(".removeImage").on("click",function(){l=!0,r.settings.image="r",g.url(),f.save(),setTimeout(function(){l=!1},200)})),t.el.find(".removelink").on("click",u.removelink),e&&e()});"peertube"==i.type?v.app.platform.sdk.videos.info([a]).then(()=>t()).catch(()=>t()):t()},images:function(t){v.shell({name:"images",turi:"embeding",inner:html,el:s.images,data:{images:_.map(r.images.v||[],function(e,a){return{src:e,id:a}})}},function(e){e.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");d.removeImage(e)}),e.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");d.editImage(e)}),e.el.find(".image").on("click",function(){var e,a=$(this).attr("i");a&&(e=_.map(r.images,function(e){return{src:e}}),v.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:a,idName:"src",images:e}}))}),e.el.find(".image").imagesLoaded({background:!0},function(e){var a;isMobile()?(t&&t(),s.images.addClass("active")):((a=s.images.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:20},initLayout:!1}),a.on("arrangeComplete",function(){t&&t(),s.images.addClass("active")}),a.isotope())})})},repost:function(a){var t=r.repost.v;v.app.platform.sdk.node.shares.getbyid([t],function(){var e=v.app.platform.sdk.node.shares.storage.trx[t];v.shell({name:"repost",inner:html,el:s.repostWrapper,data:{repost:e,share:r,level:0}},function(e){t&&(v.app.platform.papi.post(t,e.el.find(".repostShare"),function(){},{repost:!0,eid:"share"}),e.el.find(".repostCaption").on("click",function(){r.repost.set(),f.save(),v.app.nav.api.history.removeParameters(["repost"]),g.repost(function(){g.tgs(),g.postline()})})),a&&a()})})},poll:function(e){var a,t=r.poll.get(),n=s.c.find(".pollWrapper"),i="",o=t.title;o&&(i+=`<div class="title"><b>${o}</b></div>`),t.list&&t.list.length&&(a='<div class="list">',t.list.forEach(function(e){a+=`<div class="list-item">${e}</div>`}),i+=a+="</div>"),n.html(i=i?'<div class="poll">'+i+'<div class="removeWrapper"><div class="removelink"><i class="fas fa-times"></i></div></div></div>':""),s.c.find(".pollWrapper").on("click",function(){u.removePoll()})},body:function(t){v.shell({name:"body",el:s.body,data:{share:r}},function(e){var a,n;s.c&&(s.message=s.c.find(".message"),s.eMessage=s.c.find("#emjcontainer"),s.urlWrapper=s.c.find(".urlWrapper"),s.caption=s.c.find(".captionshare"),s.cpt=s.c.find(".cpt"),s.images=s.c.find(".imagesWrapper"),s.poll=s.c.find(".pollWrapper"),s.updateWallpaperInput=s.c.find(".wallpaperShareInput"),s.wallpaperStatusIcon=s.c.find(".wallpaperStatusIcon"),s.eMessage.emojioneArea({pickerPosition:"bottom",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{change:u.eTextChange,click:u.eTextChange,keyup:u.eText,onLoad:function(e,a){parameters().newshare&&s.c.find(".emojionearea-editor").focus(),s.c.find(".emojionearea-editor").pastableContenteditable(),s.c.find(".emojionearea-editor").on("pasteImage",function(e,a){topPreloader(100),resize(a.dataURL,1920,1080,function(e){e.split(",")[1]?r.images.set(e)?g.images&&g.images():sitemessage(m.images):sitemessage("Image upload error")})}).on("pasteImageStart",function(){topPreloader(30)}).on("pasteImageError",function(e,a){topPreloader(100)}).on("pasteText",function(e,a){d.eTextChange(s.eMessage[0].emojioneArea)}),(isMobile()||isTablet())&&s.c.find(".emojionearea-button").hide()}}}),s.caption.on("keyup",u.caption),a={animation:150,swapThreshold:.5,draggable:".draggablepart",onUpdate:function(e){var a=[],t=$(n).find(".draggablepart");$.each(t,function(){a.push($(this).attr("part"))}),r.settings.a=a,o.changeArrange&&o.changeArrange(),o.share||f.save()},forceFallback:!0,handle:".marker"},(n=document.getElementById("sortableBody"))&&!isMobile()&&Sortable.create(n,a),d.autoFilled(),t&&t())})}},f={save:function(){var e;r?r.aliasid||((e=r.export(!0)).message==t&&(e.message=""),v.app.settings.set(v.map.id,"currentShare_v1",e)):v.app.settings.set(v.map.id,"currentShare_v1","")},load:function(){var e=v.app.settings.get(v.map.id,"currentShare_v1");return e&&r.import(e),e}},h=function(){g.all()};return{primary:a,post:d.post,make:function(){f.load(),h()},auto:function(){parameters().marticles&&!v.app.nav.wnds.articles&&d.embeding("article",null)},getdata:function(a,e){c=null,r=deep(e,"settings.essenseData.share")||new Share(v.app.localization.key),o=deep(e,"settings.essenseData")||{},v.app.platform.sdk.user.get(function(e){o.share||(f.load(),0===e.postcnt&&!r.message.v&&o.hello&&(r.message.v=t),r.language.set(v.app.localization.key)),(o.repost||parameters().repost)&&r.repost.set(o.repost||parameters().repost),e={essenseData:o,share:r,postcnt:e.postcnt},a(e)})},destroy:function(){c&&c.module.closeContainer(),n&&(n.destroy(),n=null),c=null,$("html").off("click",u.unfocus),delete v.app.platform.ws.messages.transaction.clbks.share,s.c&&s.c.find(".emojionearea-editor").off("pasteImage"),s={},Sortable&&Sortable.destroy&&Sortable.destroy()},init:function(e){(s={}).c=e.el.find("#"+v.map.id),s.tgsWrapperMain=s.c.find(".tgsWrapperMain"),s.error=s.c.find(".error"),s.changeAddress=s.c.find(".changeAddress"),s.repostWrapper=s.c.find(".repostWrapper"),s.postline=s.c.find(".postlineWrapper"),s.body=s.c.find(".bodywrapper"),s.changeAddress.on("change",u.changeAddress),isMobile()||s.c.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),r.on.change.edit=u.change,v.app.platform.ws.messages.transaction.clbks.share=d.waitActions,s.c.on("click",function(){s.c&&s.c.addClass("focus").removeClass("unfocus")}),$("html").on("click",u.unfocus),d.toggleTimesDisplay(),h(),e.clbk(null,e),d.waitActions()},wnd:{close:function(){p.cancelCloseFunction&&p.cancelCloseFunction(),o.close&&o.close()},class:"smallWnd withoutButtons wndsharepost"},id:e._id}}var v=new nModule,n={};return v.run=function(e){var a=v.addEssense(n,t,e);v.init(a,e)},v.stop=function(){_.each(n,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=share:(app.modules.share={},app.modules.share.module=share);
 /*_____*/ 
var embeding=function(){function i(e){function i(){var e=$(this).attr("action")||l;r.add[e]()}function n(){var e=$(this).closest(".imageContainer").attr("value");r.removeImage(e)}var s,o,t,e=deep(e,"history"),l=null,c={url:new Parameter({type:"URL",id:"url",placeholder:g.app.localization.e("e13102"),onType:!0}),images:{isValid:function(){return!0},value:[]}},u={url:g.app.localization.e("e13103"),imagesLength:g.app.localization.e("e13104")},r={check:function(e){if(c[e].isValid(c[e].value))return s.error.html(""),!0;s.error.html(u[e])},removeImage:function(e){removeEqual(c.images.value,{id:e}),d.images(),s.error.html("")},add:{url:function(){r.check("url")&&(o.added(c.url.value),g.closeContainer())},images:function(){var a;r.check("images")&&(a=[],_.each(c.images.value,function(e){e.base64&&a.push(e.base64)}),o.added(a),g.closeContainer())}},slowUploadGif:function(e,a){e.id=makeid(),e.slow=!0,e.base64=e.base64,c.images.value.push(e),a&&a()},slowUpload:function(a,i){resize(a.base64,1080,1080,function(e){e.split(",")[1]&&(a.id=makeid(),a.slow=!0,a.base64=e,c.images.value.push(a)),i&&i()})},upload:function(a,i){resize(a.base64,1080,1080,function(e){(e=e.split(","))[1]&&(5<c.images.value.length?s.error.html(u.imagesLength):(s.error.html(""),a.id=makeid(),a.loading=!0,c.images.value.push(a),d.images(),g.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:e[1]},success:function(e){a.loading=!1,a.src=deep(e,"data.link")||"https://"+g.app.options.url+"/img/imagenotuploaded.jpg",d.images(),i&&i()},fail:function(){a.src="https://"+g.app.options.url+"/img/imagenotuploaded.jpg",d.images(),i&&i()}})))})}},d={images:function(e,a){(e=e||c.images.value).length&&g.shell({name:"images",el:s.images,data:{images:e}},function(e){e.el.find(".remove").on("click",n),e.el.find(".image").each(function(){$(this)}),a&&a()})}};return{primary:e,getdata:function(e,i){l=i.settings.essenseData.type,o=i.settings.essenseData.on,t=i.settings.essenseData,i.settings.essenseData.subtype,i.settings.essenseData.storage&&_.each(c,function(e,a){e.value=i.settings.essenseData.storage[a],"images"==a&&(e.value=[])}),e({type:l,options:c})},destroy:function(){s={}},init:function(e){var a;(s={}).c=e.el.find("#"+g.map.id),s.error=s.c.find(".error"),s.action=s.c.find(".action"),s.upload=s.c.find(".upload"),s.images=s.c.find(".imagesMi"),s.c.find("input").focus().on("change",i),s.action.on("click",i),"images"==l?(d.images(),t.value&&(a={base64:t.value},r.slowUpload(a)),initUpload({el:s.upload,ext:["png","jpeg","jpg","gif"],dropZone:s.c.closest(".wnd"),multiple:!0,action:function(e,a){"gif"==e.ext?r.slowUploadGif(e,a):r.slowUpload(e,a)},onSuccess:function(){r.add.images()}})):ParametersLive([c[l]],s.c),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-check"></i> '+g.app.localization.e("finish"),fn:function(e,a){r.add[l]()}}},close:function(){t.on.close&&t.on.close()},success:function(e,a){wndObj=a,wnd=e},offScroll:!0,noInnerScroll:!0,class:"embeding",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var g=new nModule,n={};return g.run=function(e){var a=g.addEssense(n,i,e);g.init(a,e)},g.stop=function(){_.each(n,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=embeding:(app.modules.embeding={},app.modules.embeding.module=embeding);
 /*_____*/ 
"undefined"==typeof _OpenApi&&(_OpenApi=!1);var comments=function(){function t(e){function s(o,t,i){var e=t.el.find(".leaveComment"),a=t.el.find(".postbody");z.process(o.id||"0"),e.emojioneArea({pickerPosition:"top",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{"emojibtn.click":W.emessage,change:W.emessage,click:W.emessage,keydown:function(e,n){if(n.ctrlKey&&13==n.keyCode)return a.hasClass("sending")?void 0:(a.addClass("sending"),z.post(o.id||"0",o.pid,o.aid,o.editid),n.preventDefault(),!1);z.scrollToComment(t.el)},keyup:function(e,n){var t=String.fromCharCode(n.keyCode||n.which),i=this.getText();x.test(t)&&z.links(i),n.ctrlKey&&13==n.keyCode||(z.message(o.id||"0",i),T.limits(a,i))},focus:function(){z.scrollToComment(t.el)},onLoad:function(e,n){(m.init||o.init)&&(t.el.find(".emojionearea-editor").focus(),t.el.addClass("active"),m.init=!1),o.value&&this.setText(o.value),o.images&&o.editid&&o.images.length&&(h[o.editid].images.v=_.clone(o.images),T.images(o.editid,o)),(isMobile()||isTablet())&&t.el.find(".emojionearea-button").hide(),i&&i(this,t.el.find(".emojionearea-editor"))}}}),t.el.find(".emojionearea-editor").on("focus",function(){z.process(o.id||"0"),t.el.addClass("active")}),t.el.find(".emojionearea-editor").on("blur",function(){setTimeout(function(){t.el.removeClass("active")},150)}),t.el.find(".postaction").on("click",function(){a.hasClass("sending")||(a.addClass("sending"),z.post(o.id||"0",o.pid,o.aid,o.editid))}),o.id&&t.el.find(".closeEdit").on("click",function(){z.closeEdit(o.id)}),t.el.find(".closeAnswer").on("click",function(){z.removeForm(o.id||"0")})}function a(e,n,t,i,o){var a,s;console.log("CLBK"),n&&n.txid==r&&(s=(a=c.c.find("#"+n.id)).find(">div.commentPaddingWrapper>div.commentWrapper>div.commentBody>div.cbodyWrapper"),i==A.app.platform.sdk.address.pnet().address&&(t?(a.addClass("rated"),0<t&&s.find(".scoreUp").addClass("ratedScore"),t<0&&s.find(".scoreDown").addClass("ratedScore")):40!=e&&(a.removeClass("rated"),s.find(".scoreUp").removeClass("ratedScore"),s.find(".scoreDown").removeClass("ratedScore"))),t={scoreUp:(n.scoreUp||0)+(o&&0<t?1:0),scoreDown:(n.scoreDown||0)+(o&&t<0?1:0)},s.find(".scoreUp .commentScore").html(n.scoreUp?compressedNumber(t.scoreUp,1):""),s.find(".scoreDown .commentScore").html(t.scoreDown?compressedNumber(t.scoreDown,1):""))}function l(e,n,t,i,o,a,s,l){t==r&&(c.c.find(".sending").removeClass("sending"),e||(j.save(),c.c.find(".emojionearea-editor").blur(),c.c.find(".att").html(""),t={comments:[n]},w&&(m.lastComment=A.app.platform.sdk.comments.toLastComment(n)),delete h[s],"0"==s&&(t.class="firstcomment"),"0"==s?(y[s]&&y[s].setText(""),c.c.find(".post .newcommentimages").html("")):(e=c.c.find("#"+s),a?(e.find(".edit").html(""),n.timeUpd=n.timeUpd.addMinutes(1),n.parentid||(t.class="firstcomment"),delete y[s],delete C[s],e.removeClass("editing"),t.inner=replaceWith,t.el=e):(e.find(".answer").html(""),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),t.el=c.c.find("#"+s+" .answers"),delete y[s])),t.newcomments="newcomments",T.list(t,function(){l&&z.tocomment(n.id)}),!a&&m.send&&m.send(n,A.app.platform.sdk.comments.toLastComment(n)),a||(m.comments&&m.comments++,z.showhideLabel())))}var c,r,m,d,p,f,u,g,e=deep(e,"history"),h={},v=!1,w=!1,i=!1,o=!1,k={content:A.app.localization.e("e13029"),messagelength:A.app.localization.e("e13030"),images:A.app.localization.e("maximages")},C={},y={},t=null,b={},x=/[,.!?;:() \n\r]/g,z={myscores:function(){_.each(C,function(e,n){(n=deep(A.app.platform.sdk,"comments.storage.all."+n))&&a(null,n,Number(n.myScore),A.app.platform.sdk.address.pnet().address)})},stateAction:function(n){if(_OpenApi){var e="https://"+A.app.options.url+"/post?openapi=true&s="+r;return A.app.ref&&(e+="&ref="+A.app.ref),void window.open(e,"_blank")}A.app.user.isState(function(e){e?n():A.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:A.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!o},function(){n&&n()})}}})})},sharesocial:function(e){var n=m.hr+"&commentid="+e.id;e.parentid&&"0"!=e.parentid&&(n=n+"&parentid="+e.parentid),A.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:n,caption:"Share comment",sharing:e.social(A.app),embedding:{type:"comment",commentid:e.id,parentid:e.parentid,id:r}}})},editImage:function(t,e,i){var o=h[t],a=_.map(o.images.v,function(e,n){return{original:e,index:n}});focusfixed=!0,A.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:a,close:function(){},success:function(e,n){_.each(o.images.v,function(e,n){var t=_.find(a,function(e){if(e.index==n)return!0});t&&(o.images.v[n]=t.original)}),T.images(t,i,n)}}})},removeImage:function(e,t,n){h[e].images.v.splice(t,1)[0],n.el.find(".imageContainer").each(function(){var e=$(this),n=e.attr("value");t<n&&e.attr("value",n-1),n==t&&e.remove()}),n.el.find(".imagesEmbWr").isotope()},embedimages:function(i,n){i=i||"0",z.process(i),y[i]&&(y[i].___inited=!0);var e=h[i].export(!0);A.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:"images",storage:e,on:{added:function(e){var t=!0;_.isArray(e)||(e=[e]),_.each(e,function(e,n){t=h[i].images.set(e)}),!t&&k[type]&&sitemessage(k[type]),T.images(i,n)}}},clbk:function(e,n){t=n}})},removeForm:function(e){console.log("ID",e),delete y[e],c.c.find("#"+e+" .answer").html(""),c.c.find("#"+e+" .edit").html("")},post:function(e,n,t,i){var o,a=h[e=e||"0"];a?(o=a.validation())?(c.c.find(".sending").removeClass("sending"),sitemessage(k[o])):a.loading||(a.loading=!0,a.uploadImages(A.app,function(){z.send(a,function(e,n){a.loading=!1,e||successCheck()},n,t,i,e)})):(c.c.find(".sending").removeClass("sending"),sitemessage(k.content))},send:function(e,t,n,i,o,a){A.app.platform.sdk.comments.send(r,e,n,i,function(e,n){c.c&&c.c.find(".sending").removeClass("sending"),e?(A.app.platform.errorHandler(e,!0),t&&t(e,null)):t&&t(null,n)},o,a)},links:function(e,n){var t=h[e=e||"0"];t&&(t.url.v||(e=null,(e=(n=n.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi))&&0<n.length?n[0]:e)&&t.url.set(e)))},process:function(e){h[e=e||"0"]||(h[e]=new Comment(r))},message:function(e,n){h[e=e||"0"]&&h[e].message.set(n),j.save()},emessage:function(e,n){n=n.getText(),z.links(e,n),z.message(e,n),y[e]&&(y[e].___inited=!0)},fastreply:function(n){n&&z.replies(n.parentid||n.answerid,!0,function(){var e;n.noaction?(z.tocomment(n.answerid),(e=c.c.find("#"+n.answerid)).addClass("newcommentsn"),setTimeout(function(){e.removeClass("newcommentsn")},2500)):z.reply(n.parentid||n.answerid,n.answerid)})},reply:function(a,s){z.stateAction(function(){var e=c.c.find("#"+a).find(".answer");T.post(function(e,n){var t="0",i=A.app.platform.sdk.comments.address(r,s,t=s!=a?a:t)||deep(m,"lastComment.address"),o=deep(A.app,"platform.sdk.usersl.storage."+i+".name")||i,t="@"+o+",  ";i!=A.app.platform.sdk.address.pnet().address&&o||(t=""),e.setText(t),y[a]=e,n.focus(),n.closest(".answer").addClass("active"),t.length&&ecaretPosition(n,0,t.length)},{placeholder:"Send Reply",el:e,answer:"answer",pid:a,aid:s,id:a})})},hideallReplies:function(){_.each(deep(A,"app.platform.sdk.comments.storage."+r+".0"),function(e,n){z.replies(n,!1)}),m.lastComment&&z.replies(m.lastComment.id,!1)},replies:function(n,e,t,i){var o,a;i=i||{},"0"!=n?((o={}).in=i.in,o.el=c.c.find("#"+n+" .answers"),a=c.c.find("#"+n),void 0===e&&(a.hasClass("showedreplies")?e=!1:(e=!0,a.find(".repliesloaderWrapper").removeClass("hidden"))),e?S.level(n,function(e){a.find(".repliesloaderWrapper").addClass("hidden"),o.comments=A.app.platform.sdk.comments.storage[r][n],a.addClass("showedreplies"),T.list(o,function(){d||T.caption(),t&&t()},n)}):(delete b.levels[n],A.app.platform.sdk.comments.storage[r]&&_.each(A.app.platform.sdk.comments.storage[r][n],function(e){delete C[e.id]}),a.removeClass("showedreplies"),z.removeForm(n),o.el.html(""))):t&&t()},getid:function(e){return e.attr("answer")?((n=e.closest(".comment")).attr("id"),e.closest(".firstcomment").attr("id")):e.attr("edit")?((n=e.closest(".comment")).attr("aid"),n.attr("pid"),n.attr("id")):"0";var n},tocomment:function(e){_scrollTo(c.c.find("#"+e),p)},closeEdit:function(e){var n=c.c.find("#"+e);n.removeClass("editing"),n.find(".commentBody").removeClass("editing"),z.removeForm(e)},delete:function(e,t){e=e.delete(),A.app.platform.sdk.comments.delete(r,e,function(e,n){e?(A.app.platform.errorHandler(e,!0),t&&t(e,null)):t&&t(null,n)})},update:function(e){var n={},t=null,t=e?c.c.find("#"+e+" .answers"):(n.class="firstcomment",c.c.find(".list"));S.level(e,function(e){t.html(""),n.comments=e,T.list(n)})},hiddenCounts:function(e){0<e?c.showall.find(".ccounts").html("("+e+")"):c.showall.find(".ccounts").html()},showall:function(){i=!0,c.c.addClass("showedall"),z.showhideLabel(),m.showall=!0,w?(c.c.removeClass("listpreview"),c.c.find(".loaderWrapper").removeClass("hidden"),S.level(null,function(e,n){return n?(A.app.platform.errorHandler(n,!0),c.c.addClass("listpreview"),c.c.find(".loaderWrapper").addClass("hidden"),i=!1,c.c.removeClass("showedall"),void z.showhideLabel()):(w=!1,T.caption(),C={},(n={}).comments=A.app.platform.sdk.comments.storage[r][0],n.class="firstcomment",n.inner=html,void T.list(n,function(){c.c.find(".loaderWrapper").addClass("hidden")}))})):T.caption()},showhideLabel:function(){var e,n;c.showall&&(i?c.showall.addClass("hidden"):(e=deep(A.app.platform,"sdk.node.shares.storage.trx."+r+".comments")||0,n=deep(A.app.platform,"sdk.node.shares.storage.trx."+r+".lastComment.children")||0,w?1<e-n?(c.showall.removeClass("hidden"),z.hiddenCounts(e-n-1)):c.showall.addClass("hidden"):5<e?(c.showall.removeClass("hidden"),z.hiddenCounts(e-5)):c.showall.addClass("hidden")))},openGallery:function(e,n,t){var i=_.map(e.images,function(e){return{src:e}}),o=findIndex(i,function(e){if(e.src==n)return!0});console.log("comment",e,n,i),A.app.nav.api.load({open:!0,href:"imagegallery?s="+r+"&num="+(o||0)+"&com="+e.id,inWnd:!0,history:!0,essenseData:{initialValue:n,idName:"src",images:i,gid:r+e.id},clbk:function(){t&&t()}})},upvoteComment:function(n,t){z.stateAction(function(){var e=deep(A.app.platform.sdk,"comments.storage.all."+t);e&&e.address!=A.app.platform.sdk.address.pnet().address&&(e=e.upvote(n),A.app.platform.sdk.comments.upvote(e,function(e,n){e&&A.app.platform.errorHandler(e,!0)}))})},scrollToComment:function(e){var n;e&&0<e.length&&e[0].scrollIntoView&&isMobile()&&$(window).width()<=768&&(e[0].scrollIntoView(!0),n=$("html").hasClass("showmain")?$(".lentacell"):$("html"),0<(e=120-e[0].getBoundingClientRect().top)&&n.animate({scrollTop:"-="+e+"px"},0))}},W={upvoteComment:function(){var e,n,t;$(this).closest(".comment").hasClass("rated")||(e="scoreUp"==$(this).attr("score")?1:-1,n=$(this).closest(".comment").attr("id"),t=$(this).closest(".comment").attr("pid"),z.upvoteComment(e,n,t))},openGallery:function(){var e=$(this),n=(t=e.closest(".comment")).attr("id"),t=t.attr("pid"),t=A.app.platform.sdk.comments.find(r,n,t);w&&m.lastComment&&(t=A.app.platform.sdk.comments.ini([m.lastComment])[0],console.log("ed.lastComment",m.lastComment)),z.openGallery(t,e.attr("i"))},replyandreplies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e,!0,function(){z.scrollToComment(c.list.find(".answer.active"))});var n=$(this).closest(".comment"),e=$(this).closest(".firstcomment").attr("id"),n=n.attr("id");z.reply(e,n)},replies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e)},emessage:function(e,n){var t=this.getText(),i=z.getid(e.closest(".postbody"));z.emessage(i,this),T.limits(e.closest(".postbody"),t)},message:function(){var e=$(this).val(),n=z.getid(editor.closest(".postbody"));z.links(n,e),z.message(n,e)},reply:function(){var e=$(this).closest(".comment"),n=$(this).closest(".firstcomment").attr("id"),e=e.attr("id");z.reply(n,e)},tocomment:function(){var e=$(this).attr("comment");z.tocomment(e)},metmenu:function(){var t=$(this),i=t.closest(".comment"),o=t.closest(".commentBody"),e=i.attr("id"),n=i.attr("pid"),a=A.app.platform.sdk.comments.find(r,e,n),s={address:A.app.user.address.value,caddress:A.app.platform.sdk.comments.address(r,e,n),txid:e};w&&m.lastComment&&!n&&(a=A.app.platform.sdk.comments.ini([m.lastComment])[0],s.caddress=a.address),A.fastTemplate("metmenu",function(e,n){A.app.platform.api.tooltip(t,function(){return n(s)},function(e){e.find(".edit").on("click",function(){T.edit(o,a),t.tooltipster("hide")}),e.find(".block").on("click",function(){A.app.platform.api.actions.blocking(s.caddress,function(e,n){console.log(e,n),e?i.remove():A.app.platform.errorHandler(n,!0),t.tooltipster("hide")})}),e.find(".remove").on("click",function(){dialog({html:A.app.localization.e("e13032"),success:function(){z.delete(a,function(e){e||((e=c.c.find("#"+a.id)).addClass("deleted"),c.c.find("#"+a.id+" >div.commentPaddingWrapper .commentmessage div").html("<div>"+A.app.localization.e("e13033")+"</div>"),e.find(".panel").remove(),e.find(".commentimages").remove(),e.find(".reply").remove())})},btn1text:A.app.localization.e("e13034"),btn2text:A.app.localization.e("e13035")}),t.tooltipster("hide")}),e.find(".socialshare").on("click",function(){z.sharesocial(a),t.tooltipster("hide")})},{theme:"zindex lighttooltip"})},s)}},T={images:function(n,i,o){var a=h[n];A.shell({name:"images",turi:"embeding",inner:html,el:i.el.find(".newcommentimages"),data:{images:_.map(a.images.v||[],function(e,n){return{src:e,id:n}})}},function(t){t.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.removeImage(n,e,i)}),t.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.editImage(n,e,i)}),t.el.find(".image").on("click",function(){var e,n=$(this).attr("i");n&&(e=_.map(a.images,function(e){return{src:e}}),A.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:n,idName:"src",images:e}}))}),t.el.find(".image").imagesLoaded({background:!0},function(e){var n;isMobile()?(o&&o(),i.el.find(".newcommentimages").addClass("active")):((n=t.el.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:10},initLayout:!1}),n.on("arrangeComplete",function(){o&&o(),i.el.find(".newcommentimages").addClass("active")}),n.isotope())})})},limits:function(e,n){n=1e3-n.length,e.find(".limits").removeClass("bad"),n<500?0<n?e.find(".limits").addClass("active").html(n+" "+pluralform(n,["Character","Characters"])+" Available"):e.find(".limits").addClass("active").addClass("bad").html("You are "+-n+" characters over"):e.find(".limits").removeClass("active")},cpreview:function(e){e=e||m.caption,c.caption&&(c.caption.find(".captionPreview").html(e),bgImages(c.caption.find(".captionPreview")))},caption:function(n){m.caption&&A.shell({name:"caption",el:c.caption,data:{ed:m}},function(e){T.cpreview(),d=new Caption({container:c.c,caption:c.c.find(".captionfwrapper"),offset:[f,-100],removeSpacer:!0,iniHeight:!0,_in:p}).init(),e.el.find(".close .cact").on("click",function(){m.close&&m.close()}),e.el.find(".top .cact").on("click",function(){_scrollToTop(c.c.find(".list"),p,void 0,-150)}),e.el.find(".bottom .cact").on("click",function(){_scrollToBottom(c.c.find(".list"),p,void 0,-150)}),n&&n()})},edit:function(e,n){e.addClass("editing"),n={value:n.message,images:n.images,init:!0,edit:"edit",el:e.find(">div.edit"),pid:n.parentid,aid:n.answerid,id:n.id,editid:n.id},T.post(function(e,n){},n)},post:function(o,a){m.openapi?o&&o():A.app.user.isState(function(i){(a=a||{}).el||(a.el=c.post);var e=v&&!a.answer&&!a.editid;A.shell({name:"post",el:a.el,data:{placeholder:a.placeholder||"",answer:a.answer||"",edit:a.edit||"",preview:e,mestate:g}},function(n){function t(t){v&&(v=!1,a.init=!0,c.c.removeClass("preview"),s(a,n,function(e,n){o(e,n),t&&t(e,n)}))}return n.el.find(".embedimages").off("click").on("click",function(){var e=z.getid(n.el.find(".postbody"));i?(z.embedimages(e,a),a.answer||a.editid||t()):z.stateAction(function(){})}),e?(n.el.find("textarea").on("click",function(){$(this).blur(),A.app.user.isState(function(e){e?t():z.stateAction(function(){})})}),void n.el.find(".embedEmojiPrivew").on("click",function(){i?t(function(e,n){e.showPicker()}):z.stateAction(function(){})})):void s(a,n,o)})})},commentimages:function(e,n){var t,s,l;c.c&&(e=c.c.find("#"+e.id),t=e.find(".commentimages .image"),!(s=e.find(".commentimages")).hasClass("active")&&t.length&&s.length?(e.height(),t.imagesLoaded({background:!0},function(a){_.each(a.images,function(e,n){var t=e.img,i=$(a.elements[n]).closest(".imagesWrapper"),o="",e=i.width();i.height(),t.width>t.height&&!isMobile()&&(o="w2",(n=e*(t.width/t.height))>s.width()&&(n=s.width(),l=n*(t.height/t.width),i.height(l)),i.width(n)),(t.height>t.width||isMobile())&&(o="h2",i.height(e*(t.height/t.width))),o&&i.addClass(o)}),s.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:10},initLayout:!1}),s.on("arrangeComplete",function(){s.addClass("active"),t.addClass("active"),m.renderClbk&&m.renderClbk(),n&&n()}),s.isotope()})):n&&n())},list:function(n,t,e){(n=n||{}).comments=_.filter(n.comments||[],function(e){if(!C[e.id])return C[e.id]=!0}),m.commentPs&&(n.comments=_.filter(n.comments||[],function(e){if(e.id==m.commentPs.commentid||e.id==m.commentPs.parentid)return!0}));var i=append;m.fromtop&&!n.el?(n.comments=_.sortBy(n.comments,function(e){return-e.time}),i=prepend):n.comments=_.sortBy(n.comments,function(e){return e.time}),e&&(b.levels[e]=e),n.in&&(i=n.in),n.el||(n.el=c.list),A.shell({name:"list",el:n.el||c.list,inner:n.inner||i,data:{comments:n.comments||[],_class:n.class||"",newcomments:n.newcomments||"",replaceName:function(e,n){return'<span class="tocomment" comment="'+n.comment+'">'+e+"</span>"},replaceNameNoComment:function(e,n){return'<span class="tocommentno">'+e+"</span>"},mestate:g},additionalActions:function(){m&&m.additionalActions&&m.additionalActions()}},function(e){c.list&&(c.list.find(".reply").off("click").on("click",W.replyandreplies),c.list.find(".replies").off("click").on("click",W.replies),c.list.find(".panel").off("click").on("click",W.metmenu),c.list.find(".tocomment").off("click").on("click",W.tocomment),c.list.find(".imageCommentOpen").off("click").on("click",W.openGallery),setTimeout(function(){c.list&&c.list.find(".newcomments").removeClass("newcomments")},600),bgImages(c.list),lazyEach({array:n.comments,action:function(e){T.commentimages(e.item,e.success)}})),m.renderClbk&&m.renderClbk(),t&&t()})}},S={preview:function(e){var n=[];m.lastComment&&(n=A.app.platform.sdk.comments.ini([m.lastComment])),A.sdk.comments.users(n,function(){e&&e(n)})},level:function(e,t){A.app.platform.sdk.comments.get(r,e||"",function(e,n){t&&t(e,n)})}},j={save:function(){},load:function(){var e=A.app.settings.get(A.map.id,r);e&&h[0].import(e)}};return{primary:e,getdata:function(n,e){var t;u=e.settings.eid,C={},h={},b={reply:null,levels:{}},m=e.settings.essenseData||{},v=m.preview||!1,w=v,i=!1,r=m.txid||null,h[0]=new Comment(r),r&&((t={}).ed=m,A.app.platform.sdk.ustate.me(function(e){g=e,n(t)}))},authclbk:function(){c&&c.c&&(o=!0,A.app.platform.sdk.ustate.me(function(e){function n(){var e=_.map(b.levels,function(e){return e});e.length?lazyEach({array:e,action:function(n){var e=n.item;S.level(e,function(e){n.success()})},all:{success:function(){t&&t()}}}):t&&t()}var t;g=e,t=function(){z.myscores(),o=!1},v&&!i?n():S.level(null,function(){n()}),T.post(function(e){y[0]=e})}))},destroy:function(){delete A.app.platform.sdk.comments.sendclbks[u],delete A.app.platform.ws.messages.comment.clbks[u],delete A.app.platform.sdk.comments.upvoteClbks[u],delete A.app.platform.ws.messages.cScore.clbks[u],o=!1,t&&t.destroy(),d&&d.destroy(),c={}},init:function(e){var n,t,i,o;(c={}).c=e.el.find("#"+A.map.id),c.post=c.c.find(".post"),c.list=c.c.find(".list"),c.caption=c.c.find(".captionCnt"),c.showall=c.c.find(".showall"),p=c.c.closest(".wndcontent"),f=p.length?0:(p=null,65),v?(c.c.find(".loaderWrapper").addClass("hidden"),c.c.addClass("preview"),c.c.addClass("listpreview"),o={},T.post(function(e){y[0]=e}),S.preview(function(e){o.comments=e,o.class="firstcomment",z.showhideLabel(),c.list.html(""),T.list(o,function(){i&&i()})})):(t={},S.level(null,function(e){t.comments=A.app.platform.sdk.comments.storage[r][0],t.class="firstcomment",z.showhideLabel(),c.list&&c.list.html(""),T.list(t,function(){c.c.find(".loaderWrapper").addClass("hidden"),T.post(function(e){var n;y[0]=e,m.reply?z.fastreply(m.reply):(n={},(e=m.commentPs||parameters()).commentid&&(n.answerid=e.commentid,n.parentid=e.parentid||"",n.noaction=!0,z.fastreply(n)))}),n&&n()})}),m.showall&&z.showall()),c.c.find(".showall").on("click",function(){z.showall()}),A.app.platform.sdk.comments.sendclbks[u]=l,A.app.platform.sdk.comments.upvoteClbks[u]=a,A.app.platform.ws.messages.comment.clbks[u]=function(e){if(e.posttxid==r){var n={};if(n.comments=[e.comment],e.parentid){if(e=c.c.find("#"+e.parentid),n.el=e.find(".answers"),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),!e.hasClass("showedreplies"))return}else n.el=c.c.find(".list"),n.class="firstcomment";T.list(n)}},A.app.platform.ws.messages.cScore.clbks[u]=function(e){e.comment.txid==r&&a(null,e.comment,e.upvoteVal||e.value,e.addrFrom)},c.c.on("click",".upvoteComment",W.upvoteComment),e.clbk(null,e)},freeze:function(){d&&d.destroy()},hideall:function(e){i=!1,(w=void 0!==e?e||!1:w)?(c.c.addClass("listpreview"),d&&d.destroy(),d=null):c.c.removeClass("listpreview"),c.c.removeClass("showedall"),z.hideallReplies(),z.showhideLabel()},changein:function(e,n){e?(p=e,f=n,d&&(d.addscroll=!0,d.setOffset([f,0]),d.setIn(p))):(p=c.c.closest(".wndcontent"),f=p.length?0:(p=null,65),d&&(d.addscroll=!!p,d.setOffset([f,0]),d.setIn(p)))}}}var A=new nModule,i={};return A.run=function(e){var n=A.addEssense(i,t,e);A.init(n,e)},A.authclbk=function(){_.each(i,function(e){e.authclbk()})},A.stop=function(){_.each(i,function(e){e.destroy()})},A}();"undefined"!=typeof module?module.exports=comments:(app.modules.comments={},app.modules.comments.module=comments);
 /*_____*/ 
var oldchat=function(){function n(e){var d,e=deep(e,"history"),t=makeid(),m={},l=null,f=null,n=null,p=null,a=null,h=null,u={},g={},w={preloader:function(e){e?d.c.addClass("loading"):d.c.removeClass("loading")},close:function(){b.removeEssense(s,t),m.closeClbk&&m.closeClbk()},sendClbk:function(e,t,n){var a=d.messages.find("#"+e.EncryptedMessageID);t?(e.EncryptedMessageID=t,e.result="success",e.Message=n.note||"",e.Attachment=n.attachment||"",e.AttachmentName=n.attachmentName||"",e.AttachmentPreview=n.attachmentPreview||"",a.attr("id",e.EncryptedMessageID)):e.result="fail",a.removeClass("sending"),a.addClass(e.result)},mobileBuildHeight:function(){var e,t,n;"buildin"==m.view&&isMobile()&&(e=d.c.find(".chatwindow").height(),t=$(window).height(),n=d.c.find(".chatmessages").height(),e<=t-175&&n<e?d.c.find(".chatwindow").height(t-175):d.c.find(".chatwindow").css("height","auto"))},spacer:function(){var e;w.mobileBuildHeight(),!isTablet()||(e=0)<d.messages.find(".chatmessage").length&&(d.c.find(".spacer").height(0),e=d.c.find(".chatwindow").height()-d.c.find(".chatmessages").height()-10,d.spacer.height((e=e<0?0:e)+"px"))},send:function(e){e&&p.rtc.send(e)},sendAttachment:function(e,n){b.app.platform.sdk.chats.send({attachment:e.attachment,attachmentName:e.attachmentName,attachmentPreview:e.attachmentPreview,temp:n},p.ThreadID,function(e,t){w.sendClbk(n,e,t)})},addTempMessage:function(e){var t=new Date;return b.app.platform.timeDifference&&(t=t.addSeconds(b.app.platform.timeDifference/1e3)),e={Created:dateToStrUtcS(t),ThreadID:p.ThreadID,EncryptedMessageID:makeid(!0),temp:!0,UserID:b.app.user.data.id,decrypted:{Message:e.note,AttachmentName:e.attachmentName,AttachmentPreview:e.attachmentPreview}},p.messages.push(e),o.messages(null,[e],!0),e},clearTempMessages:function(){d.messages.find(".temp").remove()},scrollToPx:function(e,t){if(!w.checkState())return!1;var n,a,s,i;null!==t&&(i=n=null,a="position","buildin"==m.view?(n=$(window),i=$("html"),a="offset"):(n=d.c.find(".chatwindow"),i=d.c.find(".chatmessages")),"toLast"==e||"toLast"==t?(s=d.messages.find(".chatmessage:nth-last-child(1)"))[a]()&&(e=70,isMobile()&&(e=115),t=s[a]().top+s.height()+e-n.height(),n.scrollTop(t,200)):(i=i.height(),n.scrollTop(i-t,200)))},scrollPx:function(e){if(d.c){var t,n=null,a=null,s=null,a="buildin"==m.view?(n=$(window),$("html")):(n=d.c.find(".chatwindow"),d.c.find(".chatmessages"));return"toLast"==e?s="toLast":(t=d.messages.find(".chatmessage:nth-last-child(1)"),e="position","buildin"==m.view&&(e="offset"),inView(t,{inel:n,offset:-20,mode:"partall"}),t&&t[e]()&&(e=a.height(),a=n.scrollTop(),s=e-t.height()-150,s=a+n.height()>s?"toLast":null)),s}},saveAttachment:function(e){topPreloader(30);var t=c.findEl(e);t&&t.addClass("saveAttachment"),b.app.platform.sdk.chats.getAttachment(e,function(e){topPreloader(100),t&&t.removeClass("saveAttachment"),e?e.ChatMessageAttach&&saveAs({download:e.decrypted.AttachmentName,file:e.ChatMessageAttach,noA:!0}):console.log("ERROR")})},openGallery:function(e){e={idName:"EncryptedMessageID",initialValue:e.EncryptedMessageID,getImages:function(){return _.filter(p.messages,function(e){if((e=deep(e,"decrypted.AttachmentName"))&&(-1<e.indexOf(".jpg")||-1<e.indexOf(".png")||-1<e.indexOf(".jpeg")))return!0})},getImage:function(e,t){e.ChatMessageAttach?t&&t({src:e.ChatMessageAttach,name:e.decrypted.AttachmentName}):b.app.platform.sdk.chats.getAttachment(e,function(e){e={src:e.ChatMessageAttach,name:e.decrypted.AttachmentName},t&&t(e)})}},o.gallery(e)},getPreview:function(e){b.app.platform.sdk.chats.getPreview(e,function(e){_.each(e,function(e){var t=c.findEl(e);o.messages(null,[e],!0,t)})})},read:function(){},countUnread:function(){d.countUnread&&d.countUnread.html("")},checkState:function(){if(d.c&&!d.c.hasClass("minimized"))return!0}},v={minimize:function(){d.c.addClass("minimized"),m.minimizeClbk&&m.minimizeClbk(),l.clear(),f.clear(),d.type.blur()},expand:function(){d.c.removeClass("minimized"),m.expandClbk&&m.expandClbk(),isTablet()||d.type.focus(),w.spacer(),setTimeout(function(){w.scrollToPx("toLast","toLast")},100)},out:function(){b.app.modules.chats.module.api.add(p.ThreadID)},close:function(){w.close()},type:function(e,t){var n=this.getText();if(13==t.which||13==t.keyCode)return n&&(this.setText(""),w.send(n),$(this).val("")),!1},resizeWindow:function(){l&&l.setOffset([65,0]),f&&f.setOffset([0,100])},getAttachment:function(){var e=$(this).closest(".chatmessage"),t=e.attr("id");e.hasClass("sending")||(e=c.findMessage(t)).decrypted&&e.decrypted.AttachmentName&&(-1<(t=e.decrypted.AttachmentName.toLowerCase()).indexOf(".jpg")||-1<t.indexOf(".png")||-1<t.indexOf(".jpeg")?w.openGallery(e):w.saveAttachment(e))},messagesInView:function(){n=slowMade(function(){if(!w.checkState())return!1;var e=d.messages.find(".chatmessage"),t=d.messages.find(".chatmessage:nth-last-child(1)");"buildin"==m.view&&(n=$(window)),"fixedin"==m.view&&(n=d.c.find(".chatwindow"));var e=inView(e,{inel:n}),n=inView(t,{inel:n});0<e.length&&_.map(e,function(e){return e=$(e).attr("id"),c.findMessage(e)}),0<n.length&&w.read()},n,100)}},c={findMessage:function(t){return _.find(p.messages,function(e){return e.EncryptedMessageID==t})},findEl:function(e){return d.c.find("#"+(e.tm+e.f))}},o={gallery:function(e){b.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e=e||{}})},safemessages:function(e,t){var s=_.map(g,function(e,t){return{m:e,t:t}}),s=_.sortBy(s,function(e){return Number(e.t)}),i=[];_.each(s,function(t,n){var a={newmessages:[],oldmessage:t};_.each(e,function(e){(Number(e.tm)<Number(t.t)||n==s.length-1)&&(!n||Number(s[n-1].t)>Number(e.tm))&&a.newmessages.push(e)}),a.newmessages.length&&(a.newmessages.push(a.oldmessage.m),a.newmessages=_.sortBy(a.newmessages,function(e){return Number(t.t)}),i.push(a))}),i.length?lazyEach({array:i,action:function(e){var t=e.item,n=c.findEl(t.oldmessage);o.messages(e.success,t.newmessages,null,n)},all:{success:t}}):o.messages(t,e)},messages:function(t,a,n,e){var s,i,c,o,r;d.c&&(a=_.filter(a,function(e,t){var n=e.tm;if(17==e.tm.length&&(e.tm=n+"0"),!(h&&h.tm>e.tm))return!(a.length-50>t)}),s=a?"fixed":"toLast",i=w.scrollPx(s),a=a||[],console.log("BEFORE",a),a=_.filter(a,function(e){var t=e.tm+e.f;return!!e.tm&&(u[t]?void 0:(u[t]=!0,g[e.tm]=e,!0))}),c=_.sortBy(a,function(e){var t=e.tm;return 17==e.tm.length&&(e.tm=t+"0"),Number(e.tm)}),n||w.clearTempMessages(),o=append,r=d.messages,e&&(o=replaceWith,r=e),a.length?(h=c[c.length-1],console.log("messages : sorted\t",c),b.shell({name:"messages",el:r,data:{chat:p,messages:c},inner:o},function(e){m.messagesClbk&&m.messagesClbk(),d.messages.find(".attachment").off("click"),d.messages.find(".attachment").on("click",v.getAttachment),v.messagesInView(),0<d.messages.find(".chatmessage").length?d.c.find(".other").fadeOut(1):d.c.find(".other").fadeIn(1),n&&(i="toLast"),w.spacer(),setTimeout(function(){w.scrollToPx(s,i)},20),l&&l.action(),f&&f.action(),w.countUnread(),t&&t()})):t&&t())}};return{primary:e,getdata:function(t,e){var n,a={},s=deep(e,"settings.essenseData.chat");s||(n=parameters().chatid,s=b.app.platform.sdk.discussions.fromChatId(n)),s||(b.app.platform.sdk.chats.add(n,"share"),s=b.app.platform.sdk.discussions.fromChatId(n)),deep(e,"settings.essenseData"),console.log("_chat",s),s&&(p=s.chat,b.app.platform.sdk.chats.info([s.chat],function(e){a.chat=s,b.app.platform.sdk.tempmessenger.getChat(s.chat),a.canEnc=!0,b.app.platform.sdk.ustate.me(function(e){a.mestate=e,t(a)})}))},destroy:function(){d.type&&d.type.blur(),$("html").off("mousemove",v.messagesInView),window.removeEventListener("scroll",v.messagesInView),window.removeEventListener("resize",v.resizeWindow),b.app.platform.ws,$(window).off("focus",w.read),$(window).off("mousemove",w.read),delete p.rtc.clbks.receive.message.messenger,delete p.rtc.clbks.receive.messages.messenger,delete p.rtc.clbks.send.message.messenger,n&&clearTimeout(n),d={},l&&l.destroy(),f&&f.destroy(),l=f=null,p&&(p.rtc.leave(),p=null),clearInterval(a),$("#tawkchat-container").fadeIn(),m.destroyClbk&&m.destroyClbk()},init:function(e){var t,n;u={},g={},h=null,(m=e.essenseData||{}).view||(m.view="buildin"),(d={}).c=e.el.find("#"+b.map.id),d.messages=d.c.find(".chatmessages"),d.type=d.c.find(".type"),d.attachement=d.c.find(".attachement"),d.countUnread=d.c.find(".countUnread"),d.spacer=d.c.find(".spacer"),d.c.addClass(m.view),"buildin"==m.view&&(isMobile()||(l=new Caption({container:d.c.find(".chatWrapper"),caption:d.c.find(".captionfwrapper"),offset:[65,0]}).init()),t=0,isMobile()&&(t=50),f=new Caption({container:d.c.find(".chatWrapper"),caption:d.c.find(".bcaptionfwrapper"),offset:[t,2*t],pos:"bottom"}).init(),d.c.find(".out").on("click",v.out),window.addEventListener("scroll",v.messagesInView),window.addEventListener("resize",v.resizeWindow),$("html").on("mousemove",v.messagesInView)),"fixedin"==m.view&&(d.c.find(".close").on("click",v.close),d.c.find(".chatwindow").on("scroll",v.messagesInView),$("html").on("mousemove",v.messagesInView)),d.c.find(".minimize").on("click",v.minimize),d.c.find(".expand").on("click",v.expand),d.countUnread.on("click",function(){v.expand()}),d.type.emojioneArea({pickerPosition:"top",search:!1,tones:!1,attributes:{spellcheck:!0,autocomplete:"on"},events:{keyup:v.type,onLoad:function(e,t){}}}),initUpload({el:d.attachement,ext:["png","jpeg","jpg","pdf"],multiple:!0,maxFileSize:5,dropZone:d.c.find(".chatWrapper"),beforeUpload:function(e){var t,a=deep(e,"file.name");"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?resize(e.base64,200,200,function(t){var n=w.addTempMessage({attachmentName:a,attachmentPreview:t});resize(e.base64,1600,1600,function(e){w.sendAttachment({attachment:e,attachmentName:a,attachmentPreview:t},n)})}):(t=w.addTempMessage({attachmentName:a}),w.sendAttachment({attachment:e.base64,attachmentName:a},t))}}),p.rtc.clbks.receive.message.messenger=function(e){!b.app.platform.focus&&b.app.platform.titleManager&&b.app.platform.titleManager.add("You have new messages"),h=e,b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,[e])})},p.rtc.clbks.receive.messages.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,e,!0)})},p.rtc.clbks.send.message.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){h=e,o.messages(null,[e],!0)})},p&&(n=_.toArray(p.rtc.storage._db||{}),b.app.platform.sdk.messenger.load.messages(n,function(){o.messages(null,n,!0)}),p.rtc.connect(function(){})),b.app.platform.ws,$(window).on("focus",w.read),$(window).on("mousemove",w.read),w.countUnread(),e.clbk(null,e)},id:t,api:v}}var b=new nModule,s={};return b.run=function(e){var t=b.addEssense(s,n,e);b.init(t,e)},b.stop=function(){_.each(s,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=oldchat:(app.modules.oldchat={},app.modules.oldchat.module=oldchat);
 /*_____*/ 
"undefined"==typeof _OpenApi&&(_OpenApi=!1);var lenta=function(){function n(e){var c,t,p,u,a,n,s,r,o=deep(e,"history"),e=e.mid,i=!1,l=!1,d=[],f={},m=!1,v=!1,b=!1,g=0,k={},x={},w=!1,y=!1,C={},V=[],S=!1,T=0,I=0,P=null,M=0,A={},E={},z=0,W=null,L=!1,F=0,H=null,N=!1,O=!1,D={newmaterials:function(e){if(!(i||p.author||p.txids)){if(e=e||{},"sub"!=u)return e.sharesLang?B(deep(e,"sharesLang."+Z.app.localization.key)):B(v?deep(e,"contentsLang.video."+Z.app.localization.key):(deep(e,"contentsLang.video."+Z.app.localization.key)||0)+(deep(e,"contentsLang.share."+Z.app.localization.key)||0));B(e.sharesSubscr)}},scrollmode:function(e){e?$("html").addClass("scrollmodedown"):$("html").removeClass("scrollmodedown")},authclbk:function(){O=!0;var e=_.map(k,function(e,t){return t});Z.app.platform.sdk.node.shares.getbyid(e,function(e){_.each(e,function(e){delete e.myVal}),U.mystars(e,function(){O=!1}),D.subscribeLabels()})},subscribeLabels:function(){_.each(k,function(e,t){(t=Z.app.platform.sdk.node.shares.storage.trx[t])&&D.subscribeLabel(t)})},subscribeLabel:function(e){var t=Z.app.user,n=!1;t.address.value&&e.address==t.address.value||!t.address.value||(t=deep(Z.app,"platform.sdk.users.storage."+t.address.value))&&t.relation(e.address,"subscribes")&&(n=!0),c.c&&(e=c.c.find("#"+e.txid+" .shareTable"),n?e.addClass("subscribed"):e.removeClass("subscribed"))},repost:function(e){D.stateAction("_this",function(){Z.app.platform.ui.share({repost:e})},e)},cleardelay:function(){W&&(clearTimeout(W),W=null),c.c&&c.c.removeClass("rebuilding")},rebuilddelay:function(){c.c&&c.c.addClass("rebuilding"),W=slowMade(function(){_scrollToTop(c.shares,null,10,-80),D.loadprev()},W,600)},loadprev:function(e){c.c.find(".shares").html('<div class="bspacer"></div>'),c.c.removeClass("showprev"),c.c.removeClass("loading"),c.c.removeClass("sharesEnded"),c.c.removeClass("sharesZero"),c.shares&&b&&c.shares.isotope("destroy"),b=!1,j(),D.clear(),p.renderclbk&&p.renderclbk(),G(e)},clear:function(){_.each(k,function(e,t){delete Z.app.platform.sdk.node.shares.storage.trx[t]}),_.each(C,function(e){e.p&&e.p.destroy()}),_.each(f,function(e){e&&e.destroy()}),_.each(E,function(e){e&&e.destroy()}),E={},T=F=0,O=!(d=[]),k={},x={},A={},L=!(f={}),$("html").removeClass("fullvideoshowed"),$("html").removeClass("fullvideoshowedanimblock"),y=w=!1,C={},S=!(V=[]),r&&(clearTimeout(r),r=null),n&&(clearTimeout(n),n=null),s&&(clearTimeout(s),s=null),H=P=null,loaded=y=N=!1,i=!1,z=M=I=0},next:function(t,n){var e=nextElH(V,function(e){if(e.txid==t)return!0});e?n&&n(e.txid):y?n&&n(null):D.loadmore(function(e){n&&n(deep(e,"0.txid")||null)})},loadmore:function(n){q.shares(function(e,t){return t?(i=!1,Z.app.errors.connection()&&c.c.addClass("networkError"),void(Z.app.errors.connectionRs()&&(Z.iclbks.lenta=D.loadmore))):(c.c.removeClass("networkError"),e&&U.shares(e,function(){U.sharesInview(e,function(){p.renderclbk&&p.renderclbk()})},{index:V.length}),void(n&&n(e)))})},removeAdditionalByScroll:function(){var e;P&&(e=c.w.scrollTop(),150<Math.abs(e-I)&&D.additional(P,!1))},additional:function(e,t){t?(e.addClass("showAdditional"),e.find(".subscribeWrapper").fadeIn(),I=e.w.scrollTop(),(P=e).w.on("scroll",D.removeAdditionalByScroll)):(e.removeClass("showAdditional"),e.find(".subscribeWrapper").fadeOut(),e.w.on("scroll",D.removeAdditionalByScroll))},applyheight:function(e,t,n){},applyheightEl:function(e,t,n){},stateAction:function(t,n,s){Z.app.user.isState(function(e){if(e)n();else{if(_OpenApi)return e="https://"+Z.app.options.url+"/post?openapi=true&s="+s,Z.app.ref&&(e+="&ref="+Z.app.ref),void window.open(e,"_blank");Z.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:Z.app.localization.e("llogin"),successHref:t,signInClbk:function(){retry(function(){return!O},function(){n&&n()})}}})}})},destroyVideo:function(e){C[e.txid]&&(C[e.txid].p&&C[e.txid].p.destroy(),delete C[e.txid],U.urlContent(e))},initVideo:function(e,t,n,s){if(t&&t.txid){var a=e.find(".js-player"),o=e.find(".videoWrapper");if(s&&!C[t.txid])return C[t.txid]={shadow:!0,el:o,txid:t.txid},void(n&&n(!0));!C[t.txid]||C[t.txid].error||C[t.txid].shadow?!Z.app.platform.sdk.usersettings.meta.embedvideo||Z.app.platform.sdk.usersettings.meta.embedvideo.value?a.length&&a[0].getAttribute&&(s={muted:!0,resetOnEnd:!0,controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],speed:{selected:1,options:[1]},volumeChange:function(e){g=e,Z.sdk.videos.volume=g,Z.sdk.videos.save()}},"a"==t.settings.v&&(s.muted=!1,s.autoplay=!1),isMobile()&&(s.controls=["play","progress","current-time","fullscreen"]),PlyrEx(a[0],s,e=>{e?(C[t.txid]||(C[t.txid]={}),C[t.txid].p=e,C[t.txid].initing=!0,C[t.txid].el=o,C[t.txid].id=o.attr("pid"),C[t.txid].shadow=!1,D.setVolume(C[t.txid]),v&&(C[t.txid].preview=!0),p.enterFullScreenVideo&&(p.enterFullScreenVideo=!1,D.fullScreenVideo(t.txid))):C[t.txid]={error:!0}},e=>{C[t.txid]&&(a.find("iframe").attr("disable-x-frame-options","disable-x-frame-options"),C[t.txid].inited=!0),n&&n(!0)})):n&&n(!1):n&&n(!0)}},openPost:function(n,s){var e;isMobile()?(e=Z.app.platform.sdk.node.shares.storage.trx[n],delete f[n],U.share(e,null,!0)):Z.app.user.isState(function(e){var t={share:n,hr:p.hr,like:function(e){U.stars(e)},next:D.next,close:function(){p.renderclbk&&p.renderclbk()}};Z.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,history:!0,clbk:function(){p.renderclbk&&p.renderclbk(),s&&s()},essenseData:t})})},sharesocial:function(e,t){var n,s=Z.app.platform.sdk.node.shares.storage.trx[e];s&&(n="https://"+Z.app.options.url+"/"+(p.hr||"index?")+"s="+e+"&mpost=true",parameters().address&&(n+="&address="+(parameters().address||"")),(v||p.videomobile||s.itisvideo())&&(n="https://"+Z.app.options.url+"/index?v="+e+"&mpost=true&video=1"),e="Post","a"==s.settings.v&&(e="Article"),Z.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:n,caption:Z.app.localization.e("e13133")+" "+e,sharing:s.social(Z.app),embedding:{type:"post",id:s.txid,fullscreenvideoShowed:L}}}))},unblock:function(e,t){(e=Z.app.platform.sdk.node.shares.storage.trx[e])&&Z.app.platform.api.actions.unblocking(e.address,function(e,t){e||Z.app.platform.errorHandler(t,!0)})},htls:function(e){Z.app.platform.ui.wallet.send({htls:e},function(){})},donate:function(e,t){var n,s,a=Z.app.platform.sdk.node.shares.storage.trx[e];a&&(n=deep(app,"platform.sdk.usersl.storage."+a.address)||{address:a.address,addresses:[]},e=a.caption||a.message,s="send?address="+a.address+"&amount=1&message="+hexEncode(Z.app.localization.e("postlabel")+" - "+e.substr(0,20)+(e.length<=20?"":"..."))+"&label="+(n.name||n.address)+"&setammount=true",Z.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:Z.app.localization.e("dcancel"),clbk:function(e,t){e.find(".pnetdnt").on("click",function(){Z.nav.api.load({open:!0,href:s,history:!0}),t.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(Z.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:n}))},videoPosition:function(e){var t,n,s;p.openapi||(t=e.find(".work"),e.hasClass("fullScreenVideo")?(n=$(window).height(),s=0,isMobile()||(s=100),0<(s=(n-(e.find(".videoWrapper").height()+s))/2)?t.css("margin-top",s+"px"):t.css("margin-top","0px")):t.css("margin-top","0px"))},fullScreenVideoMobile:function(e){C[e]&&(C[e].p.fullscreen.enter(),C[e].p.playing||C[e].p.play(),D.setVolume(C[e],g||.5))},opensvi:function(e){p.opensvi&&p.opensvi(e,deep(Z,"app.platform.sdk.node.shares.storage.trx."+e))},fullScreenVideo:function(t,n){var e,s=c.c.find("#"+t),a=Z.app.platform.sdk.node.shares.storage.trx[t];a||(e=_.find(Z.sdk.node.transactions.temp.share,function(e){return e.txid==t}),(a=new pShare)._import(e),a.temp=!0,a.address=Z.app.platform.sdk.address.pnet().address),D.initVideo(s,a,function(e){e?C[t]&&(s.addClass("fullScreenVideo"),$("html").addClass("fullvideoshowed"),$("html").addClass("fullvideoshowedanimblock"),D.videoPosition(s),Z.app.nav.api.history.addParameters({v:t}),(e=C[t]).p.playing||e.p.play(),D.setVolume(C[t],g||.5),T=c.w.scrollTop(),l=!Z.app.actions.offScroll(),p.comments||retry(function(){return f[t]||!c.c},function(){c.c&&(f[t]&&(f[t].destroy(),f[t]=null),U.comments(t,!1,!0))}),L=!0,n&&n()):sitemessage("")})},exitFullScreenVideo:function(e){var t;$("html").removeClass("fullvideoshowed"),setTimeout(function(){$("html").removeClass("fullvideoshowedanimblock")},300),c.c&&((t=c.c.find("#"+e)).scrollTop(0),t.removeClass("fullScreenVideo"),D.videoPosition(t)),C[e],D.setVolume(C[e],g),Z.app.nav.api.history.removeParameters(["v"]),Z.app.actions.onScroll(),c.w.scrollTop(T||0),L=!1,p.comments||(f[e]&&(f[e].destroy(),f[e]=null),U.comments(e,!1,!1,!0)),v&&(e=Z.app.platform.sdk.node.shares.storage.trx[e],D.destroyVideo(e))},postscores:function(e,t){Z.app.nav.api.load({open:!0,href:"postscores?p="+e,inWnd:!0,history:!0,essenseData:{share:e,like:function(e){U.stars(e)}},clbk:function(){t&&t()}})},like:function(n,e,s){var a=n.upvote(e);if(!a)return Z.app.platform.errorHandler("4",!0),void(s&&s(!1));Z.sdk.node.transactions.create.commonFromUnspent(a,function(e,t){topPreloader(100),e?s&&s(!0):(a.myVal=null,n.myVal=0,Z.app.platform.errorHandler(t,!0),s&&s(!1))})},block:function(e,t){},complain:function(e){Z.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:Z.app.platform.sdk.node.shares.storage.trx[e],success:function(){}},clbk:function(){}})},openGalleryRec:function(n,s,a){var o=[],i=function(e,t){_.each(e.images,function(e){o.push(e)}),e.repost?Z.app.platform.sdk.node.shares.getbyid(e.repost,function(e){(e=e[0])?i(e,t):t&&t()}):t&&t()};i(n,function(){var e=_.map(o,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==s)return!0});(1<=e.length||n.url&&e.length&&parseVideo(n.url).type||!isMobile())&&Z.app.nav.api.load({open:!0,href:"imagegallery?i="+n.txid+"&num="+(t||0),inWnd:!0,history:!0,essenseData:{initialValue:s,idName:"src",images:e,gid:n.txid},clbk:function(){a&&a()}})})},openGallery:function(e,t,n){var s=_.map(e.images,function(e){return{src:e}}),a=findIndex(s,function(e){if(e.src==t)return!0});(1<s.length||e.url&&s.length&&parseVideo(e.url).type||!isMobile())&&Z.app.nav.api.load({open:!0,href:"imagegallery?i="+e.txid+"&num="+(a||0),inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:s,gid:e.txid},clbk:function(){n&&n()}})},scrollToPost:function(e){_scrollTo($("#"+e))},videosInview:function(e,a,o){var i;L||(i=_.filter(e,function(e){if(e.inited&&!e.playing&&!e.stopped&&e.el&&!e.preview&&!e.error)return!0})).length&&(n=slowMade(function(){window.requestAnimationFrame(function(){i=_.filter(i,function(e){return e.el}),_.map(i,function(e){return e.el[0]});var e=inView(c.c.find(".videoWrapper"),{offset:c.w.height()/10,mode:"all"}),t=null;if(0<e.length){var n=$(e[0]),t=n.attr("pid"),s=_.find(i,function(e){return e.id==t});if(!t||!s)return;s&&setTimeout(function(){inView(n,{offset:-100,mode:"all"}).length&&a(s,n)},520)}(e=_.filter(i,function(e){return e.id!=t})).length&&o(e)})},n,60))},sharesInview:function(a,o,i){t.scrollTop(),a.length&&!S&&(r=slowMade(function(){window.requestAnimationFrame(function(){var n,e=c.c.find(".share"),t=c.w,s=c.w.height()/4;0<(t=inView(e,{inel:t,offsetTop:s,offsetBottom:s})).length&&(n={},s=_.map(t,function(e){var t=e.getAttribute("id");return n[t]=!0,_.find(a,function(e){return e.txid==t})}),s=_.filter(s,function(e){if(e&&!e.temp)return!0}),o(s,t,function(){var e;i&&(e=_.filter(a,function(e){if(!n[e.txid])return!0}),i(e))}))})},r,60))},videoShare:function(e){if(!e.url||!e.itisvideo())return sitemessage("Unable to parse a video in the post");var t=Z.app.platform.parseUrl(e.url),n="https://"+Z.app.options.url+`/embedVideo.php?host=${t.host_name}&id=${t.id}&embed=true&s=${e.txid}`;return"peertube"===t.type?copycleartext(n):copycleartext(e.url),sitemessage(Z.app.localization.e("videoCopied"))},setVolume:function(e,t){void 0===t&&(t=g),e.p&&(t&&e.p.setVolume?e.p.setVolume(t):e.p.muted=!0)}},R={sharesPreInitVideo:function(){var t={};_.each(C,function(e){e.shadow&&e.txid&&(t[e.txid]=!0)});var e=_.filter(V,function(e){return t[e.txid]});e.length&&(s=slowMade(function(){window.requestAnimationFrame(function(){var n;c.c&&(n=c.w.scrollTop(),_.each(e,function(e){var t=c.share[e.txid];t.length&&n+3500>t.offset().top&&D.initVideo(t,e)}))})},s,60))},sharesInview:function(e){D.sharesInview(V,function(e,t,n){var s=_.filter(e,function(e){return!k[e.txid]});p.contents&&0<s.length&&(p.beginmaterial=e[0].txid,q.shares(function(e){U.sharesInview(e,function(){})})),_.each(e,function(e){c.share[e.txid].addClass("vstars")}),n&&n()},function(e){_.each(e,function(e){c.share[e.txid].removeClass("vstars")})})},videosInview:function(e){D.videosInview(C,function(e,t,n){var s;Z.app.platform.sdk.usersettings.meta.videoautoplay&&!Z.app.platform.sdk.usersettings.meta.videoautoplay.value||(s=t.closest(".share"),t.closest(".share").hasClass("showAdditional")||D.initVideo(s,Z.app.platform.sdk.node.shares.storage.trx[s.attr("id")],function(){e.p.getState&&"ended"==e.p.getState()||e.p.playing||(e.p.play(),D.setVolume(e))}))},function(e){_.each(e,function(e){e.error||(e.p.muted=!0,e.p.playing&&(e.p.stop(),isMobile()&&e.p.rebuild&&setTimeout(function(){},1e3)))})})},repost:function(){var e=$(this).closest(".share").attr("id");D.repost(e)},showmorebyauthor:function(){$(this).closest(".authorgroup").find(".share").removeClass("hidden"),$(this).remove(),U.sharesInview(V,function(e){R.sharesPreInitVideo(),R.videosInview()},function(){})},metmenu:function(){var e=$(this),t=$(this).closest(".share").attr("id");Z.app.platform.api.metmenu(e,t,D)},resize:function(){var e=c.c.find(".fullScreenVideo");0<e.length&&D.videoPosition(e)},loadmorescroll:function(){p.horizontal?!w&&!y&&"recommended"!=u&&c.w.scrollLeft()+c.w.width()>c.c.find(".shares").width()-2e3&&D.loadmore():!w&&!y&&("recommended"!=u||isMobile())&&c.w.scrollTop()+c.w.height()>c.c.height()-2e3&&D.loadmore()},commentLike:function(){var e=$(this).closest(".comment").attr("id"),t=$(this).closest(".share").attr("id");D.like(Z.app.platform.sdk.node.shares.storage.trx[t].findComment(e)),$(this).addClass("active")},toComments:function(){var e=$(this).closest(".share").attr("id");U.comments(e,!0)},getTransaction:function(){var e=$(this).closest(".share").attr("id");Z.app.platform.sdk.node.transactions.get.tx(e)},postscores:function(){var e=$(this).closest(".share").attr("id");D.postscores(e)},like:function(){var n,e,s=$(this).closest(".stars");s.attr("value")||(e=$(this).closest(".share").attr("id"),n=$(this).attr("value"),e=e||$(this).closest(".truerepost").attr("stxid"),D.stateAction("_this",function(){Z.app.platform.sdk.node.shares.getbyid(e,function(){var t=Z.app.platform.sdk.node.shares.storage.trx[e];Z.app.platform.sdk.address.pnet()&&t.address==Z.app.platform.sdk.address.pnet().address||(s.attr("value",n),s.addClass("liked"),D.like(t,n,function(e){e?(t.scnt||(t.scnt=0),t.score||(t.score=0),t.scnt++,t.score=Number(t.score||0)+Number(n),e=Number(t.score)/Number(t.scnt),s.find(".tstarsov").css("width",e/5*100+"%"),s.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),U.stars(t)):(s.removeAttr("value"),s.removeClass("liked"))}))})},e))},complain:function(){var e=$(this).closest(".share").attr("id");D.complain(e)},additional:function(){var e=$(this).closest(".share");D.additional(e,!e.hasClass("showAdditional"))},openGallery:function(){var e,t=$(this).closest(".shareinlenta").attr("id"),n=$(this).attr("i"),s=Z.app.platform.sdk.node.shares.storage.trx[t];s||(e=_.find(Z.sdk.node.transactions.temp.share,function(e){return e.txid==t}),(s=new pShare)._import(e),s.temp=!0,s.address=Z.app.platform.sdk.address.pnet().address),D.openGalleryRec(s,n)},subscribePrivate:function(){var e=(t=$(this)).hasClass("turnon"),t=t.closest(".shareTable").attr("address");Z.app.platform.api.actions[e=e?"notificationsTurnOff":"notificationsTurnOn"](t,function(e,t){e||Z.app.platform.errorHandler(t,!0)})},asubscribe:function(){var e=$(this).closest(".shareTable").attr("address"),t=$(this).closest(".shareTable").attr("stxid");$(this).closest(".share"),D.stateAction("_this",function(){Z.app.platform.api.actions.subscribeWithDialog(e,function(e,t){e||Z.app.platform.errorHandler(t,!0)})},t)},aunsubscribe:function(){var e=$(this).closest(".shareTable").attr("address"),n=$(this).closest(".share");dialog({html:Z.app.localization.e("e13022"),btn1text:Z.app.localization.e("unsub"),btn2text:Z.app.localization.e("ucancel"),class:"zindex",success:function(){Z.app.platform.api.actions.unsubscribe(e,function(e,t){e?n.find(".shareTable").removeClass("subscribed"):Z.app.platform.errorHandler(t,!0)})}})},exitFullScreenVideo:function(){var e=$(this).closest(".share").attr("id");D.exitFullScreenVideo(e)},fullScreenVideo:function(){var e=$(this).closest(".share").attr("id");D.fullScreenVideo(e)},opensvi:function(){var e=$(this).closest(".share").attr("id");D.opensvi(e)},fullScreenVideoMobile:function(){var e=$(this).closest(".share").attr("id");D.fullScreenVideoMobile(e)},openPost:function(e){deep(e,"target.href")||(e=$(this).closest(".shareinlenta").attr("id"),D.openPost(e))},sharesocial:function(){var e=$(this).closest(".shareinlenta").attr("id");D.sharesocial(e)},unblock:function(){var e=$(this).closest(".share").attr("id");D.unblock(e)},donate:function(){var e=$(this).closest(".share").attr("id");D.donate(e)},htls:function(){var e=$(this).closest(".share").attr("id");D.htls(e)},discussion:function(){var e=$(this).closest(".share").attr("id"),t=Z.app.platform.sdk.node.shares.getWithTemp(e);isMobile()?Z.nav.api.load({open:!0,id:"discussions",history:!0,clbk:function(){Z.app.platform.sdk.chats.add(e+"_"+t.address,"share")}}):Z.app.platform.sdk.chats.add(e+"_"+t.address,"share")},loadmore:function(){D.loadmore()},loadprev:function(){D.loadprev()}},U={debugusers:function(e){e.find(".testusersprofiles").each(function(){var e=$(this),t=(e.attr("ids")||"").split(","),n=_.map((e.attr("ids")||"").split(","),function(e){return e.split("_")[0]});t.length?Z.app.platform.sdk.users.get(n,function(){Z.shell({inner:html,name:"testusers",data:{ids:t},el:e},function(e){})}):e.text("Empty")})},comments:function(s,a,o,i){var r,l;"no"!=p.comments&&(v||f[s]||c.c&&(r=c.c.find("#"+s+" .commentsWrapper"),l=deep(Z.app.platform,"sdk.node.shares.storage.trx."+s),Z.fastTemplate("commentspreview",function(e){var t,n;c.c&&(t=c.c.find("#"+s),n="",Z.app.platform.sdk.address.pnet()&&(n="&ref="+Z.app.platform.sdk.address.pnet().address),n="https://"+Z.app.options.url+"/"+(p.hr||"index?")+"s="+s+"&mpost=true"+n,parameters().address&&(n+="&address="+(parameters().address||"")),Z.nav.api.load({open:!0,id:"comments",el:r,eid:s+"lenta",essenseData:{close:function(){f[s]&&f[s].hideall(!0),_scrollToTop(r,0,0,-65)},totop:c.c.find("#"+s),send:function(e,t){var n=c.c.find("#"+s+" .commentsAction .count span");n.html(Number(n.html()||"0")+1),l.lastComment=t},txid:s,showall:"all"==p.comments||o,fromtop:"all"==p.comments||t.hasClass("fullScreenVideo")||!1,preview:"all"!=p.comments&&i,lastComment:"all"!=p.comments?l.lastComment:null,count:l.comments,init:"all"!=p.comments&&a,hr:n,renderClbk:function(){p.renderclbk&&p.renderclbk()}},clbk:function(e,t){c.c&&(c.c.find("#"+s),t&&(f[s]=t),p.renderclbk&&p.renderclbk())}}))},{share:l})))},roomsinfo:function(e){_.each(e,function(e){var t=deep(Z.app.platform,"rtc.storage.info."+e+".d.users_count"),e=e.split("_")[0];void 0!==t&&c.c&&c.c.find("#"+e+" .discussion .count").html(t?"<b>"+t+"</b>":"")})},shareSpacers:function(e){_.each(e,function(e){U.shareSpacer(e)})},shareSpacer:function(e){var t,n;k[e.txid]&&!x[e.txid]&&(n=(t=c.shares.find("#"+e.txid)).find(".work").outerHeight(),C[e.txid]&&C[e.txid].inited&&(C[e.txid].p.destroy(),C[e.txid].el=null,C[e.txid].inited=!1),k[e.txid]=!1,c.shares.css("height",c.shares.outerHeight()),t.html('<div class="shareSpacer added"></div>'),t.find(".shareSpacer").outerHeight(n),A[e.txid]=D.applyheightEl(A[e.txid],t,"space"))},share:function(t,n,e){var s;t&&(s=c.share[t.txid],A[t.txid]=0,s.find(".added"),x[t.txid]=!0,Z.shell({name:v?"sharevideolight":"share",el:s,data:{share:t,ed:p,mestate:a,all:e||!1,tplvideo:v}},function(e){s.find(".work"),k[t.txid]=!0,A[t.txid]=D.applyheightEl(A[t.txid],s,"share"),U.stars(t),t.temp||U.comments(t.txid,!1,!1,!0),U.repost(e.el,t.repost,t.txid,t.isEmpty()),U.url(e.el.find(".url"),t.url,t,function(){U.urlContent(t,function(){p.searchValue&&e.el.find(".canmark").mark(p.searchValue),v||D.initVideo(e.el,t,null,!p.openapi),b&&c.shares.isotope(),x[t.txid]=!1,n&&n()})}),U.images(t,function(){})}))},mystars:function(e,t){var n=_.filter(e,function(e){if(void 0===e.myVal)return!0}),n=_.map(n,function(e){return e.txid});Z.app.platform.sdk.likes.get(n,function(){_.each(e,function(e){U.stars(e),U.wholike(e)}),t&&t()})},wholike:function(e,t){var n,s;!c.shares||(n=c.shares.find("#"+e.txid)).length&&(s=e.who,Z.shell({name:"wholike",el:n.find(".wholikes"),data:{scores:Number(e.scnt),wholikes:s||[]},bgImages:{}},function(e){t&&t()}))},stars:function(e,t){var n;!c.shares||(n=c.shares.find("#"+e.txid)).length&&Z.shell({name:"stars",el:n.find(".forstars"),data:{share:e}},function(e){fastars(e.el.find(".stars")),t&&t()})},sharesInview:function(e,t){e=_.filter(e,function(e){return!$("#"+e.txid).hasClass("hidden")});var n=_.sortBy(e,function(e){return-e.time});lazyEach({array:n,action:function(e){var t=e.item;k[t.txid]?e.success():(k[t.txid]=!0,U.share(t,e.success))},sync:isMobile(),all:{success:function(){U.mystars(e),t()}}})},shareall:function(e){_.each(e,function(e){U.share(e)})},txidall:function(e){_.each(e,function(e){e=deep(Z.app.platform,"sdk.node.shares.storage.trx."+e),U.share(e)})},shares:function(t,n,e){(e=e||{}).inner||(e.inner=function(e,t){if(!b)return append(e,t);t=$(t),e.append(t).isotope("appended",t)});var s="groupshares";(p.author||u||p.horizontal||p.txids||p.search)&&(s="shares"),"recommended"==u&&(t=_.sortBy(t,function(e){return-e.time})),e.ignoresw||(t=_.filter(t,function(t){return!_.find(V,function(e){return e.txid==t.txid})})),Z.shell({name:s,inner:e.inner,el:e.el||c.shares,data:{shares:t||[],index:e.index||0,video:v||p.videomobile},animation:!1,delayRender:b},function(e){e.inner==append?V=V.concat(t):e.inner!=replaceWith&&(V=t.concat(V)),V=_.uniq(V,function(e){return e.txid}),_.each(t,function(e){c.share[e.txid]=c.c.find("#"+e.txid)}),p.renderclbk&&p.renderclbk(),v&&!isMobile()&&(b||p.horizontal||(c.shares.isotope({layoutMode:"packery",itemSelector:".authorgroup",packery:{gutter:0},initLayout:!1}),c.shares.on("arrangeComplete",function(){}),b=!0)),n&&n()})},videoPreview:function(e,t){var n,s=c.share[e.txid];"a"==e.settings.v?(s=s.find("[data-plyr-provider][data-plyr-embed-id]"),n=[],$.each(s,function(){var e={type:(e=$(this)).attr("provider"),id:e.attr("eid")};n.push(videoImage(e))})):t&&t()},images:function(n,s){var a,i,r,l=n;c.c&&(a=c.share[n.txid],i=a.find(".image"),!(r=a.find(".images")).hasClass("active")&&i.length&&r.length?window.requestAnimationFrame(function(){i.imagesLoaded({background:!0},function(o){function e(){r.addClass("active"),i.addClass("active"),A[l.txid]=D.applyheightEl(A[l.txid],a),p.renderclbk&&p.renderclbk(),s&&s()}var t;"a"!=n.settings.v&&_.each(o.images,function(e,t){var n=e.img,s=$(o.elements[t]).closest(".imagesWrapper"),a="",e=s.width();s.height(),n.width>n.height&&!isMobile()&&768<window.innerWidth&&(a="w2",(t=e*(n.width/n.height))>r.width()&&(t=r.width(),h=t*(n.height/n.width),s.height(h)),s.width(t)),(n.height>n.width||isMobile()||window.innerWidth<=768)&&(a="h2",s.height(e*(n.height/n.width))),a&&s.addClass(a)}),A[l.txid]=D.applyheightEl(A[l.txid],a),"a"!=n.settings.v&&1<o.images.length?(t=5,isMobile()&&(t=0),r.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:t},initLayout:!1}),r.on("arrangeComplete",function(){e()}),r.isotope()):e()})}):s&&s())},repost:function(e,t,n,s,a){t&&Z.shell({name:"repost",el:e.find(".repostWrapper"),data:{repost:t,share:deep(Z.app.platform,"sdk.node.shares.storage.trx."+n),level:1}},function(e){e.el&&e.el.length&&Z.app.platform.papi.post(t,e.el.find(".repostShare"),function(e){E[n]=e},{repost:!0,eid:n+"lenta",level:1,fromempty:s})})},url:function(t,a,o,i){var n,r,e,s,l;p.nourlload?i&&i():(n=Z.app.platform.sdk.remote.storage[a],r=t.closest(".share"),e=Z.app.platform.parseUrl(a),s=function(n){var e=deep(Z,"app.platform.sdk.videos.storage."+a+".data.aspectRatio")||0,t=Z.app.platform.sdk.videos.storage[a];(e=t&&t.data?t.data.aspectRatio||0:e)&&((t=n.el.find(".jsPlayerLoading")).css("padding-top",`${e=100/(2*e)}%`),t.css("padding-bottom",`${e}%`)),Z.app.nav.api.links(null,n.el,function(e){e.stopPropagation()}),A[o.txid]=D.applyheightEl(A[o.txid],r,"url");var s=n.el.find("img");p.renderclbk&&p.renderclbk(),n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(s[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(s[t]).closest(".image").css("display","none")}),A[o.txid]=D.applyheightEl(A[o.txid],r,"url"),p.renderclbk&&p.renderclbk()}),i&&i()},l=function(e){Z.shell({turi:"share",name:"url",el:t,data:{url:a,og:n,share:o,video:v,preview:!!v},notdisplay:!!v,bgImages:{clbk:!!v}},s)},"peertube"===e.type?Z.app.platform.sdk.videos.info([a]).then(e=>{l()}):l())},urlContent:function(t,n){var s,a,e,o;c.c&&((s=t.url)?(a=c.share[t.txid].find(".url"),e=Z.app.platform.parseUrl(s),o=Z.app.platform.sdk.remote.storage[s],!s||o||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?n&&n():Z.app.platform.sdk.remote.get(s,function(e){e?U.url(a,s,t,n):n&&n()})):n&&n())},urlsContent:function(e){_.each(e,function(e){U.urlContent(e)})},urls:function(e,t){lazyEach({array:e,sync:!0,action:function(e){U.url(e.item.el,e.item.url,e.item.share,e.success)},all:{success:function(){t&&t()}}})},spacers:function(e,t){e=_.map(e,function(e){return{txid:e,author:p.author}}),this.shares(e,t,{noview:!0})}},q={recomended:function(t,n){c.loader.fadeIn(),c.c.addClass("loading"),d=[],p.author||H?t&&t(d):Z.app.platform.sdk.node.shares.recomended({},function(e){d=_.filter(e,function(t){if(!_.find(n,function(e){if(e.txid==t)return!0}))return!0}),Z.app.platform.sdk.node.shares.users(e,function(){t&&t(d)})})},txids:function(e,t){N?t([]):Z.app.platform.sdk.node.shares.getbyid(e,function(e){N=!0,t(e)})},begin:function(t){!H||N||u&&"sub"!=u?(N=!0,t([])):Z.app.platform.sdk.node.shares.getbyid(H,function(e){N=!0,t(e)})},videosinfo:function(e,t){},sstuff:function(s,a,o,i,r){r=r||[];var l=[].concat(s,r),d=p.author;Z.app.platform.sdk.node.shares.loadvideoinfoifneed(l,v,function(){Z.app.platform.sdk.node.shares.users(l,function(e,t){var n;F+=l.length,w=!1,c.c&&(a||t||(s&&s.length&&!(s.length<o.count)&&"recommended"!=u||(H||F?!p.txids&&(s.length<o.count||"recommended"==u)&&(u||d||p.search||p.tags)&&setTimeout(function(){c.c&&c.c.addClass("sharesEnded")},1e3):c.c.addClass("sharesZero"),(!s.length||s.length<o.count)&&(u||d||p.search)&&(y=!p.ended||p.ended(s))),(s=_.filter(s,function(t){return!_.find(r,function(e){return e.txid==t.txid})})).concat(r),s=[].concat(r,s),p.filter&&(s=_.filter(s,p.filter)),!p.author&&Z.user.address&&Z.user.address.value&&(n=deep(Z.app,"platform.sdk.users.storage."+Z.user.address.value.toString("hex")),s=_.filter(s,function(e){return!n.relation(e.address,"blocking")})),s.length&&p.hasshares&&p.hasshares(s)),p.afterload&&p.afterload(p,s,a||t),c.loader.fadeOut(),i&&i(s,a||t))})})},shares:function(r,l){w||y&&(!p.contents||p.txids.length==_.toArray(k).length)||(c.loader.fadeIn(),c.c.addClass("loading"),w=!0,p.loader?p.loader(function(e,t,n){q.sstuff(e,t,n,r)}):Z.app.user.isState(function(i){q.begin(function(s){var e=p.author,t="common",n="";if(e?n=H:t="hierarchical",u)if("recommended"==u)t="recommended";else if("hot"!=u)if("b"==u)t="getbyidsp",n=p.beginmaterial;else if(t="common",e="1",!i)return void q.sstuff([],null,{count:0},r);p.txids&&"b"!=u&&(t="txids"),p.loaderkey&&(t=p.loaderkey),p.from&&(n=p.from);var a=Z.app.platform.sdk.categories.gettags();p.tags&&(a=p.tags);var o=p.page||parameters().page||0;Z.app.platform.sdk.node.shares[t]({author:e,begin:n||"",txids:p.txids,height:z,tagsfilter:a,video:v||p.videomobile,count:v?20:10,page:o,period:p.period},function(e,t,n){n.blocknumber&&(z=n.blocknumber),p.shuffle&&(e=_.shuffle(e)),q.sstuff(e,t,n,r,s),"b"==u&&(H="")},l)})}))}},B=function(e){var t,n;"recommended"==u||p.author||p.search||(n=0,(t=_.toArray(Z.sdk.node.transactions.temp.share||{})).length&&!u&&(n-=t.length),0<(e||0)+n&&(M=M+(e||0)+n,c.c.addClass("showprev"),c.c.find(".countnew").html("("+M+")"),p.renderclbk&&p.renderclbk()))},G=function(s,a){i=!0,D.cleardelay();var e="clear",n=!0;p.goback&&(e="cache"),p.contents&&(c.c.find(".shares").html(""),U.spacers(p.txids,function(){D.scrollToPost(p.beginmaterial)}),n=!1);var t=parameters();p.second||v&&t.v&&D.opensvi(t.v),q.shares(function(e,t){return t?(i=!1,Z.app.errors.connection()&&c.c.addClass("networkError"),void(Z.iclbks.lenta=function(){G(null,a)})):(c.c.removeClass("networkError"),void(e?(n&&c.c.find(".shares").html(""),U.shares(e,function(){U.sharesInview(e,function(){i=!1,R.sharesInview(),R.sharesPreInitVideo(),R.videosInview();var e,t,n=parameters();p.second||(n.s&&!n.msh&&(isMobile()||D.openPost(n.s,function(){D.scrollToPost(n.p)})),n.i&&(t=null,(e=deep(Z.app.platform,"sdk.node.shares.storage.trx."+n.i))&&(n.num&&(t=deep(e,"images."+n.num)),D.openGalleryRec(e,t))),n.v&&(v||isMobile()||D.fullScreenVideo(n.v,function(){})),n.p&&D.postscores(n.p,function(){D.scrollToPost(n.p)})),s&&s(),p.goback&&a.clbk&&(p.goback=!1,a.clbk(null,a)),p.notscrollloading&&p.txids&&U.txidall(p.txids)})})):i=!1))},e)},j=function(){var e;p.goback||p.second||p.author||H||(e="sub"==u?"sub":v?"video":"common","recommended"!=u&&Z.app.platform.sdk.newmaterials.see(e))};return{id:e,primary:o,getdata:function(n,e){l=!1,M=0,f={},p=e.settings.essenseData||{},D.clear(),e=parameters(),g=Z.sdk.videos.volume,H=e.s||e.i||e.v||e.p||null,u=e.r||!1,void 0!==p.r&&null!=p.r&&(u=p.r),p.second&&(H=null),p.txids&&"b"!=u&&(u=!1),m=!p.txids||!1,v=p.video||!1,Z.app.platform.sdk.ustate.me(function(e){a=e||{};var t={beginmaterial:H,author:p.author,recommended:u,filters:p.search||p.tags};Z.loadTemplate({name:"share"},function(){Z.loadTemplate({name:"sharevideo"},function(){Z.loadTemplate({turi:"share",name:"url"},function(){Z.loadTemplate({name:"stars"},function(){n(t)})})})})})},hasplayingvideos:function(){var e=_.filter(C,function(e){if(e.p&&e.el&&e.inited&&e.p.playing)return!0});return console.log("players",e),e.length},destroy:function(){c.shares&&b&&c.shares.isotope("destroy"),D.cleardelay(),D.scrollmode(!1),b=!1,_.each(k,function(e,t){delete Z.app.platform.sdk.node.shares.storage.trx[t]}),_.each(C,function(e){e.p&&e.p.destroy()}),C={},l&&Z.app.actions.onScroll(),_.each(f,function(e){e.destroy()}),f={},delete Z.iclbks.lenta,p.openapi||p.second||p.txids||(delete Z.app.platform.sdk.categories.clbks.tags.lenta,delete Z.app.platform.sdk.categories.clbks.selected.lenta,delete Z.app.platform.ws.messages.comment.clbks.lenta,delete Z.app.platform.sdk.node.shares.clbks.added.lenta,delete Z.app.platform.ws.messages.transaction.clbks.temp,delete Z.app.platform.ws.messages.event.clbks.lenta,delete Z.app.platform.ws.messages["new block"].clbks.newsharesLenta,delete Z.app.platform.clbks.api.actions.subscribe.lenta,delete Z.app.platform.clbks.api.actions.unsubscribe.lenta,delete Z.app.platform.clbks.api.actions.subscribePrivate.lenta,delete Z.app.platform.clbks.api.actions.blocking.lenta,delete Z.app.platform.clbks.api.actions.unblocking.lenta,delete Z.app.platform.clbks._focus.lenta),Z.app.platform.sdk.chats.removeTemp(),v=!1,c.w&&(c.w.off("scroll",R.sharesPreInitVideo),c.w.off("scroll",R.videosInview),c.w.off("scroll",R.sharesInview),c.w.off("scroll",R.loadmorescroll),c.w.off("resize",R.resize)),c={}},authclbk:function(){void 0!==c&&c.c&&D.authclbk()},update:function(){c.shares&&b&&c.shares.isotope("layout")},init:function(e){var n,s,a;t=$(window),(c={}).c=e.el.find("#"+Z.map.id),c.shares=c.c.find(".shares"),c.loader=c.c.find(".loader"),c.lentacnt=c.c.find(".lentacell .cnt"),c.w=p.window||$(window),c.share={},p.horizontal&&c.c.addClass("horizontal"),p.compact&&c.c.addClass("compact"),isMobile()&&m&&!p.openapi&&(n=c.c.find(".circularprogress"),(s=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),c.c.find(".circularprogressWrapper").html(s.el),a=c.c.find(".loadprev"),p.second||new SwipeParallaxNew({el:c.c.find(".shares"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/80;0<=e?(s.options.text={value:""},s.update(100*t),n.fadeIn(1),n.height(220*t+"px"),a.css("opacity",1-4*t)):(s.renew(),n.fadeOut(1))},constraints:function(){if(c.w.scrollTop()<=0&&!L)return!0},restrict:!0,dontstop:!0,trueshold:80,clbk:function(){s.update(0),n.fadeOut(1),Z.app.platform.sdk.notifications.getNotifications(),D.loadprev(function(){})}}}}).init()),p.openapi||(c.w.on("resize",R.resize),p.horizontal||(c.w.on("scroll",R.videosInview),c.w.on("scroll",R.sharesPreInitVideo)),p.notscrollloading||(c.w.on("scroll",R.sharesInview),c.w.on("scroll",R.loadmorescroll))),c.c.on("click",".wholikesTable",R.postscores),c.c.on("click",".stars i",R.like),c.c.on("click",".complain",R.complain),c.c.on("click",".imageOpen",R.openGallery),c.c.on("click",".txid",R.getTransaction),isMobile(),c.c.on("click",".debuginfo .icon",function(){$(this).closest(".debuginfo").addClass("showed"),U.debugusers($(this).closest(".debuginfo"))}),c.c.on("click",".showMore",R.openPost),c.c.on("click",".forrepost",R.repost),c.c.on("click",".unblockbutton",R.unblock),c.c.on("click",".videoTips",R.fullScreenVideo),c.c.on("click",".videoOpen",R.fullScreenVideo),c.c.on("click",".opensviurl",R.opensvi),c.c.on("click",".exitFull",R.exitFullScreenVideo),c.c.on("click",".additional",R.additional),c.c.on("click",".asubscribe",R.asubscribe),c.c.on("click",".aunsubscribe",R.aunsubscribe),c.c.on("click",".notificationturn",R.subscribePrivate),c.c.on("click",".donate",R.donate),c.c.on("click",".sharesocial",R.sharesocial),c.c.on("click",".discussion",R.discussion),c.c.on("click",".metmenu",R.metmenu),c.c.find(".loadmore button").on("click",R.loadmore),c.c.find(".loadprev button").on("click",R.loadprev),c.c.on("click",".showmorebyauthor",R.showmorebyauthor),c.c.on("click",".commentsAction",R.toComments),p.openapi||p.second||(p.txids||(Z.app.platform.sdk.node.shares.clbks.added.lenta=function(e){var t;e.txidEdit?(delete f[e.txidEdit],delete k[e.txidEdit],delete x[e.txidEdit],t=replaceEqual(V,{txid:e.txidEdit},e),D.destroyVideo(e),t&&U.shares([e],function(){U.sharesInview([e],function(){})},{inner:replaceWith,el:c.shares.find("#"+e.txidEdit),ignoresw:!0})):(D.destroyVideo(e),U.shares([e],function(){U.sharesInview([e],function(){})},{inner:prepend}))},Z.app.platform.ws.messages.transaction.clbks.temp=function(t){var e;p.author||p.txids||!t.temp||(e=_.find(V,function(e){if(e.txid==t.temp.txid)return!0}))&&(e.temp=!1,e.scnt="0",e.score="0",e.myVal=0,e.time=new Date,k[e.txid]=!1,U.sharesInview([e],function(){}))},Z.app.platform.ws.messages.event.clbks.lenta=function(t){var e;"upvoteShare"!=t.mesType||!t.share||(e=_.find(V,function(e){if(e.txid==t.share.txid)return!0}))&&U.stars(e,function(){})}),Z.app.platform.clbks._focus.lenta=function(e){!window.cordova&&!isInStandaloneMode()||L||p.txids||i||!(120<e)||p.second||(D.loadprev(),_scrollTop(0))},p.txids||(Z.app.platform.ws.messages.newblocks.clbks.newsharesLenta=Z.app.platform.ws.messages["new block"].clbks.newsharesLenta=D.newmaterials,Z.app.platform.sdk.categories.clbks.tags.lenta=Z.app.platform.sdk.categories.clbks.selected.lenta=function(e){var t,n;"hierarchical"!=(t="common",n=p.author,p.loaderkey||(n||(t="hierarchical"),u&&(t="recommended"==u?"recommended":"b"==u?"getbyidsp":"common"),p.txids&&"b"!=u?"txids":t))||p.second||D.rebuilddelay()}),Z.app.platform.ws.messages.comment.clbks.lenta=function(e){k[e.posttxid]&&(e=c.c.find("#"+e.posttxid+" .commentsAction .count span")).html(Number(e.html()||"0")+1)},Z.app.platform.clbks.api.actions.subscribe.lenta=function(e){(e=c.c.find('.shareTable[address="'+e+'"]')).addClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},Z.app.platform.clbks.api.actions.subscribePrivate.lenta=function(e){var t=c.c.find('.shareTable[address="'+e+'"]'),n=deep(Z.app,"platform.sdk.users.storage."+Z.user.address.value.toString("hex"));n&&(!(e=n.relation(e,"subscribes"))||"true"!=e.private&&!0!==e.private?t.find(".notificationturn").removeClass("turnon"):t.find(".notificationturn").addClass("turnon")),t.addClass("subscribed")},Z.app.platform.clbks.api.actions.unsubscribe.lenta=function(e){(e=c.c.find('.shareTable[address="'+e+'"]')).removeClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},Z.app.platform.clbks.api.actions.blocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").addClass("blocking")},Z.app.platform.clbks.api.actions.unblocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").removeClass("blocking")}),j(),G(null,e),v&&c.c.addClass("mainvideo"),p.goback||e.clbk(null,e)}}}var Z=new nModule,s={};return Z.update=function(){_.each(s,function(e){e.update()})},Z.authclbk=function(){_.each(s,function(e){e.authclbk()})},Z.run=function(e){var t=Z.addEssense(s,n,e);Z.init(t,e)},Z.stop=function(){_.each(s,function(e){e.destroy()})},Z}();"undefined"!=typeof module?module.exports=lenta:(app.modules.lenta={},app.modules.lenta.module=lenta);
 /*_____*/ 
var tube=function(){function t(e){var n,t,a,e=deep(e,"history");return{primary:e,getdata:function(e,n){t=n.settings.essenseData||{},_.each(a,function(e,n){delete o.app.platform.sdk.node.shares.storage.trx[n]}),loaded=!1,a={},(n=parameters()).s||n.i||n.v||n.p,e({})},destroy:function(){n={}},init:function(e){(n={}).c=e.el.find("#"+o.map.id),n.shares=n.c.find(".shares"),n.loader=n.c.find(".loader"),n.lentacnt=n.c.find(".lentacell .cnt"),t.goback,t.goback||e.clbk(null,e)}}}var o=new nModule,a={};return o.run=function(e){var n=o.addEssense(a,t,e);o.init(n,e)},o.stop=function(){_.each(a,function(e){e.destroy()})},o}();"undefined"!=typeof module?module.exports=tube:(app.modules.tube={},app.modules.tube.module=tube);
 /*_____*/ 
var send=function(){function a(e){var a,s,e=deep(e,"history"),t={stateAction:function(n,a){i.app.user.isState(function(e){e?a():i.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{loginText:i.app.localization.e("llogin"),successHref:n,signInClbk:function(){a&&a()}}})})},send:function(){t.stateAction("_this",function(){i.nav.api.load({open:!0,history:!0,href:"userpage?id=wallet&action=send&address="+s.address+"&amount="+s.amount+"&message="+s.message})})}};return{primary:e,getdata:function(e){var n=parameters();s={},n.address&&bitcoin.address.fromBase58Check(n.address)&&(s.address=n.address),n.amount&&(s.amount=Number(n.amount)),n.label&&(s.label=clearScripts(donottrustLink(findAndReplaceLink(n.label,!0)))),n.message&&(s.message=clearScripts(donottrustLink(findAndReplaceLink(hexDecode(n.message,!0))))),s.amount&&s.address&&s.message?e(s):i.nav.api.load({open:!0,href:"page404",history:!0})},destroy:function(){a={}},init:function(e){var n;(a={}).c=e.el.find("#"+i.map.id),a.am=a.c.find(".amredit"),a.c.find(".send").on("click",t.send),a.am.on("change",function(){var e=$(this).val();s.amount=e}),0<(n={alias:"numeric",groupSeparator:",",radixPoint:".",digits:6,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(n.placeholder="0.000000"),a.am.inputmask(n),parameters().setammount||a.am.blur(),e.clbk(null,e)}}}var i=new nModule,s={};return i.run=function(e){var n=i.addEssense(s,a,e);i.init(n,e)},i.stop=function(){_.each(s,function(e){e.destroy()})},i}();"undefined"!=typeof module?module.exports=send:(app.modules.send={},app.modules.send.module=send);
 /*_____*/ 
var imagegallery=function(){function n(e){function t(){if(!r){var e=$(this).attr("action");return c[e](),!1}}function n(e){}var a,i,r,e=deep(e,"history"),o=null,s=0,l={current:{z:1}},c={swipe:function(e,t,n){},back:function(){1<i.images.length&&(c.prepareImages(),--s<0&&(s=i.images.length-1),u())},next:function(){1<i.images.length&&(c.prepareImages(),++s>=i.images.length&&(s=0),u())},initialValue:function(){c.prepareImages(),i.initialValue&&(s=findIndex(i.images,function(e){var t="name";if(e[t=i.idName||t]==i.initialValue)return!0}))},prepareImages:function(){i.getImages&&(i.images=i.getImages())},prepareImage:function(e,t){i.getImage?i.getImage(e,function(e){t&&t(e)}):t&&t(e)}},g={resize:function(){g.bestFit(a.imagesWrapper.find(".image"),o)},bestFit:function(e,t){var n=e.closest(".imagesAbsWrapper"),i=e.find(".imgWrapper"),a=t.naturalWidth||t.width,r=t.naturalHeight||t.height,o=r/a;e.css("padding-top","0px");var s=e.width(),l=e.height(),e=n.width();(l=(n=n.height())<l?n:l)<=(r=(s=e<s?e:s)<a?(a=s)*o:r)&&(a=(r=l)/o),t.width=a,t.height=r,$(t).attr("data-camanwidth",a),$(t).attr("data-camanheight",r),$(t).animate({opacity:1}),i.width(a),i.height(r)},nFormat:function(e){return e<10?"0"+e:e},getRelativePosition:function(e,t,n,i){var a=g.getCoords(e),e=t.x-a.x,a=t.y-a.y;return{x:e/(n.width*i/2)-1,y:a/(n.height*i/2)-1}},getCoords:function(e){var e=(t=e.getBoundingClientRect()).top,t=t.left;return{x:Math.round(t),y:Math.round(e)}},scaleFrom:function(e,t,n){var i=g.getCoordinateShiftDueToScale(l.originalSize,t),a=g.getCoordinateShiftDueToScale(l.originalSize,n),r=i.x-a.x,a=i.y-a.y;return{x:e.x*r,y:e.y*a,z:n-t}},getCoordinateShiftDueToScale:function(e,t){var n=t*e.width,t=t*e.height;return{x:(n-e.width)/2,y:(t-e.height)/2}},updateZoomedImage:function(e=!0){var t;l.current.height=l.originalSize.height*l.current.z,l.current.width=l.originalSize.width*l.current.z,e&&(t=l.imageContainerParent.height()<l.current.height?Math.abs((l.current.height-l.imageContainerParent.height())/2):0,e=l.imageContainerParent.width()<l.current.width?Math.abs((l.current.width-l.imageContainerParent.width())/2):0,l.current.y>t?l.current.y=l.last.y=t:l.current.y<-t&&(l.current.y=l.last.y=-t),l.current.x>e?l.current.x=l.last.x=e:l.current.x<-e&&(l.current.x=l.last.x=-e)),l.imageContainer.style.transform="translate3d("+l.current.x+"px, "+l.current.y+"px, 0) scale("+l.current.z+")"}},u=function(){a.c.addClass("loading"),r=!0;var e=i.images[s]||i.images[0];console.log(e,i.images,s),m.app.nav.api.history.addParameters({num:s.toString()}),c.prepareImage(e,function(e){e={image:e},a.imageNavigation.find(".number").html(g.nFormat(s+1)),$(window).off("resize",g.resize),e=e||{},m.shell({name:"image",el:a.images,inner:html,display:"table",data:{data:i,image:e.image}},function(i){i.el.find("img").imagesLoaded(function(e){a.c.removeClass("loading"),r=!1,(o=deep(e,"images.0.img"))&&(g.resize(),$(window).on("resize",g.resize));var t=i.el.find(".imgWrapper")[0],e=i.el.find("img")[0];l={fullContainer:$(t).closest(".imageContainer")[0],imageContainerParent:$(t).parent(),imageContainer:t,imageElement:e,minZoomAllowed:1,maxZoomAllowed:5,current:{x:0,y:0,z:1,zooming:!1,width:e.width,height:e.height},fixHammerjsDeltaIssue:void 0,pinchStart:{x:void 0,y:void 0},last:{x:0,y:0,z:1},lastEvent:void 0,originalSize:{width:e.width,height:e.height,containerWidth:$(t).width(),containerHeight:$(t).height()},pinchZoomOrigin:void 0};var n=new Hammer(l.imageContainer);n.get("pan").set({threshold:0}),n.get("pinch").set({enable:!0}),n.get("tap").set({taps:2}),n.get("swipe").set({direction:Hammer.DIRECTION_ALL}),n.on("pan",function(e){l.imageContainer.style.transition="none","pan"!==l.lastEvent&&(l.fixHammerjsDeltaIssue={x:e.deltaX,y:e.deltaY}),l.current.x=l.last.x+e.deltaX-l.fixHammerjsDeltaIssue.x,l.current.y=l.last.y+e.deltaY-l.fixHammerjsDeltaIssue.y,l.lastEvent="pan",g.updateZoomedImage(!1)}),n.on("panend",function(e){l.imageContainer.style.transition=l.current.z<=1?"0.3s":"none",l.last.x=l.current.x,l.last.y=l.current.y,l.lastEvent="panend",g.updateZoomedImage()}),n.on("doubletap",function(e){var t=1<l.current.z?1-l.current.z:2;l.imageContainer.style.transition="0.3s",e=g.getRelativePosition(l.imageElement,{x:e.center.x,y:e.center.y},l.originalSize,l.current.z),t=g.scaleFrom(e,l.current.z,l.current.z+t),l.current.x+=t.x,l.current.y+=t.y,l.current.z+=t.z,l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,g.updateZoomedImage()}),n.on("swipeleft swiperight",function(e){l.imageContainerParent.width()<l.current.width||(e.deltaX<0?c.next():c.back())}),n.on("swipeup swipedown",function(e){l.imageContainerParent.height()<l.current.height||m.closeContainer()}),n.on("pinchstart",function(e){l.pinchStart.x=e.center.x,l.pinchStart.y=e.center.y,l.pinchZoomOrigin=g.getRelativePosition(l.imageContainer,{x:l.pinchStart.x,y:l.pinchStart.y},l.originalSize,l.current.z),l.lastEvent="pinchstart"}),n.on("pinch",function(e){(e=g.scaleFrom(l.pinchZoomOrigin,l.last.z,l.last.z*e.scale)).z+l.last.z<=l.maxZoomAllowed&&e.z+l.last.z>=l.minZoomAllowed&&(l.current.x=e.x+l.last.x,l.current.y=e.y+l.last.y,l.current.z=e.z+l.last.z),l.lastEvent="pinch",g.updateZoomedImage()}),n.on("pinchend",function(e){l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,l.lastEvent="pinchend",n.get("pan").set({enable:!1}),setTimeout(()=>{n.get("pan").set({enable:!0})},200)}),l.imageElement.addEventListener("wheel",e=>{var t=0<e.deltaY?-1:1;t<0&&l.current.z+t<l.minZoomAllowed||0<t&&l.current.z+t>l.maxZoomAllowed||(l.imageContainer.style.transition="0.3s",e=g.getRelativePosition(l.imageElement,{x:e.x,y:e.y},l.originalSize,l.current.z),t=g.scaleFrom(e,l.current.z,l.current.z+t),l.current.x+=t.x,l.current.y+=t.y,l.current.z+=t.z,l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,g.updateZoomedImage())},!1),(t=new Hammer(l.fullContainer)).get("swipe").set({direction:Hammer.DIRECTION_ALL}),t.on("swipeleft swiperight",function(e){1.2*l.imageContainerParent.width()<l.current.width||(e.deltaX<0?c.next():c.back())}),t.on("swipeup swipedown",function(e){1.2*l.imageContainerParent.height()<l.current.height||m.closeContainer()})})})})};return{primary:e,parametersHandler:function(){var e=parameters().num;void 0!==e&&(s=Number(e),c.prepareImages(),u())},getdata:function(e){e({})},destroy:function(){o=null,$(window).off("resize",g.resize),r=!1,a={}},clearparameters:["i","num","s","com"],init:function(e){o=null,r=!1,i=e.essenseData||{},c.initialValue(),(a={}).c=e.el.find("#"+m.map.id),a.imagesWrapper=e.el.find(".imagesWrapper"),a.images=e.el.find(".images"),a.imageNavigation=e.el.find(".imageNavigation"),a.arrows=a.imageNavigation.find(".arrow"),u(),a.arrows.on("click",t),isMobile()||isTablet()||a.c.on("click",n),a.c.find(".imagesTableWrapper").closest(".wnd"),i.images&&1<i.images.length&&a.c.find(".imagesTableWrapper").swipe({allowPageScroll:"auto",swipeStatus:function(e,t,n,i){return c.swipe(t,n,i),!0}}),e.clbk(null,e)},wnd:{class:"allscreen black withoutButtons imageGallery"}}}var m=new nModule,i={};return m.run=function(e){var t=m.addEssense(i,n,e);m.init(t,e)},m.stop=function(){_.each(i,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=imagegallery:(app.modules.imagegallery={},app.modules.imagegallery.module=imagegallery);
 /*_____*/ 
var s=function(){function t(s){function e(){var s=$(this).attr("arrow");d.clickArrow(s)}function t(){d.clickNext()}var n,a,u,r,i,s=deep(s,"history"),o=0,l=10,c="list",d={clickNext:function(){f("users",o+=l,30),d.displayArrows()},clickArrow:function(s){"left"==s&&(o-=l)<0&&(o=0),"right"==s&&((o+=l)>=u.users.count&&(o=u.users.count-1),f("users",o,l)),d.slideCarousel()},displayArrows:function(){0<o?d.displayArrow("left",!0):d.displayArrow("left",!1),o+l<u.users.count?(d.displayArrow("right",!0),d.displayNext(!0)):(d.displayArrow("right",!1),d.displayNext(!1))},displayNext:function(s){s?n.unext.addClass("active"):n.unext.removeClass("active")},displayArrow:function(s,e){var t=n.ea;s&&(t=n["u"+s]),e?t.addClass("active"):t.removeClass("active")},slideCarousel:function(){var s=n.c.find(".user").width(),s=o*s;n.userslist.css("margin-left","-"+s+"px"),d.displayArrows()},applyCarousel:function(){var s,e;"list"==c?(s=n.c.find(".user").width(),e=n.c.find(".userslistwrapper").width(),l=Math.min(Number((e/s).toFixed(0)),10),n.c.find(".user").width((e/l).toFixed(0)+"px"),n.userslist.width((u.users.data.length*(e/l)).toFixed(0)+1),d.slideCarousel()):(n.userslist.css("margin-left","0px"),n.userslist.css("width","auto"),n.c.find(".user").css("width","auto"))},changeUsersView:function(){"list"==c?c="full":(c="list",o=0),n.users.attr("view",c),d.applyCarousel()}},p={users:function(s,e){m.shell({name:"userslist",el:n.users.find(".userslist"),data:{users:s},inner:append,bgImages:{clbk:function(s){$(s.elements[0]).addClass("active")}}},function(s){"list"==c&&d.applyCarousel(),e&&e(s)})},posts:function(){var s=!1;m.nav.api.load({open:!0,id:"lenta",el:n.lenta,animation:!1,mid:"search",essenseData:{search:!0,hr:"index?",searchValue:a,loader:function(e){function t(s){s=m.app.platform.sdk.node.shares.transform(s),e&&e(s,null,{count:10})}s?f("posts",u.posts.data.length,10,function(s){t(s)}):(s=!0,t(u.posts.data))}},clbk:function(s,e){i=e}})}},f=function(e,s,t,n){var a,r=u[e].data.length,i=u[e].count;s+t<=r||(s<r&&(a=r-s,s=r,t-=a),(t=i<s+t?i-s:t)<=0||h[e](function(s){n?n(s):p[e](s)},s,t))},h={users:function(e,s,t){m.app.platform.sdk.search.get(a,"users",s,t,r,function(s){e(s.data)})},posts:function(e,s,t){m.app.platform.sdk.search.get(a,"posts",s,t,r,function(s){e(s.data)})}};return{primary:s,getdata:function(t){var n={};i=null,a=(parameters().ss||"").replace("tag:","#");var s=deep(m,"app.modules.menu.module.showsearch");s&&s(a),m.app.platform.sdk.search.clear(),m.app.platform.sdk.search.get(a,"all",0,10,null,function(s,e){r=e,u=s,n.result=s,n.value=a,t(n)})},destroy:function(s){s==m.app.nav.current.href||(s=deep(m,"app.modules.menu.module.closesearch"))&&s(),i&&i.destroy(),i=null,n={}},init:function(s){o=0,l=10,(n={}).c=s.el.find("#"+m.map.id),n.users=n.c.find(".users"),n.userslist=n.c.find(".userslist"),n.posts=n.c.find(".posts"),n.uleft=n.c.find(".uleft"),n.uright=n.c.find(".uright"),n.ua=n.c.find(".arrow"),n.showmore=n.c.find(".showmore"),n.unext=n.c.find(".nextpage"),n.lenta=n.c.find(".lentasearch"),n.ua.on("click",e),n.showmore.on("click",d.changeUsersView),n.userslist.swipe({swipe:function(s,e,t,n,a,r){}}),n.unext.on("click",t),deep(u,"users.data.length")&&p.users(u.users.data),deep(u,"posts.data.length")&&p.posts(),s.clbk(null,s)}}}var m=new nModule,n={};return m.run=function(s){var e=m.addEssense(n,t,s);m.init(e,s)},m.stop=function(e){_.each(n,function(s){s.destroy(e)})},m}();"undefined"!=typeof module?module.exports=s:(app.modules.s={},app.modules.s.module=s);
 /*_____*/ 
var menu=function(){function a(){function t(){var e=d.app.platform.sdk.newmaterials.storage;s.c&&_.each(e,function(e,n){(n=s.c.find('.lentaunseen[key="'+n+'"]')).html(e=99<e?"99":e),e?n.addClass("hasunseen"):n.removeClass("hasunseen")})}function e(){l&&l.placeholder(d.app.localization.e("e13139")),c=null}var s,a=null,n=null,c=null,l=null,i=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),format:{right:!0},_onChange:function(e){(e=app.localization.findByName(e))&&e.key!=app.localization.key&&app.localization.set(e.key)}}),o={},r={elswidth:function(){s.c.find(".autowidth.active").each(function(){r.setWidth($(this))})},setWidth:function(e){},ahnotifyclear:function(){o={},r.ahnotify(null)},ahnotify:function(e,n,a){n=n||0,a&&(o[a]=n),a=_.reduce(o,function(e,n){return e+(n||0)},0),n=null,"undefined"!=typeof cordova&&(n=deep(cordova,"plugins.notification.badge")),e&&r.ah(e,a),n&&n.set(a),d.app.platform.api.electron.notifications(a,"notifications")},ah:function(e,n){0<n?e.addClass("amountHave"):e.removeClass("amountHave"),e.find(".amount").html(n)},sitenameToNav:function(){p.navinit.el&&(n=slowMade(function(){var e,n;l&&l.active||parameters().ss||(("index"==(e=d.app.nav.current.href)||"author"==e)&&45<$(window).scrollTop()?(s.nav.addClass("active"),s.c.addClass("menupanelactive"),s.nav.find(".pcenterLabel").removeClass("active"),s.postssearch.find("input").blur(),l&&l.blur(),n=parameters(d.app.nav.current.completeHref,!0).r||"empty",parameters(d.app.nav.current.completeHref,!0).video&&(n="video"),"index"==e&&s.nav.find('.pcenterLabel[r="'+n+'"]').addClass("active")):(s.c.removeClass("menupanelactive"),s.nav.removeClass("active")),r.elswidth())},n,10))}},p={navinit:{init:function(e){isTablet()||($(window).on("scroll",r.sitenameToNav),d.app.nav.clbks.history.menu=function(e){r.sitenameToNav()})},destroy:function(){$(window).off("scroll",r.sitenameToNav),delete d.app.nav.clbks.history.menu}},chats:{click:function(){var e=deep(d,"app.platform.matrixchat.core.apptochat");e&&e()},init:function(n){d.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu=function(e){r.ahnotify(n,e,"chat")}}},sitename:{click:function(){d.app.user.isState(function(e){var n=localStorage.lentakey||"index";"index"!=(n=parameters().r==n?"index":n)&&(n="video"==n?"index?video=1":"index?r="+n),e||(n="index"),d.app.curation()&&(n="userpage"),d.nav.api.go({href:n,history:!0,open:!0,handler:!0})})}},activate:{click:function(){dialog({header:d.app.localization.e("id167"),html:d.app.localization.e("id168"),class:"one",btn1text:d.app.localization.e("id169"),success:function(){d.app.platform.sdk.user.activateWithDialogs(function(e){})}})}},keyexport:{click:function(){d.app.platform.ui.showmykey()},init:function(n){d.app.platform.sdk.registrations.clbks.menu=function(){if(d.sdk.address.pnet()){var e=d.sdk.address.pnet().address;if((e=d.app.platform.sdk.registrations.storage[e])&&e<=4)return}n.closest(".keyexportWrapper").remove(),delete d.app.platform.sdk.registrations.clbks.menu}}},notifications:{init:function(e){function n(){return _.filter(d.app.platform.sdk.notifications.storage.notifications,function(e){if(e.seen)return!1;var n=null;return e.mesType&&(n=d.app.platform.ws.messages[e.mesType]),!!(n=e.msg&&!n?d.app.platform.ws.messages[e.msg]:n)&&!!n.fastMessage(e)})}d.app.platform.sdk.notifications.init(function(){r.ahnotify(e,n().length,"notifications")}),isMobile()||d.nav.api.load({eid:"menu",open:!0,id:"notifications",el:e,inTooltip:!0}),d.app.platform.sdk.notifications.clbks.added.menu=d.app.platform.sdk.notifications.clbks.seen.menu=function(){r.ahnotify(e,n().length,"notifications")}},click:function(e){isMobile()&&d.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0})}},messenger:{init:function(e){function n(){var a=0;return _.each(t.storage.chat,function(e,n){a+=e.messages.unreaded}),a}var t=d.app.platform.clientrtc.rtchttp;d.app.platform.clientrtc.rtchttp.info.allchats(function(){r.ahnotify(e,n(),"chat")}),d.app.platform.sdk.messenger.clbks.menu=function(){r.ahnotify(e,n(),"chat")}},click:function(e){isMobile()?d.nav.api.load({href:"messenger",history:!0,open:!0}):d.nav.api.go({href:"userpage?id=messenger&report=messenger",history:!0,open:!0})}},savecross:{init:function(n){var e=deep(d.app,"platform.sdk.user.storage.me.rc")||0;r.ah(n,e),d.app.platform.ws.messages.event.clbks.menusave=function(e){"userInfo"==e.mesType&&(e=deep(d.app,"platform.sdk.user.storage.me.rc")||0,r.ah(n,e))}},click:function(){d.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{rescue:!0}})}},search:{click:function(){s.c.addClass("searchactive"),searchBackAction=null,s.postssearch.find("input").focus(),s.postssearch.addClass("active"),a&&(clearTimeout(a),a=null)}},searchinit:{init:function(n){function i(e){"index"!=d.app.nav.current.href||e?(n.find("input").val(""),f(),o()):searchBackAction&&(searchBackAction(),searchBackAction=null)}function r(e,n,a,t){u.results(e,n,function(e){a(e,function(e,a){bgImages(e),d.app.nav.api.links(null,e,function(){a.closeResults(),o()}),e.find(".user").on("click",function(){var e=$(this).attr("address"),n=$(this).attr("name");d.nav.api.go({href:n?n.toLowerCase():"author?address="+e,history:!0,open:!0}),a.closeResults(),i(),o()})})},t)}var o=function(){a&&(clearTimeout(a),a=null)};l=new search(s.postssearch,{placeholder:d.app.localization.e("e13139"),right:!0,clbk:function(e){e.find("input").on("blur",function(){a=slowMade(function(){i()},a,200)})},last:{get:function(){var a=[],t={};return _.each(d.sdk.activity.latest,function(e,n){_.each(e,function(e){t[e.type]||(t[e.type]=0),7<=t[e.type]||(t[e.type]++,a.push(e))})}),a=_.uniq(a,function(e){return e.type+e.index}),a=_.sortBy(a,function(e){return-Number(e.date)})},tpl:function(e,n){r(e,"",n)}},events:{fastsearch:function(i,o){var s={},c={};d.app.platform.sdk.search.get(i,"users",null,null,null,function(e){var n,a="user",t=e.data;e=e.count,s[a]=_.map(t,function(e){var n={type:a,data:e};return n.id=e.address,n.index=e.name,n}),c[a]=e,r((n=[],_.each(["user","tag"],function(e){n=n.concat(s[e]||[])}),n),i,o,{counts:c})})},search:function(e,n,a,t){e={href:-1<e.indexOf("#")?"index?sst="+_.uniq(_.filter(e.replace(/#/g,"").split(/[,.!?;:() \n\r]/g),function(e){return e})).join(" "):"index?ss="+e,history:!0,open:!0},c&&(e.handler=!0),d.nav.api.go(e),t.closeResults(),o(),n&&n(!0)},clear:function(e){e||(n.find("input").blur(),setTimeout(function(){i(!0),o()},100),(parameters().sst||parameters().ss)&&d.nav.api.go({href:"index",history:!0,open:!0}))},blank:function(){p.search.click()}}})}},newaccount:{click:function(){d.nav.api.go({href:"registration",history:!0,open:!0})}},state:{init:function(e){function n(){_.isEmpty(d.app.errors.state)?e.addClass("hidden"):e.removeClass("hidden")}n(),d.app.errors.clbks.menu=function(){n()},e.tooltipster({theme:"tooltipster-light",maxWidth:300,zIndex:200})}},wallets:{click:function(){d.nav.api.go({open:!0,href:"userpage?id=wallet",history:!0})},init:function(t){function e(){d.app.platform.sdk.node.transactions.get.allBalance(function(e){var a,n=(e+=d.app.platform.sdk.node.transactions.tempBalance())-s;o&&(n=0,s=e),o=!1,a=s,t.removeClass("hidden"),0==n?(i.text(d.app.platform.mp.coin(a)),r.elswidth()):i.animateNumber({number:n,numberStep:function(e,n){e=Number(a+e).toFixed(8),$(n.elem).text(d.app.platform.mp.coin(e))}},rand(400,1200),function(){t.removeClass("good"),r.elswidth()}),s=e,d.app.platform.sdk.wallet.drawSpendLine(t.find(".numberWrp"))})}var i=t.find(".number"),o=!0,s=0;d.app.platform.sdk.node.transactions.clbks.menu=e,e()}},signout:{click:function(){d.app.user.signout(),d.app.reload({href:"authorization"})}},signin:{init:function(e){},click:function(){d.nav.api.go({href:"authorization",history:!0,open:!0})}},signup:{init:function(e){},click:function(){d.nav.api.go({href:"registration",history:!0,open:!0})}}},u={results:function(e,n,a,t){d.shell({name:"results",data:{results:e,value:n,counts:(t=t||{}).counts||{}}},function(e){a&&a(e.rendered)})}},f=function(){s.c&&s.c.removeClass("searchactive"),s.postssearch&&s.postssearch.find(".search").removeClass("fastSearchShow")};return{getdata:function(e,n){var a={};i.value=app.localization.current().name,a.loc=i,a._SEO=_SEO,a.lkey=app.localization.current();var t=deep(app,"platform.sdk.user.storage.me");a.haschat=d.app.platform.matrixchat.core&&t&&!(t.temp||t.relay||t.fromstorage),n.state?(n=d.sdk.address.pnet().address,d.app.platform.sdk.registrations.showprivate()&&(a.key=!0),d.app.platform.sdk.users.getone(n,function(){e(a)})):e(a)},destroy:function(){e(),r.ahnotifyclear(),l=null,$(window).off("resize",r.elswidth),delete d.app.platform.sdk.newmaterials.clbks.update.menu,delete d.app.platform.sdk.node.transactions.clbks.menu,delete d.app.platform.ws.messages.event.clbks.menusave,delete d.app.platform.sdk.notifications.clbks.seen.menu,delete d.app.platform.sdk.notifications.clbks.added.menu,delete d.app.platform.sdk.messenger.clbks.menu,delete d.app.errors.clbks.menu,delete d.app.platform.sdk.registrations.clbks.menu,delete d.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu,delete d.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu2,_.each(p,function(e){delete e.el,e.destroy&&e.destroy()}),s={}},closesearch:function(){f()},showsearch:function(e,n){console.log("showsearch",e,n),e?(s.c.addClass("searchactive"),s.postssearch.find(".search").addClass("searchFilled")):s.postssearch.find(".search").removeClass("searchFilled"),s.postssearch.find("input").val(e.replace("tag:","#")),searchBackAction=n||null,r.elswidth(),setTimeout(function(){r.elswidth()},2)},initauthorsearch:function(e){e.data&&(l&&l.placeholder(d.app.localization.e("e13140")+" "+e.data.name.toUpperCase()),c=e)},destroyauthorsearch:function(){e()},init:function(e){var n,a;(s={}).c=e.el.find("#"+d.map.id),s.a=e.el.find(".additionalbar"),s.cart=s.c.find(".cart"),s.likes=s.c.find(".favorites"),s.messagesCount=s.c.find(".dialogs .count"),s.notificationsCount=s.c.find(".notifications .count"),s.walletsAmount=s.c.find(".wallets .amount"),s.notactive=s.c.find(".notactive"),s.currency=s.c.find(".currencyWrapper"),s.postssearch=s.c.find(".postssearch"),s.nav=s.c.find(".menutoppanel"),r.ahnotifyclear(),d.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu2=function(e){r.ahnotify(null,e,"chat")},s.c.find(".localization").on("click",function(){var e=[];_.each(d.app.localization.available,function(a){e.push({text:a.name,action:function(e){var n=app.localization.findByName(a.name);n&&n.key!=d.app.localization.key&&d.app.localization.set(n.key),e()}})}),menuDialog({items:e})}),d.app.platform.sdk.newmaterials.clbks&&(d.app.platform.sdk.newmaterials.clbks.update.menu=t),s.c.find("[events]").each(function(){var a=$(this),e=a.attr("events");p[e]&&(p[e].el=a,_.each(p[e],function(e,n){"init"==n?e(a):a.on(n,e)}))}),$(window).on("resize",r.elswidth),ParametersLive([i],s.c),"undefined"!=typeof _Electron&&(n=require("electron").remote,a=function(){n.getCurrentWindow().isFullScreen()?s.c.addClass("fullscreen"):s.c.removeClass("fullscreen")},s.c.find(".closeApp").on("click",function(){n.getCurrentWindow().close()}),s.c.find(".miniizeApp").on("click",function(){n.getCurrentWindow().minimize()}),s.c.find(".toggleMinMax").on("click",function(){var e=n.getCurrentWindow();e.setFullScreen(!e.isFullScreen()),a()}),a()),d.app.user.isState(function(e){!parameters().ss&&!parameters().sst||!isMobile()&&"s"!=d.app.nav.get.pathname()||(s.c.addClass("searchactive"),s.c.find(".postssearch").addClass("active"),r.elswidth(),s.postssearch.find("input").val(parameters().ss.replace("tag:","#")))}),e.clbk(null,e)}}}var d=new nModule,t={};return d.run=function(e){var n=d.addEssense(t,a,e);d.init(n,e)},d.stop=function(){_.each(t,function(e){e.destroy()})},d.initauthorsearch=function(n){_.each(t,function(e){e.initauthorsearch(n)})},d.destroyauthorsearch=function(){_.each(t,function(e){e.destroyauthorsearch()})},d.closesearch=function(){_.each(t,function(e){e.closesearch()})},d.showsearch=function(n){_.each(t,function(e){e.showsearch(n)})},d}();"undefined"!=typeof module?module.exports=menu:(app.modules.menu={},app.modules.menu.module=menu);
 /*_____*/ 
var toppanel=function(){function n(e){function a(a){var n=function(){var e={index:"index",sub:"index?r=sub",recommended:"index?r=recommended"};l.app.platform.videoenabled&&(e.video="index?video=1");var a=_.toArray(e),n=parameters(l.app.nav.current.completeHref,!0).r||"index",t=parameters(l.app.nav.current.completeHref,!0).video||!1,p=e[n],o=[l.app.localization.e("e13136"),l.app.localization.e("e13137"),l.app.localization.e("e13138")];return l.app.platform.videoenabled&&(p=e[t?"video":n],o.push(l.app.localization.e("video"))),(o=new Parameter({type:"VALUES",name:"Contents",id:"contents",possibleValues:a,possibleValuesLabels:o,defaultValue:p})).value=p,o._onChange=function(e){l.nav.api.load({open:!0,href:e,history:!0})},o}();l.app.user.isState(function(e){e&&isMobile()&&"index"!=a?(t.c.addClass("hidden"),$("html").removeClass("toppanelshowed")):(t.c.removeClass("hidden"),$("html").addClass("toppanelshowed"),l.shell({name:"menu",el:t.menu,data:{pathname:a,state:e,mobile:isMobile(),selector:n}},function(e){p(),ParametersLive([n],e.el)}))})}var t,e=deep(e,"history"),p=function(){var e=l.app.platform.sdk.newmaterials.storage;t.c&&_.each(e,function(e,a){(a=t.c.find('.lentaunseen[key="'+a+'"]')).html(e=99<e?"99":e),e?a.addClass("hasunseen"):a.removeClass("hasunseen")})};return{primary:e,getdata:function(e){e({})},destroy:function(){delete l.app.platform.sdk.newmaterials.clbks.update.toppanel,delete l.app.nav.clbks.history.toppanel,t={}},init:function(e){(t={}).c=e.el.find("#"+l.map.id),t.menu=t.c.find(".panelitems"),l.app.nav.clbks.history.toppanel=function(e){a(app.nav.current.href)},l.app.platform.sdk.newmaterials.clbks&&(l.app.platform.sdk.newmaterials.clbks.update.toppanel=p),a(l.app.nav.current.href),e.clbk(null,e)}}}var l=new nModule,t={};return l.run=function(e){var a=l.addEssense(t,n,e);l.init(a,e)},l.stop=function(){_.each(t,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=toppanel:(app.modules.toppanel={},app.modules.toppanel.module=toppanel);
 /*_____*/ 
var navigation=function(){function a(n){function e(n){250<=n?r.c.addClass("scrolled"):r.c.removeClass("scrolled")}function a(){250<=c.scrollTop()?r.c.addClass("scrolled"):r.c.removeClass("scrolled")}function l(){var n=deep(d,"app.modules.main.module.scrolltopall");n&&n(),_scrollTop(0,null,0)}function o(n){var e=d.app.nav.api.backChainIndex(),a=localStorage.lentakey||e+"?b=true";-1==(a=a==e?e+"?b=true":a).indexOf("?")&&(a="video"==a?e+"?video=1":e+"?r="+a);var o=parameters().video,i=d.app.nav.api.backChainGet();d.shell({name:"menu",inner:html,el:r.menu,data:{back:i,href:n,lentakey:a,indexkey:e,shw:o,haschat:d.app.platform.matrixchat.core}},function(n){n.el.find(".toup").on("click",l),n.el.find(".matrixchat").on("click",function(){var n=deep(d,"app.platform.matrixchat.core.apptochat");n&&n()})})}function i(){r.c&&r.c.closest("#navigationWrapper").addClass("hidden")}function t(){r.c&&r.c.closest("#navigationWrapper").removeClass("hidden")}var r,c,n=deep(n,"history");return{primary:n,getdata:function(n,e){console.log("P",e),c=$(window),n({})},destroy:function(){d.app.scrolling&&delete d.app.scrolling.clbks.navigation,window.removeEventListener("scroll",a),window.cordova&&(window.removeEventListener("keyboardWillShow",i),window.removeEventListener("keyboardWillHide",t)),delete d.app.nav.clbks.history.navigation,r&&(r.c&&r.c.remove(),r={})},init:function(n){(r={}).c=n.el.find("#"+d.map.id),r.menu=r.c.find(".nmenu"),d.app.nav.clbks.history.navigation=function(n){r.c.removeClass("scrolled"),o(d.app.nav.get.pathname())},r.c.find(".fakem").on("click",function(){$("html").removeClass("scrollmodedown")}),window.addEventListener("scroll",a),a(),window.cordova&&(window.addEventListener("keyboardWillShow",i),window.addEventListener("keyboardWillHide",t)),d.app.scrolling&&(d.app.scrolling.clbks.navigation=e),n.clbk(null,n),o(d.app.nav.get.pathname())}}}var d=new nModule,o={};return d.run=function(n){var e=d.addEssense(o,a,n);d.init(e,n)},d.stop=function(){_.each(o,function(n){n.destroy()})},d}();"undefined"!=typeof module?module.exports=navigation:(app.modules.navigation={},app.modules.navigation.module=navigation);
 /*_____*/ 
var notifications=function(){function i(e){function l(){var n=c.c.find(".notification:not(.seen)");n.length&&(t=slowMade(function(){p.app.platform.sdk.notifications.seenall(),0<n.length&&n.addClass("seen")},t,50))}function a(){p.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0}),p.closeContainer()}function s(){l()}var c,t,r,n=deep(e,"history"),d="",f={notifications:function(t,n){var e,i,o,a,s=(t=t||{}).notifications||p.app.platform.sdk.notifications.storage.notifications,r=!1;t.el=c.new,t.el&&(p.app.platform.currentTime(),t.seenFilter,e=-s.length+(t.notifications||p.app.platform.sdk.notifications.storage.notifications).length,s=_.sortBy(s,function(n){return Number(-n.nblock)}),i=new Date,s=_.filter(s,function(n){var t=null;return n.mesType&&(t=p.app.platform.ws.messages[n.mesType]),!(!(t=n.msg&&!t?p.app.platform.ws.messages[n.msg]:t)||!t.fastMessage(n)&&(console.log("empty",n),1))}),o=group(s,function(n){return t.now?"ntnow":(n=new Date(1e3*n.time)).addMinutes(60)>i?"ntlasthour":dateToStrSmall(n)==dateToStrSmall(i)?"nttoday":n.getFullYear().toString()+(n.getMonth()+1).toString()==i.getFullYear().toString()+(i.getMonth()+1).toString()?"ntmounth":"ntearlier"}),t.now&&((a=t.el.find('.group[index="ntnow"]')).length&&(t.el=a.find(".groupContent")),r=!0),p.shell({name:"notifications",el:t.el,data:{notifications:s,ws:p.app.platform.ws,now:t.now,grou:o,rnow:r},inner:prepend},function(i){f.loadingAndEmpty(),e&&c.c.find(".more").html("("+e+")");var o=p.app.platform.ws;_.each(s,function(n){var t=null;n.mesType&&(t=o.messages[n.mesType]),(t=n.msg&&!t?o.messages[n.msg]:t)&&t.fastMessageEvents&&t.fastMessageEvents(n,{el:i.el.find('.notification[notification="'+n.txid+'"]')})}),p.app.nav.api.links(null,c.c,function(){p.closeContainer()}),l()}))},loadingAndEmpty:function(){if(p.app.errors.connection())return c.loader.addClass("hidden"),c.empty.addClass("hidden"),void c.error.removeClass("hidden");c.error.addClass("hidden"),p.app.platform.sdk.notifications.loading?c.loader.removeClass("hidden"):(c.loader.addClass("hidden"),c.c.find(".notification").length?c.empty.addClass("hidden"):(c.empty.removeClass("hidden"),c.loader.addClass("hidden")))}};return{primary:n,getdata:function(n){var t={};e.notifications||p.app.platform.sdk.notifications.storage.notifications?n(t):p.app.platform.sdk.notifications.init(function(){n(t)})},destroy:function(){c={},d="",t&&clearTimeout(t),t=null,r.removeEventListener("scroll",s),delete p.app.platform.sdk.notifications.clbks.added["notifications"+d],delete p.iclbks.lenta},init:function(n){var i,o,t;(c={}).c=n.el.find("#"+p.map.id),c.new=c.c.find(".newWrapper"),c.loader=c.c.find(".loader"),c.empty=c.c.find(".empty"),c.error=c.c.find(".error"),"tooltip"==n.insert?(r=c.c.find(".nabsContentWrapper")[0],d="tt"):(d="",r=window),jinel=$(r),f.loadingAndEmpty(),c.c.find(".showAll").on("click",a),r.addEventListener("scroll",s),c.c.find(".closecontainer").on("click",function(){p.closeContainer()}),p.iclbks.lenta=function(){f.loadingAndEmpty()},isMobile()&&(i=c.c.find(".circularprogress"),(o=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),c.c.find(".circularprogressWrapper").html(o.el),t=$(window),new SwipeParallaxNew({el:c.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(n){var t=Math.abs(n)/90;0<=n&&(o.options.text={value:""},o.update(100*t),i.height(220*t+"px"))},constraints:function(){if(0==t.scrollTop())return!0},restrict:!0,trueshold:90,clbk:function(){p.app.platform.sdk.notifications.getNotifications(function(){})}}}}).init()),n.insert,f.notifications({seenFilter:e.inTooltip}),p.app.platform.sdk.notifications.clbks.added["notifications"+d]=function(n,t){f.notifications({notifications:n,now:t})},n.clbk(null,n)},tooltip:{options:{theme:"lighttooltip notificationTolltip",position:"left",zIndex:50,distance:-47,functionPosition:function(n,t,i){return i.coord.top=0,i.coord.left=0,i},arrow:!1,trigger:"custom",triggerOpen:{click:!0},triggerClose:{}}}}}var p=new nModule,o={};return p.run=function(n){var t=p.addEssense(o,i,n);p.init(t,n)},p.stop=function(){_.each(o,function(n){n.destroy()})},p}();"undefined"!=typeof module?module.exports=notifications:(app.modules.notifications={},app.modules.notifications.module=notifications);
 /*_____*/ 
var imageGalleryEdit=function(){function a(e){function a(){var e=$(this).attr("action");m[e]()}function n(){var e=$(this).attr("action"),i=$(this);m[e]()?i.addClass("active"):i.removeClass("active")}var t,r,e=deep(e,"history"),l=null,o=0,s=!1,d=null,c=null,f=null,p={normal:{name:"Normal"},vintage:{name:"Vintage"},oldBoot:{name:"Old Boot"},clarity:{name:"Clarity"},sunrise:{name:"Sunrise"},crossProcess:{name:"Cross Process"},orangePeel:{name:"Orange Peel"},love:{name:"Love"},jarques:{name:"Jarques"},pinhole:{name:"Pinhole"}},u={},m={back:function(){--o<0&&(o=r.images.length-1),v()},next:function(){++o>=r.images.length&&(o=0),v()},initialValue:function(){r.initialValue&&(o=r.initialValue)},filters:function(){return(s=!s)?(t.c.addClass("filters"),h.filters()):t.c.removeClass("filters"),g.resize(),s},caman:function(e,i){var a=i||"#galleryImage";c&&!i?e&&e(c):Caman(a,function(){i||(c=this),e&&e(this)})},crop:function(){return d?(d.destroy(),d=null,!1):(m.caman(function(){var e=t.imagesWrapper.find("#galleryImage"),i=e.parent();l=c,r.crop||(r.crop={}),d=new Cropper(e[0],{aspectRatio:r.crop.aspectRatio||null,autoCropArea:r.crop.autoCropArea||.9,checkOrientation:!1,crop:function(e){var i=c.width,a=c.height,a={x:e.detail.x/i,y:e.detail.y/a,w:e.detail.width/i,h:e.detail.height/a};u.crop=a},ready:function(){i.find(".cropper-container").addClass(r.crop.style||""),i.find(".cropper-crop-box").append('<div class="applyCrop center" action="apply">\t\t\t\t\t\t\t\t\t<span class="fa fa-check" aria-hidden="true"></span>\t\t\t\t\t\t\t\t</div>'),i.find(".applyCrop").on("click",function(){m.apply("crop"),h.savePanel()})}})}),!0)},camanFilter:function(e,i,a){e.revert(!1),"normal"!=i&&e.newLayer(function(){this.opacity(50),this.copyParent(),this.filter[i]()}),e.render(a)},previewFilter:function(e,i){var a=e.attr("filter"),n=e.attr("imageId");Caman("#"+n,function(){m.camanFilter(this,a,function(){e.animate({opacity:1})})}),e.on("click",function(){m.caman(function(){m.camanFilter(c,a,function(){l=c,u.filter=a,h.savePanel(),g.resize()})})})},applyFilters:function(t,e,r,l){"crop"!=e?"filter"==e&&m.caman(function(e){m.camanFilter(e,t,function(){l&&l()})},r):m.caman(function(e){var i=e.canvas.width,a=e.canvas.height,n={x:t.x*i,y:t.y*a,width:t.w*i,height:t.h*a};e.crop(n.width,n.height,n.x,n.y),e.resize({width:n.width,height:n.height}),e.render(function(){e.resetOriginalPixelData(),e.cropped=!1,e.cropCoordinates={x:0,y:0},e.originalHeight=n.height,e.originalWidth=n.width,e.preScaledHeight=n.height,e.preScaledWidth=n.width,e.resized=!1,r||g.resize(),l&&l()})},r)},apply:function(e,i){e&&u[e]&&(m.applyFilters(u[e],e,i),m[e](),t.c.find('[action="'+e+'"]').removeClass("active"))},close:function(){r.success?(topPreloader(20),r.success(r.images,function(){topPreloader(100),y.closeContainer()})):y.closeContainer()},exit:function(){r.apply&&(m.apply("crop"),m.save(!0)),m.close()},cancel:function(){u={},h.savePanel(),h.image({image:f})},save:function(e){m.checkUpdates()&&(f.original=c.toBase64(),u={},e||(h.savePanel(),h.image({image:f})))},checkUpdates:function(){return!!(u.filter&&"normal"!=u.filter||u.crop)}},g={resize:function(){g.bestFit(t.imagesWrapper.find(".image"),l)},bestFit:function(e,i){var a=e.closest(".imagesAbsWrapper"),n=e.find(".imgWrapper"),t=i.naturalWidth||i.width,r=i.naturalHeight||i.height,l=r/t;e.css("padding-top","0px");var o=e.width(),s=e.height(),c=a.width();(s=(a=a.height())<s?a:s)<=(r=(o=c<o?c:o)<t?(t=o)*l:r)&&(t=(r=s)/l),e.css("padding-top",(s-r)/2+"px"),i.canvas?(i.resize({width:t,height:r}),i.render()):(i.width=t,i.height=r,$(i).attr("data-camanwidth",t),$(i).attr("data-camanheight",r),$(i).css("opacity","1")),n.width(t),n.height(r),d&&d.resize({width:t,height:r})},nFormat:function(e){return e<10?"0"+e:e}},h={savePanel:function(){(u.filter&&"normal"!=u.filter||u.crop)&&!r.apply?t.exitPanel.fadeOut(200,function(){t.savePanel.fadeIn(200)}):t.savePanel.fadeOut(200,function(){t.exitPanel.fadeIn(200)})},image:function(i){c=l=null,u={},h.savePanel(),d&&(d.destroy(),d=null,t.editPanel.find('.eitem[action="crop"]').removeClass("active")),t.imageNavigation.find(".number").html(g.nFormat(Number(o)+1)),$(window).off("resize",g.resize),i=i||{},y.shell({name:"image",el:t.images,inner:html,display:"table",animation:!1,data:{data:r,image:i.image}},function(e){e.el.find("img").imagesLoaded(function(e){l=deep(e,"images.0.img"),f=i.image,g.resize(),$(window).on("resize",g.resize),s&&(s=!s,m.filters()),i.clbk&&i.clbk()})})},filters:function(i){(i=i||{}).image||(i.image=r.images[o]),t.filters.html(""),resizeFit(i.image.original,80,80,function(e){y.shell({name:"filters",el:t.filters,data:{data:r,image:e,filters:p}},function(e){e.el.find(".preview").each(function(){m.previewFilter($(this),i.image)});var r=e.el.find(".filtersSwipe");swipedetect(r[0],function(e,i,a,n){var t=Number(r.css("margin-left").replace("px",""))+Number(1.7*i),i=-r.find(".filtersList").width()+r.closest(".filtersWrapperOvf").width();r.css("margin-left",(t=(t=0<t?0:t)<i?i:t)+"px")})})})}},v=function(){h.image({image:r.images[o],clbk:function(){r.apply&&(m.filters(),m.crop())}})};return{primary:e,getdata:function(e){e({})},destroy:function(){$(window).off("resize",g.resize),t={}},init:function(e){var i;f=l=c=null,s=!1,u={},r=e.essenseData||{},m.initialValue(),(t={}).c=e.el.find("#"+y.map.id),t.imagesWrapper=e.el.find(".imagesWrapper"),t.images=e.el.find(".images"),t.imageNavigation=e.el.find(".imageNavigation"),t.arrows=t.imageNavigation.find(".arrow"),t.editPanel=t.c.find(".editPanel"),t.savePanel=t.c.find(".panel .savePanel"),t.exitPanel=t.c.find(".panel .exitPanel"),t.filters=t.c.find(".filters"),i=function(){v(),t.arrows.on("click",a),t.editPanel.find(".eitem").on("click",n),t.savePanel.find(".sitem").on("click",n),t.exitPanel.find(".sitem").on("click",n),e.clbk(null,e)},r.edit?y.nav.api.loadRelations({relations:[{src:"js/vendor/caman.full.min.js",f:"js",require:function(){Caman=require("../../js/vendor/caman.full.min.js").Caman}},{src:"js/vendor/cropper.js",f:"js",require:function(){Cropper=require("../../js/vendor/cropper.js")}},{src:"css/cropper.min.css",f:"css"}]},i):i&&i()},wnd:{close:function(){r.close&&r.close()},class:"allscreen black withoutButtons imageGalleryEdit"}}}var y=new nModule,n={};return y.run=function(e){var i=y.addEssense(n,a,e);y.init(i,e)},y.stop=function(){_.each(n,function(e){e.destroy()})},y}();"undefined"!=typeof module?module.exports=imageGalleryEdit:(app.modules.imageGalleryEdit={},app.modules.imageGalleryEdit.module=imageGalleryEdit);
 /*_____*/ 
var panel=function(){function s(n){var c,n=deep(n,"history"),e=null,s=null,t=null,a=null,i=null,l={tags:function(){o.nav.api.load({open:!0,id:"tagcloud",el:c.tags,animation:!1,clbk:function(n,e){s=e}})},stacking:function(){o.nav.api.load({open:!0,id:"staking",el:c.stacking,animation:!1,clbk:function(n,e){a=e}})},recommendationslist:function(n,e){n.length&&c.c&&o.shell({name:"recommendationslist",el:c.r.find(".userslist"),data:{users:n},bgImages:{clbk:function(n){$(n.elements[0]).addClass("active")}}},function(n){e&&e()})},lastcomments:function(n){o.nav.api.load({open:!0,id:"lastcomments",el:c.comments,animation:!1,clbk:function(n,e){t=e},essenseData:{renderclbk:function(){i.renderclbk&&i.renderclbk()}}})},recommendations:function(r,n){r.length&&c.c?o.shell({name:"recommendations",el:c.r,data:{users:r}},function(o){l.recommendationslist(r,function(){var e=0,s=4,t=o.el.find(".userslist"),a=o.el.find(".arrow"),i={uleft:o.el.find(".uleft"),uright:o.el.find(".uright")},l={clickArrow:function(n){"left"==n&&(e-=s)<0&&(e=0),"right"==n&&(e+=s)>=r.count&&(e=r.count-1),l.slideCarousel()},displayArrows:function(){0<e?l.displayArrow("left",!0):l.displayArrow("left",!1),e+s<r.length?l.displayArrow("right",!0):l.displayArrow("right",!1)},displayArrow:function(n,e){n=n?i["u"+n]:a,e?n.addClass("active"):n.removeClass("active")},slideCarousel:function(){var n=c.c.find(".user").width(),n=e*n;t.css("margin-left","-"+n+"px"),l.displayArrows()},applyCarousel:function(){var n=o.el.find(".user").width(),e=o.el.find(".userslistwrapper").width();s=Math.min(Number((e/n).toFixed(0)),4),c.c.find(".user").width((e/s).toFixed(0)+"px"),t.width((r.length*(e/s)).toFixed(0)+1),l.slideCarousel()}};l.applyCarousel(),o.el.find(".arrow").on("click",function(){var n=$(this).attr("arrow");l.clickArrow(n)})})}):c.r.html("")},discussions:function(e){o.shell({name:"discussiondummy",el:c.cnt,data:{}},function(n){e&&e()})},_discussions:function(){o.user.isState(function(n){n&&((n=o.app.platform.sdk.users.storage[o.app.platform.sdk.address.pnet().address]).relay||n.temp||l.discussions())})}};return{primary:n,getdata:function(n,e){i=e.settings.essenseData||{},n({})},destroy:function(){delete o.app.platform.clbks.api.actions.subscribe.panelrec,delete o.app.platform.ws.messages.event.clbks.panel,e&&(e.destroy(),e=null),s&&(s.destroy(),s=null),t&&(t.destroy(),t=null),a&&(a.destroy(),a=null),c={}},authclbk:function(){},init:function(n){(c={}).c=n.el.find("#"+o.map.id),c.cnt=c.c.find(".panelcnt"),c.tags=c.c.find(".tagscnt"),c.comments=c.c.find(".lastcommentscnt"),c.stacking=c.c.find(".stackingcnt"),c.r=c.c.find(".recommendationscnt"),o.app.platform.clbks.api.actions.subscribe.panelrec=function(){var s;s=function(n){l.recommendations(n)},o.app.user.isState(function(n){var e;n?(e=o.sdk.address.pnet().address,o.sdk.users.get(e,function(){var n=deep(o,"sdk.users.storage."+e+".recomendedSubscribes");n&&n.length?o.sdk.users.get(n,function(){s&&s(n)}):s&&s([])})):s&&s([])})},o.app.platform.ws.messages.event.clbks.panel=function(n){"userInfo"==n.mesType&&l._discussions()},o.app.platform.sdk.usersettings.meta.vidgetchat.value&&l._discussions(),o.app.platform.sdk.usersettings.meta.vidgetlastcomments.value&&l.lastcomments(),deep(o.app.platform,"released.vidgets.staking")&&deep(o.app.platform.sdk,"usersettings.meta.vidgetstaking.value")&&l.stacking(),n.clbk(null,n)}}}var o=new nModule,t={};return o.authclbk=function(){_.each(t,function(n){n.authclbk()})},o.run=function(n){var e=o.addEssense(t,s,n);o.init(e,n)},o.stop=function(){_.each(t,function(n){n.destroy()})},o}();"undefined"!=typeof module?module.exports=panel:(app.modules.panel={},app.modules.panel.module=panel);
 /*_____*/ 
var aboutus=function(){function o(u){u=deep(u,"history");return{primary:u,getdata:function(u){u({})},destroy:function(){},init:function(u){u.el.find("#"+t.map.id),u.clbk(null,u)}}}var t=new nModule,e={};return t.run=function(u){var n=t.addEssense(e,o,u);t.init(n,u)},t.stop=function(){_.each(e,function(u){u.destroy()})},t}();"undefined"!=typeof module?module.exports=aboutus:(app.modules.aboutus={},app.modules.aboutus.module=aboutus);
 /*_____*/ 
var support=function(){function t(n){function o(){t.send()}var s,n=deep(n,"history"),t={send:function(){var n=t.values();n?(s.c.removeClass("showError"),topPreloader(20),e.app.platform.sdk.user.support(n,function(){topPreloader(100),dialog({html:e.app.localization.e("contactSuccess"),class:"one"}),$.each(s.inputs,function(){$(this).val("")})})):s.c.addClass("showError")},values:function(){var t={},e=!0;return $.each(s.inputs,function(){var n=(o=$(this)).val(),o=o.attr("systemId");n?t[o]=n:e=!1}),e?t:null}};return{primary:n,getdata:function(n){n({})},destroy:function(){s={}},init:function(n){(s={}).c=n.el.find("#"+e.map.id),s.send=s.c.find(".send"),s.inputs=s.c.find(".forminput"),s.send.on("click",o),n.clbk(null,n)}}}var e=new nModule,s={};return e.run=function(n){var o=e.addEssense(s,t,n);e.init(o,n)},e.stop=function(){_.each(s,function(n){n.destroy()})},e}();"undefined"!=typeof module?module.exports=support:(app.modules.support={},app.modules.support.module=support);
 /*_____*/ 
var leftpanel=function(){function t(n){function e(n,e){var t;r.c&&(t="index",parameters().video&&(t="index?video=1"),o.shell({name:"currentsearch",data:{value:n,backlink:t},el:r.currentsearch},function(n){e&&e()}))}var r,n=deep(n,"history"),t=null,a=null,s=null,c={search:function(){var n;parameters().ss&&e(parameters().ss),parameters().sst&&(n=decodeURI(parameters().sst||""),n=_.uniq(_.filter(n.split(/[,.!?;:() \n\r]/g),function(n){return n})),e(_.map(n,function(n){return"#"+n}).join(" ")))},main:function(){r.c&&o.nav.api.load({open:!0,id:"tagcloud",el:r.tags,animation:!1,clbk:function(n,e){t=e}}),r.c&&o.nav.api.load({open:!0,id:"categories",el:r.cats,animation:!1,clbk:function(n,e){a=e}})},sub:function(){var e;r.c&&o.shell({name:"sub",data:{},el:r.subtop},function(n){e&&e()})},top:function(){var e,t,a;r.c&&(t=o.app.platform.sdk.node.shares.parameters.get(),(a=parameters().page||0)<0&&(a=0),o.shell({name:"top",data:{ps:t,page:a},el:r.subtop},function(n){ParametersLive(_.toArray(t),n.el),t.period.onChange=function(){a&&(o.nav.api.history.removeParameters(["page"]),c.top()),s.changed&&s.changed()},e&&e()}))}};return{primary:n,getdata:function(n,e){s=e.settings.essenseData||{},n({})},destroy:function(){t&&(t.destroy(),t=null),a&&(a.destroy(),a=null),r={}},authclbk:function(){},init:function(n){var e;(r={}).c=n.el.find("#"+o.map.id),r.cnt=r.c.find(".leftpanelcnt"),r.tags=r.c.find(".tagscnt"),r.cats=r.c.find(".catscnt"),r.currentsearch=r.c.find(".currentsearchcnt"),r.subtop=r.c.find(".subtop"),(e=parameters()).sst||e.ss?c.search():"sub"!=e.r?"recommended"!=e.r?c.main():c.top():c.sub(),n.clbk(null,n)}}}var o=new nModule,a={};return o.authclbk=function(){_.each(a,function(n){n.authclbk()})},o.run=function(n){var e=o.addEssense(a,t,n);o.init(e,n)},o.stop=function(){_.each(a,function(n){n.destroy()})},o}();"undefined"!=typeof module?module.exports=leftpanel:(app.modules.leftpanel={},app.modules.leftpanel.module=leftpanel);
 /*_____*/ 
var footer=function(){function o(a){var e,a=deep(a,"history"),o=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),possibleValuesLabels:app.localization.availableMap("name"),format:{right:!0},_onChange:function(a){(a=app.localization.findByName(a))&&a.key!=app.localization.key&&app.localization.set(a.key)}});return{primary:a,getdata:function(a){var e={};e._SEO=_SEO,e.loc=o,a(e)},destroy:function(){e={}},init:function(a){(e={}).c=a.el.find("#"+n.map.id),ParametersLive([o],e.c),a.clbk(null,a)}}}var n=new nModule,i={};return n.run=function(a){var e=n.addEssense(i,o,a);n.init(e,a)},n.stop=function(){_.each(i,function(a){a.destroy()})},n}();"undefined"!=typeof module?module.exports=footer:(app.modules.footer={},app.modules.footer.module=footer);
 /*_____*/ 
var authorization=function(){function o(e){var a,t,i,o=deep(e,"history"),n="secondary",s=null;o&&(n="primary"),e.inWnd&&(n="window");var r=new Parameter({type:"BOOLEAN",name:"stay",id:"stay",name:c.app.localization.e("e13027"),_onChange:function(e){e||(localStorage.stay="0",localStorage.mnemonic,c.app.user.stay=0)}}),l={login:function(){var n={},e=trim(a.login.val());localStorage.stay=boolToNumber(r.value).toString(),c.user.stay=r.value,c.user.signin(e,function(e){e?(c.app.platform.sdk.registrations.remove(),(e={}).href=t.successHref,!e.href&&o&&(e.href=function(){return c.app.user.validate()?"index":c.app.errors.connection()?"userpage?id=test":"filluserfast"}),e.nav=t.nav,e.clbk=function(){topPreloader(100);var e=deep(i,"container.close");e&&e(),t.signInClbk&&t.signInClbk()},"_this"==deep(t,"successHref")?c.app.reloadModules(function(){var e;c.app.user.validate()?((e=deep(i,"container.close"))&&e(),t.signInClbk&&t.signInClbk()):c.nav.api.loadSameThis("filluser",n)}):c.app.reload(e)):sitemessage(c.app.localization.e("e13028"))})}};return{primary:o,id:n,getdata:function(e,n){n.state&&o?c.nav.api.load({open:!0,href:"index",history:!0}):(r.value=numberToBool(c.app.user.stay),localStorage.mnemonic,e({stay:r,mnemonic:"",fast:deep(n,"settings.essenseData.fast")||!1}))},destroy:function(){a={},s&&(s.destroy(),s=null)},init:function(e){var n,o;(a={}).c=e.el.find("#"+c.map.id),a.login=a.c.find(".loginValue"),a.pwd=a.c.find(".pwdValue"),a.enter=a.c.find(".enter"),a.toRegistration=a.c.find(".toRegistration"),a.forgotPassword=a.c.find(".forgotPassword"),t=e.essenseData||{},n=i=e,a.enter.on("click",l.login),a.toRegistration.on("click",function(){c.nav.api.loadSameThis("registration",n)}),a.c.find(".showformh").on("click",function(){a.c.toggleClass("signinshow")}),initUpload({el:a.c.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:a.c,action:function(e,n){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.debug=!0,qrscanner.q.callback=function(e){console.log("data",e),"error decoding QR Code"==e?sitemessage(c.app.localization.e("filedamaged")):(a.login.val(trim(e)),l.login())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(a.login.val(trim(e[1])),l.login()):sitemessage(c.app.localization.e("filedamaged")))}}),a.c.find(".loginValue").on("focus",function(){a.c.find(".inputTable").addClass("typeactive")}),a.c.find(".loginValue").on("blur",function(){a.c.find(".inputTable").removeClass("typeactive")}),o=parameters(),ParametersLive([r],a.c),o.restore&&l.forgotPassword(),t.fast&&c.nav.api.load({open:!0,id:"filluserfast",el:a.c.find(".filluserform"),essenseData:{inauth:!0,successHref:t.successHref,welcomepart:function(){a.c.addClass("welcomepnet")},signInClbk:function(){var e=deep(i,"container.close");e&&e(),t.signInClbk()}},clbk:function(e,n){s=n}}),e.clbk(null,e)},tooltip:{options:{position:"left",functionPosition:function(e,n,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen authwindow"}}}var c=new nModule,a={};return c.run=function(e){var n=c.addEssense(a,o,e);c.init(n,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=authorization:(app.modules.authorization={},app.modules.authorization.module=authorization);
 /*_____*/ 
var discussions=function(){function i(s){var a,c,d,n,s=deep(s,"history"),i={},t={},e={},r=null,o=!1,u=null,l=null,f={preloader:function(s){a.c&&(s?a.c.addClass("loading"):a.c.removeClass("loading"))},inView:function(s,n,i){var t,e,o;_.toArray(c).length&&a.c&&(t=a.c.find(n||".discussion"),n="offset","fixedin"==r.view&&(n="position"),0<(n=inView(t,{inel:d,offset:0,mode:"part",f:n})).length&&(e={},n=_.map(n,function(s){return s=$(s).attr("chat"),e[s]=!0,c[s]}),i&&(o=[],_.each(c,function(s,n){e[n]||o.push(s)}),i(o)),s&&s(n)))},chatp:function(s){f.preloader(!0),retry(function(){if(t[s]||!i[s])return!0},function(){f.chat(c[s])})},chat:function(s){l=!0,h.app.platform.sdk.chats.save();var n={open:!0,href:"oldchat",animation:!1};"fixedin"==r.view?(n.history=!1,n.el=a.c.find(".chatWrapper"),n.essenseData={view:"fixedin",chat:s,destroyClbk:function(){u&&(l=!1,f.preloader(!0),a.c&&a.c.removeClass("forChat"),n.el.html(""),m.discussions(null,function(){u=null,f.preloader(!1),d.scrollTop(0),setTimeout(function(){f.openInView()},100)}))}},n.clbk=function(s,n){u=n,a.c&&(a.c.addClass("forChat"),f.preloader(!1))}):n.href="oldchat?chatid="+s.chat.id,h.nav.api.load(n)},open:function(s,n){},remove:function(s){f.preloader(!0),f.close(s,function(){f.preloader(!1),h.app.platform.sdk.chats.remove(s),c=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),r.author),a.c.find('.discussion[chat="'+s+'"]').remove(),m.empty()})},openInView:function(s){f.inView(function(s){_.map(s,function(s){return s.chat.id}),_.each(s,function(s){f.open(s)})},".discussion:not(.dempty)",function(s){s=_.map(s,function(s){return s.chat.id}),f.closeMany(s)})},close:function(s,n){e[s]?retry(function(){if(!e[s])return!0},n):(e[s]=!0,retry(function(){if(t[s])return!0},function(){h.app.platform.rtc.destroy(s),delete e[s],delete t[s],delete i[s],n()}))},closeMany:function(s,n){lazyEach({array:s,action:function(s){var n=s.item;i[n]?f.close(n,s.success):s.success()},all:{success:function(){n&&n()}}})},closeAll:function(s){var n=_.map(i,function(s,n){return n});lazyEach({array:n,action:function(s){var n=s.item;f.close(n,s.success)},all:{success:function(){i={},t={},e={},s&&s()}}})}},p={inViewScroll:function(){n=slowMade(function(){l||(p.inView(),f.openInView())},n,200)},inView:function(){o||f.inView(function(s){o=!0,h.app.platform.sdk.discussions.info(s,function(s){m.fdiscussions(s,function(){o=!1}),c=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),r.author)})},".discussion.dempty")},chat:function(){var s=$(this).closest(".discussion").attr("chat");f.chatp(s)},remove:function(){var s=$(this).closest(".discussion").attr("chat");f.remove(s)}},m={empty:function(){_.toArray(c).length?a.c.removeClass("sempty"):a.c.addClass("sempty")},message:function(s,n){h.shell({name:"message",inner:html,el:a.list.find('[chat="'+n+'"] .lastMessage'),data:{message:s}},function(s){})},discussion:function(s,n){var i;a.list&&(i=a.list.find('[chat="'+s.chat.id+'"]'),s.share&&s.author?h.shell({name:"discussion",inner:html,el:i,data:{discussion:s}},function(s){i.removeClass("dempty"),s.el.find(".discussioncnt").on("click",p.chat),s.el.find(".remove").on("click",p.remove),n&&n()}):(i.remove(),n&&n()))},fdiscussions:function(s,n){lazyEach({array:_.toArray(s),action:function(s){var n=s.item;m.discussion(n,s.success)},all:{success:function(){f.openInView(),n&&n()}}})},discussions:function(s,n,i){s=s||c,s=_.toArray(s),s=_.sortBy(s,function(s){return-s.chat.time}),h.shell({name:"discussions",inner:i||html,el:a.list,data:{discussions:s}},function(s){p.inView(),n&&n()})},discussionTemp:function(i,t,e){h.shell({name:"discussions",el:a.temp,data:{discussions:i}},function(s){var n=s.el.find(".discussion");h.app.platform.sdk.discussions.info(i,function(s){h.shell({name:"discussion",inner:html,el:n,data:{discussion:i[0],c:t}},function(s){n.removeClass("dempty"),n.on("click",function(){h.app.platform.sdk.chats.add(i[0].chat.id,"share")}),e&&e()})})})}};return{primary:s,getdata:function(s,n){r=n.settings.essenseData||{},o=!1,n=h.app.platform.sdk.address.pnet().address+"addedtochat",localStorage[n]=!0,h.app.platform.sdk.chats.add("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd","share"),n={},c=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),r.author),n.discussions=c,s(n)},destroy:function(){d&&d.off("scroll",p.inViewScroll),delete h.app.platform.sdk.chats.clbks.discussions,f.closeAll(),u&&(u.destroy(),u=null),a={}},init:function(s){i={},opened={},l=!(t={}),(a={}).c=s.el.find("#"+h.map.id),d="fixedin"==r.view?a.c.find(".discussionsWrapper"):$(window),a.list=a.c.find(".list"),a.temp=a.c.find(".gotoDisscussion"),d.on("scroll",p.inViewScroll),h.app.platform.sdk.chats.clbks.discussions=function(s,n,i){if("removeTemp"==n)return a.temp.html(""),void a.temp.fadeOut(1);var t=_.toArray(h.app.platform.sdk.discussions.fromChats([s]));"add"==n&&(c=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),r.author),m.empty(),m.discussions(t,function(){f.chatp(t[0].chat.id)},prepend)),"addTemp"==n&&m.discussionTemp(t,i,function(){}),"addtwice"==n&&(m.discussions(),f.chatp(t[0].chat.id))},f.chatp("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),s.clbk(null,s)}}}var h=new nModule,t={};return h.run=function(s){var n=h.addEssense(t,i,s);h.init(n,s)},h.stop=function(){_.each(t,function(s){s.destroy()})},h}();"undefined"!=typeof module?module.exports=discussions:(app.modules.discussions={},app.modules.discussions.module=discussions);
 /*_____*/ 
var addaccount=function(){function o(n){var o,e,t=deep(n,"history"),i=t?"primary":"secondary";n.inWnd&&(i="window");function a(){var n=trim(o.login.val());e.success&&e.success(n),c.closeContainer()}return{primary:t,id:i,getdata:function(n,e){n({})},destroy:function(){o={}},init:function(n){(o={}).c=n.el.find("#"+c.map.id),o.login=o.c.find(".loginValue"),o.enter=o.c.find(".enter"),e=n.essenseData||{},o.enter.on("click",a),o.login.on("focus",function(){o.c.find(".inputTable").addClass("typeactive")}),o.login.on("blur",function(){o.c.find(".inputTable").removeClass("typeactive")}),initUpload({el:o.c.find(".uploadFile"),notexif:!0,ext:["txt","png","jpeg","jpg"],dropZone:o.c,action:function(n,e){"png"==n.ext||"jpeg"==n.ext||"jpg"==n.ext?grayscaleImage(n.base64,function(n){qrscanner.q.callback=function(n){"error decoding QR Code"==n?sitemessage(c.app.localization.e("filedamaged")):(o.login.val(trim(n)),a())},qrscanner.q.decode(n)}):(n=n.base64.split(",")[1],(n=b64_to_utf8(n).split("/"))[1]?(o.login.val(trim(n[1])),a()):sitemessage(c.app.localization.e("filedamaged")))}}),n.clbk(null,n)},tooltip:{options:{position:"left",functionPosition:function(n,e,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen"}}}var c=new nModule,t={};return c.run=function(n){var e=c.addEssense(t,o,n);c.init(e,n)},c.stop=function(){_.each(t,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=addaccount:(app.modules.addaccount={},app.modules.addaccount.module=addaccount);
 /*_____*/ 
var complain=function(){function a(e){function t(){d?o.next.removeClass("disabled"):o.next.addClass("disabled")}function n(){m.closeContainer()}function a(){var a,e;!o.next.hasClass("disabled")&&d&&(a=function(e){e&&(m.closeContainer(),l.success&&l.success())},e=r.complain(d),topPreloader(30),m.sdk.node.transactions.create.commonFromUnspent(e,function(e,n){topPreloader(100),e?a&&a(!0):(m.app.platform.errorHandler(n,!0),a&&a())}))}function i(){var n,e=$(this).attr("reason");(e=(n=e,_.find(u[s],function(e){return(e.gid||e.id)==n})))&&($(this).hasClass("active")||(o.c.find(".reason").removeClass("active"),d=null,$(this).addClass("active"),e.group?c.selector(e):d=e.id,t()))}var o,s,r,d,l,e=deep(e,"history"),u={post:[{name:"Sexual content",gid:1,group:[{name:"Graphic sexual activity",id:"1"},{name:"Nudity",id:"2"},{name:"Suggestive, but without nudity",id:"3"},{name:"Content involving minors",id:"4"},{name:"Abusive title or description",id:"5"},{name:"Other sexual content",id:"6"}]},{name:"Violent or repulsive content",gid:2,group:[{name:"Adults fighting",id:"7"},{name:"Physical attack",id:"8"},{name:"Youth violence",id:"9"},{name:"Animal abuse",id:"10"}]},{name:"Hateful or abusive content",gid:3,group:[{name:"Promotes hatred or violence",id:"11"},{name:"Abusing vulnerable individuals",id:"12"},{name:"Bullying",id:"13"},{name:"Abusive title or description",id:"14"}]},{name:"Harmful dangerous acts",gid:4,group:[{name:"Pharmaceutical or drug abuse",id:"19"},{name:"Abuse of fire or explosives",id:"20"},{name:"Suicide or self injury",id:"21"},{name:"Other dangerous acts",id:"22"}]},{name:"Child abuse",id:"23"},{name:"Promotes terrorism",id:"24"},{name:"Spam or misleading",gid:6,group:[{name:"Mass advertising",id:"25"},{name:"Pharmaceutical drugs for sale",id:"26"},{name:"Misleading text",id:"27"},{name:"Misleading thumbnail",id:"28"},{name:"Scams / fraud",id:"29"}]},{name:"Infringes my rights",gid:7,group:[{name:"Infringes my copyright",id:"30"},{name:"Invades my privacy",id:"31"},{name:"Other legal claim",id:"32"}]}]},c={reasons:function(){m.shell({name:"reasons",inner:html,el:o.reasons,data:{reasons:u[s]}},function(e){e.el.find(".reason").on("click",i)})},selector:function(e){var n=o.c.find('.reason[reason="'+e.gid+'"] .reasongroupIn'),a=_.map(e.group,function(e){return e.name}),i=_.map(e.group,function(e){return e.id}),s=new Parameter({type:"VALUES",name:e.name,id:e.gid,possibleValues:i,possibleValuesLabels:a,placeholder:"Choose one"});s._onChange=function(e){d=e||null,t()},m.shell({name:"selector",inner:html,el:n,data:{selector:s}},function(e){ParametersLive([s],e.el)})}};return{primary:e,getdata:function(e,n){d=null,s=deep(n,"settings.essenseData.item")||"post",r=deep(n,"settings.essenseData.obj")||null,l=n.settings.essenseData||{},r&&e({ess:s})},destroy:function(){o={}},init:function(e){(o={}).c=e.el.find("#"+m.map.id),o.reasons=o.c.find(".reasons"),o.next=o.c.find(".next"),o.c.find(".cancel").on("click",n),o.next.on("click",a),c.reasons(),e.clbk(null,e)},wnd:{class:"withoutButtons transparent small complain"}}}var m=new nModule,i={};return m.run=function(e){var n=m.addEssense(i,a,e);m.init(n,e)},m.stop=function(){_.each(i,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=complain:(app.modules.complain={},app.modules.complain.module=complain);
 /*_____*/ 
var socialshare2=function(){var k=new nModule;function n(e){function n(){(c?w:v)()}function i(){c=k.app.settings.get(k.map.id,"notincludedRef")||!1}function r(e,a){return(a+=":\r\n")+e}var a,e=deep(e,"history"),o="",s=(k.app.localization.e("e13171"),k.app.localization.e("e13172")+"\r\n"),l={},t=!1,c=!1,d={},p=deep(window,"plugins.socialsharing"),u={black:new Parameter({name:"Black Theme",id:"black",type:"BOOLEAN",value:"black"===localStorage.getItem("usertheme")}),autoplayvideo:new Parameter({name:"Autoplay Video",id:"black",type:"BOOLEAN",value:!1}),fullscreenvideo:new Parameter({name:"Remove Description",id:"fullscreenvideo",type:"BOOLEAN",value:!1}),onlyvideo:new Parameter({name:"Only video",id:"onlyvideo",type:"BOOLEAN",value:!1}),comments:new Parameter({name:"Include comments",id:"comments",type:"VALUES",defaultValue:"last",possibleValues:["last","all","no"],possibleValuesLabels:["Show Only last comment","Show All comments","Don't show comments"],value:""})},m={post:{settings:function(e){var a=["black","comments"],n=k.app.platform.sdk.node.shares.storage.trx[e];return n&&(n.url&&("youtube"!=(e=app.platform.parseUrl(n.url)).type&&"vimeo"!=e.type&&"bitchute"!=e.type&&"peertube"!=e.type||a.push("fullscreenvideo")),n.itisvideo()&&(a=["onlyvideo"])),Promise.resolve(a)},action:function(e,a){return Promise.resolve("lenta")}},channel:{settings:function(e){return Promise.resolve(["black"])},action:function(e,a){return Promise.resolve("channel")}},comment:{settings:function(e){return Promise.resolve(["black"])},action:function(e,a){return Promise.resolve("comment")},extra:function(e){e.commentPs={commentid:l.embedding.commentid,parentid:l.embedding.parentid}}}},f={sharebuttons:function(){l.sharing&&k.shell({name:"sharebuttons",el:a.c.find(".sharebuttons"),data:{socials:g()}},function(e){b()})},embedding:function(){var e,i;console.log("ED",l),l.embedding&&(e=m[l.embedding.type],i=[],e.settings(l.embedding.id).then(e=>(i={},_.each(e,function(e){i[e]=u[e]}),console.log("settings",i),Promise.resolve())).then(()=>e.action(i,l.embedding.id)).then(n=>{k.shell({name:"embedding",el:a.c.find(".embeddingWrapperCnt"),data:{embeddingcode:f.embeddingcode(n,l.embedding.id,i),embeddingSettings:i}},function(e){function a(){t?e.el.addClass("showedcode"):e.el.removeClass("showedcode")}ParametersLive(i,e.el),_.each(i,function(e){e._onChange=function(){console.log("CHANGE"),f.embedding()}}),a(),e.el.find(".showcode").on("click",function(){t=!t,console.log("showcode",t),a()}),e.el.find(".copycode").on("click",function(){copycleartext(f.embeddingcode(n,l.embedding.id,i,u)),sitemessage(k.app.localization.e("successcopied"))})})}))},embeddingcode:function(e,a,n){var i={};_.each(n,function(e,a){i[a]=e.value});var t=m[l.embedding.type];return t.extra&&t.extra(i),k.app.platform.sdk.address.pnet()?i.ref=k.app.platform.sdk.address.pnet().address:k.app.ref&&(i.ref=k.app.platform.sdk.address.pnet().address=k.app.ref),n.onlyvideo?(t=k.app.platform.sdk.node.shares.storage.trx[a])&&t.url&&e&&a?(n=app.peertubeHandler.parselink(t.url),'<iframe width="640" height="'+(640/(((k.app.platform.sdk.videos.storage[t.url]||k.app.platform.sdk.videos.storage[n.id]||{}).data||{}).aspectRatio||1.77)).toFixed(0)+'" src="https://pocketnet.app/embedVideo.php?embed=true&s='+a+"&host="+n.host+"&id="+n.id+'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'):"":(i=hexEncode(JSON.stringify(i)),e&&a?'<div id="pocketnet_'+o+'"></div><script src="https://'+k.app.options.url+'/js/widgets.js"><\/script><script type="text/javascript">(new window.PNWIDGETS()).make('+o+', "'+e+'", "'+a+'", "'+i+'")<\/script>':"")}},g=function(){return _.filter(h,function(e){if(!e.if||e.if())return!0})},h=[{n:"Email",i:'<i class="far fa-envelope"></i>',t:"email",c:"#f82a53",group:"email"},{n:"Telegram",i:'<i class="fab fa-telegram-plane"></i>',t:"telegram",c:"#0088cc",group:"messenger"},{n:"Viber",i:'<i class="fab fa-viber"></i>',t:"viber",c:"#59267c",group:"messenger"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")},group:"messenger"},{n:"Parler",i:'<img src="img/parlerlogo.png">',t:"parler",c:"#d31f3e",group:"social"},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"social"},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"instagram",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")},group:"social"},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"social"},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700",group:"social"},{n:"Gmail",i:'<i class="fab fa-google"></i>',t:"gmail",c:"#fbbc05",group:"email"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"messenger"},{n:"VK",i:'<i class="fab fa-vk"></i>',t:"vk",c:"#45668e",group:"social"},{n:"Tumblr",i:'<i class="fab fa-tumblr"></i>',t:"tumblr",c:"#35465c",group:"blog"},{n:"Blogger",i:'<i class="fab fa-blogger-b"></i>',t:"blogger",c:"#f57d00",group:"blog"}],b=function(){a.c.find(".socialsharebtn").each(function(){var e,a,n,i,t=$(this);t.hasClass("s_email")?t.on("click",function(){var e=s+"\r\n\r\n"+trimHtml(l.sharing.text.body,500).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")+"\r\n\r\n"+r(l.url,"Сontinue on Pocketnet");deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var a="";a+="mailto:",a+="?subject="+l.sharing.title,a+="&body=",a+=encodeURIComponent(e),window.location.href=a}):(e=l.sharing.title+": "+l.sharing.text.preview+"\r\n\r\n"+r(l.url,"Сontinue on Pocketnet"),a=t.data("type"),i=a,(a=_.find(h,function(e){return e.t==i}))&&a.s&&window.cordova&&p?(n=a.s,t.on("click",function(){"shareViaFacebook"!=n&&"shareViaTwitter"!=n&&"shareViaWhatsApp"!=n||p[n](e,l.sharing.image,l.url),"shareViaInstagram"==n&&p[n](e,l.sharing.image),"shareViaSMS"==n&&p[n]({message:e+" "+l.url,subject:l.sharing.title,image:l.sharing.image})})):(t.hasClass("s_gmail")&&(e=s+"\r\n\r\n"+l.sharing.text.body+"\r\n\r\n"+r(l.url,"Сontinue on Pocketnet"),deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"))),t.ShareLink({title:l.sharing.title,text:e,image:l.sharing.image,url:l.url,class_prefix:"s_",width:640,height:480})),t.on("click",function(){$(this).data("type")}))})},v=function(){k.app.platform.sdk.address.pnet()?l.url=k.app.nav.api.history.addParametersToHref(l.url,{ref:k.app.platform.sdk.address.pnet().address}):k.app.ref&&(l.url=k.app.nav.api.history.addParametersToHref(l.url,{ref:k.app.ref}))},w=function(){l.url=k.app.nav.api.history.removeParametersFromHref(l.url,["ref"])};return{primary:e,getdata:function(e,a){a.state,l=a.settings.essenseData||{},i(),l.title||(l.title="Pocketnet"),o=rand(1e4,99999),d.reflink=new Parameter({name:"Include Referal Link",id:"reflink",type:"BOOLEAN",value:!c,dbId:"reflink"}),d.reflink._onChange=function(){c=!d.reflink.value,k.app.settings.set(k.map.id,"notincludedRef",c),n(),f.sharebuttons()},l.url||("undefined"!=typeof _Electron||window.cordova?(a=(a=window.location.pathname.split("/"))[a.length-1]||"index",l.url="https://"+k.app.options.url+"/"+a+window.location.search):l.url="https://"+k.app.options.url+"/"+k.app.nav.get.href()||"index"),l.url=k.app.nav.api.history.removeParametersFromHref(l.url,["mpost","msocialshare2"]),n(),e({caption:l.caption,style:l.style||"",eparameters:d})},destroy:function(){a={}},init:function(e){i(),(a={}).c=e.el.find("#"+k.map.id),a.url=a.c.find(".url"),a.c.find(".url").on("click",function(){copycleartext(l.url),sitemessage(k.app.localization.e("urlsuccesscopied"))}),f.sharebuttons(),f.embedding(),ParametersLive(_.toArray(d),a.c),e.clbk(null,e)},wnd:{swipeClose:!0,trueshold:1,swipeCloseDir:"down",header:k.app.localization.e("e13174"),class:"sharingwindow2"}}}console.log("@@@@@@","black"===localStorage.getItem("usertheme"));var i={};return k.run=function(e){var a=k.addEssense(i,n,e);k.init(a,e)},k.stop=function(){_.each(i,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=socialshare2:(app.modules.socialshare2={},app.modules.socialshare2.module=socialshare2);
 /*_____*/ 
var postscores=function(){function t(s){function t(){var t=$(this).attr("value");d.app.user.isState(function(s){var e;s?(e=$(this).closest(".stars")).attr("value")||(e.attr("value",t),e.addClass("liked"),function(s,t){if(r.address!=d.user.address.value){if(!(s=r.upvote(s)))return d.app.platform.errorHandler("4",!0),t&&t(!1);d.sdk.node.transactions.create.commonFromUnspent(s,function(s,e){topPreloader(100),s?t&&t(!0):(r.myVal=null,d.app.platform.errorHandler(e,!0),t&&t(!1))})}}(t,function(s){s?(r.scnt||(r.scnt=0),r.score||(r.score=0),r.scnt++,r.score=Number(r.score||0)+Number(t),s=Number(r.score)/Number(r.scnt),e.find(".tstarsov").css("width",s/5*100+"%"),e.closest(".itemwr").find(".count span.v").html(s.toFixed(1)),i.stars(),n.push({address:d.user.address.value,value:t}),i.details(),i.userlist(),o.like&&o.like(r)):(e.removeAttr("value"),e.removeClass("liked"))})):d.nav.api.load({open:!0,href:"authorization",history:!0})})}var a,r,n,o,s=deep(s,"history"),i={userlist:function(t){n=_.filter(n,function(s){return 1<=s.value});var s=_.map(n,function(s){return s.address}),e={};_.each(n,function(s){e[s.address]=s.value}),d.nav.api.load({open:!0,id:"userslist",el:a.users,animation:!1,essenseData:{addresses:s,empty:d.app.localization.e("e13151"),caption:d.app.localization.e("e13152"),extra:function(s){return'<div class="userscore">'+e[s]+' <i class="fas fa-star"></i>'+"</div>"}},clbk:function(s,e){t&&t(s,e)}})},mystars:function(s){var e;void 0===r.myVal&&(e=[r.txid],d.app.platform.sdk.likes.get(e,function(){i.stars()}))},stars:function(e){d.shell({turi:"lenta",name:"stars",el:a.stars,data:{share:r}},function(s){fastars(s.el.find(".stars")),s.el.find(".stars i").on("click",t),e&&e()})},details:function(e){d.shell({name:"details",el:a.details,data:{share:r,scores:n}},function(s){s.el.find(".line").each(function(){var s=$(this);s.width(s.attr("awidth")+"%")}),e&&e()})}};return{primary:s,getdata:function(e,s){var t=deep(s,"settings.essenseData.share");o=deep(s,"settings.essenseData"),d.app.platform.sdk.node.shares.getbyid([t],function(){var s;(r=d.app.platform.sdk.node.shares.storage.trx[t])||(s=_.find(d.sdk.node.transactions.temp.share,function(s){return s.txid==t}))&&((r=new pShare)._import(s,!0),r.temp=!0,r.address=d.app.platform.sdk.address.pnet().address),r&&d.app.platform.sdk.postscores.get(t,function(){n=d.sdk.postscores.storage[t]||[],e({share:r})})})},destroy:function(){a={}},clearparameters:["p"],init:function(s){(a={}).c=s.el.find("#"+d.map.id),a.stars=a.c.find(".forstars"),a.details=a.c.find(".details"),a.users=a.c.find(".users"),i.stars(function(){i.details(),i.userlist(),i.mystars()}),s.clbk(null,s)},wnd:{class:"postscoreswnd",nooverflow:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,buttons:{}}}}var d=new nModule,a={};return d.run=function(s){var e=d.addEssense(a,t,s);d.init(e,s)},d.stop=function(){_.each(a,function(s){s.destroy()})},d}();"undefined"!=typeof module?module.exports=postscores:(app.modules.postscores={},app.modules.postscores.module=postscores);
 /*_____*/ 
var surveyiframe=function(){function r(e){function n(e){"endsurvey"==(e.originalEvent.data||{}).message&&a.closeContainer()}var r,e=deep(e,"history");return{primary:e,getdata:function(e){e({})},destroy:function(){r={}},init:function(e){localStorage.survey1=!0,(r={}).c=e.el.find("#"+a.map.id),$(r.c.find("iframe")[0].contentWindow).on("message",n),e.clbk(null,e)},wnd:{class:"allscreen black surveyiframe"}}}var a=new nModule,i={};return a.run=function(e){var n=a.addEssense(i,r,e);a.init(n,e)},a.stop=function(){_.each(i,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=surveyiframe:(app.modules.surveyiframe={},app.modules.surveyiframe.module=surveyiframe);
 /*_____*/ 
var main=function(){function a(e){function o(){I.app.user.isState(function(e){W.panel(),W.leftpanel(),W.addpanel()})}function t(){w=$(this).attr("lenta"),P.currentMode()}var i,a,l,p,s,r=deep(e,"history"),c=null,d=null,u=null,f=!1,m=null,h=null,v="",b=null,k=null,w="common",g=!1,y=null,C=null,S=0,T=/[,.!?;:() \n\r]/g,M=[{mode:"leftshow",icon:"fas fa-hashtag"},{mode:"mainshow",icon:"fas fa-home"},{mode:"rightshow",icon:"fas fa-arrow-right"}],x="mainshow",P={swipe:function(e,n,a){if(n&&a)if("move"!=e&&(y=null),"left"==n||"right"==n){if(!y){var o=_.findIndex(M,function(e){return e.mode==x}),t=null,l=0,s=1;if("move"==e&&("left"==n||"right"==n))return l=a/i.w.width()*100,void i.slwork.css({transform:"translateX("+(s="left"==n?-1:s)*(l=10<l?10:l)+"%)"});i.slwork.css({transform:"translateX(0%)"}),"end"==e&&("right"==n&&(0<o?t=M[o-1].mode:e="cancel"),"left"==n&&(o<M.length-1?t=M[o+1].mode:e="cancel"),t&&W.mobilemode(t))}}else if(i.slwork.css({transform:"translateX(0%)"}),"move"==e&&20<a&&(y=n),"end"==e){if("down"==n){if(console.log("lenta.hasplayingvideos()",d.hasplayingvideos()),d&&d.hasplayingvideos())return;I.app.el.html.removeClass("scrollmodedown")}"up"==n&&200<i.lentacell.scrollTop()&&I.app.el.html.addClass("scrollmodedown")}},refreshSticky:function(){g&&(i.panel.hcSticky("refresh"),i.leftpanel.hcSticky("refresh"))},addbutton:function(){I.app.platform.ui.share()},addbuttonscroll:function(){400<i.w.scrollTop()?i.addbutton.addClass("scrollactive"):i.addbutton.removeClass("scrollactive")},currentMode:function(){"recommended"==w?I.nav.api.history.addParameters({r:"recommended"}):"sub"==w?I.nav.api.history.addParameters({r:"sub"}):I.nav.api.history.removeParameters(["r"]),W.lentawithsearch(),E(),W.smallpanel()},backtolenta:function(){P.backtolentaClear(),_scrollTop(S,null,5)},backtolentaClear:function(){I.nav.api.history.removeParameters(["v"]),i.c.removeClass("opensvishowed"),W.post(null),setTimeout(function(){W.upbutton(),P.refreshSticky()},350),d&&d.update&&d.update()}},D={posts:function(n,e,a){I.app.platform.sdk.search.get(v,"posts",e,a,s,function(e){n(e.data)})}},W={addpanel:function(){I.app.user.isState(function(e){e&&(isMobile()?i.addbutton.removeClass("active"):i.addbutton.addClass("active"))})},smallpanel:function(){i.smallpanel.find(".item").removeClass("active"),i.smallpanel.find('.item[lenta="'+w+'"]').addClass("active")},share:function(){isMobile()||f||v||b?i.c.addClass("wshar"):(i.c.removeClass("wshar"),I.nav.api.load({open:!0,id:"share",el:i.share,animation:!1,clbk:function(e,n){u=n,P.refreshSticky()},essenseData:{post:function(){}}}))},topvideos:function(e){var n=i.topvideos;n.removeClass("hasshares"),e?I.app.platform.papi.horizontalLenta(n,function(e,n){C=n,P.refreshSticky()},{caption:I.app.localization.e("Top videos"),video:!0,r:"hot",loaderkey:"recommended",shuffle:!0,period:"4320",page:0,afterload:function(e,n,a){!a&&n.length&&e.page++},ended:function(e){return!e.length},hasshares:function(e){2<e.length&&n.addClass("hasshares")},opensvi:function(e,n){isMobile()&&n?I.nav.api.load({open:!0,href:"post?&s="+e,history:!0,handler:!0}):I.nav.api.load({open:!0,href:"index?video=1&v="+e,history:!0,handler:!0})},compact:!0}):(C&&(C.destroy(),C=null),n.html(""),n.removeClass("hasshares"))},leftpanel:function(){I.nav.api.load({open:!0,id:"leftpanel",el:i.leftpanel,animation:!1,essenseData:{renderclbk:function(){P.refreshSticky()},changed:function(){W.lentawithsearch()}},clbk:function(e,n){l=n}})},panel:function(){f&&!isMobile()||I.nav.api.load({open:!0,id:"panel",el:i.panel,animation:!1,essenseData:{renderclbk:function(){P.refreshSticky()}},clbk:function(e,n){a=n}})},lentawithsearch:function(a,o){var e,n;v?(n=v.replace("tag:","#"),(e=deep(I,"app.modules.menu.module.showsearch"))&&e(n),I.app.platform.sdk.search.get(v,"posts",0,10,null,function(e,n){e.count&&I.app.platform.sdk.activity.addsearch(v),s=n,p={posts:e},W.lenta(a,o)})):(p={},s=null,(e=deep(I,"app.modules.menu.module.showsearch"))&&(b?(e(n=_.map(b,function(e){return"#"+e}).join(" ")),I.app.platform.sdk.activity.addtagsearch(n)):e("")),W.lenta(a,o))},lenta:function(a,e){e=e||{};var n=null,c=!1;d&&d.destroy(),W.addpanel(),v&&(n=function(n){function a(e){e=I.app.platform.sdk.node.shares.transform(e),n&&n(e,null,{count:10})}var e,o,t,l,s,i,r;c?(o=p.posts.data.length,l=function(e){a(e)},i=p[e="posts"].data.length,r=p[e].count,o+(t=10)<=i||(o<i&&(s=i-o,o=i,t-=s),(t=r<o+t?r-o:t)<=0||D[e](function(e){l(e)},o,t))):(c=!0,a(p.posts.data))}),I.nav.api.load({open:!0,id:"lenta",el:i.lenta,animation:!1,mid:"main",essenseData:{hr:"index?",goback:e.goback,searchValue:v||null,search:!!v,tags:b,video:f&&!isMobile(),videomobile:f&&isMobile(),window:isMobile()?i.c.find(".lentacell"):i.w,page:0,afterload:function(e,n,a){isMobile()&&!a&&n.length&&e.page++},opensvi:function(e){S=i.w.scrollTop(),i.c.addClass("opensvishowed"),m&&m.destroy(),h&&h.destroy(),setTimeout(function(){h=I.app.platform.api.upbutton(i.upbackbutton,{top:function(){return"65px"},rightEl:i.c.find(".lentacellsvi"),scrollTop:0,click:function(e){P.backtolenta()},icon:'<i class="fas fa-chevron-left"></i>',class:"bright",text:"Back"})},50),setTimeout(function(){h.apply()},300),W.post(e),I.nav.api.history.addParameters({v:e}),_scrollTop(0,null,5)},renderclbk:function(){},loader:n},clbk:function(e,n){W.upbutton(),P.refreshSticky(),d=n,a&&a()}})},upbutton:function(){m&&m.destroy(),m=I.app.platform.api.upbutton(i.up,{top:function(){return"65px"},rightEl:i.c.find(".leftpanelcell")})},post:function(e){i&&i.c&&(e?I.app.platform.papi.post(e,i.c.find(".renderposthere"),function(e,n){k=n},{video:!0,autoplay:!0,nocommentcaption:!0,r:"recommended",opensvi:function(e){k&&(k.destroy(),k=null),i.c.find(".renderposthere").html(""),W.post(e),_scrollTop(0)}}):(k&&(k.destroy(),k=null),i.c.find(".renderposthere").html("")))},mobilemode:function(e){e&&("mainshow"==x&&(S=i.w.scrollTop(),_scrollTop(0,null,0)),x=e),i.c.attr("mobilemode",x),W.columnnavigation(),setTimeout(function(){I.app.el.html.removeClass("scrollmodedown")},300),"mainshow"==x&&S&&_scrollTop(S,null,0)},columnnavigation:function(){}},E=function(){I.app.user.isState(function(e){e&&(isMobile()||("common"==w?(W.share(),i.c.find(".bgCaption").removeClass("hidden")):(i.share.html(""),i.c.find(".bgCaption").addClass("hidden"))))})};return{primary:r,scrolltopall:function(){i.lentacell&&isMobile()&&(_scrollTop(0,i.lentacell,200),W.mobilemode("mainshow"))},parametersHandler:function(e){var n=w;localStorage.lentakey=parameters().r||"index",parameters().video&&(localStorage.lentakey="video"),n=parameters().r?parameters().r:"common",w!=n&&(w=n),(n=!!parameters().video)!=f&&(f=n),v=parameters().ss||"",n=decodeURI(parameters().sst||""),n=_.uniq(_.filter(n.split(T),function(e){return e})),b=n.length?n:null,W.topvideos("common"==w&&!f&&!v&&!b),f?(i.c.addClass("videomain"),parameters().v||(P.backtolenta(),o())):(i.c.removeClass("videomain"),P.backtolentaClear(),o()),d&&(d.destroy(),d=null),W.lentawithsearch(),W.leftpanel(),E(),P.refreshSticky(),e&&e()},authclbk:function(){void 0!==i&&i.c&&(i.c.find(".bgCaption").removeClass("hidden"),E(),P.refreshSticky())},getdata:function(e,n){g=!1;var a=parameters();w=a.r||"common",beginmaterial=a.s||a.i||a.v||null,I.app.curation()?I.nav.api.load({open:!0,href:"userpage",history:!0}):n.state&&r&&!I.app.user.validate()?I.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):e({})},destroy:function(){i&&i.w&&i.w.off("scroll",P.addbuttonscroll),I.app.el.html.removeClass("scrollmodedown"),W.post(null),g=!1,m&&m.destroy(),m=null,h&&h.destroy(),h=null,c&&c.destroy(),d&&d.destroy(),u&&u.destroy(),a&&a.destroy(),C&&(C.destroy(),C=null),l&&l.destroy(),S=0,f=!(x="mainshow"),y=u=d=c=a=l=null,I.app.el.footer.removeClass("workstation"),I.app.el.html.removeClass("nooverflow"),I.app.el.html.removeClass("showmain"),i={},I.app.scrolling&&_.each(I.app.scrolling.clbks,function(e){e(0)})},init:function(e){var n,a;y=d=c=null,(i={}).c=e.el.find("#"+I.map.id),i.share=i.c.find(".share"),i.lenta=i.c.find(".lentaWrapper"),i.lentacell=i.c.find(".lentacell"),i.panel=i.c.find(".panel"),i.leftpanel=i.c.find(".leftpanel"),i.up=i.c.find(".upbuttonwrapper"),i.upbackbutton=i.c.find(".upbackbuttonwrapper"),i.smallpanel=i.c.find(".smallpanell"),i.addbutton=i.c.find(".addbutton"),i.columnnavigationWrapper=i.c.find(".columnnavigationWrapper"),i.slwork=i.c.find(".maincntwrapper >div.work"),i.topvideos=i.c.find(".topvideosWrapper"),i.w=$(window),I.app.el.footer.addClass("workstation"),isMobile()&&I.app.el.html.addClass("nooverflow"),I.app.el.html.addClass("showmain"),i.w.on("scroll",P.addbuttonscroll),i.smallpanel.find(".item").on("click",t),i.c.find(".backtolenta").on("click",P.backtolenta),i.addbutton.on("click",P.addbutton),isMobile()?I.app.scrolling&&i.lentacell.on("scroll",function(){var n;i.lentacell&&((n=i.lentacell.scrollTop())<200&&I.app.el.html.removeClass("scrollmodedown"),_.each(I.app.scrolling.clbks,function(e){e(n)}))}):(i.leftpanel.hcSticky({stickTo:"#main",top:64,bottom:122}),i.panel.hcSticky({stickTo:"#main",top:76,bottom:122}),g=!0),e.goback||(v=parameters().ss||"",n=decodeURI(parameters().sst||""),a=_.uniq(_.filter(n.split(T),function(e){return e})),b=a.length?a:null,s=null,p={}),(f=!!parameters().video)&&!isMobile()&&i.c.addClass("videomain"),W.mobilemode(),n=function(){e.clbk(null,e)},a=e,localStorage.lentakey=parameters().r||"index",parameters().video&&(localStorage.lentakey="video"),W.lentawithsearch(n,a),E(),o(),W.smallpanel(),"common"!=w||f||v||b||W.topvideos(!0),isMobile()&&i.c.find(".maincntwrapper").swipe({allowPageScroll:"auto",swipeStatus:function(e,n,a,o){if(!I.app.el.html.hasClass("fullvideoshowedanimblock"))return 0<i.topvideos.has(e.target).length||P.swipe(n,a,o),!0}})}}}var I=new nModule,o={};return I.scrolltopall=function(){_.each(o,function(e){e.scrolltopall()})},I.run=function(e){var n=I.addEssense(o,a,e);I.init(n,e)},I.stop=function(){var n=null;return _.each(o,function(e){(e=e.destroy())&&(n=e)}),n},I.authclbk=function(){_.each(o,function(e){e.authclbk()})},I}();"undefined"!=typeof module?module.exports=main:(app.modules.main={},app.modules.main.module=main);
 /*_____*/ 
var author=function(){function a(e){var i,o,r,a,e=deep(e,"history"),t=null,n=null,l=!1,s=null,c={subscribeLabel:function(){var e,n=g.app.user,a=!1;n.address.value&&i.address==n.address.value||!n.address.value||(e=deep(g.app,"platform.sdk.users.storage."+n.address.value))&&e.relation(i.address,"subscribes")&&(a=!0),r.c&&(e=r.caption.find(".subscribebuttonstop"),a?e.addClass("following"):e.removeClass("following"))},showmoreabout:function(){var e=filterXSS(clearScripts(findAndReplaceLink(deep(i,"data.about"),!0)));r.c.find(".aboutwrapper").html(e),r.c.find(".showmoreabout").remove()},showHideUp:function(){200<r.w.scrollTop()?r.up.addClass("active"):r.up.removeClass("active")},panelTopPosition:function(){var e;isTablet()||(e=$(window).scrollTop(),r.caption.height()+20<e?r.fxd.addClass("dfxd"):r.fxd.removeClass("dfxd"),c.panelPosition())},panelPosition:function(){var e,n,a;isTablet()||(e=r.fxd,a=r.panel.closest(".mwork"),a=(n=$(window).width())-(n=n-(a.offset().left+a.width())+0)-350,e.css("right",n+"px"),e.css("left",a+"px"))},destroy:function(){_.each(d,function(e){e.active=!1,e.module&&e.module.destroy()})}},p={showHideUp:function(){n=slowMade(function(){c.showHideUp()},n,30)},up:function(){_scrollTop(0)},unsubscribe:function(){dialog({html:g.app.localization.e("e13022"),btn1text:g.app.localization.e("unfollow"),btn2text:g.app.localization.e("ucancel"),class:"zindex",success:function(){g.app.platform.api.actions.unsubscribe(i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})}})},subscribe:function(){g.app.platform.api.actions.subscribeWithDialog(i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})},subscribePrivate:function(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";g.app.platform.api.actions[e](i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})}},d={},u={contents:function(a,e){g.app.platform.sdk.contents.get(i.address,function(e){var n=parameters().mt,n={name:"contents",el:a,data:{contents:e,author:i,selected:n}};g.shell(n,function(e){})})},metmenu:function(a){var t={};g.fastTemplate("metmenu",function(e,n){g.app.platform.api.tooltip(a,function(){return t.author=i,n(t)},function(e){e.find(".donate").on("click",function(){c.donate(id),a.tooltipster("hide")}),e.find(".block").on("click",function(){g.app.platform.api.actions.blocking(i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)}),a.tooltipster("hide")}),e.find(".unblock").on("click",function(){g.app.platform.api.actions.unblocking(i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)}),a.tooltipster("hide")})})},t)},panel:function(){var e={};g.user.isItMe(i.address)||(e.author=i.address),g.nav.api.load({open:!0,id:"panel",el:r.panel,animation:!1,essenseData:{discussions:e},clbk:function(e,n){t=n,c.panelPosition(),window.addEventListener("resize",p.panelPosition),window.addEventListener("scroll",c.panelTopPosition)}})},report:function(e,n,a){var t;c.destroy(),!e.active&&e.history&&(t=["mt","s"],"shares"==e.id&&!n||t.push("ss"),a||g.app.nav.api.history.addRemoveParameters(t,{report:e.id})),e.active=!0,u[e.render]&&(u[e.render](r.lenta,e),u.menulight())},menulight:function(){r.menu.find(".usermenuitem").removeClass("active");var e=_.find(d,function(e){return e.active});e&&r.menu.find(".usermenuitem .c"+e.class).addClass("active")},menu:function(e){g.shell({name:"menu",el:r.menu,data:{reports:d}},function(t){t.el.find(".usermenuitem").swipe({tap:function(){var e=$(this).attr("menuitem");d[e]&&d[e].render&&u.report(d[e])}}),_.each(d,function(e,n){var a;e.events&&(a=t.el.find('[menuitem="'+n+'"]'),_.each(e.events,function(e,n){"click"==n&&isTablet()?a.swipe({tap:e}):a.on(n,e)}))}),e&&e()})},userslist:function(e,n,a,t,o){g.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:n,empty:a,caption:t},clbk:function(e,n){o&&o(e,n)}})},info:function(e){g.sdk.ustate.get(i.address,function(){i.state=g.sdk.ustate.storage[i.address],g.shell({name:"info",el:e,data:{author:i},animation:"fadeIn"},function(e){e.el.find(".showmoreabout").on("click",c.showmoreabout),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(g.app.localization.e("successcopied"))}),e.el.find(".postcnt").on("click",function(){u.report(d.contents)})})})},followers:function(e,a){var n=_.map(deep(i,"data.subscribers")||[],function(e){return e}),t=deep(i,"data.blocking")||[],n=_.filter(n,function(e){return-1==_.indexOf(t,e)}),o=g.app.localization.e("anofollowers");g.user.isItMe(i.address)&&(o=g.app.localization.e("aynofollowers")),u.userslist(e,n,o,g.app.localization.e("followers"),function(e,n){a.module=n})},following:function(e,a){var n=_.map(deep(i,"data.subscribes")||[],function(e){return e.adddress}),t=deep(i,"data.blocking")||[],n=_.filter(n,function(e){return-1==_.indexOf(t,e)}),o=g.app.localization.e("anofollowing");g.user.isItMe(i.address)&&(o=g.app.localization.e("aynofollowing")),u.userslist(e,n,o,g.app.localization.e("following"),function(e,n){a.module=n})},blocking:function(e,a){var n=_.map(deep(i,"data.blocking")||[],function(e){return e}),t=g.app.localization.e("anoblocked");g.user.isItMe(i.address)&&(t=g.app.localization.e("aynoblocked")),u.userslist(e,n,t,g.app.localization.e("blockedusers"),function(e,n){a.module=n})},post:function(e,n){var t=parameters().mt,a=g.app.platform.sdk.contents.getsorteditems(contents),o=_.map(a,function(e){return e.txid}),s=_.indexOf(o,t),a={currentindex:s+1,allength:o.length,leftid:null,rightid:null};0<s&&(a.leftid=o[s-1]),s<o.length-1&&(a.rightid=o[s+1]),g.shell({name:"post",el:e,data:a},function(a){var e="author?address="+i.address,n=app.platform.api.name(i.address);n&&(e=n.toLowerCase()+"?"),g.app.platform.papi.post(t,a.el.find(".postcnt"),function(e,n){external=n,l&&r.c.find(".contentswrapper").hcSticky("refresh"),a.el.find(".postauarrows").addClass("active")},{hr:e})})},lenta:function(a,t){var n,e,o,s;g.app.curation()&&!g.user.isItMe(i.address)||(n=function(){g.shell({name:"lenta",el:a,data:{}},function(e){var n;g.nav.api.load({open:!0,id:"lenta",el:a.find(".authorlentawrapper"),animation:!1,mid:i.address,essenseData:s,clbk:function(e,n){t.module=n,l&&r.c.find(".contentswrapper").hcSticky("refresh")}}),i.data&&i.data.name&&(n=e.el.find(".authorlentawrappermain"),e.el.find(".authorsearchicon .icon").on("click",function(){n.toggleClass("searchactive"),n.hasClass("searchactive")?n.find(".search input").focus():(n.find(".search input").val(""),m())}),new search(e.el.find(".authorsearch"),{placeholder:"Search on "+i.data.name,clbk:function(e){},last:{get:function(){return[]},tpl:function(e,n){}},events:{search:function(e,n,a,t){e="?report=shares&ssa="+e.replace("#","tag:"),m(!0),g.nav.api.go({href:e,history:!0,open:!0,handler:!0}),n&&n(!0)},clear:function(e){m()}}}),parameters().ssa&&(n.addClass("searchactive"),n.find(".search input").val(parameters().ssa)),isTablet()&&n.addClass("searchactive"))})},e="author?address="+i.address,(o=app.platform.api.name(i.address))&&(e=o.toLowerCase()+"?"),s={author:i.address,byauthor:!0,hr:e,renderclbk:function(){l&&r.c.find(".contentswrapper").hcSticky("refresh")}},"b"==parameters().r?(e=o.toLowerCase()+"?r=b&mt="+parameters().mt,s.beginmaterial=parameters().mt,s.contents=!0,g.app.platform.sdk.contents.get(i.address,function(e){e=g.app.platform.sdk.contents.getsorteditems(e),s.txids=_.map(e,function(e){return e.txid}),n()})):(parameters().ssa&&(s.search=!0,s.searchValue=parameters().ssa,s.loader=function(n){h("posts",deep(f,"data.length")||0,10,function(e){e=g.app.platform.sdk.node.shares.transform(e),n&&n(e,null,{count:10})})}),n()))}},f=null,m=function(e){parameters().ssa&&(g.app.platform.sdk.search.clear(),s=f=null,e||(g.app.nav.api.history.removeParameters(["ssa"]),u.report(d.shares,!0)))},h=function(e,n,a,t){var o,s=0,i=10;f&&(s=f.data.length,i=f.count),n+a<=s||(n<s&&(o=s-n,n=s,a-=o),(a=i<n+a?i-n:a)<=0||b[e](function(e){t&&t(e)},n,a))},b={posts:function(a,e,n){g.app.platform.sdk.search.get(parameters().ssa,"posts",e,n,s||null,function(e,n){s=n,a((f=f||e).data)},i.address)}};return{primary:e,parametersHandler:function(){var e=parameters().report||"shares";u.report(d[e],null,!0),u.menu()},authclbk:function(){var e=_.find(d,function(e){return e.active});e&&"shares"!=e.id&&u.report(e,null,!0),c.subscribeLabel()},getdata:function(n,e){i={},g.app.platform.sdk.search.clear();var a=e.settings.essenseData||{},t=parameters();o=e.state,t.address||(t.address=a.address),l=!1,f=s=null,d={shares:{name:g.app.localization.e("uposts").toUpperCase(),mobile:'<i class="fas fa-align-justify"></i>',id:"shares",render:"lenta",history:!0,if:function(){return!g.app.curation()||g.user.isItMe(i.address)},count:function(){return 0}},post:{if:function(){return!1},id:"post",render:"post",count:function(){return 0}},followers:{name:g.app.localization.e("followers").toUpperCase(),mobile:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,count:function(){var e=_.map(deep(i,"data.subscribers")||[],function(e){return e}),n=deep(i,"data.blocking")||[];return _.filter(e,function(e){return-1==_.indexOf(n,e)}).length}},contents:{name:g.app.localization.e("followers").toUpperCase(),mobile:'<i class="fas fa-users"></i>',id:"contents",render:"contents",history:!0,if:function(){return!1}},following:{name:g.app.localization.e("following").toUpperCase(),id:"following",mobile:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,count:function(){var e=_.map(deep(i,"data.subscribes")||[],function(e){return e.adddress}),n=deep(i,"data.blocking")||[];return _.filter(e,function(e){return-1==_.indexOf(n,e)}).length}},blocking:{name:g.app.localization.e("blockedusers").toUpperCase(),id:"blocking",mobile:'<i class="fas fa-user-slash"></i>',render:"blocking",history:!0,if:function(){if(g.user.isItMe(i.address))return!0},count:function(){return(deep(i,"data.blocking")||[]).length}},share:{name:g.app.localization.e("share").toUpperCase()+' <i class="fas fa-share-alt"></i>',mobile:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){g.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,uid:"authorshare",essenseData:{caption:"Share this author",sharing:i.data.social(g.app),embedding:{type:"channel",id:i.address}}})}}},settings:{name:g.app.localization.e("settings").toUpperCase()+' <i class="fas fa-cog"></i>',mobile:'<i class="fas fa-cog"></i>',id:"settings",href:function(){return g.app.user.validate()?"userpage?id=ustate":"userpage"},class:"tosettings",if:function(){if(g.user.isItMe(i.address)&&!isTablet())return!0}},more:{name:'<i class="fas fa-ellipsis-h"></i>',mobile:'<i class="fas fa-ellipsis-h"></i>',id:"more",class:"more",if:function(){if(!g.user.isItMe(i.address)&&o)return!0},events:{click:function(){u.metmenu($(this))}}},info:{name:g.app.localization.e("info")+' <i class="fas fa-info-circle"></i>',mobile:'<i class="fas fa-info-circle"></i>',id:"info",class:"info",render:"info",history:!0,if:function(){return!1}}},g.sdk.users.addressByName(t.address,function(e){e&&(i.address=e,g.sdk.users.get(i.address,function(){if(g.app.platform.sdk.address.pnet()&&i.address==g.app.platform.sdk.address.pnet().address){if(d.shares.name=g.app.localization.e("myuposts"),!g.app.user.validate())return void g.nav.api.go({href:"userpage?id=test",history:!0,open:!0})}else d.shares.name=g.app.localization.e("uposts");i.data=g.sdk.users.storage[i.address],n({author:i})}))})},destroy:function(){a&&a.destroy(),a=null,t&&t.destroy(),window.removeEventListener("resize",p.panelPosition),window.removeEventListener("scroll",c.panelTopPosition),window.removeEventListener("scroll",p.showHideUp),delete g.app.platform.ws.messages.event.clbks.author,delete g.app.platform.clbks.api.actions.subscribe.author,delete g.app.platform.clbks.api.actions.unsubscribe.author,delete g.app.platform.clbks.api.actions.subscribePrivate.author,c.destroy(),r={}},init:function(e){var n;(r={}).c=e.el.find("#"+g.map.id),r.lenta=r.c.find(".lentaWrapper"),r.menu=r.c.find(".usermenu"),r.panel=r.c.find(".panel"),r.caption=r.c.find(".bgCaption"),r.fxd=r.c.find(".fxd"),r.subscribe=r.c.find(".subscribebuttonstop"),r.up=r.c.find(".upbuttonwrapper"),r.w=$(window),r.contents=r.c.find(".contentswrapper"),r.info=r.c.find(".authorinfoWrapper"),n=parameters().report||"shares",d[n].active=!0,u.report(d[n],null,!0),u.menu(),isTablet()&&u.info(r.c.find(".mobileinfo")),g.app.user.isState(function(e){!e||(e=g.app.platform.sdk.users.storage[g.app.platform.sdk.address.pnet().address])&&e.relation(i.address,"blocking")&&r.caption.addClass("blocking")}),a=g.app.platform.api.upbutton(r.up,{top:function(){return"65px"},class:"light",rightEl:r.c.find(".leftpanelcell")}),isTablet()||u.info(r.info),r.up.on("click",p.up),r.subscribe.find(".subscribe").on("click",p.subscribe),r.subscribe.find(".unsubscribe").on("click",p.unsubscribe),r.c.find(".notificationturn").on("click",p.subscribePrivate),r.caption.find(".unblocking").on("click",function(){dialog({html:g.app.localization.e("e13023"),btn1text:g.app.localization.e("unblock"),btn2text:g.app.localization.e("ucancel"),class:"zindex",success:function(){g.app.platform.api.actions.unblocking(i.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})}})}),g.app.platform.ws.messages.event.clbks.author=function(e){"subscribe"!=e.mesType&&"unsubscribe"!=e.mesType||(r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count()))},g.app.platform.clbks.api.actions.subscribe.author=function(e){e==i.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count())),g.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count()))},g.app.platform.clbks.api.actions.subscribePrivate.author=function(e){e==i.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").addClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count())),g.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count()))},g.app.platform.clbks.api.actions.unsubscribe.author=function(e){e==i.address&&(r.subscribe.removeClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count())),g.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(d.followers.count()),r.c.find('.toReport[report="following"] .count').html(d.following.count()))},g.app.platform.clbks.api.actions.blocking.author=function(e){e==i.address&&(r.caption.addClass("blocking"),r.c.find(".notificationturn").removeClass("turnon"))},g.app.platform.clbks.api.actions.unblocking.author=function(e){e==i.address&&r.caption.removeClass("blocking")},g.sdk.activity.adduser("visited",i.address),g.user.isItMe(i.address)&&g.app.nav.api.backChainClear(),e.clbk(null,e)}}}var g=new nModule,t={};return g.run=function(e){var n=g.addEssense(t,a,e);g.init(n,e)},g.stop=function(){_.each(t,function(e){e.destroy()})},g.authclbk=function(){_.each(t,function(e){e.authclbk()})},g}();"undefined"!=typeof module?module.exports=author:(app.modules.author={},app.modules.author.module=author);
 /*_____*/ 
var socialshare=function(){function i(a){function e(){h.shell({name:"sharebuttons",el:n.c.find(".sharebuttons"),data:{socials:s()}},function(a){f()})}function i(){h.app.settings.set(h.map.id,"calltoActionNotInclude",r),h.app.settings.set(h.map.id,"calltoActionUserText",p)}function t(){p=h.app.settings.get(h.map.id,"calltoActionUserText")||"",r=h.app.settings.get(h.map.id,"calltoActionNotInclude")||!1}var o,n,a=deep(a,"history"),c=(h.app.localization.e("e13171"),h.app.localization.e("e13172")+"\r\n"),l={},r=!1,p="",d=deep(window,"plugins.socialsharing"),s=function(){return _.filter(u,function(a){if(!a.if||a.if())return!0})},u=[{n:"Email",i:'<i class="far fa-envelope"></i> '+h.app.localization.e("e13173"),t:"email",c:"#f82a53"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"instagram",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700"},{n:"Pinterest",i:'<i class="fab fa-pinterest-p"></i>',t:"pinterest",c:"#bd081c"},{n:"LinkedIn",i:'<i class="fab fa-linkedin-in"></i>',t:"linkedin",c:"#0077B5"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}}],f=function(){n.c.find(".socialsharebtn").each(function(){var a,e,i,t,n,s=$(this);s.hasClass("s_email")?s.on("click",function(){var a=(!o||r?"":p||c)+"\r\n"+l.title+"\r\n\r\n"+l.text+"\r\n\r\n\r\n"+l.url;deep(app,"platform.sdk.user.storage.me.name")&&(a+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var e="";e+="mailto:",e+="?subject="+l.title,e+="&body=",e+=encodeURIComponent(a),window.location.href=e}):(e=l.text,a=l.title,e=trim((!o||r?"":p||c)+" "+e),i=s.data("type"),n=i,(i=_.find(u,function(a){return a.t==n}))&&i.s&&window.cordova&&d?(t=i.s,s.on("click",function(){"shareViaFacebook"!=t&&"shareViaTwitter"!=t&&"shareViaWhatsApp"!=t||d[t](e,l.image,l.url),"shareViaInstagram"==t&&d[t](e,l.image),"shareViaSMS"==t&&d[t]({message:e+" "+l.url,subject:a,image:l.image})})):s.ShareLink({title:a,text:e,image:l.image,url:l.url,class_prefix:"s_",width:640,height:480}),s.on("click",function(){$(this).data("type")}))})};return{primary:a,getdata:function(a,e){o=e.state,l=e.settings.essenseData||{},t(),l.title||(l.title="Pocketnet"),l.text||(l.text=h.app.localization.e("e13171")),l.image||(l.image="https://"+h.app.options.url+"/img/logobigpadding.png"),l.url||("undefined"!=typeof _Electron||window.cordova?(e=(e=window.location.pathname.split("/"))[e.length-1],l.url="https://"+h.app.options.url+"/"+e+window.location.search):l.url="https://"+h.app.options.url+"/"+h.app.nav.get.href()),h.app.platform.sdk.address.pnet()&&(l.url=h.app.nav.api.history.addParametersToHref(l.url,{ref:h.app.platform.sdk.address.pnet().address})),a({socials:s(),url:l.url,rescue:l.rescue||!1,caption:l.caption,style:l.style||"",calltoActionUserText:p||c,calltoActionNotInclude:r})},destroy:function(){n={}},init:function(a){t(),(n={}).c=a.el.find("#"+h.map.id),n.url=n.c.find(".url"),n.c.find(".copycell").on("click",function(){copyText(n.url.find(".urlcell")),sitemessage(h.app.localization.e("urlsuccesscopied"))}),n.c.find(".changecallto").on("click",function(){r=!r,$(".additionalwrapper").toggleClass("checked"),r&&n.c.removeClass("textshowed"),i(),e()}),n.c.find(".morecell").on("click",function(){n.c.toggleClass("textshowed"),n.c.closest(".wnd").toggleClass("textshowedwnd")}),n.c.find(".calltoActionUserText").on("keyup",function(){(p=$(this).val())==c&&(p=""),i(),e()}),n.c.find(".calltoActionUserText").on("change",function(){p||n.c.find(".calltoActionUserText").val(c)}),e(),a.clbk(null,a)},wnd:{swipeClose:!0,swipeMintrueshold:30,header:h.app.localization.e("e13174"),class:"sharingwindow"}}}var h=new nModule,t={};return h.run=function(a){var e=h.addEssense(t,i,a);h.init(e,a)},h.stop=function(){_.each(t,function(a){a.destroy()})},h}();"undefined"!=typeof module?module.exports=socialshare:(app.modules.socialshare={},app.modules.socialshare.module=socialshare);
 /*_____*/ 
var channel=function(){function a(t){function e(){var e=app.platform.api.name(o.address);return e?e+"?":"author?address="+o.address}var a,n=deep(t,"history"),o={},i={followers:{name:s.app.localization.e("followers").toUpperCase(),icon:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,href:function(){return e()+"report=followers"},count:function(){return deep(o,"data.subscribers.length")||0}},reputation:{name:"REPUTATION",icon:'<i class="far fa-star"></i>',id:"reputation",render:"reputation",history:!0,href:e,count:function(){return deep(o,"state.reputation")||0}},following:{name:s.app.localization.e("following").toUpperCase(),id:"following",icon:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,href:function(){return e()+"report=following"},count:function(){return deep(o,"data.subscribes.length")||0}},share:{name:s.app.localization.e("share").toUpperCase(),icon:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){s.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{caption:"Share this author",sharing:o.data.social(s.app),embedding:{type:"channel",id:o.address}}})}}}};return{primary:n,getdata:function(e,n){(a=n.settings.essenseData||{}).id||(a.id="PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),s.sdk.users.get(a.id,function(){s.sdk.ustate.get(a.id,function(){o.data=s.sdk.users.storage[a.id],o.state=s.sdk.ustate.storage[a.id],o.address=a.id,console.log(o),e({author:o,reports:i})})})},destroy:function(){},init:function(e){e.el.find("#"+s.map.id),_.each(i,function(e,n){var a;e.events&&(a=t.el.find('[menuitem="'+n+'"]'),_.each(e.events,function(e,n){"click"==n&&isMobile()?a.swipe({tap:e}):a.on(n,e)}))}),e.clbk(null,e)}}}var s=new nModule,t={};return s.run=function(e){var n=s.addEssense(t,a,e);s.init(n,e)},s.stop=function(){_.each(t,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=channel:(app.modules.channel={},app.modules.channel.module=channel);
 /*_____*/ 
var scheduler=function(){function t(e){function n(a){return _.find(i,function(e){return e.id==a})}function a(){function e(){o.remove(a)}var a=$(this).closest(".shareTimeWrapper").attr("task"),t=n(a);t&&(t.share.validation()?e():dialog({html:"Do you really want to remove this task?",btn1text:"Yes",btn2text:"No",success:e}))}var s,r,e=deep(e,"history"),i=[],t=null,o={postInterval:function(){t=setInterval(function(){var e=o.taskForTime();d.time(),e.length&&lazyEach({array:e,sync:!0,action:function(e){var a=e.item;l.app.platform.sdk.node.transactions.get.unspent(function(){o.post(a,function(){e.success()})},null,!0)}})},6e4)},missed:function(e){dialog({html:"You have <b>"+e.length+"</b> missed posts. Do you want to share it?",btn1text:"Yes",btn2text:"No",success:function(){_.each(e,function(e){o.post(e)})},fail:function(){_.each(e,function(e){e.time=null,d.task(e,null,!0)})}})},taskForTime:function(){var a=new Date;return _.filter(i,function(e){if(e.time&&e.ready&&a>e.time&&!e.remove)return!0})},post:function(t,n){var e;t.share?(e=t.share.validation())?(sitemessage(e),o.failPost(t.id),n&&n(!1)):l.app.platform.sdk.pool.dumpKey(r,t.address,function(e){var a;e?(a=bitcoin.ECPair.fromPrivateKey(Buffer.from(e,"hex")),e=bitcoin.payments.p2pkh({pubkey:a.publicKey}),t.module.post(function(e,a){e?o.successPost(t.id):(sitemessage(a),o.failPost(t.id)),n&&n(e)},{address:e,keys:a})):sitemessage("noprivateley")}):(sitemessage("error"),o.failPost(t.id),n&&n(!1))},add:function(){var e={time:null,id:makeid(),share:new Share,address:l.app.platform.sdk.address.pnet().address,ready:!1};e.share.on.change.scheduler=function(){c.save()},i.push(e),d.task(e),c.save()},remove:function(e){var a,t=(a=e,findIndex(i,function(e){return e.id==a}));i.splice(t,1),c.save(),s.c.find('.shareAppendWrapper[t="'+e+'"]').remove()},failPost:function(a){var e=n(a);e.time=null,d.task(e,function(){d.ready();var e=s.c.find('.shareAppendWrapper[t="'+a+'"] .result');e.html('<i class="fas fa-exclamation-circle"></i>'),e.addClass("bad")},!0)},successPost:function(e){n(e).remove=!0,(e=s.c.find('.shareAppendWrapper[t="'+e+'"] .result')).html('<i class="far fa-check-circle"></i>'),e.addClass("good"),d.ready(),c.save()}},d={tasks:function(e){lazyEach({array:i,action:function(e){var a=e.item;d.task(a,e.success)},sync:!0,all:{success:e}})},task:function(t,n,e){e||s.tasks.append('<div class="shareAppendWrapper" t="'+t.id+'">'),_el=s.tasks.find('.shareAppendWrapper[t="'+t.id+'"]'),l.shell({name:"task",el:_el,data:{task:t}},function(e){e.el.find(".remove").on("click",a),e=e.el.find('.shareTimeWrapper[task="'+t.id+'"] .shareContainer'),l.nav.api.load({open:!0,id:"share",el:e,animation:!1,_id:t.id,essenseData:{daddress:t.address||l.app.platform.sdk.address.pnet().address,dtype:t.ready,share:t.share,exoprtByTime:!0,pack:r||{},time:t.time,notClear:!0,changeArrange:function(){c.save()},selectTime:function(e){t.time=e,d.ready(),c.save()},address:function(e){t.address=e,d.ready(),c.save()},type:function(e){"p"==e&&o.post(t,function(){}),"t"==e&&(t.ready=!0),"w"==e&&(t.ready=!1),d.time(),d.ready(),c.save()}},clbk:function(e,a){t.module=a,n&&n()}})})},time:function(){var e=new Date;s.c.find(".timeCellWrapper .time").html(e.getHours()+":"+e.getMinutes())},ready:function(){var a=new Date,e=_.filter(i,function(e){if(e.time&&e.ready&&a<e.time&&!e.remove)return!0});s.c.find(".activeTasks .count").html(e.length)}},c={save:function(){var e=_.filter(i,function(e){if(!e.remove)return!0}),e=_.map(e,function(e){var a=null;return{time:a=e.time?dateToStr(e.time):a,id:e.id,share:e.share.export(!0),address:e.address,ready:e.ready}});localStorage.tasks=JSON.stringify(e)},load:function(){var e=JSON.parse(localStorage.tasks||"[]");i=_.map(e,function(e){var a=new Share;a.import(e.share),a.on.change.scheduler=function(){c.save()};var t=null;return{time:t=e.time?strToDate(e.time):t,id:e.id,share:a,address:e.address,ready:e.ready||!1}})}};return{primary:e,getdata:function(e){c.load(),e({tasks:i})},destroy:function(){s={},t&&clearInterval(t),t=null},init:function(e){function a(){d.tasks();var e=o.taskForTime();d.time(),d.ready(),e.length&&o.missed(e)}var t;c.load(),(s={}).c=e.el.find("#"+l.map.id),s.tasks=s.c.find(".shares"),s.add=s.c.find(".addshare"),s.add.on("click",o.add),o.postInterval(),t=l.app.platform.sdk.address.pnet().address,(t=l.app.platform.sdk.pool.getPack(t))?(r=t[0],l.app.platform.sdk.pool.info(r,function(){a()})):a(),e.clbk(null,e)}}}var l=new nModule,n={};return l.run=function(e){var a=l.addEssense(n,t,e);l.init(a,e)},l.stop=function(){_.each(n,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=scheduler:(app.modules.scheduler={},app.modules.scheduler.module=scheduler);
 /*_____*/ 
var userslist=function(){function e(s){function n(){$(window).scrollTop()+$(window).height()>$(document).height()-400&&!r&&!l&&d()}function e(){var s,n=$(this).closest(".user").attr("address");s=n,dialog({html:f.app.localization.e("e13023"),btn1text:f.app.localization.e("unblock"),btn2text:f.app.localization.e("ucancel"),class:"zindex",success:function(){f.app.platform.api.actions.unblocking(s,function(s,n){s||f.app.platform.errorHandler(n,!0)})}})}function t(){var s,n=$(this).closest(".user").attr("address");s=n,dialog({html:f.app.localization.e("e13022"),btn1text:f.app.localization.e("unsub"),btn2text:f.app.localization.e("ucancel"),class:"zindex",success:function(){f.app.platform.api.actions.unsubscribe(s,function(s,n){s||f.app.platform.errorHandler(n,!0)})}})}function i(){var s=$(this).closest(".user").attr("address");f.app.platform.api.actions.subscribeWithDialog(s,function(s,n){s||f.app.platform.errorHandler(n,!0)})}function a(){var s=$(this).closest(".user").attr("address"),n=$(this).hasClass("turnon");f.app.platform.api.actions[n?"notificationsTurnOff":"notificationsTurnOn"](s,function(s,n){s||f.app.platform.errorHandler(n,!0)})}var o,r,s=deep(s,"history"),c=[],l=!1,u=null,p=0,d=function(s){var n,e,t=_.filter(c,function(s,n){if(50*p<=n&&n<50*(p+1))return!0});t.length?(n=t,e=function(){var n;n=s,f.shell({name:"users",el:o.users,data:{addresses:t,extra:u},inner:append},function(s){n&&n()})},r||(r=!0,topPreloader(80),o.c.addClass("loading"),f.sdk.users.get(n,function(){o.c.removeClass("loading"),r=!1,topPreloader(100),e&&e()})),p++):l=!0};return{primary:s,getdata:function(s,n){p=0,r=l=!1;var e={};c=deep(n.settings,"essenseData.addresses")||[],e.addresses=c,e.empty=deep(n.settings,"essenseData.empty"),e.caption=deep(n.settings,"essenseData.caption"),u=deep(n.settings,"essenseData.extra"),s(e)},destroy:function(){window.removeEventListener("scroll",n),delete f.app.platform.clbks.api.actions.subscribe.userlist,delete f.app.platform.clbks.api.actions.subscribePrivate.userlist,delete f.app.platform.clbks.api.actions.unsubscribe.userlist,delete f.app.platform.clbks.api.actions.blocking.userlist,o={}},init:function(s){(o={}).c=s.el.find("#"+f.map.id),o.users=o.c.find(".users"),f.app.platform.clbks.api.actions.subscribe.userlist=function(s){o.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("following"),o.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.subscribePrivate.userlist=function(s){o.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("following"),o.c.find('.user[address="'+s+'"] .notificationturn').addClass("turnon")},f.app.platform.clbks.api.actions.unsubscribe.userlist=function(s){o.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("following"),o.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.blocking.userlist=function(s){o.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("blocking"),o.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.unblocking.userlist=function(s){o.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("blocking"),o.c.find('.user[address="'+s+'"]').removeClass("userblocking")},o.c.on("click",".subscribe",i),o.c.on("click",".unsubscribe",t),o.c.on("click",".unblocking",e),o.c.on("click",".notificationturn",a),d(function(){window.addEventListener("scroll",n)}),s.clbk(null,s)}}}var f=new nModule,t={};return f.run=function(s){var n=f.addEssense(t,e,s);f.init(n,s)},f.stop=function(){_.each(t,function(s){s.destroy()})},f}();"undefined"!=typeof module?module.exports=userslist:(app.modules.userslist={},app.modules.userslist.module=userslist);
 /*_____*/ 
"undefined"==typeof _OpenApi&&(_OpenApi=!1);var post=function(){function t(s){function t(){D.postscores()}function i(){D.repost(v.txid)}function o(){var e=$(this),s=v.txid;z.app.platform.api.metmenu(e,s,D)}function r(e){D.unsubscribe(function(){tx&&h.share.find(".shareTable").removeClass("subscribed")})}function p(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";z.app.platform.api.actions[e](v.address,function(e,s){e||z.app.platform.errorHandler(s,!0)})}function d(e){D.stateAction(function(){z.app.platform.api.actions.subscribeWithDialog(v.address,function(e,s){e?h.share.find(".shareTable").addClass("subscribed"):z.app.platform.errorHandler(s,!0)})},v.txid)}function l(){z.app.platform.sdk.node.transactions.get.tx(v.txid)}function a(){var t=$(this).attr("value");D.stateAction(function(){var s;z.app.platform.sdk.address.pnet()&&v.address!=z.app.platform.sdk.address.pnet().address&&((s=$(this).closest(".stars")).attr("value")||(s.attr("value",t),s.addClass("liked"),D.like(t,function(e){e?(v.scnt||(v.scnt=0),v.score||(v.score=0),v.scnt++,v.score=Number(v.score||0)+Number(t),e=Number(v.score)/Number(v.scnt),s.find(".tstarsov").css("width",e/5*100+"%"),s.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),V.stars(),b.like&&b.like(v)):(s.removeAttr("value"),s.removeClass("liked"))})))},v.txid)}function c(){dialog({html:z.app.localization.e("e13148"),btn1text:z.app.localization.e("dyes"),btn2text:z.app.localization.e("dno"),success:function(){h.share.addClass("complained"),topPreloader(30),D.complain(function(e){topPreloader(100),e||s.removeClass("hidden")})}})}function u(){var e=$(this).attr("i");D.openGalleryRec(e)}function f(){D.sharesocial()}function m(){D.donate()}var h,v,b,n,g=deep(s,"history")||deep(s,"primary"),k="",y=null,x=0,w=null,C=null,T=!1,D={authclbk:function(){T=!0;var e=v.txid;z.app.platform.sdk.node.shares.getbyid(e,function(){delete(v=z.app.platform.sdk.node.shares.storage.trx[e]).myVal,D.subscribeLabel(),V.mystars(function(){T=!1})})},subscribeLabel:function(){var e,s=z.app.user,t=!1;s.address.value&&v.address==s.address.value||!s.address.value||(e=deep(z.app,"platform.sdk.users.storage."+s.address.value))&&e.relation(v.address,"subscribes")&&(t=!0),h.c&&(e=h.share.find(".shareTable"),t?e.addClass("subscribed"):e.removeClass("subscribed"))},stateAction:function(s,e){if(_OpenApi)return e="https://"+z.app.options.url+"/post?openapi=true&s="+e,z.app.ref&&(e+="&ref="+z.app.ref),void window.open(e,"_blank");z.app.user.isState(function(e){e?s():z.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:z.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!T},function(){s&&s()})}}})})},postscores:function(e){z.app.nav.api.load({open:!0,href:"postscores?p="+v.txid,inWnd:!0,history:!0,essenseData:{share:v.txid,like:function(e){V.stars(),b.like&&b.like()}},clbk:function(){e&&e()}})},repost:function(s){D.stateAction(function(){var e="index";isMobile()&&(e="share"),z.closeContainer(),z.nav.api.load({open:!0,href:e+"?repost="+s,history:!0,handler:!0,essenseData:{},clbk:function(e){}})},s)},next:function(){h.wnd.off("scroll");var s=h.c.find(".nextpost");s.html('<div class="loader"><div class="preloader5"><span></span><span></span><span></span></div></div>'),b.next(v.txid,function(e){e?z.nav.api.load({open:!0,href:"post?s="+e,eid:"nextpost"+e,el:s,clbk:function(){},essenseData:{share:e,hr:b.hr,like:b.like,next:b.next,removemargin:!0}}):s.html('<div class="ended">'+z.app.localization.e("e13146")+"</div>")})},sharesocial:function(e){var s="https://"+z.app.options.url+"/"+(b.hr||"index?")+"s="+v.txid+"&mpost=true";parameters().address&&(s+="&address="+(parameters().address||"")),b.video&&(s="https://"+z.app.options.url+"/"+(b.hr||"index?")+"v="+v.txid+"&mpost=true&video=1");var t=v.message;trimHtml(t,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),v.images[0]||!v.url||(a=videoImage(v.url));var a="Post";"a"==v.settings.v&&(a="Article"),z.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:s,caption:z.app.localization.e("e13133")+" "+a,sharing:v.social(z.app),embedding:{type:"post",id:v.txid}}})},donate:function(e){var s=deep(app,"platform.sdk.usersl.storage."+v.address)||{address:v.address,addresses:[]},t="send?address="+v.address+"&amount=1&message="+hexEncode(z.app.localization.e("postlabel")+" &mdash; "+(v.caption||v.message).substr(0,20)+"...")+"&label="+(s.name||s.address)+"&setammount=true";z.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:z.app.localization.e("dcancel"),clbk:function(e,s){e.find(".pnetdnt").on("click",function(){z.nav.api.load({open:!0,href:t,history:!0}),z.closeContainer(),s.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(z.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:s})},position:function(){var e;isMobile()||g||b.removemargin||(0<(e=($(window).height()-h.wr.height())/2)?h.wr.css("margin-top",e+"px"):h.wr.css("margin-top","0px"))},initVideo:function(t){var e,a,n;z.app.platform.sdk.usersettings.meta.embedvideo&&!z.app.platform.sdk.usersettings.meta.embedvideo.value||(e=h.c.find(".js-player, [data-plyr-provider][data-plyr-embed-id]"),a=!!(v.itisvideo()&&isMobile()||b.autoplay&&e.length<=1),e.length&&(n={resetOnEnd:!0,muted:!1,wautoplay:a,volumeChange:function(e){videosVolume=e,console.log("v",e),z.sdk.videos.volume=videosVolume,z.sdk.videos.save()}},$.each(e,function(e,s){PlyrEx(s,n,e=>{C=e},()=>{a&&(C.play(),C.muted=!1,C.setVolume(z.sdk.videos.volume)),t&&t()})})))},likeWithR:function(e,s){},like:function(e,t){if(!(e=v.upvote(e)))return z.app.platform.errorHandler("4",!0),void(t&&t(!1));z.sdk.node.transactions.create.commonFromUnspent(e,function(e,s){topPreloader(100),e?t&&t(!0):(v.myVal=null,z.app.platform.errorHandler(s,!0),t&&t(!1))})},complain:function(e){z.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:v,success:function(){}},clbk:function(){}})},unsubscribe:function(t){z.app.platform.api.actions.unsubscribe(v.address,function(e,s){e||z.app.platform.errorHandler(s,!0),t&&t(e,s)})},subscribe:function(t){z.app.platform.api.actions.subscribe(v.address,function(e,s){e||z.app.platform.errorHandler(s,!0),t&&t(e,s)})},openGalleryRec:function(t,e){var a=[],n=function(e,s){_.each(e.images,function(e){a.push(e)}),e.repost?z.app.platform.sdk.node.shares.getbyid(e.repost,function(e){(e=e[0])?n(e,s):s&&s()}):s&&s()};n(v,function(){var e=_.map(a,function(e){return{src:e}}),s=findIndex(e,function(e){if(e.src==t)return!0});z.app.nav.api.load({open:!0,href:"imagegallery?i="+v.txid+"&num="+(s||0),inWnd:!0,history:"true",essenseData:{initialValue:t,idName:"src",images:e}})})},openGallery:function(s){var e=_.map(v.images,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==s)return!0});z.app.nav.api.load({open:!0,href:"imagegallery?i="+v.txid+"&num="+(t||0),inWnd:!0,history:"true",essenseData:{initialValue:s,idName:"src",images:e}})},videoShare:function(e){if(!e.url||!e.itisvideo())return sitemessage("Unable to parse a video in the post");var s=z.app.platform.parseUrl(e.url),t="https://"+z.app.options.url+`/embedVideo.php?host=${s.host_name}&id=${s.id}&embed=true&s=${e.txid}`;return"peertube"===s.type?copycleartext(t):copycleartext(e.url),sitemessage(z.app.localization.e("videoCopied"))}},V={comments:function(a){b.repost&&!b.fromempty||"no"==b.comments?a&&a():z.fastTemplate("commentspreview",function(e){var s=h.c.find(".commentsWrapper"),t="";z.app.platform.sdk.address.pnet()&&(t="&ref="+z.app.platform.sdk.address.pnet().address),t="https://"+z.app.options.url+"/"+(b.hr||"index?")+"s="+v.txid+"&mpost=true"+t,parameters().address&&(t+="&address="+(parameters().address||"")),z.nav.api.load({open:!0,id:"comments",el:s,eid:(b.eid||"")+v.txid+"post",essenseData:{hr:t,totop:h.c,caption:b.nocommentcaption?null:e,send:function(){var e=h.c.find(".commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:v.txid,reply:b.reply,showall:!b.fromempty,init:b.fromempty||!1,preview:b.fromempty||!1,fromtop:!b.fromempty,fromempty:b.fromempty,lastComment:b.fromempty?v.lastComment:null,additionalActions:function(){z.closeContainer()}},clbk:function(e,s){D.position(),n=s,a&&a()}})},{share:v})},empty:function(){z.shell({name:"empty",el:h.share},function(e){D.position()})},images:function(e){var s=h.c.find(".image"),t=h.c.find(".images");!t.hasClass("active")&&s.length&&t.length?s.imagesLoaded({background:!0},function(a){"a"!=v.settings.v&&_.each(a.images,function(e,s){var t=e.img,s=(e=$(a.elements[s]).closest(".imagesWrapper")).width();e.height(),t.width,t.height,t.width<e.width()?(e.find(".image").width(t.width),e.find(".image").height(t.height)):e.height(s*(t.height/t.width))}),t.addClass("active"),s.addClass("active"),e&&e()}):e&&e()},share:function(s){var e,t=!1,a=!1,n=0;void 0!==v&&(e=z.app.platform.sdk.videos.storage[v.url||"undefined"]||{},n=deep(e,"data.aspectRatio")||0),console.log("aspectRatio",n),z.shell({turi:"lenta",name:b.video?"sharevideo":"share",el:h.share,additionalActions:function(){z.closeContainer()},data:{share:v,all:!0,mestate:{},repost:b.repost,fromempty:b.fromempty,verticalVideo:t=n<.9&&0!=n||t,squareVideo:a=.9<n&&n<1.25||a}},function(e){h.stars=h.share.find(".forstars"),D.position(),h.wr.addClass("active"),V.stars(function(){V.mystars(function(){}),V.url(function(){V.repost(),D.position(),V.urlContent(function(){D.position(),D.initVideo(),V.images(function(){b.repost||(D.position(),h.share.find(".complain").on("click",c),h.share.on("click",".imagePostOpent",u),h.share.on("click",".forrepost",i),h.share.find(".txid").on("click",l),h.share.find(".donate").on("click",m),h.share.find(".sharesocial").on("click",f),h.share.find(".asubscribe").on("click",d),h.share.find(".aunsubscribe").on("click",r),h.share.find(".metmenu").on("click",o),h.share.find(".notificationturn").on("click",p)),s&&s()}),b.video&&V.showmoreby()})})})})},showmoreby:function(){var s=h.c.find(".showmorelenta");z.app.platform.papi.horizontalLenta(s,function(e,s){w=s},{caption:z.app.localization.e("More videos by this author"),author:v.address,video:!0,shuffle:!0,loaderkey:"getusercontents",filter:function(e){if(v.txid!=e.txid)return!0},hasshares:function(e){2<e.length&&s.addClass("hasshares")},opensvi:function(e){b.opensvi?b.opensvi(e):z.nav.api.load({open:!0,href:"index?video=1&v="+e,history:!0})},compact:!0})},wholike:function(s){var e=v.who||[];z.shell({turi:"lenta",name:"wholike",el:h.share.find(".wholikes"),data:{scores:Number(v.scnt),wholikes:e},bgImages:{}},function(e){e.el.find(".wholikesTable").on("click",t),s&&s()})},mystars:function(e){var s;void 0===v.myVal?(s=[v.txid],z.app.platform.sdk.likes.get(s,function(){V.stars(),V.wholike(e)})):e&&e()},stars:function(s){z.shell({turi:"lenta",name:"stars",el:h.stars,data:{share:v}},function(e){fastars(e.el.find(".stars")),h.share.find(".stars i").on("click",a),s&&s()})},repost:function(e){v.repost&&z.shell({turi:"lenta",name:"repost",el:h.c.find(".repostWrapper"),data:{repost:v.repost,level:x,share:v}},function(e){D.position(),e.el&&e.el.length&&z.app.platform.papi.post(v.repost,e.el.find(".repostShare"),function(e){y=e,D.position()},{repost:!0,eid:k+v.txid,level:x,fromempty:v.isEmpty()})})},url:function(s){var t=v.url,a=z.app.platform.sdk.remote.storage[t];z.app.platform.sdk.videos.paddingplaceholder(t,function(e){z.shell({turi:"share",name:"url",el:h.c.find(".url"),data:{url:t,og:a,share:v},additionalActions:function(){z.closeContainer()}},e)},function(t){var a=t.el.find("img");t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,s){e.isLoaded?($(a[s]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(a[s]).closest(".image").css("display","none")}),s&&s()})})},urlContent:function(s){var e,t,a=v.url;a?(e=z.app.platform.parseUrl(a),t=z.app.platform.sdk.remote.storage[a],!a||t||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?s&&s():z.app.platform.sdk.remote.get(a,function(e){e?V.url(s):s&&s()})):s&&s()}};return{primary:g,getdata:function(a,n){y=null,k=n.settings.eid||"";var s=deep(n,"settings.essenseData.share")||parameters().s;b=deep(n,"settings.essenseData")||{},v=null,x=(b.level||-1)+1,z.app.platform.sdk.node.shares.getbyid([s],function(){var e;(v=z.app.platform.sdk.node.shares.storage.trx[s])||(e=_.find(z.sdk.node.transactions.temp.share,function(e){return e.txid==s}))&&((v=new pShare)._import(e,!0),v.temp=!0,v.address=z.app.platform.sdk.address.pnet().address),v&&z.app.platform.sdk.node.shares.users([v],function(e,s){var t={ed:deep(n,"settings.essenseData")||{},share:v};z.app.platform.sdk.videos.info([v.url]).then(e=>{a(t)})})})},authclbk:function(){void 0!==h&&h.c&&D.authclbk()},destroy:function(e){h={},w&&(w.destroy(),w=null),z.app.el.menu.find("#menu").removeClass("static"),b.close&&b.close(),n&&n.destroy(),delete z.app.platform.ws.messages.event.clbks.post,delete z.app.platform.ws.messages.transaction.clbks.temppost,delete z.app.platform.clbks.api.actions.subscribePrivate.post,delete z.app.platform.clbks.api.actions.unsubscribe.post,delete z.app.platform.clbks.api.actions.subscribe.post,T=!1,C&&(C.destroy&&C.destroy(),C=null),y&&(y.destroy(),y=null)},clearparameters:["s","commentid","parentid"],init:function(e){(h={}).c=e.el.find("#"+z.map.id),h.share=h.c.find(".share"),h.wr=h.c.find(".postWrapper"),h.wnd=h.c.closest(".wndcontent"),v?V.share(function(){V.comments(function(){})}):V.empty(),e.clbk(null,e),b.video&&z.app.el.menu.find("#menu").addClass("static"),z.app.platform.ws.messages.transaction.clbks.temppost=function(e){e.temp&&v.txid==e.temp.txid&&(v.temp=!1,v.scnt="0",v.score="0",v.myVal=0,V.share())},z.app.platform.ws.messages.event.clbks.post=function(e){"upvoteShare"==e.mesType&&e.share&&v.txid==e.share.txid&&V.stars(function(){})},z.app.platform.clbks.api.actions.subscribePrivate.post=function(e){var s;e==v.address&&(h.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),(s=deep(z.app,"platform.sdk.users.storage."+z.user.address.value.toString("hex")))&&(s=s.relation(e,"subscribes"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"),!s||"true"!=s.private&&!0!==s.private?h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"):h.c.find('.shareTable[address="'+e+'"] .notificationturn').addClass("turnon")))},z.app.platform.clbks.api.actions.subscribe.post=function(e){e==v.address&&(h.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))},z.app.platform.clbks.api.actions.unsubscribe.post=function(e){e==v.address&&(h.c.find(".shareTable").removeClass("subscribed"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))}},wnd:{class:"withoutButtons postwindow",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,close:function(){}}}}var z=new nModule,a={};return z.authclbk=function(){_.each(a,function(e){e.authclbk()})},z.run=function(e){var s=z.addEssense(a,t,e);z.init(s,e)},z.stop=function(){_.each(a,function(e){e.destroy()})},z}();"undefined"!=typeof module?module.exports=post:(app.modules.post={},app.modules.post.module=post);
 /*_____*/ 
var ustate=function(){function n(t){function e(n){l.app.platform.sdk.user.waitActions(function(e){l.app.platform.sdk.ustate.me(function(t){a=e,i=t,c.uscnt(function(){o.ustatecontent=o.c.find(".ustatecontent"),c.ustatecontent(),c.reputationsteps(),n&&n()})},!0)})}var o,i,a,t=deep(t,"history"),n=makeid(),s={post:{key:"post",vis:"scale",name:l.app.localization.e("spc"),bad:function(t){if(t<=2)return!0}},score:{key:"score",vis:"scale",name:l.app.localization.e("ssc"),bad:function(t){if(t<=10)return!0}},comment:{key:"comment",vis:"scale",name:l.app.localization.e("ccc"),bad:function(t){if(t<=10)return!0}},comment_score:{key:"comment_score",vis:"scale",name:l.app.localization.e("crc"),bad:function(t){if(t<=10)return!0}}},c={gifts:function(t){},currentLevel:function(s){l.app.platform.sdk.processes.get(function(t){var a=l.app.platform.sdk.processes.level(i.reputation);a&&_.each(t,function(t){var e,n,o;t.level&&(n="next",o=(e=s.find('.level[level="'+t.level+'"]')).find(".line"),t.level<a.level&&(n="completed",o.removeAttr("width")),t.level==a.level&&(n="current",o.width(100*a.perc+"%")),t.level>a.level&&(next="next",o.removeAttr("width")),e.attr("state",n))})})},reputationsteps:function(n){l.app.platform.sdk.processes.get(function(t){var e=l.app.platform.sdk.processes.level(i.reputation);l.shell({name:"reputation",el:o.c.find(".ustatecontentrep"),data:{reputation:i.reputation,level:e,levels:t}},function(t){c.currentLevel(t.el),c.gifts(t.el),t.el.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),n&&n()})})},uscnt:function(e){l.shell({name:"uscnt",el:o.c.find(".mwork"),data:{mestate:i,metrics:s}},function(t){e&&e()})},ustatecontent:function(e){l.shell({name:"ustatecontentnew",el:o.ustatecontent,data:{metrics:s,mestate:i,waitActions:a}},function(t){e&&e()})}};return{primary:t,getdata:function(t){t({})},destroy:function(){o={},delete l.app.platform.ws.messages["new block"].clbks.ustate,delete l.app.platform.sdk.ustate.clbks[n]},init:function(t){(o={}).c=t.el.find("#"+l.map.id),l.app.platform.sdk.ustate.clbks[n]=e,e(function(){l.app.platform.ws.messages["new block"].clbks.ustate=function(t){l.app.platform.sdk.user.waitActions(function(t){a=t,c.ustatecontent()})},t.clbk(null,t)})},tooltip:{options:{minWidth:380,position:"left",functionPosition:function(t,e,n){return n.coord.top=10,n.coord.left+=10,n},theme:"tooltipster-light zindex ustatetooltip"}}}}var l=new nModule,o={};return l.run=function(t){var e=l.addEssense(o,n,t);l.init(e,t)},l.stop=function(){_.each(o,function(t){t.destroy()})},l}();"undefined"!=typeof module?module.exports=ustate:(app.modules.ustate={},app.modules.ustate.module=ustate);
 /*_____*/ 
var dust=function(){function t(e){function t(){var e=deep(r,"pk.value");r={pk:new Parameter({name:"Private Key",type:"string",id:"pk",placeholder:"Private Key",value:e||""}),reciever:new Parameter({name:u.app.localization.e("wsreciever"),type:"string",id:"reciever",placeholder:u.app.localization.e("wsenter")}),amount:new Parameter({name:u.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:u.app.localization.e("wsamountof"),format:{Precision:6}}),outputs:new Parameter({name:"Count of outputs",id:"outputs",type:"NUMBER",placeholder:"Count of outputs",defaultValue:1,format:{Precision:0,Min:1,Max:200}}),message:new Parameter({name:"Message",id:"message",type:"stringany",placeholder:"Your message",format:{Length:80}})}}var n,e=deep(e,"history"),r={},s={sendWrapper:function(){if(r.reciever.value){var a=!0;try{bitcoin.address.fromBase58Check(r.reciever.value)}catch(e){a=!1}a?r.amount.value?r.pk.value?s.send(r.pk.value):dialog({html:"Do you want to send coins from current acount?",btn1text:"Yes",btn2text:"No, cancel",success:function(){s.send(u.app.user.private.value.toString("hex"))}}):sitemessage("You must enter Amount"):sitemessage("Address is not valid")}else sitemessage("You Must Enter Reciever Address")},send:function(e){n.c.find(".loader").fadeIn(),u.app.platform.sdk.wallet.sendmanyoutputs(e,r.reciever.value,r.amount.value,r.outputs.value,function(e,a){console.log("ERR",e),n.c.find(".loader").fadeOut(),e?u.app.platform.errorHandler(e,!0):(t(),o.parameters(),sitemessage("Success!"))},r.message.value)}},o={parameters:function(){u.shell({name:"parameters",el:n.c.find(".parametersWrapper"),data:{d:{parameters:r}}},function(e){ParametersLive(_.toArray(r),e.el),e.el.find(".sends").on("click",s.sendWrapper)})}};return{primary:e,getdata:function(e){e({})},destroy:function(){n={}},init:function(e){(n={}).c=e.el.find("#"+u.map.id),t(),o.parameters(),e.clbk(null,e)}}}var u=new nModule,n={};return u.run=function(e){var a=u.addEssense(n,t,e);u.init(a,e)},u.stop=function(){_.each(n,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=dust:(app.modules.dust={},app.modules.dust.module=dust);