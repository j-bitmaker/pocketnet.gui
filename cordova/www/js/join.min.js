
 /*_____*/ 
window.pocketnetTemplates = {"navigation":{"menu":"\r\n\r\n<% if(typeof lentakey == 'undefined') lentakey = 'index' %>\r\n<% if(typeof indexkey == 'undefined') indexkey = 'index' %>\r\n\r\n\r\n<div class=\"items table\">\r\n\r\n\t<div class=\"item\">\r\n\r\n\t\t<div class=\"linkButtonWrapper\">\r\n\r\n\t\t\t<% if(back) {  \r\n\t\t\t\t\r\n\t\t\t\tvar ur = addtouri(back.href, 'back', 'true')\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t%>\r\n\t\t\t\t\r\n\t\t\t\t\t<a href=\"<%- ur %>\" fast=\"fast\" handler=\"true\">\r\n\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t<% if(ur.indexOf('index') > -1 && !self.app.curation()){ %>\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-home\"></i>\r\n\t\t\t\t\t\t\t<% } else { %> \r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-chevron-left\"></i>\r\n\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\r\n\t\t\t<% } else { %> \r\n\r\n\t\t\t\t<% if(href == 'chat') { %>\r\n\r\n\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t<% if(href == indexkey || !href) { \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(state){ %>\r\n\r\n\t\t\t\t\t\t\t<% if(self.app.curation()) {%>\r\n\r\n\t\t\t\t\t\t\t\t<a href=\"userpage?id=wallet\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-wallet\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t\t\t\t<% if(typeof shw != 'undefined' && shw) {%>\r\n\r\n\t\t\t\t\t\t\t\t\t<a href=\"index\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-rss\"></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<% } else { %>\r\n\t\r\n\t\t\t\t\t\t\t\t\t<a href=\"index?video=1\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-play-circle\"></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t<!--\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t -->\r\n\r\n\t\t\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t\t\t<% if(typeof shw != 'undefined' && shw) {%>\r\n\t\t\t\t\t\t\t\t<a href=\"index\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-rss\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% } else { %>\r\n\r\n\t\t\t\t\t\t\t\t<a href=\"index?video=1\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-play-circle\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\r\n\t\t\t\t\t<% } else { \r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t%> \r\n\r\n\t\t\t\t\t\t<% if(self.app.curation()) {%>\r\n\r\n\t\t\t\t\t\t\t<a href=\"userpage?id=wallet\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-wallet\"></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t\t\t<a href=\"<%- lentakey %>\" fast=\"fast\">\r\n\t\t\t\t\t\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-home\"></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<%}%>\r\n\r\n\t\t\t\t<% } %>\r\n\t\t\t\r\n\t\t\t<% } %>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"upbuttonWrapper\">\r\n\t\t\t<div class=\"iconWrapper toup\">\r\n\t\t\t\t<i class=\"fas fa-chevron-up\"></i>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t\r\n\t</div>\r\n\r\n\t\t\r\n\t<div class=\"item\">\r\n\r\n\t\t<% \r\n\t\t\r\n\t\tvar sharec = ''\r\n\t\t\r\n\t\tif(href == 'share') { \r\n\t\t\tsharec = 'active' %>\r\n\t\t<% } %>\r\n\r\n\t\t\t<% if(state){ %>\r\n\r\n\t\t\t\t<a href=\"share\" fast=\"fast\">\r\n\t\t\t\t\t<div class=\"iconWrapper shr <%-sharec%>\">\r\n\t\t\t\t\t\t<i class=\"fas fa-plus-circle\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</a>\r\n\r\n\t\t\t<% } else { %> \r\n\r\n\t\t\t\t<a href=\"registration\" fast=\"fast\">\r\n\t\t\t\t\t<div class=\"iconWrapper reg\">\r\n\t\t\t\t\t\t<i class=\"fas fa-user-plus\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</a>\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t<% } %>\r\n\r\n\t\t\r\n\t\t\r\n\t</div>\r\n\r\n\r\n\t<div class=\"item\">\r\n\r\n\t\t\r\n\r\n\t\t<a href=\"userpage\" fast=\"fast\" handler=\"true\">\r\n\t\t\t<div class=\"iconWrapper\">\r\n\t\t\t\t\t<i class=\"fas fa-bars\"></i>\r\n\t\t\t</div>\r\n\t\t</a>\r\n\r\n\t</div>\r\n\r\n\r\n</div>\r\n","index":"\r\n<% if(app.curation() && !state) { %> \r\n<% } else { %> \r\n\r\n<div id=\"<%-module.map.id%>\">\r\n\t<div class=\"nmenu\">\r\n\t</div>\r\n\r\n\t<div class=\"fakem\">\r\n\t\t<i class=\"fas fa-chevron-up\"></i>\r\n\t</div>\r\n</div>\r\n\r\n<% } %>"},"menu":{"index":"<div id=\"<%-module.map.id%>\" >\r\n\t<!--\r\n\t<div class=\"titleBar\">\r\n\t\t\r\n\t\t<div class=\"titleBarButtons\">\r\n\t\t\t<div class=\"closeApp\"><i class=\"fas fa-times\"></i></div>\r\n\r\n\t\t\t<div class=\"toggleMinMax\">\r\n\t\t\t\t<div class=\"maximizeApp\"><i class=\"far fa-window-restore\"></i></div>\r\n\t\t\t\t<div class=\"restoreApp\"><i class=\"far fa-window-maximize\"></i></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"miniizeApp\">\r\n\t\t\t\t<i class=\"far fa-window-minimize\"></i>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"titleBarDrag\" style=\"-webkit-app-region: drag; -webkit-user-select: none;\"></div>\r\n\t</div>\r\n\t-->\r\n\r\n\t<div class=\"menuWrapper\">\r\n\t\t\r\n\t\t\r\n\r\n\t\t<div class=\"sections\">\r\n\t\t\t<div class=\"section right\">\r\n\r\n\t\t\t\t\t<div class=\"items navWrapper unselectable\">\r\n\r\n\t\t\t\t\t\t<div class=\"item navWrapperItem\" events=\"navinit\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"menutoppanel \">\r\n\t\t\t\t\t\t\t\t<div class=\"panelitemCenter\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"centerTable table\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterLabel fresh\" r=\"empty\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"index\" handler=\"true\"><%=e('e13136')%> <span class=\"lentaunseen\" key=\"common\"></span></a>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterLabel \" r=\"sub\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"index?r=sub\"  handler=\"true\"><%=e('e13137')%> <span class=\"lentaunseen \" key=\"sub\"></span></a>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<% if(app.platform.videoenabled) {%>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterLabel \" r=\"video\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"index?video=1\"  handler=\"true\"><%=e('video')%> <span class=\"lentaunseen\" key=\"video\"></span></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"pcenterLabel toppost \" r=\"recommended\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"index?r=recommended\"  handler=\"true\"><%=e('e13138')%></a>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t<% if(state) { %>\r\n\r\n\t\t\t\t\t\t<!--<div class=\"items saveCrossWrapper\">\r\n\t\t\t\t\t\t\t<div class=\"item table right onlyicon saveCrossObj\" events=\"savecross\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-share-alt\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t\t\t<%- deep(app, 'platform.sdk.user.storage.me.rc') || 0 %>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>-->\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!--\r\n\t\t\t\t\t\t<div class=\"items messengerWrapper\">\r\n\t\t\t\t\t\t\t<div class=\"item table right onlyicon messenger\" events=\"messenger\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-comments\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>-->\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% if(typeof key!= 'undefined' && key) {%>\r\n\r\n\t\t\t\t\t\t\t<div class=\"items keyexportWrapper\">\r\n\t\t\t\t\t\t\t\t<div class=\"item table right onlyicon keyexport\" events=\"keyexport\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-key\"></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<div class=\"items notificationsWrapper\">\r\n\t\t\t\t\t\t\t<div class=\"item table right onlyicon notifications\" events=\"notifications\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-bell\"></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t\t\t<div class=\"items walletsWrapper\">\r\n\t\t\t\t\t\t\t<div class=\"item table right wallets onlyicon\" events=\"wallets\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"numberWrp\">\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"number\">0</span> PKOIN\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<% } %>\r\n\r\n\r\n\t\t\t\t\t<div class=\"items\">\r\n\t\t\t\t\t\t<div class=\"item table right state onlyicon\" events=\"state\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class=\"icon\"> <% if(state) {%> <a href=\"userpage?id=system16\">\t<% } else { %> <a href=\"system16\"> <% } %>\r\n\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-wifi\"></i>\r\n\t\t\t\t\t\t\t\t</div></a>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t<% if(state) { %>\r\n\r\n\t\t\t\t\t\t<div class=\"items\">\r\n\t\t\t\t\t\t\t<div class=\"item table right user\" events=\"userpage unselectable\">\r\n\r\n\t\t\t\t\t\t\t\t<% var src = deep(app, 'platform.sdk.user.storage.me.image')  %>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(user.address.value.toString('hex'))%>\">\t\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"usericon\" image=\"<%-src || ''%>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<% if(!src) {%>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-user\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<% if(deep(app, 'platform.real.'+user.address.value.toString('hex'))) {%>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"realperson\">\r\n\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"fa-stack fa-2x\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-certificate fa-stack-2x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-check fa-stack-1x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t  </span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\t<!--<div class=\"localizationicon\">\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"img/localization/small/<%-lkey.key || ''%>.png\">\r\n\t\t\t\t\t\t\t\t\t</div>-->\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<% if(!state) { %>\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"items\">\r\n\t\t\t\t\t\t\t<div class=\"item table right signin\" events=\"signin\">\r\n\t\t\t\t\t\t\t\t<div class=\"label\">\r\n\t\t\t\t\t\t\t\t\t<b><%=e('signinmenu')%></b>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"items workstation\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"item table right signup\" events=\"signup\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"label\">\r\n\t\t\t\t\t\t\t\t\t<b><%=e('signupmenu')%></b>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<% } %>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\t\t\r\n\r\n\t\t\t<div class=\"section leftpart\">\r\n\r\n\t\t\t\t<% if(haschat && state && isMobile() && window.testpocketnet) {%>\r\n\r\n\t\t\t\t\t<div class=\"items chat\">\r\n\r\n\t\t\t\t\t\t<div class=\"item table chatwr\" events=\"chats\">\r\n\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\r\n\t\t\t\t\t\t\t\t\t<i class=\"far fa-comment\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"amount\">\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t<div class=\"items sitenames\">\r\n\r\n\t\t\t\t\t\t<div class=\"item table sitename\" >\r\n\t\t\t\t\t\t\t<div class=\"icon\" events=\"sitename\">\r\n\t\t\t\t\t\t\t\t<img class=\"header_logo\" src=\"img/logo20.svg\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"label\">\r\n\t\t\t\t\t\t\t\t<div events=\"sitename\"><% if(app.test){%>TESTNET<%} else {%>POCKETNET<% }%></div>\r\n\t\t\t\t\t\t\t\t<div class=\"lang localization\">\r\n\t\t\t\t\t\t\t\t\t<% if(isMobile()) {%>\r\n\t\t\t\t\t\t\t\t\t\t<%-(lkey.key || '').toLowerCase()%> \r\n\t\t\t\t\t\t\t\t\t<% } else { %>\r\n\t\t\t\t\t\t\t\t\t\t<%-(lkey.name || '').toLowerCase()%> \r\n\t\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-caret-down\"></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\r\n\t\t\t\t<% if(typeof _Electron == 'undefined' && !window.cordova){ %> \r\n\r\n\t\t\t\t\t<!--<div class=\"items mdl workstation\">\r\n\r\n\t\t\t\t\t\t<div class=\"item table\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class=\"label\">\r\n\t\t\t\t\t\t\t\t<div><a href=\"about\"><%=e('aboutmenu')%></a></div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>-->\r\n\r\n\t\t\t\t<% } %>\r\n\r\n\t\t\t\t<!--<% if(!state){ %>  \r\n\r\n\t\t\t\t\t<div class=\"items gethotpostsWrapper\">\r\n\t\t\t\t\t\t<a href=\"index?r=recommended\">\r\n\t\t\t\t\t\t\t<div class=\"item table right onlyicon gethotposts\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"icn\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-fire\"></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"label\">\r\n\t\t\t\t\t\t\t\t\t\tTop posts\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>-->\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"section centerpart\">\r\n\t\t\t\t<% if(!app.curation()) {%>\r\n\t\t\t\t\t<div class=\"items searchWrapper\">\r\n\r\n\t\t\t\t\t\t<div class=\"item table right\" events=\"searchinit\">\r\n\t\t\t\t\t\t\t<div class=\"postssearchwrapper\">\r\n\t\t\t\t\t\t\t\t<div class=\"postssearch\">\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\r\n\t\t\r\n\r\n\t\t<div class=\"mobilemenu\">\r\n\r\n\t\t\t<div class=\"items\">\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t<% if(state) { %>\r\n\r\n\t\t\t\t\t<div class=\"itemGroup\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item\">\r\n\t\t\t\t\t\t<div class=\"label signout\" events=\"signout\">\r\n\t\t\t\t\t\t\t<%=e('signout')%>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\r\n\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"close\" events=\"hambclose\">\r\n\t\t\t\t<i class=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\t</div>\r\n\t\r\n\r\n</div>\r\n\r\n"},"toppanel":{"index":"<% if(!app.curation()) {%> \r\n<div id=\"<%-module.map.id%>\" class=\"hidden\">\r\n\t<div class=\"work\">\r\n\r\n\t\t<div class=\"panelitems\">\r\n\t\t\t\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n<% } %>","menu":"<% \r\n\r\nvar r = parameters(app.nav.current.completeHref, true).r;\r\nvar video = parameters(app.nav.current.completeHref, true).video;\r\n%>\r\n\r\n<% if(!app.curation()) {%> \r\n\r\n\t<% if(!state && !(pathname == 'index' && mobile)) {%>\r\n\r\n\t<div class=\"panelitem blexpl\">\r\n\t\t<a href=\"https://<%-app.options.url%>/blockexplorer/\"><i class=\"fas fa-th\"></i> <%=e('e13182')%></a>\r\n\t</div>\r\n\r\n\t<% } %>\r\n\r\n\r\n\t<% if(state || (pathname == 'index' && mobile)) {%>\r\n\r\n\t<% if(pathname == 'index' && mobile) {%>\r\n\t\t<div class=\"panelitem\">\r\n\t\t\t<%= selector.input() %>\r\n\t\t</div>\r\n\r\n\t<% } else { %>\r\n\t\t<div class=\"panelitem\">\r\n\t\t\t<a href=\"donations\"><i class=\"fas fa-money-bill-wave\"></i> <%=e('donate')%></a>\r\n\t\t\t<!--<i class=\"fas fa-sync\"></i> Exchange-->\r\n\t\t</div>\r\n\t<% } %>\r\n\r\n\t<% } %>\r\n\r\n<% } %>\r\n\r\n\r\n<% if(!mobile) { %>\r\n\r\n\t<div class=\"panelitemCenter\">\r\n\t\t<div class=\"centerTable table\">\r\n\r\n\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t<span class=\"pcenterLabel fresh <% if(!r && !video && pathname=='index') {%> active <% } %> \">\r\n\t\t\t\t\t<a href=\"index\" handler=\"true\"><%=e('e13136')%> <span class=\"lentaunseen\" key=\"common\"></span></a>\r\n\t\t\t\t</span>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t<span class=\"pcenterLabel <% if(r == 'sub' && pathname=='index') {%> active <% } %>\">\r\n\t\t\t\t\t<a href=\"index?r=sub\"  handler=\"true\"><%=e('e13137')%> <span class=\"lentaunseen \" key=\"sub\"></span></a>\r\n\t\t\t\t</span>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<% if(app.platform.videoenabled) {%>\r\n\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t<span class=\"pcenterLabel <% if(video && pathname=='index') {%> active <% } %>\">\r\n\t\t\t\t\t<a href=\"index?video=1\"  handler=\"true\"><%=e('video')%> <span class=\"lentaunseen\" key=\"video\"></span></a>\r\n\t\t\t\t\t\r\n\t\t\t\t</span>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<% } %>\r\n\t\t\t<div class=\"pcenterCell\">\r\n\t\t\t\t<span class=\"pcenterLabel toppost <% if(!video && r == 'recommended' && pathname=='index') {%> active <% } %>\">\r\n\t\t\t\t\t<a href=\"index?r=recommended\"  handler=\"true\"><%=e('e13138')%></a>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n<% } %>\r\n\r\n\r\n<% if(!app.curation()) {%> \r\n\t<div class=\"panelitem right\">\r\n\t\t<a href=\"help\"><%=e('e13183')%> <i class=\"fas fa-question-circle\"></i></a>\r\n\t</div>\r\n<% } %>"},"footer":{"index":"<div id=\"<%-module.map.id%>\">\r\n\t<div class=\"footerCenterWrapper\">\r\n        <div class=\"ftcWrapper\">\r\n            <div class=\"footerTable table\">\r\n\r\n                <div class=\"logoCellWrapper\">\r\n                     <div class=\"logoWrapper\">\r\n\r\n                        <div class=\"icon\">\r\n                            <img class=\"footer_logo\" src=\"img/logo20.svg\">\r\n                        </div>\r\n                        <div class=\"label\">\r\n                            <a href=\"index\"><b>POCKETNET</b></a>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                   \r\n                </div>\r\n                <div class=\"footerContentWrapper\">\r\n                    <div class=\"footerContentTableWrapper\">\r\n                        <div class=\"footerContentTable table\">\r\n                            <div class=\"column\">\r\n\r\n                                <% if(!window.cordova && os() && app.platform.applications.ui[os()]) {%>\r\n                                    <div class=\"fitem\">\r\n                                        <a href=\"applications\"><%=e('e13120')%></a>\r\n                                    </div>\r\n                                <% } %>\r\n                               \r\n                            </div>\r\n\r\n                            <div class=\"column\">\r\n                               \r\n                                <% if(!app.curation()) {%>\r\n                                    <div class=\"fitem\">\r\n                                        <a href=\"about\"><%=e('aboutus')%></a>\r\n                                    </div>\r\n                                <% } %>\r\n                                <div class=\"fitem localization\">\r\n                                    <div class=\"label\">\r\n\r\n                                        <% if(_SEO) { %>\r\n\r\n                                            <%= app.localization.locLinks() %>\r\n\r\n                                        <% } else { %>\r\n\r\n                                            <%= loc.input() %>\r\n\r\n                                        <% } %>\r\n\r\n                                    </div>\r\n                                </div>\r\n\r\n                                \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class=\"ye\">\r\n                Pocketnet, 2019&mdash;2021\r\n            </div>\r\n        </div>\r\n\r\n\r\n\r\n    </div>\r\n</div>"},"main":{"index":"<div id=\"<%-module.map.id%>\" class=\"testpocketnetbg\">\r\n\r\n\t<div class=\"upbuttonwrapper\">\r\n\t</div>\r\n\t<div class=\"maincntwrapperOvf\">\r\n\t\t<div class=\"maincntwrapper\" id=\"maincntwrapper\">\r\n\t\t\t<div class=\"work adj\">\r\n\r\n\t\t\t\t<div class=\"leftpanelcell\">\r\n\t\t\t\t\t<div class=\"cnt fxd\">\r\n\t\t\t\t\t\t<div class=\"leftpanel\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"mainpanelcell\">\r\n\t\t\t\t\t<div class=\"cnt fxd\">\r\n\t\t\t\t\t\t<div class=\"panel\">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"lentacell\">\r\n\r\n\t\t\t\t\t<div class=\"cnt\">\r\n\r\n\t\t\t\t\t\t<% \r\n\r\n\t\t\t\t\t\t\tvar h = 'hidden'\r\n\r\n\t\t\t\t\t\t\tif(state && !parameters().r) {\r\n\r\n\t\t\t\t\t\t\t\th = ''\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} \r\n\r\n\r\n\r\n\t\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t\t<div class=\"bgCaption sec <%-h%>\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class=\"share\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"topvideosWrapper\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"lentaWrapper\">\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"opensvi\">\r\n\r\n\t\t<div class=\"upbackbuttonwrapper\">\r\n\t\t</div>\r\n\r\n\t\t<div class=\"work adj\">\r\n\r\n\t\t\t<div class=\"leftpanelsvicell\">\r\n\t\t\t\t<div class=\"cnt fxd\">\r\n\t\t\t\t\t<div class=\"leftpanelsvi\">\r\n\t\t\t\t\t\t<button class=\"button small backtolenta\"><i class=\"fas fa-caret-left\"></i> <%=e('back')%></button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class=\"mainpanelsvicell\">\r\n\t\t\t\t<div class=\"cnt fxd\">\r\n\t\t\t\t\t<div class=\"panelsvi\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"lentacellsvi\">\r\n\t\t\t\t<div class=\"cnt\">\r\n\t\t\t\t\t<div class=\"renderposthere\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\t\r\n\t<div class=\"addbutton\">\r\n\t\t<i class=\"fas fa-signature\"></i>\r\n\t</div>\r\n\r\n\t<div class=\"columnnavigationWrapper\">\r\n\t\t\r\n\t</div>\r\n\r\n\t\r\n\t\r\n</div>"},"panel":{"index":"<div id=\"<%-module.map.id%>\">\r\n\r\n\t\r\n\r\n\t<!--<div class=\"tagscnt\">\t\r\n\t</div>-->\r\n\t\r\n\t\r\n\r\n\t<div class=\"stackingcnt\">\t\r\n\t</div>\t\r\n\t\r\n\t<div class=\"lastcommentscnt\">\t\r\n\t</div>\r\n\r\n\t<div class=\"panelcnt\">\r\n\t</div>\r\n\r\n\t<div class=\"rightbottomnav\">\r\n\r\n\t\t<div class=\"rightbottomlinks\">\r\n\t\t\t<a href=\"https://<%-app.options.url%>/blockexplorer/\">Block Explorer</a>\r\n\t\t\t<span>&middot;</span>\r\n\t\t\t<a href=\"help?page=faq\">F.A.Q.</a>\r\n\t\t\t<span>&middot;</span>\r\n\t\t\t<a href=\"help?page=roadmap\">Roadmap</a>\r\n\t\t\t<span>&middot;</span>\r\n\t\t\t<a href=\"help?page=node\">Node&nbsp;Setup</a>\r\n\t\t\t<span>&middot;</span>\r\n\t\t\t<a href=\"help?page=pkoin\" data-anchor=\"pocketcoin\">PKOIN</a>\r\n\t\t\t<span>&middot;</span>\r\n\t\t\t<a href=\"help?page=applications\">Applications</a>\r\n\r\n\t\t\t<% var year = new Date().getFullYear() %>\r\n\r\n\t\t\t<div class=\"copyright\">\r\n\t\t\t\t<img class=\"copy_logo\" src=\"img/logogray.png\" alt=\"logo\">\r\n\t\t\t\t<span class=\"copyright_text\">Pocketnet, 2019 — <%-year%></span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\t\r\n\t<!--\r\n\t\t<div class=\"recommendationscnt\">\t\r\n\t\t</div>\r\n\t-->\r\n\r\n\t\r\n</div>","discussiondummy":"<div class=\"discussiondummy\">\r\n    <a href=\"oldchat?chatid=6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd\">\r\n        Pocketnet chat\r\n    </a>\r\n</div>"},"leftpanel":{"index":"<div id=\"<%-module.map.id%>\">\r\n\r\n\r\n\t<div class=\"catscnt\">\t\r\n\t</div>\r\n\t\r\n\t<div class=\"tagscnt\">\t\r\n\t</div>\r\n\r\n\t<div class=\"currentsearchcnt\">\r\n\t</div>\r\n\r\n\t<div class=\"subtop\">\r\n\t</div>\r\n\r\n</div>"},"lastcomments":{"index":"<div id=\"<%-module.map.id%>\">\r\n\r\n\t\r\n</div>","lastcommentslist":"<div class=\"wrp\">\r\n    <div class=\"rcptwrp\">\r\n\r\n                    <div class=\"rcaption\">\r\n                        <span><%=e('e13122')%></span>\r\n                    </div>\r\n\r\n        \r\n\r\n        <div class=\"lastcommentslistwrapper\">\r\n            <div class=\"lastcommentslist\">        \r\n\r\n            \r\n\r\n    <% _.each(comments, function(group, postid){ \r\n        \r\n        var share = app.platform.sdk.node.shares.storage.trx[postid]\r\n        \r\n        if(!share) return\r\n\r\n        if(share.address == 'PR7srzZt4EfcNb3s27grgmiG8aB9vYNV82') return\r\n\r\n\r\n        var me = app.platform.sdk.user.me()\r\n        if (me && me.relation(share.address, 'blocking')) {\r\n            return\r\n        }\r\n        \r\n        var h = '';\r\n\r\n        var m = '';\r\n\r\n        if(share.caption) m = m + '' + share.caption + ' '\r\n\r\n        if(share.message) m = m + '' + share.message + ''\r\n\r\n        var nm = filterXSS(trimHtml(m, 80), {\r\n            stripIgnoreTag : true,\r\n            whiteList: {\r\n                b : [\"style\"]\r\n            }\r\n        });\r\n\r\n        if(!nm) return\r\n\r\n        var image = share.images[0] || deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image');\r\n        var video = null;\r\n\r\n        var vstyle = false;\r\n\r\n        var cmts = _.filter(group, function(c){\r\n            return c.message\r\n        })\r\n\r\n        if(!cmts.length) return\r\n\r\n        if (share.url){\r\n            video = videoImage(share.url)\r\n            vstyle = true;\r\n        } %>\r\n\r\n        <div class=\"commentgroup\" share=\"<%-postid%>\">\r\n\r\n            <!--<div class=\"sharepreview\">\r\n                <div class=\"shareprwrapper table\">\r\n\r\n                <% if(video || image){ %>\r\n\r\n                    <div class=\"tcell forimage\">\r\n                        <div class=\"img\" image=\"<%-(video || image)%>\">\r\n\r\n                        <% if(vstyle){ %>\r\n                            <div class=\"vstyle\">\r\n                            <i class=\"fas fa-play\"></i>\r\n                            </div>\r\n                        <% } %>\r\n\r\n                        </div>\r\n                    </div>\r\n\r\n                <% } %>\r\n\r\n                    <div class=\"tcell fortext\">\r\n                        <div class=\"sharecaption\">\r\n                            <span><%= nm %></span>\r\n                        </div>\r\n\r\n                    \r\n\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </div>-->\r\n\r\n            <div class=\"comments\">\r\n                <% _.each(group, function(comment){ \r\n                    \r\n                    if(comment.deleted || !comment.message) return\r\n\r\n                    if (me && me.relation(comment.address, 'blocking')) {\r\n                        return\r\n                    }\r\n                    \r\n                    %> \r\n\r\n                    <div class=\"comment \" id=\"<%-comment.id%>\" aid=\"<%-comment.answerid%>\" pid='<%-comment.parentid%>'>\r\n\r\n                        <div class=\"commentPaddingWrapper\">\r\n\r\n                            <div class=\"icons\">\r\n\r\n                                <div class=\"iconWrapper\">\r\n                                    <% var src = deep(app, 'platform.sdk.usersl.storage.'+comment.address+'.image')  %>\r\n            \r\n                                    <div class=\"icon\">\r\n                                        <div class=\"usericon\" image=\"<%-src || ''%>\">\r\n                                        </div>\r\n                                    </div>\r\n            \r\n                                </div>\r\n\r\n                                <% if(comment.address != share.address) {%>\r\n\r\n                                <div class=\"iconbetweenWrapper\">\r\n                                    <i class=\"fas fa-long-arrow-alt-right\"></i>\r\n                                </div>\r\n\r\n                                <div class=\"iconWrapper\">\r\n                                    <% var src2 = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image')  %>\r\n            \r\n                                    <div class=\"icon\">\r\n                                        <div class=\"usericon\" image=\"<%-src2 || ''%>\">\r\n                                   \r\n                                        </div>\r\n                                    </div>\r\n            \r\n                                </div>\r\n\r\n                                <% } %>\r\n\r\n                            </div>\r\n                \r\n                            <div class=\"commentWrapper table\">\r\n                \r\n                                \r\n                \r\n                                <div class=\"commentBody\">\r\n                \r\n                                   \r\n                \r\n                                    <div class=\"cbodyWrapper\">\r\n                \r\n                                        <div class=\"commentcontenttable table\">\r\n                                            <div class=\"commentcontent\">\r\n                \r\n                                                <% if(comment.message) {\r\n                \r\n                                                    var l = findAndReplaceLink(filterXSS(comment.message, {\r\n                                                        whiteList: [],\r\n                                                        stripIgnoreTag: true\r\n                                                    }), true)\r\n                \r\n                                                    m = joypixels.toImage(l)\r\n\r\n                                                %>\r\n                \r\n                                                    <div class=\"commentmessage\">\r\n                                                        <div><b><%-deep(app, 'platform.sdk.usersl.storage.'+comment.address+'.name') || comment.address %></b> <% if(comment.address != share.address) {%> <i class=\"fas fa-long-arrow-alt-right\"></i> <b><%-deep(app, 'platform.sdk.usersl.storage.'+share.address+'.name') || share.address %></b><% } %>: <%=nl2br(trimHtml(trimrn(m), 120))%> <span class=\"realtime\" time=\"<%-comment.time%>\"><%- app.reltime(comment.time) %></span></div>\r\n                                                    </div>\r\n                \r\n                                                <% } %>\r\n                                        \r\n                \r\n                                            </div>\r\n                \r\n                                            \r\n                                        </div>                                                \r\n                \r\n                                    </div>\r\n\r\n                                \r\n                                    \r\n                                </div>\r\n                \r\n                            </div>\r\n                \r\n                        </div>\r\n                \r\n                    </div>\r\n                    \r\n                <% }) %>\r\n            </div>\r\n\r\n        </div>\r\n        \r\n    <% }) %>\r\n\r\n        </div>\r\n    </div>\r\n</div>\r\n</div>"},"tagcloud":{"index":"<div id=\"<%-module.map.id%>\">\r\n\t<div class=\"wrp\">\r\n\t\t<div class=\"rcptwrp\">\r\n\t\t\t<div class=\"tcaptionwrapper\">\r\n\t\t\t\t<div class=\"tcaptiontable table\">\r\n\t\t\t\t\t<div class=\"tcaption\">\r\n\t\t\t\t\t\t<span><%=e('e13175')%></span> \r\n\t\t\t\t\t</div>\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div class=\"mlab ticon cleartags\">\r\n\t\t\t\t\t\t<i class=\"fas fa-ban\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\r\n\t\t\t<div class=\"tags\">\r\n\r\n\t\t\t\t<div class=\"preloaderwrapper\">\r\n\t\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\t\r\n\t\t</div>\r\n\t</div>\r\n</div>"},"categories":{"index":"<div id=\"<%-module.map.id%>\">\r\n\r\n\t<div class=\"wrp\">\r\n\t\t<div class=\"rcptwrp\">\r\n\t\t\t<div class=\"tcaptionwrapper\">\r\n\t\t\t\t<div class=\"tcaptiontable table\">\r\n\t\t\t\t\t<div class=\"tcaption\">\r\n\t\t\t\t\t\t<span><%=e('Categories')%></span> \r\n\t\t\t\t\t</div>\t\r\n\t\t\t\t\t<div class=\"ticon addcategory\">\r\n\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"mlab ticon clearcategories\">\r\n\t\t\t\t\t\t<i class=\"fas fa-ban\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class=\"cats\">\r\n\r\n\t\t\t\t<div class=\"preloaderwrapper\">\r\n\t\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\t\r\n\t\t</div>\r\n\t</div>\r\n</div>","categories":"<div class=\"ta\">\r\n    <% _.each(cats, function(cat, i){ \r\n        \r\n        var title = _.map(cat.tags, function(w){return \"#\" + w}).join(', ')\r\n        \r\n        %>\r\n\r\n        <div category=\"<%-cat.id%>\" class=\"tg <% if(cat.added) {%> added <% } %> <% if(cat.selected) {%> selected <% } %> <% if(i > 9) {%> hdn <% } %>\">\r\n\r\n            \r\n                <div class=\"cat\">\r\n                    <div class=\"cattable table\">\r\n\r\n                        <div class=\"catvalue catcheckgl\" title=\"<%-title%>\">\r\n                            <span ><%- cat.name %></span>\r\n                        </div>\r\n\r\n                        <div class=\"catcheck catcheckgl\">\r\n                            \r\n                            <i class=\"far fa-circle unselected\"></i>\r\n                            <i class=\"far fa-check-circle selected\"></i>\r\n                        </div>\r\n\r\n                        <div class=\"catsearch\">\r\n                            <a href=\"?sst=<%-cat.tags.join(' ')%>\">\r\n                                <i class=\"fas fa-search\"></i>\r\n                            </a>\r\n                        </div>\r\n                        <% if(cat.added) {%>\r\n                        <div class=\"catedit\">\r\n                            <i class=\"fas fa-pencil-alt\"></i>\r\n                        </div>\r\n                        <% } %>\r\n\r\n                    </div>\r\n                </div>\r\n        </div>\r\n\r\n    <% }) %>\r\n\r\n    <% if(cats.length > 9) {%>\r\n\r\n        <div class=\"showallcats showhideallcats\">\r\n            <span><%=e('e13021')%></span>\r\n        </div>\r\n\r\n        <div class=\"hideallcats showhideallcats\">\r\n            <span><%=e('hide')%></span>\r\n        </div>\r\n\r\n    <% } %>\r\n\r\n</div>"},"lenta":{"share":"<%\r\n\r\nvar c = share.renders.caption();\r\nvar m = share.renders.message();\r\n\r\nif(typeof ed == 'undefined') ed = {}\r\n\r\n\r\nif(share.address){\r\n\r\n\tvar my = (user.address.value && share.address == user.address.value.toString('hex'))\r\n\tvar subscribed = '';\r\n\r\n\tif(!my && user.address.value){\r\n\r\n\t\tvar me = deep(app, 'platform.sdk.users.storage.' + user.address.value.toString('hex'))\r\n\r\n\r\n\t\tif (me && me.relation(share.address, 'subscribes')){\r\n\t\t\tsubscribed = 'subscribed'\r\n\t\t}\r\n\t}\r\n\r\nvar view = 'post';\r\n\r\nif(share.settings.v == 'a'){\r\n\tview = 'article'\r\n}\r\nvar bigmessage = false;\r\nvar name = app.platform.api.name(share.address)\r\n\r\nvar emptywithrepost = share.isEmpty() && share.repost\r\n\r\nvar value = Number(share.score)\r\n\r\n\r\nvar metadisplay = function(){ %>\r\n\r\n<div class=\"meta\">\r\n\t<div class=\"metatable table\">\r\n\t\t<div class=\"metadata\">\r\n\r\n\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t<div class=\"author\">\r\n\r\n\t\t\t\t\t<div class=\"authorTable table\">\r\n\t\t\t\t\t\t<div class=\"authorCell\">\r\n\r\n\t\t\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\r\n\r\n\t\t\t\t\t\t\t<% var reputation = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.reputation') || 0 %>\r\n\t\t\t\t\t\t\t\t<b><span class=\"adr\"><%-name || share.address %></span></b><% if(reputation) {%><sup class=\"spsp\"><%-compressedNumber(reputation, 1)%></sup><% } %>\r\n\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t<% if((!state || !my) && (typeof repost == 'undefined' || !repost)) { %> \r\n\r\n\t\t\t\t\t\t\t\t<span class=\"sbtnxs\">\r\n\t\t\t\t\t\t\t\t\t&middot; <span class=\"subscribeLabel asubscribe\"><%=e('sub')%></span><span class=\"subscribedLabel aunsubscribe\"><i class=\"far fa-check-circle\"></i>  <%=e('following')%></span> \r\n\t\t\t\t\t\t\t\t\t<% if(state && !my && user.address.value) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar r = me.relation(share.address, 'subscribes') \r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t%>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"notificationturn <% if(r && (r.private == 'true' || r.private === true)) {%> turnon <% } %>\">&middot; <i class=\"far fa-bell-slash\"></i></span>\r\n\t\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } else { %> \r\n\t\t\t\r\n\t\t\t\t<div class=\"repostCaption\">\r\n\t\t\t\t\t<i class=\"fas fa-share\"></i> \r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\t\t\t\t\t\t<span class=\"adr\"><%-name || share.address %></span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t<% } %>\r\n\t\t\r\n\t\t</div>\r\n\r\n\t\t<% if(state && (typeof repost == 'undefined' || !repost)) { %>\t\t\t\r\n\r\n\t\t\t<div class=\"metapanel\">\r\n\t\t\t\t<div class=\"metapanelitem metmenu\">\r\n\t\t\t\t\t<i class=\"fas fa-ellipsis-h\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t<% if(typeof repost != 'undefined' && repost && !fromempty) { %> \r\n\r\n\t\t\t<div class=\"metapanel\">\r\n\t\t\t\t<div class=\"metapanelitem\">\r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>?s=<%-share.txid%>&mpost=true\">\r\n\t\t\t\t\t\t<i class=\"fas fa-share\"></i> \r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t<% } %>\r\n\t\t\r\n\t</div>\t\t\t\t\t\r\n</div>\r\n\t\r\n<% }\r\n\r\n%>\r\n\r\n<% var arranges = {\r\n\t\r\n\tcm : function(){ %> \r\n\r\n\t\t<% if(c) {\r\n\r\n\t\t\tc = filterXSS(clearScripts((findAndReplaceLink(c, true))))\r\n\t\t%>\r\n\t\t\t<div class=\"paddingWrapper hideOnFullVideo\">\r\n\t\t\t\t<div class=\"sharecaption canmark\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<%=joypixels.toImage(nl2br(trimrn(c)))%>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t<% if(m) {\r\n\r\n\t\t\tm = (m)\r\n\t\t\t\r\n\t\t\tvar nm = m;\r\n\r\n\t\t\tif(typeof all == 'undefined' || !all){\r\n\r\n\t\t\t\tnm = trimHtml(m, 750);\r\n\r\n\t\t\t\tif(nm != m){\r\n\t\t\t\t\tbigmessage = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tnm = share.renders.xssmessage(nm)\r\n\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t%>\r\n\t\t\t<div class=\"paddingWrapper hideOnFullVideo\">\r\n\t\t\t\t<div class=\"message canmark\">\r\n\r\n\t\t\t\t\t<%=joypixels.toImage((clearScripts(((nm)))))%>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<% if(bigmessage) {%>\r\n\r\n\t\t\t\t<div class=\"paddingWrapper showMorePW\">\r\n\t\t\t\t\t<div class=\"showMore\">\r\n\t\t\t\t\t\t<div class=\"showmoretable table\">\r\n\t\t\t\t\t\t\t<!-- <div class=\"linecell\">\r\n\t\t\t\t\t\t\t\t<div class=\"line\"></div>\r\n\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t\t<div class=\"buttoncell\">\r\n\t\t\t\t\t\t\t\t<button>\r\n\t\t\t\t\t\t\t\t\t<%=e('showmore')%>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<!-- <div class=\"linecell\">\r\n\t\t\t\t\t\t\t\t<div class=\"line\"></div>\r\n\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t<% } %>\r\n\t\t\r\n\t<% },\r\n\r\n\t\r\n\ti : function(){ %> \r\n\t\t<% if(share.images.length) {\r\n\r\n\t\t\t\tvar icClass = '';\r\n\t\t\t\tvar additionall = 0;\r\n\t\t\t\tvar imageFromVideo = ''\r\n\r\n\r\n\t\t\t\tif(share.url && parseVideo(share.url).type){\r\n\t\t\t\t\tadditionall++;\r\n\t\t\t\t\timageFromVideo = videoImage(share.url)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (share.images.length + additionall == 1) icClass = 'one';\r\n\t\t\t\tif (share.images.length + additionall == 2) icClass = 'two';\r\n\t\t\t\tif (share.images.length + additionall == 2) icClass = 'three';\r\n\t\t\t\tif (share.images.length + additionall == 4) icClass = 'four';\r\n\t\t\t\tif (share.images.length + additionall > 4) icClass = 'more';\r\n\t\t\t\t\r\n\r\n\r\n\t\t\t\tif(share.settings.v == 'a'){ \r\n\r\n\t\t\t\t\ticClass = 'articleImages'\r\n\r\n\t\t\t\t%>\r\n\r\n\t\t\t\t\t<div class=\"imagecaption\">\r\n\t\t\t\t\t\t<%=e('e13129')%>:\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n \r\n\t\t\t\t<div class=\"images hideOnFullVideo\">\r\n\t\t\t\t\t<div class=\"imagesContainer <%-icClass%>\">\r\n\t\t\t\t\t\t<% _.each(share.images, function(image){ %>\r\n\r\n\t\t\t\t\t\t\t<div class=\"imagesWrapper\">\r\n\t\t\t\t\t\t\t\t<div class=\"image imageOpen imagePostOpent\" image=\"<%-image%>\" i=\"<%-image%>\">\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t\t\t<% if(imageFromVideo) {%>\r\n\r\n\t\t\t\t\t\t\t<div class=\"imagesWrapper forvideo\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"image videoOpen\" image=\"<%-imageFromVideo%>\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"playicon\"><i class=\"fas fa-play\"></i></div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t<% },\r\n\r\n\tu : function(){\t%> \r\n\t\t<% if(share.url) {\r\n\r\n\r\n\t\t\tvar h = ''\r\n\t\t\t\r\n\t\t\tif(parseVideo(share.url).type && share.images.length){\r\n\t\t\t\th = 'hiddenurl'\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t%>\r\n\r\n\t\t\t<div class=\"url <%-h%>\">\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t<% },\r\n\r\n\r\n} %>\r\n\r\n\t<div class=\"work\">\r\n\r\n\t\t<div class=\"shareTable <%-subscribed%> <%-view%> <% if(emptywithrepost) { %> emptywithrepost <% } else { %> truerepost <% } %>\" address=\"<%-share.address%>\" stxid=\"<%-share.txid%>\">\r\n\r\n\t\t\t<% if(!emptywithrepost) { %>\r\n\r\n\t\t\t\t<div class=\"iconWrapper\">\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\r\n\r\n\t\t\t\t\t\t<% var src = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image')  %>\r\n\r\n\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t<div class=\"usericon usericonsbsa another\" image=\"<%-src || ''%>\">\r\n\t\t\t\t\t\t\t\t<% if(!src) {%>\r\n\t\t\t\t\t\t\t\t\t<svg width=\"30\" height=\"30\" data-jdenticon-value=\"<%-share.address%>\"></svg>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t<% if(deep(app, 'platform.real.'+share.address)) {%>\r\n\t\t\t\t\t\t\t\t\t<div class=\"realperson\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"fa-stack fa-2x\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-certificate fa-stack-2x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-check fa-stack-1x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t  </span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</a>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t\t<div class=\"cntswrk hideOnFullVideo formeta\">\r\n\r\n\t\t\t\t<div class=\"metawrapper\"> \r\n\t\t\t\t\t<% metadisplay() %> \r\n\t\t\t\t</div> \r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"cntswrk\">\r\n\r\n\r\n\t\t\t\t<% var a = share.settings.a || share.default.a %>\r\n\r\n\r\n\t\t\t\t<% _.each(a, function(key, i){ %> \r\n\r\n\t\t\t\t\t<% if(arranges[key]) arranges[key]() %>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"repostWrapper\"></div>\r\n\r\n\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t<div class=\"cntswrk\">\r\n\t\t\t\t\t<div class=\"paddingWrapper\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% if(share.tags && share.tags.length > 0) {\r\n\r\n\t\t\t\t\t\t\tvar bycategories = app.platform.sdk.categories.fromTags(share.tags, share.lanuage)\r\n\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t\t\t<div class=\"tags canmark hideOnFullVideo\">\r\n\t\t\t\t\t\t\t\t<% _.each(bycategories.categories, function(category){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"category\">\r\n\t\t\t\t\t\t\t\t\t\t<a href=\"index?sst=<%-category.tags.join(' ')%>\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span><b>@<%-category.name%></b></span> \r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t<!--<% _.each(category.tags, function(tag){ %><span>#<%-tag%></span><% }) %><span>;</span>-->\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t\t\t\t\t<% _.each(bycategories.tags, function(tag){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"tag\">\r\n\t\t\t\t\t\t\t\t\t\t<a href=\"index?sst=<%-tag%>\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t#<%-tag%>\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<% }) %>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% if((typeof repost == 'undefined' || !repost || fromempty)) {%>\r\n\t\t\t\t\t\t\t<div class=\"sys hideOnFullVideo\">\r\n\t\t\t\t\t\t\t\t<% if(share.time) {%>\r\n\r\n\t\t\t\t\t\t\t\t\t<span  class=\"realtime\" time=\"<%-share.time%>\"><%- app.reltime(share.time) %></span>\r\n\r\n\t\t\t\t\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t\t\t\t\t<span><%=e('e13019')%></span>\r\n\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t<% if(share.edit == 'true') {%>\t\r\n\t\t\t\t\t\t\t\t\t<span class=\"editedLabel\"><i class=\"fas fa-pencil-alt\"></i> <%=e('e13130')%></span>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<% if(!share.temp &&  (typeof repost == 'undefined' || !repost || fromempty)) {%>\r\n\t\t\t\t\t\t\t<div class=\"panel\">\r\n\t\t\t\t\t\t\t\t<div class=\"item forstars\">\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<% if(app.platform.repost && !my) {%>\r\n\t\t\t\t\t\t\t\t\t<div class=\"item <% if(!my){ %> forrepost <% } else { %> nact <% } %>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"itemwr table\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-share\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<!--<% if(share.reposted || my) {%> \r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"labelwr\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"label\"><%-share.reposted || 0%></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<% } %>-->\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"item sharesocial right unselectable\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"itemwr table\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"labelwr workstation\"><span class=\"label\"><%=e('share').toUpperCase()%></span></div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-share-alt\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"wholikes\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<% if(share.temp) {%>\r\n\r\n\t\t\t\t\t\t\t<div class=\"panel\">\r\n\t\t\t\t\t\t\t\t<div class=\"item right\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"itemwr table tempPreloader\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"count\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"label\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span><%=e('postWaitConf')%></span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"clearfix\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\r\n\t\t\t\t\t\t<% \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(typeof verticalVideo != 'undefined' && verticalVideo) {%>\r\n\r\n\t\t\t\t\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t\t\t\t\t<% if(typeof repost == 'undefined' || !repost || fromempty) {%>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<div class=\"commentsWrapperHb\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"commentsWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=\"blockAuthor\">\r\n\t\t\t<div class=\"blockTable table\">\r\n\t\t\t\t<div class=\"blockCell\">\r\n\t\t\t\t\t<div class=\"label\"><%=e('e13131')%></div>\r\n\r\n\t\t\t\t\t<div class=\"unblockWrapper\">\r\n\t\t\t\t\t\t<button class=\"button small unblockbutton\">\r\n\t\t\t\t\t\t\tUnblock\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n\t<div class=\"exitFull roundclosebutton\">\r\n\t\t<i class=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n\t</div>\r\n\r\n\t<% if(typeof verticalVideo == 'undefined' || !verticalVideo) {%>\r\n\r\n\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t<% if(typeof repost == 'undefined' || !repost || fromempty) {%>\r\n\t\r\n\t\t\t\t<div class=\"commentsWrapperHb\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div class=\"commentsWrapper\">\r\n\t\t\t\t\t</div>\r\n\t\r\n\t\t\t\t</div>\r\n\t\r\n\t\t\t<% } %>\r\n\t\r\n\t\t<% } %>\r\n\r\n\t<% } %>\r\n\r\n\t\r\n\r\n\t<% if(app.platform.istest && app.platform.istest() && share.info && !_.isEmpty(share.info)) {%>\r\n\t\t<div class='debuginfo'>\r\n\r\n\t\t\t<div class=\"icon\">\r\n\t\t\t\t<i class=\"fas fa-sort-down\"></i>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"info\">\r\n\t\t\t\t\r\n\t\t\t\t<% _.each(share.info, function(k, v){\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(v == 'LAST5RADRS' || v == 'PREPRADRS'){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar ids = _.map(k, function(a){\r\n\t\t\t\t\t\t\treturn a.address + '_' + a.value\r\n\t\t\t\t\t\t}).join(',')\r\n\r\n\t\t\t\t\t\tif(!ids.length) return\r\n\t\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t\t<div class=\"lll\"><b><%-v%></b>:</div>\r\n\r\n\t\t\t\t\t\t<div class=\"testusersprofiles\" ids=\"<%-ids%>\">\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"\">\r\n\t\t\t\t\t\t\t___________________\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<%\treturn \r\n\t\t\t\t\r\n\t\t\t\t\t} %>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span><%-v %></span>\r\n\t\t\t\t\t\t<b><%- Number(k || 0).toFixed(2) %></b>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t<% }) %>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span>TXID:</span>\r\n\t\t\t\t\t<b><%-share.txid%></b><br>\r\n\t\t\t\t</div>\t\r\n\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t<% } %>\r\n\r\n<% } %>","shares":"<% \r\nvar i = index || 0;\r\n\r\nshares = _.filter(shares, function(s){\r\n\r\n\tvar name = deep(app, 'platform.sdk.usersl.storage.' + s.address + '.name') || ''\r\n\t\r\n\tname = name.toLowerCase().replace(/[^a-z]/g,'')\r\n\r\n\tif((name.indexOf('pocketnet') == -1 || s.address == 'PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd' || s.address == 'PJ3nv2jGyW2onqZVDKJf9TmfuLGpmkSK2X') ){\r\n\t\treturn true\r\n\t}\r\n})\r\n\r\n\r\nvar me = app.platform.sdk.user.me()\r\n\r\n_.each(shares, function(share){\r\n\r\n %>\r\n\t<div class=\"share <% if(me && me.relation(share.address, 'blocking')) {%>blocking<% } %> shareinlenta\" id=\"<%-share.txid%>\">\r\n\t\t<div class=\"shareSpacer\">\r\n\t\t\t\r\n\t\t</div>\r\n\r\n\r\n\t\t\r\n\t</div>\r\n<% \r\n\r\ni++;\r\n\r\n}) %>","wholike":"<% if(wholikes.length) {\r\n    \r\n    wholikes = firstEls(wholikes, 3);\r\n    \r\n    %>\r\n\r\n    <div class=\"wholikesTable\">\r\n        <% _.each(wholikes, function(whl, i){ %> \r\n            <div class=\"wholikeAuthorTable table\">\r\n                <div class=\"uiconcell\">\r\n                    <div class=\"usericon usericonsbsa another\" image=\"<%-whl.avatar%>\">\r\n                        <% if(!whl.avatar) {%>\r\n                            <svg width=\"30\" height=\"30\" data-jdenticon-value=\"<%-whl.address%>\"></svg>\r\n                        <% } %>\r\n                    </div> \r\n                </div>\r\n                <div class=\"unamecell\">\r\n                    <b><%-decodeURIComponent(whl.name)%></b><% if(i < wholikes.length - 1) {%>, <%} else {%>\r\n\r\n                        \r\n\r\n                            <span class=\"morelikes\">\r\n                                <% if(wholikes.length < scores) {%>\r\n                                    + <b><%- scores - wholikes.length %></b> <%- pluralform(scores - wholikes.length, [e('user'), e('userstx')]) %>\r\n                                <% } %>\r\n\r\n                                <%=e('e13132')%>\r\n                            </span>\r\n                \r\n                       \r\n\r\n                    <% } %>\r\n\r\n\r\n\r\n                </div>\r\n            </div>\r\n            \r\n        <% }) %>\r\n\r\n       \r\n    </div>\r\n\r\n<% } %>","index":"<div id=\"<%-module.map.id%>\">\r\n\r\n\t<div class=\"mlwr\">\r\n\r\n\t\t<div class=\"loadprev\"><button><span><%=e('lloadprev')%></span><!-- <span class='countnew'></span>--></button></div>\r\n\r\n\t\t<div class=\"circularprogress\">\t\r\n\t\t\t<div class=\"circularprogressWrapper\"></div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"shares\">\r\n\t\t\t<div class=\"bspacer\"></div>\t\t\r\n\t\t</div>\r\n\r\n\t\t<div class=\"tspacer\"></div>\r\n\r\n\t\t<% if(!app.curation()) {%>\r\n\r\n\t\t\t<div class=\"loadmore\"><button><%=e('lloadmore')%></button></div>\r\n\r\n\t\t\t<% if(recommended == 'recommended') {%>\t\r\n\r\n\t\t\t\t<!--<div class=\"seemore\">\r\n\t\t\t\t\t<a href=\"index\" handler=\"true\">\r\n\t\t\t\t\t\t<button><%=e('lloadmore')%></button>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>-->\r\n\r\n\t\t\t<% } else { %> \r\n\r\n\t\t\t\t<div class=\"ended\">\r\n\t\t\t\t\t<a href=\"index?r=recommended\">\r\n\t\t\t\t\t\t<button style=\"border-radius: 50px;\"><%=e('e13124')%></button>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t<% } %>\r\n\r\n\r\n\t\t\t<div class=\"zero\">\r\n\t\t\t\t\r\n\t\t\t\t<%=e('zeron')%>\t\r\n\t\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\r\n\t\t<% if(author) {%>\r\n\r\n\t\t\t<div class=\"zero\">\r\n\t\t\t\t\r\n\t\t\t\t<% if(!app.platform.sdk.address.pnet() || app.platform.sdk.address.pnet().address != author) {%>\r\n\r\n\t\t\t\t\t<%=e('zerop')%>\r\n\r\n\t\t\t\t<% } else { %>\r\n\r\n\t\t\t\t\t<% \r\n\t\t\t\t\t\tvar h = 'index';\r\n\r\n\t\t\t\t\t\tif(isMobile()){\r\n\t\t\t\t\t\t\th = 'share'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t<a href=\"<%-h%>?newshare=1\">\r\n\t\t\t\t\t\t<div class=\"tou\">\r\n\t\t\t\t\t\t\t<i class=\"fas fa-share\"></i> <%=e('zeroy')%> \r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t<% } %>\t\t\r\n\t\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\r\n\t\t<% if(recommended) {%>\r\n\r\n\t\t\t<div class=\"zero\">\r\n\r\n\t\t\t<% if(recommended == 'recommended') {%>\t\r\n\r\n\t\t\t\t<%=e('e13125')%>\r\n\t\t\t\t\r\n\t\t\t<% } else { %>\r\n\t\t\t\t\r\n\t\t\t\t<% if(state) { \r\n\t\t\t\t\t\r\n\t\t\t\t\tvar t = app.platform.sdk.node.transactions.temp || {}\r\n\t\t\t\t\tvar r = app.platform.sdk.relayTransactions.storage[user.address.value] || {}\r\n\r\n\r\n\t\t\t\t\tif(!_.isEmpty(t.subscribe) || !_.isEmpty(t.subscribePrivate) || !_.isEmpty(r.subscribe) || !_.isEmpty(r.subscribePrivate)){ %> \r\n\r\n\t\t\t\t\t\t<%=e('e13126')%>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t\t<%=e('e13127')%>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t<% } else { %> \r\n\r\n\t\t\t\t\t<div class=\"zerocaption\">\r\n                        <span>\r\n\t\t\t\t\t\t\t<%=e('e13128')%>\r\n                        </span>\r\n                    </div>\r\n                    <div class=\"subc\">\r\n                        <a href=\"filluserfast\">\r\n                            <button><%=e('registration')%></button>\r\n                        </a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t<% } %>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t\t\r\n\r\n\t\t<div class=\"networkErrorMessage\">\r\n\t\t\t<i class=\"fas fa-wifi\"></i>\r\n\t\t</div>\t\r\n\r\n\t\t<div class=\"loader\">\r\n\t\t\t<div class=\"work\">\r\n\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>","sharevideo":"<%\r\n\r\nvar c = share.renders.caption();\r\nvar m = share.renders.message();\r\nvar bigmessage = false\r\n\r\nif(typeof ed == 'undefined') ed = {}\r\n\r\nif(share.address){\r\n\r\n\tvar my = (user.address.value && share.address == user.address.value.toString('hex'))\r\n\tvar subscribed = '';\r\n\r\n\tif(!my && user.address.value){\r\n\r\n\t\tvar me = deep(app, 'platform.sdk.users.storage.' + user.address.value.toString('hex'))\r\n\t\tif (me && me.relation(share.address, 'subscribes')){\r\n\t\t\tsubscribed = 'subscribed'\r\n\t\t}\r\n\t}\r\n\r\nvar view = 'post';\r\nvar name = app.platform.api.name(share.address)\r\nvar emptywithrepost = share.isEmpty() && share.repost\r\nvar value = Number(share.score)\r\n\r\nvar metadisplay = function(){ %>\r\n\r\n<div class=\"meta\">\r\n\t<div class=\"metatable table\">\r\n\t\t<div class=\"metadata\">\r\n\r\n\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t<div class=\"author\">\r\n\r\n\t\t\t\t\t<div class=\"authorTable table\">\r\n\r\n\r\n                        <div class=\"iconWrapper\">\r\n                            \r\n                            <a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n        \r\n        \r\n                                <% var src = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image')  %>\r\n        \r\n                                <div class=\"icon\">\r\n                                    <div class=\"usericon usericonsbsa another\" image=\"<%-src || ''%>\">\r\n                                     \r\n\t\t\t\t\t\t\t\t\t\t<% if(deep(app, 'platform.real.'+share.address)) {%>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"realperson\">\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"fa-stack fa-2x\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-certificate fa-stack-2x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-check fa-stack-1x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t  </span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<% } %>\r\n                                    </div>\r\n                                </div>\r\n        \r\n                            </a>\r\n        \r\n                        </div>\r\n            \r\n\r\n\t\t\t\t\t\t<div class=\"authorCell\">\r\n\r\n\t\t\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\t\t\t\t\t\t\t<% var reputation = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.reputation') || 0; %>\r\n\t\t\t\t\t\t\t\t<span class=\"adr\"><%-name || share.address %></span><% if(reputation > 1 || reputation < -1) {%><sup class=\"spsp\"><%-compressedNumber(reputation, 1)%></sup><% } %>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\t\t\t\r\n                        \r\n                        <div class=\"datetime\">\r\n                            <% if(share.time) {%>\r\n                                <span  class=\"realtime\" time=\"<%-share.time%>\"><%- app.reltime(share.time) %></span>\r\n                            <% } else { %> \r\n                                <span><%=e('e13019')%></span>\r\n                            <% } %>\r\n                        </div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } else { %> \r\n\t\t\t\r\n\t\t\t\t<div class=\"repostCaption\">\r\n\t\t\t\t\t<i class=\"fas fa-share\"></i> \r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\t\t\t\t\t\t<span class=\"adr\"><%-name || share.address %></span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t<% } %>\r\n\t\t\r\n\t\t</div>\r\n\r\n\t\t<% if(state && (typeof repost == 'undefined' || !repost)) { %>\t\t\t\r\n\r\n\t\t\t<div class=\"metapanel\">\r\n\t\t\t\t<div class=\"metapanelitem metmenu\">\r\n\t\t\t\t\t<i class=\"fas fa-ellipsis-h\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t<% if(typeof repost != 'undefined' && repost && !fromempty) { %> \r\n\r\n\t\t\t<div class=\"metapanel\">\r\n\t\t\t\t<div class=\"metapanelitem\">\r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>?s=<%-share.txid%>&mpost=true\">\r\n\t\t\t\t\t\t<i class=\"fas fa-share\"></i> \r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t<% } %>\r\n\t\t\r\n\t</div>\t\t\t\t\t\r\n</div>\r\n\t\r\n<% }\r\n\r\n%>\r\n\r\n<% var arranges = {\r\n\t\r\n\tcm : function(){ %> \r\n\r\n\t\t<% if(c) {\r\n\r\n\t\t\tc = filterXSS(clearScripts((findAndReplaceLink(c, true))))\r\n\t\t%>\r\n\t\t\t<div class=\"paddingWrapper\">\r\n\t\t\t\t<div class=\"sharecaption canmark opensviurl\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<%=joypixels.toImage(nl2br(trimrn(c)))%>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t<% if(m) {\r\n\r\n            if(typeof tplvideo != 'undefined' && tplvideo) return\r\n\r\n\t\t\tm = (m)\r\n\t\t\t\r\n\t\t\tvar nm = m;\r\n\r\n\t\t\tif(typeof all == 'undefined' || !all){\r\n\r\n\t\t\t\tnm = trimHtml(m, 750);\r\n\r\n\t\t\t\tif(nm != m){\r\n\t\t\t\t\tbigmessage = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tnm = share.renders.xssmessage(nm)\r\n\r\n\t\t%>\r\n\t\t\t<div class=\"paddingWrapper hideOnFullVideo\">\r\n\t\t\t\t<div class=\"message canmark\">\r\n\r\n\t\t\t\t\t<%=joypixels.toImage((clearScripts(((nm)))))%>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<% if(bigmessage) {%>\r\n\r\n\t\t\t\t<div class=\"paddingWrapper showMorePW\">\r\n\t\t\t\t\t<div class=\"showMore\">\r\n\t\t\t\t\t\t<div class=\"showmoretable table\">\r\n\t\t\t\t\t\t\t<!-- <div class=\"linecell\">\r\n\t\t\t\t\t\t\t\t<div class=\"line\"></div>\r\n\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t\t<div class=\"buttoncell\">\r\n\t\t\t\t\t\t\t\t<button>\r\n\t\t\t\t\t\t\t\t\t<%=e('showmore')%>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<!-- <div class=\"linecell\">\r\n\t\t\t\t\t\t\t\t<div class=\"line\"></div>\r\n\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t<% } %>\r\n\t\t\r\n\t<% },\r\n\r\n\t\r\n\ti : function(){ %> \r\n\t\t\r\n\t<% },\r\n\r\n\tu : function(){\t%> \r\n\t\t<% if(share.url) {\r\n\r\n\t\t\tvar h = ''\r\n\t\t\t\r\n\t\t\t%>\r\n\r\n\t\t\t<div class=\"url\">\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t<% },\r\n\r\n\r\n} %>\r\n\r\n\r\n\t<div class=\"work\">\r\n\r\n\t\t<% \r\n\r\n\t\t\tvar info = app.platform.sdk.videos.storage[share.url || \"undefined\"] || {}\r\n\t\t\tvar aspectRatio = deep(info, 'data.aspectRatio') || 0\r\n\r\n\t\t%>\r\n\r\n\t\t<div class=\"shareTable  <%-subscribed%> <%-view%> <% if(emptywithrepost) { %> emptywithrepost <% } else { %> truerepost <% } %>\" address=\"<%-share.address%>\" stxid=\"<%-share.txid%>\">\r\n\r\n\t\t\t<div class=\"cntswrk forurl <%- (aspectRatio > 0.9) && (aspectRatio < 1.25) ? 'squareVideo' : ''%> <%- (aspectRatio < 0.9) && (aspectRatio > 0) ? 'verticalVideo' : ''%>\">\r\n\r\n\t\t\t\t<% var a = [\"u\"] %>\r\n\r\n\t\t\t\t<% _.each(a, function(key, i){ %> \r\n\r\n\t\t\t\t\t<% if(arranges[key]) arranges[key]() %>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t<% }) %>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"anothercntswrk\">\r\n\r\n\t\t\t\t<div class=\"cntswrk formeta\">\r\n\r\n\t\t\t\t\t<div class=\"metawrapper\"> \r\n\t\t\t\t\t\t<% metadisplay() %> \r\n\t\t\t\t\t</div> \r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"cntswrk\">\r\n\r\n\t\t\t\t\t<% var a = [\"i\", \"cm\", \"p\"] %>\r\n\r\n\t\t\t\t\t<% _.each(a, function(key, i){ %> \r\n\r\n\t\t\t\t\t\t<% if(arranges[key]) arranges[key]() %>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t\t<div class=\"cntswrk\">\r\n\t\t\t\t\t\t<div class=\"paddingWrapper\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% if(share.tags && share.tags.length > 0) {\r\n\r\n\t\t\t\t\t\t\t\tvar bycategories = app.platform.sdk.categories.fromTags(share.tags, share.lanuage)\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"tags canmark \">\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<% _.each(bycategories.categories, function(category){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"category\">\r\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"index?sst=<%-category.tags.join(' ')%>\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span><b>@<%-category.name%></b></span> \r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t<!--<% _.each(category.tags, function(tag){ %><span>#<%-tag%></span><% }) %><span>;</span>-->\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t\t\t\t\t\t<% _.each(bycategories.tags, function(tag){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"tag\">\r\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"index?sst=<%-tag%>\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t#<%-tag%>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<% }) %>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t<% if(!share.temp &&  (typeof repost == 'undefined' || !repost || fromempty)) {%>\r\n\t\t\t\t\t\t\t\t<div class=\"panel\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"item forstars\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<% if(app.platform.repost && !my) {%>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"item <% if(!my){ %> forrepost <% } else { %> nact <% } %>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"itemwr table\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-share\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"item sharesocial right unselectable\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"itemwr table\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"labelwr workstation\"><span class=\"label\"><%=e('share').toUpperCase()%></span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-share-alt\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"wholikes\">\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t<% if(share.temp) {%>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"panel\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"item right\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"itemwr table tempPreloader\">\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"iconwr\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"count\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"label\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span><%=e('postWaitConf')%></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"clearfix\"></div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\r\n\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"blockAuthor\">\r\n\t\t\t<div class=\"blockTable table\">\r\n\t\t\t\t<div class=\"blockCell\">\r\n\t\t\t\t\t<div class=\"label\"><%=e('e13131')%></div>\r\n\r\n\t\t\t\t\t<div class=\"unblockWrapper\">\r\n\t\t\t\t\t\t<button class=\"button small unblockbutton\">\r\n\t\t\t\t\t\t\tUnblock\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"exitFull roundclosebutton\">\r\n\t\t<i class=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n\t</div>\r\n\r\n\r\n\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t<% if(typeof repost == 'undefined' || !repost || fromempty) {%>\r\n\r\n\t\t\t\t<div class=\"showmorelenta\"></div>\r\n\t\r\n\t\t\t\t<div class=\"commentsWrapperHb\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div class=\"commentsWrapper\">\r\n\t\t\t\t\t</div>\r\n\t\r\n\t\t\t\t</div>\r\n\t\r\n\t\t\t<% } %>\r\n\t\r\n\t\t<% } %>\r\n\r\n\r\n<% } %>","sharevideolight":"<%\r\n\r\nvar c = share.renders.caption();\r\nvar m = share.renders.message();\r\nvar bigmessage = false\r\n\r\nif(typeof ed == 'undefined') ed = {}\r\n\r\nif(share.address){\r\n\r\n\tvar my = (user.address.value && share.address == user.address.value.toString('hex'))\r\n\tvar subscribed = '';\r\n\r\n\tif(!my && user.address.value){\r\n\r\n\t\tvar me = deep(app, 'platform.sdk.users.storage.' + user.address.value.toString('hex'))\r\n\t\tif (me && me.relation(share.address, 'subscribes')){\r\n\t\t\tsubscribed = 'subscribed'\r\n\t\t}\r\n\t}\r\n\r\nvar view = 'post';\r\nvar name = app.platform.api.name(share.address)\r\nvar emptywithrepost = share.isEmpty() && share.repost\r\nvar value = Number(share.score)\r\n\r\nvar metadisplay = function(){ %>\r\n\r\n<div class=\"meta\">\r\n\t<div class=\"metatable table\">\r\n\t\t<div class=\"metadata\">\r\n\r\n\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t<div class=\"author\">\r\n\r\n\t\t\t\t\t<div class=\"authorTable table\">\r\n\r\n\r\n                        <div class=\"iconWrapper\">\r\n                            \r\n                            <a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n        \r\n        \r\n                                <% var src = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image')  %>\r\n        \r\n                                <div class=\"icon\">\r\n                                    <div class=\"usericon usericonsbsa another\" image=\"<%-src || ''%>\">\r\n                                     \r\n\t\t\t\t\t\t\t\t\t\t<% if(deep(app, 'platform.real.'+share.address)) {%>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"realperson\">\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"fa-stack fa-2x\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-certificate fa-stack-2x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-check fa-stack-1x\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t  </span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<% } %>\r\n                                    </div>\r\n                                </div>\r\n        \r\n                            </a>\r\n        \r\n                        </div>\r\n            \r\n\r\n\t\t\t\t\t\t<div class=\"authorCell\">\r\n\r\n\t\t\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\t\t\t\t\t\t\t<% var reputation = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.reputation') || 0; %>\r\n\t\t\t\t\t\t\t\t<span class=\"adr\"><%-name || share.address %></span><% if(reputation > 1 || reputation < -1) {%><sup class=\"spsp\"><%-compressedNumber(reputation, 1)%></sup><% } %>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\t\t\t\r\n                        \r\n                       \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } else { %> \r\n\t\t\t\r\n\t\t\t\t<div class=\"repostCaption\">\r\n\t\t\t\t\t<i class=\"fas fa-share\"></i> \r\n\t\t\t\t\t<a href=\"<%-app.platform.api.authorlink(share.address)%>\">\r\n\t\t\t\t\t\t<span class=\"adr\"><%-name || share.address %></span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t<% } %>\r\n\t\t\r\n\t\t</div>\r\n\t\t<!--\r\n\t\t<% if(state && (typeof repost == 'undefined' || !repost)) { %>\t\t\t\r\n\r\n\t\t\t<div class=\"metapanel\">\r\n\t\t\t\t<div class=\"metapanelitem metmenu\">\r\n\t\t\t\t\t<i class=\"fas fa-ellipsis-h\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t\t-->\r\n\t\t\r\n\t</div>\t\t\t\t\t\r\n</div>\r\n\t\r\n<% }\r\n\r\n%>\r\n\r\n<% var arranges = {\r\n\t\r\n\tcm : function(){ %> \r\n\r\n\t\t<% if(c) {\r\n\r\n\t\t\tc = filterXSS(clearScripts((findAndReplaceLink(c, true))))\r\n\t\t%>\r\n\t\t\t<div class=\"paddingWrapper\">\r\n\t\t\t\t<div class=\"sharecaption canmark opensviurl\" title=\"<%-nl2br(trimrn(c))%>\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<%=joypixels.toImage(nl2br(trimrn(c)))%>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t<% if(m) {\r\n\r\n            if(typeof tplvideo != 'undefined' && tplvideo) return\r\n\r\n\t\t%>\r\n\t\t\t\r\n\r\n\t\t<% } %>\r\n\t\t\r\n\t<% },\r\n\r\n\t\r\n\ti : function(){ %> \r\n\t\t\r\n\t<% },\r\n\r\n\tu : function(){\t%> \r\n\t\t<% if(share.url) {\r\n\r\n\t\t\tvar h = '' %>\r\n\r\n\t\t\t<div class=\"url\">\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\t<% },\r\n\r\n\r\n} %>\r\n\r\n\r\n\t<div class=\"work\">\r\n\r\n\t\t<% \r\n\r\n\t\t\tvar info = app.platform.sdk.videos.storage[share.url || \"undefined\"] || {}\r\n\t\t\tvar aspectRatio = deep(info, 'data.aspectRatio') || 0\r\n\r\n\t\t%>\r\n\r\n\t\t<div class=\"shareTable  <%-subscribed%> <%-view%> <% if(emptywithrepost) { %> emptywithrepost <% } else { %> truerepost <% } %>\" address=\"<%-share.address%>\" stxid=\"<%-share.txid%>\">\r\n\r\n\t\t\t<div class=\"cntswrk forurl <%- (aspectRatio > 0.9) && (aspectRatio < 1.25) ? 'squareVideo' : ''%> <%- (aspectRatio < 0.9) && (aspectRatio > 0) ? 'verticalVideo' : ''%>\">\r\n\r\n\t\t\t\t<% var a = [\"u\"] %>\r\n\r\n\t\t\t\t<% _.each(a, function(key, i){ %> \r\n\r\n\t\t\t\t\t<% if(arranges[key]) arranges[key]() %>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t<% }) %>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"anothercntswrk\">\r\n\r\n\t\t\t\t<div class=\"cntswrk formeta\">\r\n\r\n\t\t\t\t\t<div class=\"metawrapper\"> \r\n\t\t\t\t\t\t<% metadisplay() %> \r\n\t\t\t\t\t</div> \r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"cntswrk\">\r\n\r\n\t\t\t\t\t<% var a = [\"i\", \"cm\", \"p\"] %>\r\n\r\n\t\t\t\t\t<% _.each(a, function(key, i){ %> \r\n\r\n\t\t\t\t\t\t<% if(arranges[key]) arranges[key]() %>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t<!--\r\n\r\n\t\t\t\t<% if(!emptywithrepost) {%>\r\n\r\n\t\t\t\t\t<div class=\"cntswrk\">\r\n\t\t\t\t\t\t<div class=\"paddingWrapper\">\r\n\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<% if(share.tags && share.tags.length > 0) {\r\n\r\n\t\t\t\t\t\t\t\tvar bycategories = app.platform.sdk.categories.fromTags(share.tags, share.lanuage)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"tags canmark\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"datetime\">\r\n\t\t\t\t\t\t\t\t\t\t<% if(share.time) {%>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"realtime\" time=\"<%-share.time%>\"><%- app.reltime(share.time) %></span>\r\n\t\t\t\t\t\t\t\t\t\t<% } else { %> \r\n\t\t\t\t\t\t\t\t\t\t\t<span><%=e('e13019')%></span>\r\n\t\t\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<% _.each(bycategories.categories, function(category){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"tag\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span>@<%-category.name%></span> \r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<% }) %>\r\n\r\n\t\t\t\t\t\t\t\t\t<% _.each(bycategories.tags, function(tag){ %>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"tag\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t#<%-tag%>\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<% }) %>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\r\n\t\t\t\t-->\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<!--\r\n\t\t<div class=\"blockAuthor\">\r\n\t\t\t<div class=\"blockTable table\">\r\n\t\t\t\t<div class=\"blockCell\">\r\n\t\t\t\t\t<div class=\"label\"><%=e('e13131')%></div>\r\n\r\n\t\t\t\t\t<div class=\"unblockWrapper\">\r\n\t\t\t\t\t\t<button class=\"button small unblockbutton\">\r\n\t\t\t\t\t\t\tUnblock\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t-->\r\n\t</div>\r\n\r\n\r\n<% } %>","stars":"<% \r\n\r\n\tvar my = (user.address.value && share.address == user.address.value.toString('hex'))\r\n\tvar value = Number(share.score)\r\n\r\n\tif (Number(share.scnt) && _.isNumber(Number(share.scnt))) {\r\n\t\tvalue = value / Number(share.scnt)\r\n\t}\r\n\telse {\r\n\t\tvalue = 0\r\n\t}\r\n\r\n\tvar liked = ''\r\n\r\n\tvar v = ''\r\n\r\n\tif (share.myVal) {\r\n\t\tv = 'value=' + share.myVal\r\n\t\tliked = 'liked'\r\n\t}\r\n\r\n\tif(my) liked = 'disabled'\r\n\r\n\r\n\t%>\r\n\r\n<div class=\"itemwr table unselectable\">\r\n\t<div class=\"starswr\">\r\n\t\t<div class=\"stars likeAction <%-liked%>\" <%-v%>>\r\n\r\n\t\t\t<div class=\"starsWrapper starsWrapperM\">\r\n\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t<i class=\"far fa-star\" value=\"1\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t<i class=\"far fa-star\" value=\"2\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t<i class=\"far fa-star\" value=\"3\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t<i class=\"far fa-star\" value=\"4\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t<i class=\"far fa-star\" value=\"5\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"tstars\">\r\n\t\t\t\t<div class=\"tstarsov\" style=\"width: <%-100*(value / 5)%>%\">\r\n\t\t\t\t\t<div class=\"starsWrapper\">\r\n\t\t\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-star\" value=\"1\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-star\" value=\"2\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-star\" value=\"3\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-star\" value=\"4\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"starWrapper\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-star\" value=\"5\"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"count\">\r\n\t\t<span class=\"v\"><%-value.toFixed(1)%></span> \r\n\t\t<% if(value) {%>\r\n\t\t<% if(Number(share.scnt)) {%> / <span class=\"c\"><%-Number(share.scnt)%></span> <% } %>\r\n\t\t<% } %>\r\n\t</div>\r\n\r\n</div>","groupshares":"<% \r\nvar i = index || 0;\r\n\r\nshares = _.filter(shares, function(s){\r\n\r\n\tvar name = deep(app, 'platform.sdk.usersl.storage.' + s.address + '.name') || ''\r\n\t\r\n\t\r\n\tname = name.toLowerCase().replace(/[^a-z]/g,'')\r\n\r\n\tif((name.indexOf('pocketnet') == -1 || s.address == 'PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd' || s.address == 'PJ3nv2jGyW2onqZVDKJf9TmfuLGpmkSK2X') ){\r\n\t\treturn true\r\n\t}\r\n})\r\n\r\nvar groupshares = group(shares, function(s){\r\n\treturn s.address\r\n})\r\n\r\nif(typeof video != 'undefined' && video) groupshares = group(shares, function(s){\r\n\treturn s.txid\r\n})\r\n\r\nvar me = app.platform.sdk.user.me()\r\n\r\n_.each(groupshares, function(gs, address){ \r\n\t\r\n\t\r\n\t\r\n\t%>\r\n\r\n\t<div class=\"authorgroup <% if(me && me.relation(address, 'blocking')) {%>blocking<% } %>\">\r\n\r\n\t\t<% _.each(gs, function(share, j){ \r\n\r\n\t\t\tvar h = '';\r\n\r\n\t\t\tif (j) h = 'hidden'\r\n\r\n\t\t%>\r\n\t\t\t\t<div class=\"share <%-h%> <% if(me && me.relation(share.address, 'blocking')) {%>blocking<% } %> shareinlenta\" id=\"<%-share.txid%>\" style=\"\">\r\n\t\t\t\t\t<div class=\"shareSpacer\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t<% \r\n\r\n\t\t\ti++;\r\n\r\n\t\t}) %>\r\n\r\n\t\t<% if(gs.length > 1) { %>\r\n\r\n\t\t\t<div class=\"showmorebyauthor\">\r\n\t\t\t\t<%=e('e13123')%> (<%- gs.length - 1 %>) from <span class=\"adr\"><%-deep(app, 'platform.sdk.usersl.storage.'+address+'.name') || address %></span>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t</div>\r\n\t\r\n<% }) %>\r\n\r\n\t","commentspreview":"<%\r\n\r\n\tvar tpl = app.platform.ws.tempates.share(share)\r\n\r\n%>\r\n\r\n<div class=\"csharetable table\">\r\n\t<div class=\"image\">\r\n\r\n\t\t<% var src = deep(app, 'platform.sdk.usersl.storage.'+share.address+'.image')  %>\r\n\r\n\t\t<div class=\"icon\">\r\n\t\t\t<div class=\"usericon usericonsbsa another\" image=\"<%-src || ''%>\">\r\n\t\t\t\t<% if(!src) {%>\r\n\t\t\t\t\t<svg width=\"30\" height=\"30\" data-jdenticon-value=\"<%-share.address%>\"></svg>\r\n\t\t\t\t<% } %>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\t<div class=\"csharecnt\">\r\n\t\t<%= tpl %>\r\n\t</div>\r\n</div>"},"share":{"url":"<% if(url){ \r\n\t\r\n\tvar meta = app.platform.parseUrl(url);\r\n\r\n\r\n\tif(typeof share == 'undefined') share = {};\r\n\r\n\tif((meta.type == 'youtube') || meta.type == 'vimeo' || meta.type == 'bitchute' || meta.type == 'peertube'){ \r\n\t\tif(!app.platform.sdk.usersettings.meta.embedvideo || \r\n\t\t\tapp.platform.sdk.usersettings.meta.embedvideo.value) {\r\n\r\n\t\t\tvar info = app.platform.sdk.videos.storage[url] || app.platform.sdk.videos.storage[meta.id] || {}\r\n\t\t\tvar aspectRatio = (info.data || {}).aspectRatio || 0;\r\n\t%>\r\n\t\t<div class=\"videoWrapper <%- (aspectRatio < 1.25) && (aspectRatio >= 0.9) ? 'squareVideo' : ''%> <%- (aspectRatio < 0.9) && (aspectRatio != 0) ? 'verticalVideo' : ''%>\" pid=\"<%- makeid() %>\">\r\n\r\n\t\t\t<% if(meta.type == 'youtube' && window.cordova) {%>\r\n\r\n\t\t\t\t<div class=\"js-player-dummy\">\r\n\t\t\t\t\t<div class=\"jsPlayerLoading\">\r\n\t\t\t\t\t\t<div class=\"jsPlayerLoadingD table watchonyoutube\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<a href=\"<%- url %>\" cordovalink=\"_system\" target=\"_blank\">Watch on Youtube</a>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\r\n\t\t\t<% } else { %> \r\n\t\t\t\t\r\n\t\t\t\t<div class=\"js-player\" data-plyr-provider=\"<%-meta.type%>\" data-plyr-embed-id=\"<%-meta.url%>\" data-plyr-video-id=\"<%-meta.id%>\" data-plyr-host-name=\"<%-meta.host_name || ''%>\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<% if(typeof preview != 'undefined' && preview) {  %>\r\n\r\n\t\t\t\t\t\t<div class=\"jsPlayerPreview\">\r\n\t\t\t\t\t\t\t<% if(info.data) {%>\r\n\t\t\t\t\t\t\t\t<div class=\"wpl opensviurl\" image=\"<%-info.data.image || ''%>\">\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<% if(info.data.duration) {%>\r\n\t\t\t\t\t\t\t\t\t<div class=\"durationWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t<span><%-secInTime(info.data.duration)%></span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t<% if(info.data.isLive) {%>\r\n\t\t\t\t\t\t\t\t\t<div class=\"durationWrapper live\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-rss\"></i> <span>Live</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"statswrapper\">\r\n\t\t\t\t\t\t\t\t\t<% if(info.data.views) {%>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"viewsWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-eye\"></i> <span><%-compressedNumber(info.data.views)%></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t<% if(share) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tvar value = Number(share.score)\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (Number(share.scnt) && _.isNumber(Number(share.scnt))) {\r\n\t\t\t\t\t\t\t\t\t\t\tvalue = value / Number(share.scnt)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tvalue = 0\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t%>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"starsRatingWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-star\"></i> <span><%-Number(value).toFixed(1)%></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"commentsCountWrapper\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"far fa-comment\"></i> <span><%-compressedNumber(share.comments || 0)%></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t\t<% } else { %>\r\n\r\n\t\t\t\t\t\t<div class=\"jsPlayerLoading\">\r\n\t\t\t\t\t\t\t<div class=\"jsPlayerLoadingD table\">\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"preloader5\"><span></span><span></span><span></span></div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!--<% if(typeof views != 'undefined' && views) {%>\r\n\t\t\t\t\t<div class=\"videoviews\"><span class=\"label\">Views:</span> <span class=\"number\"><%-views%></span></div>\r\n\t\t\t\t<% } %>-->\r\n\r\n\t\t\t\t<% if(typeof video == 'undefined' || !video) { %> \r\n\t\t\t\t\t<div class=\"videoTips\">\r\n\t\t\t\t\t\t<div class=\"videoTip\">\r\n\t\t\t\t\t\t\t<span><%=e('expandvideo')%></span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t<% } %>\r\n\r\n\t\t\t\t<% if(typeof remove != 'undefined' && share && share.itisvideo()) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t%>\r\n\r\n\t\t\t\t\t<div class=\"peertubepanel\">\r\n\r\n\t\t\t\t\t\t<% if(info.data) {%>\r\n\r\n\t\t\t\t\t\t\t<% if (info.data.isLive) { %>\r\n\t\t\t\t\t\t\t\t<div class=\"item streaminfo\">\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-broadcast-tower\"></i> <span><%- e('streamInfo') %></span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<% \t} %>\r\n\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class=\"item uploadpeertubewp\">\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-camera\"></i> <span><%- e('editWallpaper') %></span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<div class=\"item removepeertube\">\r\n\t\t\t\t\t\t\t<i class=\"far fa-times-circle\"></i> <span><%- e('removeVideo') %></span>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t<% } %>\r\n\t\r\n\t\t\t<% } %>\r\n\r\n\r\n\t\t\t\r\n\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t<% } else { %> \r\n\r\n\t\t<% if(og && !_.isEmpty(og)) {%>\r\n\r\n\t\t\t<div class=\"urlhtmlcontent\">\r\n\t\t\t\t<div class=\"ogtable table\">\r\n\t\t\t\t\t<% if(og.image && !deep(share, 'images.length')) {\r\n\r\n\t\t\t\t\t\tvar imagesetting = deep(share, 'settings.image') || 'a'\r\n\r\n\t\t\t\t\t\tif (imagesetting == 'a'){ %>\r\n\r\n\t\t\t\t\t\t\t<div class=\"image\">\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<img src=\"<%- og.image %>\">\t\t\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"removeImage\">\r\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-times-circle\"></i>\r\n\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t<div class=\"cnt\">\r\n\t\t\t\t\t\t<% if(og.title || og.titlePage) {%>\r\n\t\t\t\t\t\t\t<a href=\"<%- url %>\">\r\n\t\t\t\t\t\t\t\t<div class=\"title\"><%= clearStringXss(clearScripts(((og.title || og.titlePage)))) %></div>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t<% } %>\r\n\r\n\t\t\t\t\t\t<% if(og.description || og.descriptionPage) {%>\r\n\t\t\t\t\t\t\t<a href=\"<%- url %>\">\r\n\t\t\t\t\t\t\t\t<div class=\"description\"><%= trimHtml(clearScripts((findAndReplaceLink(clearStringXss(og.description || og.descriptionPage)))), 100) %></div>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t<% } %>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<% } %>\r\n\r\n\t\t\r\n\t<% } %> \r\n\r\n\t<% if((typeof remove != 'undefined' || (!og || _.isEmpty(og))) && !share.itisvideo()) {%>\r\n\r\n\t<div class=\"urlcnt\">\r\n\t\t<div class=\"urlcnttable table\">\r\n\t\t\t<div class=\"linkcnt\">\r\n\t\t\t\t<span class=\"linkedstyle <%- (meta.type === 'peertube' && typeof remove === 'undefined') ? 'hidden' : '' %>\">\r\n\t\t\t\t\t<a href=\"<%- url %>\" cordovalink=\"_system\">\r\n\t\t\t\t\t\t<%- url %>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<% if(typeof remove != 'undefined' && (!share.aliasid || !share.itisvideo || !share.itisvideo())) {%>\r\n\r\n\t\t\t\t<div class=\"removeWrapper\">\r\n\t\t\t\t\t<div class=\"removelink\">\r\n\t\t\t\t\t\t<i class=\"fas fa-times-circle\"></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t<% } %>\r\n\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<% } %>\r\n\r\n<% } %>"},"comments":{"index":"<div id=\"<%-module.map.id%>\" class=\"<% if(ed.fromtop) {%> fromtop <% } %> <% if(ed.openapi) {%> fromopenapi <% } %>\">\r\n\r\n\r\n\t<div class=\"captionfwrapper\">\r\n\t\t<div class=\"captionCnt\">\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"loaderWrapper\">\r\n\t\t<div class=\"preloader5\">\r\n\t\t    <span></span>\r\n\t\t    <span></span>\r\n\t\t    <span></span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"showall hidden\">\r\n\t\t<span><%=e('e13036').toUpperCase()%></span> <span class=\"ccounts\"></span>\r\n\t</div>\r\n\r\n\t<% if(ed.fromtop) {%>\r\n\t\t<div class=\"post\">\r\n\t\t</div>\r\n\t\t\r\n\t<% } %>\r\n\r\n\t<div class=\"list\">\r\n\t</div>\r\n\r\n\t<% if(!ed.fromtop) {%>\r\n\t\t<div class=\"post\">\r\n\t\t</div>\r\n\t<% } %>\r\n\t\r\n\r\n</div>"}}
 /*_____*/ 
var tableAlignmentCenter=function(e){return e.width="auto",{columns:[{width:"*",text:""},e,{width:"*",text:""}]}},dateFormat=function(){function v(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}var h=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,m=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,g=/[^-+\dA-Z]/g;return function(e,t,n){var a=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(t=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");"UTC:"==(t=String(a.masks[t]||t||a.masks.default)).slice(0,4)&&(t=t.slice(4),n=!0);var i=e[(p=n?"getUTC":"get")+"Date"](),o=e[p+"Day"](),r=e[p+"Month"](),s=e[p+"FullYear"](),l=e[p+"Hours"](),u=e[p+"Minutes"](),c=e[p+"Seconds"](),d=e[p+"Milliseconds"](),p=n?0:e.getTimezoneOffset(),f={d:i,dd:v(i),ddd:a.i18n.dayNames[o],dddd:a.i18n.dayNames[o+7],m:r+1,mm:v(r+1),mmm:a.i18n.monthNames[r],mmmm:a.i18n.monthNames[r+12],yy:String(s).slice(2),yyyy:s,h:l%12||12,hh:v(l%12||12),H:l,HH:v(l),M:u,MM:v(u),s:c,ss:v(c),l:v(d,3),L:v(99<d?Math.round(d/10):d),t:l<12?"a":"p",tt:l<12?"am":"pm",T:l<12?"A":"P",TT:l<12?"AM":"PM",Z:n?"UTC":(String(e).match(m)||[""]).pop().replace(g,""),o:(0<p?"-":"+")+v(100*Math.floor(Math.abs(p)/60)+Math.abs(p)%60,4),S:["th","st","nd","rd"][3<i%10?0:(i%100-i%10!=10)*i%10]};return t.replace(h,function(e){return e in f?f[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.addDays=function(e){return this.setDate(this.getDate()+e),this},Date.prototype.format=function(e,t){return dateFormat(this,e,t)},Date.prototype.addMonths=function(e){return a=new Date(this.valueOf()),a.setMonth(a.getMonth()+e),a},Date.prototype.addDays=function(e){return a=new Date(this.valueOf()),a.setDate(a.getDate()+e),a},Date.prototype.addHours=function(e){return a=new Date(this.valueOf()),a.setHours(this.getHours()+e),a},Date.prototype.addMinutes=function(e){return a=new Date(this.valueOf()),a.setMinutes(this.getMinutes()+e),a},Date.prototype.addSeconds=function(e){return a=new Date(this.valueOf()),a.setSeconds(this.getSeconds()+e),a},Date.prototype.lastDayOfMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},Date.prototype.yyyymmdd=function(e){var t=this.getMonth()+1,n=this.getDate();return[this.getFullYear(),(9<t?"":"0")+t,(9<n?"":"0")+n].join(e||"")},secInTime=function(e){var t=e/3600^0,n=(e-3600*t)/60^0,a=e-3600*t-60*n,e=[];return t&&e.push(addZero(t.toFixed(0))),e.push(addZero(n.toFixed(0))),e.push(addZero(a.toFixed(0))),e.join(":")},isios=function(){return"undefined"!=typeof window&&window.cordova&&window.device&&"iOS"==deep(window,"device.platform")},currentYear=function(){return(new Date).getFullYear()},monthConvert=function(e){return-1==(e=_.indexOf(["January","February","March","April","May","June","July","August","September","October","November","December"],e))?0:e},addZero=function(e){return Number(e)<10?"0"+e:e},dateToStr=function(e){var t=e||new Date,n=addZero((t.getMonth()+1).toString()),e=addZero(t.getDate().toString());return addZero(t.getFullYear().toString())+n+e+addZero(t.getHours().toString())+addZero(t.getMinutes().toString())},dateToStrS=function(e){var t=e||new Date,n=addZero((t.getMonth()+1).toString()),e=addZero(t.getDate().toString());return addZero(t.getFullYear().toString())+n+e+addZero(t.getHours().toString())+addZero(t.getMinutes().toString())+addZero(t.getSeconds().toString())},dateToStrUTCSS=function(e){var t=e||new Date,n=addZero((t.getUTCMonth()+1).toString()),e=addZero(t.getUTCDate().toString()),a=addZero(t.getUTCFullYear().toString()),i=addZero(t.getUTCHours().toString()),o=addZero(t.getUTCMinutes().toString()),r=addZero(t.getUTCSeconds().toString()),s=t.getUTCMilliseconds().toString();return a+n+e+i+o+r+(0<(t=4-s.length)?(Number(s)*Math.pow(10,t)).toString():s)},strToDateArr=function(e){return[e.substring(0,4),e.substring(4,6),e.substring(6,8)]},dateToStrSmall=function(e){var t=e||new Date,n=addZero((t.getMonth()+1).toString()),e=addZero(t.getDate().toString());return addZero(t.getFullYear().toString())+n+e},dateToStrUtc=function(e){return e=nowDateUtc(e),dateToStr(e)},dateToStrUtcS=function(e){return e=nowDateUtc(e),dateToStrS(e)},strToDate=function(e){var t=e.substring(0,4),n=e.substring(4,6),a=e.substring(6,8),i=e.substring(8,10),o=e.substring(10,12),e=e.substring(12,14)||0;return new Date(t,n-1,a,i,o,e)},strToDateSS=function(e){var t=e.substring(0,4),n=e.substring(4,6),a=e.substring(6,8),i=e.substring(8,10),o=e.substring(10,12),r=e.substring(12,14)||0,e=e.substring(14,17)||0;return new Date(t,n-1,a,i,o,r,e)},strToDateSmall=function(e){var t=e.substring(0,4),n=e.substring(4,6),e=e.substring(6,8);return new Date(t,n-1,e)},dateNow=function(e){var t=(e=e||new Date).getMonth()+1,n=e.getDate(),a=e.getHours(),i=e.getMinutes();e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),[e.getFullYear(),t,n,a,i]},dateUtcNow=function(e){var t=(e=e||new Date).getUTCMonth()+1,n=e.getUTCDate(),a=e.getUTCHours(),i=e.getUTCMinutes();e.getUTCSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),e.getUTCFullYear()+""+t+n+a+i},utcnow=function(e){return e=(e=e||new Date).getTime()+60*e.getTimezoneOffset()*1e3,(e=new Date(e)).toString(),e},fromutc=function(e){return e=(e=e||new Date).getTime()-60*e.getTimezoneOffset()*1e3,(e=new Date(e)).toString(),e},randomString=function(e){e=e||8;for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},utcStrToDateSS=function(e){strToDateSS(e)},utcStrToDate=function(e){return e=strToDate(e),e=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),e=new Date(e),new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())},utcStrToConvertDate=function(e){return convertDate(dateToStr(utcStrToDate(e)))},nowDateUtc=function(e){return e=e||new Date,new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())},nextMonday=function(e){var t=e||new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),t=new Date(t.getFullYear(),t.getMonth(),t.getDate());return e.getDay()?t.setDate(e.getDate()+8-e.getDay()):t.setDate(e.getDate()+1),t},nextMondayUtc=function(e){e=e||new Date;var t=nowDateUtc(),e=nowDateUtc();return t.getDay()?e.setDate(t.getDate()+8-t.getDay()):e.setDate(t.getDate()+1),e},convertDate=function(e){var t=e.substring(0,4),n=e.substring(4,6),a=e.substring(6,8),i=e.substring(8,10),e=e.substring(10,12),t=t;return n&&(t+=" "+["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][n-1]),a&&(t+=" "+a),i&&(t+=", "+i,t+=e?":"+e:"H"),t},convertDateRel=function(e){var t=new Date;return t.addMinutes(-1)<e?["fewseconds"]:t.addMinutes(-2)<e?["oneminute"]:t.addMinutes(-55)<e?["minutes","",((t.getTime()-e.getTime())/60/1e3).toFixed(0)]:t.addMinutes(-80)<e?["anhour"]:dateToStrSmall(t)==dateToStrSmall(e)?["today",addZero(e.getHours().toString())+":"+addZero(e.getMinutes().toString())]:["",convertDate(dateToStrSmall(e))]},successCheck=function(e){var e=(e=e||{}).el||$("body"),t=($(window),null),t=$("<div>",{class:"successCheck",html:'<div class="successCheckWrapper table"><div><div class="chw">\t\t\t\t<svg viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">\t\t\t\t\t<path d="M 18 32.34 l -8.34 -8.34 -2.83 2.83 11.17 11.17 24 -24 -2.83 -2.83 z" stroke="#4AC6F9" fill="transparent"/>\t\t\t\t</svg>\t\t\t</div><div class="text">SUCCESS</div></div></div>'});return e.append(t),t.fadeIn(300),t.find("svg")[0].classList.add("animate"),setTimeout(function(){t.fadeOut(300),setTimeout(function(){t.remove()},300)},900),this},wnd=function(a){function e(e){if(n)return n.find(e)}var n,i=this,o=(a=a||{}).app,r=a.content||null,t="w"+makeid().split("-")[0],s=a.nooverflow||$("html").hasClass("nooverflow"),l=a.el||$("body"),u=$(window);function c(){n.css("top",u.scrollTop())}function d(){n.css("top",u.scrollTop()),n.css("height",u.height())}i.redraw=function(){var t=[];a.scrollers&&(t=_.map(e(a.scrollers),function(e){return $(e).scrollTop()})),e(".wndcontent").html(r),a.scrollers&&$.each(e(a.scrollers),function(e){$(this).scrollTop(t[e])}),a.success&&a.success(n,i,!0)};var p,f,v={close:function(e,t){e&&a.closecross&&a.closecross(n,i),a.close&&a.close(n,i),s||o.actions.onScroll(),i.essenseDestroy&&i.essenseDestroy(t),n.remove(),u.off("resize",d),u[0].removeEventListener("scroll",c),a.noblur},hide:function(e,t){n.find(".buttons").addClass("hidden"),n.addClass("hiddenState"),n.find(".wndcontent > div").addClass("rolledUp"),n.find(".expandButton").removeClass("hidden"),n.find(".closeButton").addClass("hidden"),n.find(".hideButton").addClass("hidden"),s||o.actions.onScroll()},show:function(e,t){n.find(".buttons").removeClass("hidden"),n.removeClass("hiddenState"),n.find(".wndcontent > div").removeClass("rolledUp"),n.find(".expandButton").addClass("hidden"),n.find(".closeButton").removeClass("hidden"),n.find(".hideButton").removeClass("hidden"),s||o.actions.offScroll()}};return i.buttonState=function(e,t){var n="disabled";(t="function"==typeof t?t():t)?a.buttons[e].el.removeClass(n):a.buttons[e].el.addClass(n)},a.preloader&&preloader(!0),a.buttons||(a.buttons={}),a.buttons.close||a.noCloseButton||(a.buttons.close={action:close,html:"Close",class:"close"}),a.noblur,r&&(a.preloader&&preloader(!1),t=a.allowHide?'<div class="wndback" id='+t+'></div><div class="wndinner">':'<div class="wndback" id='+t+'><div class="_close roundclosebutton '+p+'"><i class="fa fa-times" aria-hidden="true"></i></div></div><div class="wndinner">\t\t\t\t\t ',p="",a.leftbg&&(t+='<div class="leftbg"><div>'+a.leftbg+"</div></div>"),t+=a.allowHide?'<div class="wndcontent content">'+r+'<div class="changeStateButtons"><div class="hideButton changeButton"><i class="fas fa-minus"></i></div><div class="closeButton changeButton"><i class="fas fa-times"></i></div><div class="changeButton expandButton hidden"><i class="fas fa-expand-arrows-alt"></i></div></div></div>':'<div class="wndcontent content">'+r+"</div>",a.header?t+='<div class="wndheader">'+a.header+"</div>":p="onwhite",a.noButtons||(t+=' <div class="buttons"></div>',t+="</div>"),(n=$("<div>",{class:"wnd",html:t})).css("top",u.scrollTop()),n.css("height",u.height()),a.header||n.addClass("noheader"),l.append(n),n.find("._close").on("click",function(){v.close(!0)}),_.each(a.buttons,function(e){e.el=$("<div>",{class:"button "+(e.class||""),html:"<div>"+e.html+"</div>"}),n.find(".wndinner>div.buttons").append(e.el);var t=e.fn||v[e.action]||v.close;e.el.on("click",function(){t(n,i)})}),a.class&&n.addClass(a.class),s=s||!o.actions.offScroll(a.offScroll),n.css("display","block"),a.noCloseBack||n.find(".wndback").one("click",function(){v.close(!0)}),a.swipeClose&&isMobile()&&(p=a.swipeCloseDir||"up",t={},f=n.find(".wndcontent"),t[p]={trueshold:a.trueshold||1,mintrueshold:a.swipeMintrueshold||1,positionclbk:function(e){},constraints:function(){if(0==f.scrollTop())return!0},clbk:function(){n.fadeOut(1),setTimeout(function(){v.close(!0)},400)}},new SwipeParallaxNew({allowPageScroll:"vertical",el:f,directions:t}).init()),a.allowHide&&(n.find(".hideButton").on("click",v.hide),n.find(".closeButton").on("click",v.close),n.find(".expandButton").on("click",v.show)),u.on("resize",d),u[0].addEventListener("scroll",c),i.el=n,a.postRender?a.postRender(n,i,()=>{a.clbk&&a.clbk(i,n)}):a.clbk&&a.clbk(i,n)),i.find=e,i.close=v.close,i.el=n,i.hide=v.hide,i.show=v.show,i},menuDialog=function(t){var n;(t=t||{}).wrap=!0,t.class="menudialog",t.items.push({class:"itemclose",text:"Close"}),t.html=(n="",_.each(t.items,function(e,t){n+='<div class="item '+e.class+'" item="'+t+'">',n+=e.text,n+="</div>"}),n),t.clbk=function(e){e.find(".item").on("click",function(){var e=$(this).attr("item");return t.items[e].action?t.items[e].action(function(){a.destroy()}):a.destroy(),!1}),e.on("click",function(){a.destroy()})};var a=new dialog(t);return a},inputDialogNew=function(l){var t;function r(e,t){return e.dollars&&(u.value=t.toString(),t=maskValue(u)),e.percent&&(c.value=t.toString(),t=maskValue(c)),e.convertIn?e.convertIn(t):t}(l=l||{}).alert||(l.alert="Please enter values"),l.class=(l.class||"")+" input",l.wrap=!0;var u=l.mmoneyparam,c=l.percentparam;l.html='<div class="caption">'+l.caption+"</div>",l.html+='<div class="values">',_.each(l.values,function(n,e){if(n.time)return l.html+="<div class='timeselector' index='"+e+"'>",void(l.html+="</div>");var t="",a="";n.dollars&&(t="dollars"),n.percent&&(t="percent"),n.slider&&(a="hasslider"),l.html+='<div class="value '+a+'">',n.checkbox||(l.html+='<div class="label">',l.html+=n.label,l.html+="</div>"),l.html+='<div class="v">',n.checkbox?(l.html+='<input class="checkbox" type="checkbox" index="'+e+'" id="value'+e+'" ',1==n.defValue&&(l.html+="checked"),l.html+='><label for="value'+e+'">'+n.label+"</label>"):n.text?l.html+='<textarea placeholder="'+(n.placeholder||n.label||"")+'" class="'+t+'" index="'+e+'">'+(n.defValue||"")+"</textarea>":n.upload?(l.html+='<div class="upload" index="'+e+'">',l.html+=n.placeholder,l.html+='<div class="uploaded"></div>',l.html+="</div>"):n.select?(l.html+='<select index="'+e+'">',_.each(n.select.values,function(e){var t="";e.v==n.select.default&&(t="selected"),l.html+='<option  value="'+e.v+'" '+t+">",l.html+=e.l,l.html+="</option>"}),l.html+="</select>"):(n.defValue&&n.defValue.toFixed&&(n.defValue=n.defValue.toFixed(l.precision||0)),l.html+='<input placeholder="'+(n.placeholder||n.label||"")+'" class="'+t+'" index="'+e+'" data-validate="'+(n.validate||"name")+'" type="'+(n.type||"text")+'" value="'+(n.defValue||"")+'" '+(n.allowNull?'allow-null="true"':"")+"></input>"),l.html+="</div>",n.slider&&(l.html+="<div class='sliderWrapper' index='"+e+"'>",l.html+="<div class='sliderTableWrapper'>",l.html+="<div class='min'>"+r(n,n.slider.min)+"</div>",l.html+="<div class='sliderc'>",l.html+="<div class='slider'></div>",l.html+="</div>",l.html+="<div class='max'>"+r(n,n.slider.max)+"</div>",l.html+="</div>",l.html+="</div>"),l.html+="</div>"}),l.html+="</div>",l.additional&&(l.html+=l.additional),l.html+='<div class="alert" style="display:none">'+l.alert+"</div>";var n=l.success,e=l.clbk,d={};l.clbk=function(o){t=new Validation({form:o,success:function(){}}),u&&o.find(".dollars").maskMoney(u),c&&o.find(".percent").maskMoney(c),_.each(l.values,function(a,n){var t,e,i;a.slider&&(i=o.find('input[index="'+n+'"]'),t=o.find('.sliderWrapper[index="'+n+'"] .slider'),e={slide:function(e,t){var n=t.value,t=l.precision||0;a.dollars&&(t=u.precision||0),a.percent&&(t=u.precision||0),n=n.toFixed(t),i.val(r(a,n))},value:a.defValue},_.isObject(a.slider)&&(e=_.extend(e,a.slider)),t.slider(e),i.on("change",function(){var e=$(this).val();a.dollars&&(e=i.maskMoney("unmasked",u)[0].value),(e=(e=a.percent?i.maskMoney("unmasked",c)[0].value:e)>a.slider.max?a.slider.max:e)<a.slider.min&&(e=a.slider.min),t.slider("value",e),$(this).val(r(a,e))})),a.text&&o.find('textarea[index="'+n+'"]').on("keyup",function(){0<this.scrollTop&&(this.style.height=this.scrollHeight+10+"px")}),a.upload&&(i=o.find('.upload[index="'+n+'"]'),initUpload({el:i,ext:a.upload.ext||["png","jpeg","jpg"],dropZone:i,multiple:!1,action:function(e,t){d[n]=e,i.find(".uploaded").html(e.file.name+' <i class="fas fa-check-circle"></i>'),a.onchange&&a.onchange(e,s)}})),a.time&&(i=o.find('.timeselector[index="'+n+'"]')).timingfield({daysText:"Days",hoursText:"Hours",minutesText:"Minutes",secondsText:"Seconds",defaults:a.default}),a.checkbox&&(i=o.find('input[index="'+n+'"]'),a.onchange&&i.on("change",function(){var e=$(this).is(":checked");a.onchange(e,s)}))}),e&&e()},l.success=function(o){if(!t.validation({manual:!0}))return!1;var r={},s=!0;_.each(l.values,function(e,t){var n,a,i;e.time?(a=(n=o.el.find('.timeselector[index="'+t+'"]')).find(".timingfield").val(),a={d:Number(n.find(".timingfield_days input").val()||"0"),h:Number(n.find(".timingfield_hours input").val()||"0"),m:Number(n.find(".timingfield_minutes input").val()||"0"),s:Number(n.find(".timingfield_seconds input").val()||"0")}):e.upload?(a=d[t],i=t):(a=(n=o.el.find(".values [index='"+t+"']")).val(),e.checkbox&&(a=n.is(":checked")),e.dollars&&(a=n.maskMoney("unmasked",u)[0].value),e.percent&&(a=n.maskMoney("unmasked",c)[0].value),i=e.id||t,e.id&&(s=!1)),r[i]=a}),s&&(r=_.toArray(r));var e=n(r);return void 0===e||e};var s=new dialog(l);return s},dialog=function(i){var n,o,r=this,s=i.removescroll&&i.app,e=!1;if($("html").hasClass("nooverflow")&&(s=!1),i.success||(i.success=!1),i.fail||(i.fail=!1),i.btn1text||(i.btn1text="Accept"),i.btn2text||(i.btn2text="Cancel"),i.id){if("undefined"==typeof localStorage)return;if(i.btn2text||(i.btn2text="Don't Show Anymore"),(n=JSON.parse(localStorage.qu_rx||"{}"))[i.id])return void(i.alltrue&&i.success())}function l(e,t){("function"!=typeof e||e(r)&&i.wrap)&&a(),t&&i.id&&(n[i.id]=!0,localStorage.qu_rx=JSON.stringify(n)),i.wrap||a()}var a=function(){e||(e=!0,o.fadeOut(200),setTimeout(function(){o.remove()},200),s&&app.actions.onScroll())};return function(){var e='<div class="wrapper table"><div class="secondwrapper"><div class="thwrapper">';if(i.header&&(e+='<div class="header"><div class="text">'+i.header+"</div></div>"),i.poll){var t='<div class="poll">';t+='<div class="question description">Question</div>',t+='<div class="title"><input class="input" type="text"><i class="fas fa-times-circle"></i></div>',t+='<div class="options description">Poll options</div>';for(var n=0;n<5;n++)t+=`<div class="poll-item" id="poll-item-${n+1}"><input class="input" type="text"><i class="fas fa-times-circle"></i></div>`;e+=t+="</div>"}i.html&&(e+='<div class="body"><div class="text">'+(i.html||"")+"</div></div>"),e+='<div class="buttons">\t\t\t\t\t\t\t<div class="btn2wr"><button class="btn2 medium">'+i.btn2text+'</button></div>\t\t\t\t\t\t\t<div class="btn1wr"><button class="btn1 medium">'+i.btn1text+'</button></div>\t\t\t\t\t\t</div><div class="_close"><i class="fa fa-times" aria-hidden="true"></i></div>\t\t\t\t\t\t</div>\t\t\t\t\t\t</div></div>',(o=$("<div/>",{class:"dialog "+(i.class||"")})).html(e),$("body").append(o),i.class&&o.addClass(i.class),o.find,o.find(".btn1").on("click",function(){l(i.success)}),o.find(".btn2").on("click",function(){l(i.fail,!0)}),o.find("._close").on("click",function(){l(i.close,!0)});var a=o.find(".poll .title");for(a.find("i").on("click",function(){a.find(".input").val("")}),n=0;n<5;n++){let e=o.find(`#poll-item-${n+1}`);e.find("i").on("click",function(){e.find(".input").val("")})}i.clbk&&i.clbk(o,r),s&&app.actions.offScroll(),i.render&&i.render(o),o.fadeIn(200),bgImages(o)}(),r.el=o,r.destroy=a,r},tooltip=function(a){function e(){n.hasClass("tooltipstered")||(r.debug=!1,r.contentAsHTML=!0,r.interactive=!0,r.interactiveTolerance=400,r.onlyOne=!0,r.delay=100,"mouseenter"!=o?r.trigger||(r.trigger=o):r.delay=400,r.autoClose=!1,r.theme||(r.theme="lighttooltip"),r.position||(r.position="bottom"),r.height||(r.height=420),r.maxWidth||(r.maxWidth=600),r.content=function(){return t},r.functionReady=function(e,t){i.instance=e;var n=$(t.tooltip),t=$(t.origin);i.el=function(){return n},"click"!=o&&t.on("click",function(){e.close()}),a.clbk&&a.clbk({el:n})},r.functionInit=function(e,t){},r.functionAfter=function(e,t){a.destroy&&a.destroy()},n.tooltipster(r))}var i=this,t=(a=a||{}).content||"",n=a.el,o=a.event||"click",r=a.options||{};return i.close=function(){i.instance&&i.instance.close()},a.render&&e(),e(),i},sitemessage=function(e,t){$("<div/>",{class:"sitemessage remove_now",style:"opacity:0",text:e}).appendTo("body").animate({opacity:1},200),setTimeout(function(){$(".remove_now").animate({opacity:0},500),"function"==typeof t&&t(),setTimeout(function(){$(".remove_now").detach()},500)},2200)},bgImages=function(n,a){a=a||{},n.find("[image]").each(function(){var e=$(this),t=e.attr("image");t&&(e.css({"background-image":"url("+t+")","background-size":a.size||"cover","background-position":a.position||"center center","background-repeat":a.repeat||"no-repeat"}),e.attr("image","")),a.clbk&&e.imagesLoaded({background:!0},function(e){n.fadeIn({queue:!1,duration:"fast"}),"function"==typeof a.clbk&&a.clbk(e)})})},pathFromMD5Name=function(e){return e.substr(0,2)+"/"+e.substr(2,2)+"/"+e.substr(4)+".jpg"},srcToData=function(e,t){var n=new XMLHttpRequest;n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n.response)},n.onerror=function(){},n.open("GET",e),n.responseType="blob",n.send()},resizeFit=function(e,t,n,a,i){var o,r,s,l=new Image,u=document.createElement("canvas"),c=u.getContext("2d");l.crossOrigin="Anonymous",l.src=e,i=i||"jpeg",l.onload=function(){o=l.height/l.width,s=l.height,r=l.width,s<=n&&r<=t||(t<r&&(s=(r=t)*o),n<s&&(r=(s=n)/o),0<(e=Math.max((n-s)/s,(t-r)/r))&&(s*=e+1,r*=e+1)),u.width=r,u.height=s,c.drawImage(l,0,0,r,s);var e=u.toDataURL("image/"+i,.75);$(u).remove(),a(e)}},resize=function(e,t,n,a,i){var o,r,s,l=new Image,u=document.createElement("canvas"),c=u.getContext("2d");l.crossOrigin="Anonymous",l.src=e,i=i||"jpeg",l.onload=function(){o=l.height/l.width,s=l.height,r=l.width,s<=n&&r<=t||(t<r&&(s=(r=t)*o),n<s&&(r=(s=n)/o)),u.width=r,u.height=s,c.drawImage(l,0,0,r,s);var e=u.toDataURL("image/"+i,.75);$(u).remove(),a(e)}},resizeNew=function(l,u,c,d){return new Promise((t,e)=>{var n,a,i,o=new Image,r=document.createElement("canvas"),s=r.getContext("2d");o.crossOrigin="Anonymous",o.src=l,d=d||"jpeg",o.onload=function(){n=o.height/o.width,i=o.height,a=o.width,i<=c&&a<=u||(u<a&&(i=(a=u)*n),c<i&&(a=(i=c)/n)),r.width=a,r.height=i,s.drawImage(o,0,0,a,i);var e=r.toDataURL("image/"+d,.75);return $(r).remove(),t(e)}})},dataURLtoFile=function(e,t){for(var n=e.split(","),e=n[0].match(/:(.*?);/)[1],a=atob(n[1]),i=a.length,o=new Uint8Array(i);i--;)o[i]=a.charCodeAt(i);return new File([o],t,{type:e})},toDataURL=a=>new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(a),n.onload=()=>e(n.result),n.onerror=e=>t(e)}),grayscaleImage=function(e,p){var f=new Image;f.src=e,f.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=f.width,a=f.height;e.width=n,e.height=a,t.drawImage(f,0,0);for(var i=t.getImageData(0,0,n,a),o=0,r=0,r=0;r<i.height;r++)for(o=0;o<i.width;o++){var s=4*r*i.width+4*o,l=i.data[s],u=i.data[1+s],c=i.data[2+s],d=i.data[3+s];i.data[s]=c=(3*l+u+c)/3,i.data[1+s]=c,i.data[2+s]=c,i.data[3+s]=d}t.putImageData(i,0,0,0,0,i.width,i.height),p&&p(e.toDataURL())}},colorFromGradient=function(n){n.gradient||(n.gradient=[{color:[0,0,0,0],image:"red",position:0},{color:[255,255,255,255],image:"green",position:100}]),void 0===n.value&&(n.value=50);var a,i=_.find(n.gradient,function(e,t){if(e.position<=n.value&&(!n.gradient[t+1]||n.gradient[t+1].position>n.value))return!0}),o=_.find(n.gradient,function(e,t){if(e.position>=n.value&&(!n.gradient[t-1]||n.gradient[t-1].position<n.value))return!0}),r=[0,0,0,0],o=o||n.gradient[n.gradient.length-1],i=i||n.gradient[0];if(o.position==i.position?(r=i.color,i.image,i.opacity=255,o.opacity=255):(a=(n.value-i.position)/(o.position-i.position),_.each(r,function(e,t){r[t]=(i.color[t]*(1-a)+o.color[t]*a).toFixed(0)}),i.opacity=1-a,o.opacity=a),n.mode&&"pdf"==n.mode)return{left:i,right:o};var e,t="rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")";return n.toHex?(e=(e=t).match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):"":t},randomColor=function(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"},rgbaOpacity=function(e,t){e=e.replace("rgba(","").replace(")","").split(",");return e[3]=t,"rgba("+e.join(",")+")"},aviableFilters={values:function(n,e){var a=!0;return _.each(e,function(e,t){a&&0==e[n[t]]&&(a=!1)}),a},condition:{without:{name:"Without data",id:"without",filter:function(e,t,n){if(void 0===n||"-"==e[n.id]||null==n)return!0},type:"general",values:0},with:{name:"With data",id:"with",filter:function(e,t,n){if(void 0!==n&&"-"!=n&&null!=n)return!0},type:"general",values:0},beginwith:{name:"Begin with",id:"beginwith",filter:function(e,t,n){if(0==n.toLowerCase().indexOf(t.values[0].toLowerCase()))return!0},type:"string",values:1},endsat:{name:"Ends at",id:"endsat",filter:function(e,t,n){if(n.toLowerCase().indexOf(t.values[0].toLowerCase())==n.length-t.values[0].length)return!0},type:"string",values:1},contain:{name:"Contain",id:"contain",filter:function(e,t,n){if(-1<n.toLowerCase().indexOf(t.values[0].toLowerCase()))return!0},type:"string",values:1},equaltext:{name:"Equal",id:"equaltext",filter:function(e,t,n){if(n.toLowerCase()==t.values[0].toLowerCase())return!0},type:"string",values:1},more:{name:"More",id:"more",filter:function(e,t,n){if(Number(n)>Number(t.values[0]))return!0},type:"number",values:1},moreequal:{name:"More and Equal",id:"moreequal",filter:function(e,t,n){if(Number(n)>=Number(t.values[0]))return!0},type:"number",values:1},less:{name:"Less",id:"less",filter:function(e,t,n){if(Number(n)<Number(t.values[0]))return!0},type:"number",values:1},lessequal:{name:"Less and Equal",id:"lessequal",filter:function(e,t,n){if(Number(n)<=Number(t.values[0]))return!0},type:"number",values:1},equal:{name:"Equal",id:"equal",filter:function(e,t,n){if(Number(n)==Number(t.values[0]))return!0},type:"number",values:1},notequal:{name:"Not Equal",id:"notequal",filter:function(e,t,n){if(Number(n)!=Number(t.values[0]))return!0},type:"number",values:1}}},indexArray=function(e){e=e||0;for(var t=[],n=0;n<e;n++)t.push(n);return t},b64_to_utf8=function(e){return decodeURIComponent(window.atob(e))},convertStringToArrayBuffer=function(e){for(var t=atob(e),n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a.buffer},convertArrayBufferToString=function(e){for(var t=new Uint8Array(e),n="",a=0;a<t.byteLength;a++)n+=String.fromCharCode(t[a]);return btoa(n)},objmap=function(e,t){var n={};return _.each(e,function(e){n[e.id]=e}),n},group=function(e,n){var a={};return _.each(e,function(e,t){(t=n(e,t))&&(a[t]||(a[t]=[]),a[t].push(e))}),a},apply=function(n,a){_.isArray(n)?_.each(n,function(e,t){apply(n[t],a)}):a(n)},nextIndex=function(e,t){return-1<(t=_.indexOf(e,t))&&(t==e.length-1?t=0:t++),t},findIndex=function(e,t){var n=-1;return n=_.find(e,function(e){if(n++,t(e))return!0})?n:-1},addSuffixToValue=function(t){if(t.array&&t.field&&t.value){if(_.find(t.array,function(e){if(e[t.field]&&e[t.field]==t.value)return!0})){var e=new RegExp("[(]([0-9]+)[)]");return(e=t.value.match(e))||((e=[])[1]="0"),e[1]=Number(e[1])+Number(1),t.value=trim(t.value.replace(e[0],"")),t.value+=" ("+e[1]+")",addSuffixToValue(t)}return t.value}},replaceEqual=function(e,n,t){var a=-1,i=_.find(e,function(e,t){if(isEqual(e,n,!1))return a=t,e});return-1<a&&(e.splice(a,1,t),i)},removeEqualRIObj=function(e,n){var a=-1,t=_.find(e,function(e,t){if(isEqual(e,n,!1))return a=t,e});return-1<a?(e.splice(a,1),{el:t,index:a}):null},removeEqualRI=function(e,n){var a=-1;return _.find(e,function(e,t){if(isEqual(e,n,!1))return a=t,e}),-1<a?(e.splice(a,1),a):-1},removeEqual=function(e,n){var a=-1,t=_.find(e,function(e,t){if(isEqual(e,n,!1))return a=t,e});return-1<a&&(e.splice(a,1),t)},instead=function(e,n){var a=-1;_.find(e,function(e,t){if(isEqual(e,n,!1))return a=t,!0}),-1<a&&e.splice(a,1),e.unshift(n)},lazyEach=function(u){function c(e){var t=n(u.array[e],u.each,e);t.item=u.array[e],u.action(t,e)}var d,p,f,v={after:["success","fail","after"]},h=!1,n=function(s,e,l){var t={};return _.each(e,function(o,r){t[r]="function"!=typeof o||"success"!=r&&"fail"!=r&&"after"!=r?o:function(){function e(){function e(){u.all.success&&!h&&u.all.success(u),u.all.fail&&h&&u.all.fail(u),u.all.after&&u.all.after(u)}var n,a;"fail"==(n=r)&&(h=!0),_.find(v,function(e,t){if(-1<_.indexOf(e,n))return a=t,!0}),a&&(p[a]||(p[a]=0),p[a]++),f=_.reduce(p,function(e,t){return e+t},0),o(s,f,d,i,l),u.sync?u.array[l+1]?c(l+1):e():f==d&&e()}var t,i=arguments;!u.syncCallbacks||l<=f||u.sync?e():t=setInterval(function(){l<=f&&(e(),clearInterval(t))},10)}}),t};(u=u||{}).array||(u.array=[]),u.each||(u.each={}),u.all||(u.all={}),u.each.success||(u.each.success=function(){}),u.each.fail||(u.each.fail=function(){}),u.array&&0!=u.array.length?(d=u.array.length,p={},f=0,u.all.before&&u.all.before(u),u.sync?c(0):_.each(u.array,function(e,t){c(t)})):u.all.success&&u.all.success()},lazyActions=function(e,t){lazyEach({array:e,action:function(e){e.item(function(){e.success()})},all:{success:t}})},primitiveToArray=function(e){return e=_.isArray(e)?e:[e]},actionsByType=function(e,t){if(isVal(e)){if(t.value)return t.value(e)}else if(_.isArray(e)){if(t.array)return t.array(e)}else if(t.object)return t.object(e);return null},isVal=function(e){return!_.isObject(e)||void 0!==e.v&&!_.isObject(e.v)||void 0!==e.c&&!_.isObject(e.c)},prevEl=function(e,t){return 0<(t=_.indexOf(e,t))?e[t-1]:e[0]},nextEl=function(e,t){return-1<(t=_.indexOf(e,t))&&t<e.length-1?e[t+1]:e[e.length-1]},nextElH=function(e,t){return-1<(t=findIndex(e,t))&&t<e.length-1?e[t+1]:null},firstEl=function(e){return deep(e,"length")?e[0]:null},lastEl=function(e){var t=deep(e,"length");return t?e[t-1]:null},lastEls=function(e,n){var a=e.length;return(n=Math.min(n,a))?_.filter(e,function(e,t){if(a-n<=t)return e}):[]},lastelements=function(e,t,n){return(n=n||0)<(t=e.length-(t||100))?e.splice(t):e},firstEls=function(e,n){var t=e.length;return(n=Math.min(n,t))?_.filter(e,function(e,t){if(t<n)return e}):[]},getRandomValues=function(e){for(var t=0;t<e.length;t++)e[t]=256*Math.random()|0;return e},equalhash=function(e,t){return $.md5(JSON.stringify(e))===$.md5(JSON.stringify(t))},getMethods=function(e){var t={};for(prop in e)"function"==typeof e[prop]&&(t[prop]=e[prop]);return t},getVars=function(e){var t={};for(prop in e)e.hasOwnProperty(prop)&&(t[prop]=e[prop]);return t},toDeepKey=function(e){return _.toArray(e).sort().join(".")},deepInsert=function(e,t,n){if(t){var a=t.split("."),t=a[0];if(1!=a.length)return e[t]||(e[t]={}),a.splice(0,1),deepInsert(e[t],a.join("."),n);e[t]=n}},isEqual=function(n,e,a){var i=!(a=void 0===a||a);return void 0===n&&void 0===e||void 0!==n&&void 0!==e&&(typeof n==typeof e||"function"==typeof e)&&("function"==typeof e?e(n):_.isObject(e)?_.isArray(e)?(_.each(e,function(e,t){e=!!isEqual(n[t],e,a),i=i||e}),i):!!_.isObject(e)&&(_.each(e,function(e,t){e=!!isEqual(n[t],e,a),i=a?i||e:i&&e}),i):e==n)},clear=function(n){_.each(n,function(e,t){delete n[t]})},executeIfCan=function(e){return"function"==typeof e?e():e},convertBits=function(n,e){return(n=_.toArray(Number(n).toString(2))).length,_.filter(e,function(e,t){if(e=_.toArray(Number(e.bit).toString(2)),1==n[n.length-e.length])return!0})},convertBitsToMap=function(e,t){return t=convertBits(e,t),_.map(t,function(e){return e.bit})},convertToBits=function(e){return _.reduce(e,function(e,t){return e+Number(t)},0)},boolnum=function(e){return!(0==e||"0"==e||!e)},"undefined"!=typeof FileReader&&void 0===FileReader.prototype.readAsBinaryString&&(FileReader.prototype.readAsBinaryString=function(e){var i="",o=this,r=new FileReader;r.onload=function(e){for(var t=new Uint8Array(r.result),n=t.byteLength,a=0;a<n;a++)i+=String.fromCharCode(t[a]);o.content=i,$(o).trigger("onload")},r.readAsArrayBuffer(e)}),ParametersLive=function(e,C,S){S=S||{},_.each(e,function(u){if(u&&u.type){var e,r,t,a,i,o=C.find('[pid="'+u.id+'"]');if(o){if((u.el=o).find(".operatorselect").off("change"),o.find(".operatorselect").on("change",function(){u.operator=$(this).val(),u.set("___nochange")}),"cash"==u.type)return o.find("input").on("change",function(){var e=$(this).val();u.isValid(e)?o.removeClass("error"):o.addClass("error"),u.set(e)}),void o.find("input").on("keyup",function(){var e=$(this).val();o.find(".convertValue").html(u.app.store.cash.toBTC(e,u.currency,!0))});if("cashrange"==u.type)return o.find("input").on("change",function(){var e=$(this).val(),t=$(this).attr("index");u.isValid(e)?o.removeClass("error"):o.addClass("error"),u.set(e,t)}),void o.find("input").on("keyup",function(){$(this).val(),$(this).attr("index")});if("numberrange"!=u.type){if("html"==u.type&&!_Node)return o.trumbowyg({btns:[["bold","italic"],["link"]]}),void o.on("tbwblur",function(){var e=o.trumbowyg("html");u.set(e)});if("image"!=u.type&&"file"!=u.type||(e=o.find(".addImage"),r=o.find(".imagesContainer"),t=o.find(".imageContainer"),u.upload.el=e,u.onLive&&u.onLive(t,u),u.upload.beforeUpload=function(e,t){u.previewTemplate&&r.append(u.previewTemplate({file:e,processId:t}))},u.upload.onUpload=function(e,t){var n,a,i,o;u.previewTemplate&&(n=deep(e,u.previewPath||""),a=r.find('[processId="'+t+'"]'),i=r,o="append",0<a.length&&(i=a,o="replaceWith"),i[o](u.previewTemplate({src:n,processId:t,options:u.upload})),a=r.find('[processId="'+t+'"]'),u.onLive(a,u)),u.set(n),u.upload._onUpload&&u.upload._onUpload(e)},initUpload(u.upload)),"valuesmultitree"==u.type){function s(){_.each(u.treemap,function(e){e.active=!1})}function c(){o.find(".checkbox").prop("checked",!1);var e=_.map(u.value,function(e){return u.treemap[e]});u.every({group:function(e,t,n,a){o.find('[value="'+e.id+'"]').prop("checked",!0),e.active&&a()},value:function(e,t,n){o.find('[value="'+e.id+'"]').prop("checked",!0)}},e)}var l=function(e,t){var n,a;e&&(void 0===t&&(t=!e.active),e.active=t,a=(n=o.find('[groupid="'+e.id+'"]')).find(".vmt_group_params"),t=n.attr("level"),e.active?(a.html(u.renderLevel(e.values,t+1)),n.removeClass("hidden"),n.addClass("active")):(a.html(""),n.removeClass("active")))};return o.find(".vmt_showMore").on("click",function(){o.addClass("showedMore")}),o.find(".vmt_hideMore").on("click",function(){o.removeClass("showedMore")}),o.find(".autoSearch").on("keyup",function(e){var t,n,a,i=$(this).val();i&&1<i.length?13==(e.keyCode||e.which)?(e=u.treemap[i])&&(removeEqual(u.value,e.id),o.find('input[value="'+e.id+'"]').prop("checked",!0).change(),$(this).val(""),s(),a=u.renderLevel(null,0),o.find(".chinputsv").html(a),c()):(s(),t=u.searchValues(i),n={},_.each(t,function(e){_.each(e.parents,function(e){n[e.id]=!0})}),a=u.renderLevel(null,0,{group:function(e){if(n[e.id])return e.active=!0},value:function(e){if(t[e.id])return!0}}),o.find(".chinputsv").html(a),c()):(s(),a=u.renderLevel(),o.find(".chinputsv").html(a),c())}),o.on("click",".vmt_panel_wrapper",function(){var e,t,n=$(this).closest("[groupid]").attr("groupid");e=n,e=u.treemap[n],l(e,t),c()}),o.on("change",'input[type="checkbox"]',function(){var t,e,n=$(this).attr("value"),a=$(this).is(":checked")?1:0,i=u.treemap[n],o={},r={},s=function(){i.parent&&u.childselected(i.parent,o,r)&&(i=i.parent,(o={})[i.id]=!0,s())},l=function(e){e.parent&&(r[e.parent.id]=!0,l(e.parent))};a?(o[i.id]=!0,s(),i.values&&u.every({group:function(e,t,n,a){r[e.id]=!0,a()},value:function(e){r[e.id]=!0}},i.values)):(!(t=i).parent||(e=u.parentselected(t.parent,[],[]))&&(r[e.id]=!0,_.each(t.parent.values,function(e){e.id!=t.id&&(o[e.id]=!0)})),r[i.id]=!0,l(i)),a=u.composeValues(o,r),n=_.map(a,function(e,t){return t}),u.set(n),c()}),void c()}if("valuesmulti"==u.type)return o.find("input").on("change",function(){var e=$(this).attr("val"),t=$(this).is(":checked")?1:0;u.set(e,t),o.removeClass("error")}),o.find(".vm_showMore").on("click",function(){o.addClass("showedMore")}),void o.find(".vm_hideMore").on("click",function(){o.removeClass("showedMore")});if("valuescustom"==u.type||"values"==u.type||"valuesmultibig"==u.type){function n(){return"valuesmultibig"==u.type?o.find(".vc_valuecustom"):o}function d(){n().toggleClass("opened"),o.find(".vc_value").removeClass("hidden"),n().hasClass("opened")?($("html").on("click",h),window.addEventListener("scroll",v),o.find(".vc_selectInput").scrollTop(0)):v()}var p=null,f=o.find(".vc_inputWrapper input"),v=function(){p&&f.val(p),n().removeClass("opened"),$("html").off("click",h),window.removeEventListener("scroll",v)},h=function(e){0===o.has(e.target).length&&n().hasClass("opened")&&v()};"valuescustom"!=u.type&&!u.autoSearch||(o.find(".vc_iconWrapper").on("click",function(){d(),u.autoSearch&&setTimeout(function(){f.focus(),p=f.val(),f.val("")},200)}),o.find("input").on("focus",function(){$(this).select()})),"values"!=u.type||u.autoSearch||o.find(".vc_textInput").on("click",function(){d()}),o.find(".vc_value").on("click",function(){p=null;var e=$(this).attr("value");f.val(e),f.change(),n().removeClass("opened"),n().removeClass("error")}),o.find(".vc_selected_value_icon").on("click",function(){var e=$(this).closest(".vc_selected_value").attr("value");u.set(e),o.parent().html(u.input()),ParametersLive([u],C,S)}),u.autoSearch&&(f.focus(function(){this.select()}),f.on("keyup",function(e){p=null;var a=$(this).val().toLowerCase();if(n().hasClass("opened")||d(),13==(e.keyCode||e.which))return 0<(e=o.find(".vc_value:not(.hidden)")).length&&(a=e.attr("value")),$(this).val(a),$(this).change(),!1;a?$.each(o.find(".vc_value"),function(){var e=$(this),t=e.attr("value").toLowerCase(),n=e.text().toLowerCase();-1<t.indexOf(a)||-1<n.indexOf(a)?e.removeClass("hidden"):e.addClass("hidden")}):o.find(".vc_value").removeClass("hidden")}));var m=function(){var e=$(this),t=e.val();if(u.autoSearch){var n=u.isValid(t);if(t&&!n)return void setTimeout(function(){e.val()==t&&u.require&&($(e).val(u.defaultValue),$(e).change())},150);n&&(t=n)}if(u.set(t),n=u.labelByValue(t),u.labelToInput)return e.val(u.labelToInput(n)),o.parent().html(u.input()),void ParametersLive([u],C,S);e.val(n),console.log("value",t,n),"valuesmultibig"==u.type&&(o.parent().html(u.input()),ParametersLive([u],C,S)),o.removeClass("error")};return f.on("change",m),void(u.onType&&f.on("keyup",m))}if("location"==u.type)return u.options.inputBinding||(u.options.inputBinding={}),u.options.inputBinding.locationNameInput=o.find(".place input"),u.options.inputBinding.radiusInput=o.find(".radius select"),u.options.onchanged=function(e,t,n){var a=$(this).locationpicker("map"),i=a.location.addressComponents,o={};_.clone(e),o.latitude=e.latitude,o.longitude=e.longitude,o.radius=t,o.country=i.country,o.zip=i.postalCode,o.place=a.location.formattedAddress,u.set(o)},u.options.location={latitude:u.value.latitude,longitude:u.value.longitude},u.options.enableAutocomplete=!0,u.options.autocompleteOptions={types:["(regions)"],componentRestrictions:{country:"us"}},u.options.enableAutocompleteBlur=!0,u.options.radius=u.value.radius,5e3<u.options.radius&&(u.options.zoom=10),1e4<u.options.radius&&(u.options.zoom=9),2e4<u.options.radius&&(u.options.zoom=8),5e4<u.options.radius&&(u.options.zoom=7),1e5<u.options.radius&&(u.options.zoom=6),25e4<u.options.radius&&(u.options.zoom=5),5e5<=u.options.radius&&(u.options.zoom=4),o.find(".map").locationpicker(u.options),void o.find(".locationInputUse input").on("change",function(){var e=!!$(this).is(":checked");o.toggleClass("notused"),e?(o.find(".place input").removeAttr("disabled"),o.find(".radius select").removeAttr("disabled")):(o.find(".place input").attr("disabled","disabled"),o.find(".radius select").attr("disabled","disabled")),u.set({using:e})});if("color"==u.type&&o.simpleColor({boxWidth:60,cellWidth:30,cellHeight:30,columns:4,cellMargin:2,colors:u.possibleValues,onSelect:function(e){u.set(e)}}),"date"==u.type&&(o.pickadate({today:"",onSet:function(e){e.select?(e=dateToStrSmall(new Date(e.select)),u.set(e)):u.set()},selectYears:!0,selectMonths:!0,format:"dddd, dd mmm, yyyy",formatSubmit:"yyyymmdd",min:u.options.min||void 0,max:u.options.max||void 0}),k=o.pickadate("picker"),u.value&&k.set("select",strToDateArr(u.value))),"daterange"==u.type){function g(){u.value[0]?w.set("min",strToDateArr(u.value[0])):w.set("min",u.options.min||!1),u.value[1]?b.set("max",strToDateArr(u.value[1])):b.set("max",u.options.max||!1)}function y(e,t){var n="";e.select&&(n=dateToStrSmall(new Date(e.select))),void 0===e.select&&void 0===e.clear||(u.set(n,t),g())}var b,w,x={selectYears:!0,selectMonths:!0,today:"",format:"dddd, dd mmm, yyyy",formatSubmit:"yyyymmdd",min:u.options.min||void 0,max:u.options.max||void 0},k=_.clone(x),x=_.clone(x);return k.onSet=function(e){y(e,0)},x.onSet=function(e){y(e,1)},o.find(".from").pickadate(k),o.find(".to").pickadate(x),b=o.find(".from").pickadate("picker"),w=o.find(".to").pickadate("picker"),u.value[0]&&b.set("select",strToDateArr(u.value[0])),u.value[1]&&w.set("select",strToDateArr(u.value[1])),void g()}"hours"!=u.type?"category"!=u.type?("phone"==u.type&&o.mask("(999) 999-9999"),"string"==u.type&&u.autoSearch&&(a=o.closest(".vc_autosearchInput").find(".placeholderghost"),i="&nbsp;",o.on("keydown",function(e){var t=$(this),n=t.val();39==(e.keyCode||e.which)?(n=a.html())!=i&&(a.html(i),t.val(a.attr("value")),t.change()):a.html(n||i)}),x=function(e){var t=$(this),n=t.val();a.html(n||i),n&&13!=(e.keyCode||e.which)&&u.autoSearch(n,u,function(e){t.val()==n&&(a.html(n||i),n&&e&&0==e.toLowerCase().indexOf(n.toLowerCase())&&a.html(n+e.substr(n.length)).attr("value",e))})},o.on("keyup",x),o.on("focus",x),o.on("blur",function(){a.html(i)})),m=function(){var e=$(this).val();"boolean"==u.type&&(e=$(this).is(":checked")?1:0),"email"==u.type&&"_@_._"==e&&(e=""),u.isValid(e)?o.removeClass("error"):o.addClass("error"),u.set(e)},o.on("change",m),u.onType&&o.on("keyup",m)):o.on("click",function(){u.app.nav.api.load({open:!0,id:"postSelectCategory",inWnd:!0,essenseData:{header:"Select Category",path:o.attr("parent"),validation:"canCreateItem",onSelectCategory:function(e){u.set(e.path())}}})}):o.find(".dayrow select").on("change",function(){var e=$(this).val(),t=$(this).closest(".trange").attr("index"),n=$(this).closest(".dayrow").attr("day");u.set(e="false"==e?null:e,n,t),o.removeClass("error")})}else o.find("input").on("change",function(){var e=$(this).val(),t=$(this).attr("index");u.isValid(e)?o.removeClass("error"):o.addClass("error"),u.set(e,t)})}}}),C.find("input").inputmask&&$.each(C.find("input"),function(){var e=$(this);e.attr("notmasked")||e.inputmask({})})},Parameter=function(e){var d=this;return d.type=((e=e||{}).type||"NUMBER").toLowerCase(),d.name=e.name||"",d.id=e.id||makeid(),d.defaultValue=e.defaultValue,d.order=e.order||0,d.require=e.require||!1,d.options=e.options||{},d.canClear=!0,d.patterns=e.patterns||[],!1===e.canClear&&(d.canClear=e.canClear),d.possibleValues=e.possibleValues||[],d.possibleValuesLabels=e.possibleValuesLabels||[],d.value=e.value||null,d.defaultValuesTemplate=e.defaultValuesTemplate||null,d.defaultValueTemplate=e.defaultValueTemplate||null,d.labelToInput=e.labelToInput||null,d.currency=e.currency||null,d.disabled=e.disabled,d.app=e.app,d.upload=e.upload,d.uploadTemplate=e.uploadTemplate,d.previewTemplate=e.previewTemplate,d.previewPath=e.previewPath,d.onLive=e.onLive,d.hidden=e.hidden||!1,d.groupId=e.groupId||0,d.dbId=e.dbId||null,d.convert=e.convert||null,d.dbConvert=e.dbConvert||null,d.dbType=e.dbType||null,d.dbFunc=e.dbFunc||"equal",d._onChange=e._onChange||null,d.onType=e.onType||null,d.description=e.description||"",d.format=e.format||{},d.placeholder=e.placeholder||"",d.autoSearch=e.autoSearch||!1,d.html=e.html||!1,d.operatorSelect=e.operatorSelect||null,d.operator=e.operator||null,d.if=e.if||null,d.text=e.text||null,-1<d.type.indexOf("range")&&(d.dbFunc="fromto"),d.removeImage=function(t){new Img({type:d.upload.data.essense,name:t.value,app:d.app,refId:d.upload.data.essense.RefID}).remove(function(e){removeEqual(d.value,t.value),t.clbk&&t.clbk(e)})},d.isValid=function(t){void 0===t&&(t=d.value);var e=d.mask();if("number"!=d.type&&"cash"!=d.type||(t=Number(t).toFixed(deep(d,"format.Precision")||0)),"label"==d.type)return!0;if("hours"==d.type)return!0;if("color"==d.type)return!0;if("date"==d.type||"daterange"==d.type)return!0;if("html"==d.type||"text"==d.type)return!(d.require&&!t);var n=!0;if(_.each(d.patterns,function(e){e.test(t)||(n=!1)}),!n)return!1;if("values"!=d.type&&"valuesmultibig"!=d.type||!d.autoSearch)return"boolean"==d.type||(!(d.require||t&&0!=t)||(e=Inputmask.isValid(t.toString(),e),!d.require||t&&0!=t||(e=!1),!!("number"!=d.type&&"cash"!=d.type||_.isNumber(Number(t)))&&e));e=_.find(d.possibleValues,function(e){if(e.toLowerCase()==t.toLowerCase())return!0});return!!e&&e.toUpperCase()},d.openGallery=function(e){e=e||{};var t=_.map(d.value,function(e){return new Img({type:d.upload.data.essense,name:e,app:d.app})});e=_.extend(e,{images:t,essense:d.upload.data.essense,size:"full",smallSize:"thumbnail",edit:!0}),d.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e})},d.default=function(){var e={string:"",number:0,percent:0,dollars:0,text:"",category:0,html:"",location:{country:"US",latitude:40.73387539871257,longitude:-73.98949970898434,place:"New York, NY 10003, USA",radius:1e4,zip:"10003",using:!0},valuesmulti:[],values:"",boolean:!1,cash:0,image:"",numberrange:["",""],cashrange:["",""],hours:{},valuesmultibig:[],valuescustom:"",valuesmultitree:[],phone:"",color:"#1E3DF7",date:"",daterange:["",""],email:"",stringany:"",nickname:"",password:"",file:""};return void 0!==d.defaultValue?d.defaultValue:d.type&&void 0!==e[d.type]?e[d.type]:0},d.renders={category:function(e){var t=d.app.store.categories.find(d.value||"0");return t?t.htmlpath():""},boolean:function(e){var t="",n="";return d.value&&"0"!=d.value&&(n="checked"),(t+='<input pid="'+d.id+'" type="checkbox" disabled id="checkbox_'+d.id+'"'+n+' class="checkbox nolabel '+d.type+'" />')+('<label for="checkbox_'+d.id)+'"></label>'},numberrange:function(e,t){return d.value[t]},cashrange:function(e,t){return d.value[t]}},d.mask=function(e){var t,n=d.format||{},a=!1,i={rightAlign:!1,autoUnmask:!0,showMaskOnHover:!1,showMaskOnFocus:!1,clearMaskOnLostFocus:!0};return"number"!=d.type&&"cash"!=d.type||(i.alias="numeric",i.groupSeparator=void 0!==n.groupSeparator?n.groupSeparator:",",i.radixPoint=".",i.digits=deep(d,"format.Precision"),i.digitsOptional=!1,i.autoGroup=!0,i.allowMinus=deep(d,"format.AllowMinus")||!1,deep(d,"format.Min")&&(i.min=deep(d,"format.Min")),deep(d,"format.Max")&&(i.max=deep(d,"format.Max")),0<i.digits&&(i.placeholder="0.00"),a=!0),"numberrange"!=d.type&&"cashrange"!=d.type||(i.alias="numeric",i.nullable=!0,i.groupSeparator=",",i.autoGroup=!0,i.digits=deep(d,"format.Precision"),a=!0),"email"==d.type&&(i.alias="email",a=!0),"string"==d.type&&(t=[0,""],d.require&&(t[0]=1),d.format.Length&&(t[1]=d.format.Length),i.regex="[а-яА-Яa-zA-Z0-9 ,-.&]{"+t.join(",")+"}",a=!0),"nickname"==d.type&&(t=[0,""],d.require&&(t[0]=1),d.format.Length&&(t[1]=d.format.Length),i.regex="[a-zA-Z0-9_]{"+t.join(",")+"}",a=!0),"stringany"==d.type&&(t=[0,""],d.require&&(t[0]=1),d.format.Length&&(t[1]=d.format.Length),i.regex="[^|]{"+t.join(",")+"}",a=!0),a?e?'data-inputmask="'+(i=(i=JSON.stringify(i)).substring(1)).substring(0,i.length-1).replace(/"/g,"'")+'"':i:e?"":null},d.labelByValue=function(e){var t=_.indexOf(d.possibleValues,e);return-1<t?d.possibleValuesLabels[t]:e},d.operatorInput=function(){if(!d.operatorSelect)return"";var n='<div class="operator"><select class="operatorselect">';return _.each(d.operatorSelect,function(e){var t="";e.id==d.operator&&(t="selected"),n+="<option "+t+' + value="'+e.id+'">'+e.name+"</option>"}),n+="</select></div>"},d.input=function(e){var t="";d.disabled&&(t='disabled="disabled"'),e=e||{};var n=d.mask(!0);if(("image"==d.type||"file"==d.type)&&d.uploadTemplate&&d.upload&&d.previewTemplate)return d.uploadTemplate(d);if("location"==d.type){var a="checked",i="",o="";return d.value.using||(a="",i="notused",o='disabled="disabled"'),'<div pid="'+d.id+'" class="locationInputWrapper '+i+'"><div class="table locationInputs"><div class="locationInputUse"><input type="checkbox" id="checkbox_'+d.id+'_location" '+a+' class="checkbox nolabel" /><label for="checkbox_'+d.id+'_location"></label></div><div class="locationInput place"><input type="text" notmasked="notmasked" placeholder="Name Of Place"></div><div class="locationInput radius"><select><option value="1000">1 mi</option><option value="5000">5 mi</option><option value="10000">10 mi</option><option value="20000">20 mi</option><option value="50000">50 mi</option><option value="100000">100 mi</option><option value="500000">500 mi</option></select></div></div><div class="mapwr"><div class="map"></div><div class="mapbwoverlay"></div></div></div>'}if("valuescustom"==d.type||"values"==d.type||"valuesmultibig"==d.type){var o="",r=d.value;"valuesmultibig"==d.type&&(r=""),"values"!=d.type||d.autoSearch||(o="disabled"),"values"!=d.type&&"valuescustom"!=d.type||(r=d.labelByValue(d.value),d.labelToInput&&(r=d.labelToInput(r))),i="",i+='<div class="vc_iconWrapper">',i+='<div class="vc_iconSpinWrapper">',i+='<i class="fa fa-caret-down" aria-hidden="true"></i>',i+="</div>",i+="</div>";var s="";return"valuesmultibig"==d.type?(s+='<div class="vc_valuecustom_multibig" pid="'+d.id+'">',s+='<div class="vc_valuecustom">'):s+='<div class="vc_valuecustom" pid="'+d.id+'">',s+='<div class="vc_textInput table">',d.format.right&&(s+=i),s+='<div class="vc_inputWrapper">',s+="<input "+o+' type="text" value="'+r+'" placeholder="'+d.placeholder+'">',s+="</div>",d.format.right||(s+=i),s+="</div>",s+='<div class="vc_selectInput">',d.defaultValuesTemplate?s+=d.defaultValuesTemplate(d):(d.defaultValue||(s+='<div class="vc_value" value="">',s+="&nbsp;",s+="</div>"),_.each(d.possibleValues,function(e,t){var n;"valuesmultibig"==d.type&&-1<_.indexOf(d.value,e.toUpperCase())||(n=d.labelByValue(e),s+='<div class="vc_value" value="'+e+'">',d.defaultValueTemplate?s+=d.defaultValueTemplate(n,e,d):s+=n,s+="</div>")})),s+="</div>",s+="</div>","valuesmultibig"==d.type&&(s+='<div class="vc_selected_values">',_.each(d.value,function(e,t){var n=d.labelByValue(e);s+='<div class="vc_selected_value table" value="'+e+'">',s+='<div class="vc_selected_value_icon">',s+='<i class="fas fa-times-circle"></i>',s+="</div>",s+='<div class="vc_selected_value_value">',s+=n,s+="</div>",s+="</div>"}),s+="</div>",1<d.value.length&&(s+=d.operatorInput()),s+="</div>"),s}if("text"==d.type||"html"==d.type)return s='<textarea placeholder="'+d.placeholder+'" notmasked="notmasked" pid="'+d.id+'" class="'+d.type+' ">'+d.render(!0)+"</textarea>";if("category"==d.type){var l=d.app.store.categories.find(d.value||"0");return s=l&&l.canCreateItem()?'<div parent="'+l.parent.path()+'" pid="'+d.id+'" class="editCategoryPath">'+l.htmlpath()+"</div>":'<button pid="'+d.id+'" class="selectCategoryPath">Select Category</button>'}if("valuesmulti"==d.type){s='<div class="vm_valuesmulti" pid="'+d.id+'">';return _.each(d.possibleValues,function(e,t){var n="",a=e;d.possibleValuesLabels[t]&&(a=d.possibleValuesLabels[t]),d.options.valueTemplate&&(a=d.options.valueTemplate(e,a)),-1<_.indexOf(d.value,e)&&(n="checked"),5==t&&(s+='<div class="vm_showMore">Show More</div>',s+='<div class="vm_hidden">',s+='<div class="vm_hideMore">Hide</div>'),s+='<div class="vm_value">',s+='<input val="'+e+'" type="checkbox" id="checkbox_'+d.id+"_"+e+'"'+n+' class="checkbox nolabel '+d.type+'" />',s+='<label for="checkbox_'+d.id+"_"+e+'">'+a+"</label>",s+="</div>"}),6<=d.possibleValues.length&&(s+='<div class="vm_hideMore">Hide</div>',s+="</div>"),s+="</div>"}if("valuesmultitree"==d.type){var u,c,l=null,s='<div class="vmt_valuesmultitree" pid="'+d.id+'">';return d.autoSearch&&(s+='<div class="autoSearchWrapper"><input type="text" class="autoSearch" placeholder="Search Code"></div>'),e.init&&(u={},c={},_.each(d.value,function(e){var t=d.treemap[e];t&&(c[e]=t,_.each(t.parents,function(e){u[e.id]=!0}))}),l={group:function(e){if(u[e.id])return e.active=!0},value:function(e){return!0}}),d.renderLevel=function(e,t,r){var s="";return s+='<div class="nextlevel">',d.every({group:function(e,t,n,a){var i=e.name,o=e.active||r&&r.group(e);d.options.valueTemplate&&(i=d.options.valueTemplate(e)),!o&&r&&!r.value(e)||(s+='<div class="vmt_group " level="'+t+'" groupid="'+e.id+'">',s+='<div class="vmt_name table">',s+='<div class="vmt_checkbox">',s+='<input type="checkbox" value="'+e.id+'" id="checkbox_'+d.id+e.id+'" class="checkbox" />',s+='<label for="checkbox_'+d.id+e.id+'">'+i+"</label>",s+="</div>",s+='<div class="vmt_panel">',s+='<div class="vmt_panel_wrapper">',s+='<i class="fa fa-angle-up" aria-hidden="true"></i>',s+="</div>",s+="</div>",s+="</div>",s+='<div class="vmt_group_params">',o&&(s+='<div class="nextlevel">',a(),s+="</div>"),s+="</div>",s+="</div>")},value:function(e,t,n){var a;r&&!r.value(e)||(a=e.name,d.options.valueTemplate&&(a=d.options.valueTemplate(e)),s+='<div class="vmt_value" level="'+t+'" groupid="'+e.id+'">',s+='<div class="vmt_checkbox">',s+='<input type="checkbox" value="'+e.id+'" id="checkbox_'+d.id+e.id+'" class="checkbox" />',s+='<label for="checkbox_'+d.id+e.id+'">'+a+"</label>",s+="</div>",s+="</div>")}},e,t),[s+="</div>",!1]},l=d.renderLevel(null,0,l),s+='<div class="chinputsv">',s+=l[0],s+="</div>",s+="</div>"}if("boolean"==d.type){s="",a="";return d.value&&"0"!=d.value&&(a="checked"),s+='<input pid="'+d.id+'" type="checkbox" id="checkbox_'+d.id+'"'+a+' class="checkbox nolabel '+d.type+'" />',s+='<label for="checkbox_'+d.id+'"></label>'}if("cash"==d.type){s='<div class="cashWrapper" pid="'+d.id+'">';return s+='<div class="inputCashWrapper">',s+="<input "+n+' class="'+d.type+' input" value="'+d.render(!0)+'">',s+="</div>",d.currency&&(s+='<div class="convertCashWrapper">',s+='<div class="convertValue">'+d.app.store.cash.toBTC(d.value,d.currency,!0)+"</div>",s+="</div>"),s+="</div>"}if("cashrange"==d.type){s='<div class="cashrangeWrapper" pid="'+d.id+'">';return s+='<div class="inputsCashrangeWrapper">',s+='<div class="inputCashrangeWrapper">',s+='<input index="0" '+n+' class="'+d.type+' input" placeholder="From" value="'+d.render(!0,0)+'">',s+="</div>",s+='<div class="inputCashrangeWrapper">',s+='<input index="1" '+n+' class="'+d.type+' input" placeholder="To" value="'+d.render(!0,1)+'">',s+="</div>",s+="</div>",d.currency&&(s+='<div class="convertsCashrangeWrapper">',s+='<div class="convertCashrangeWrapper">',s+='<div class="convertValue" index="0">'+d.app.store.cash.toBTC(d.value[0],d.currency,!0)+"</div>",s+="</div>",s+='<div class="convertCashrangeWrapper">',s+='<div class="convertValue" index="1">'+d.app.store.cash.toBTC(d.value[1],d.currency,!0)+"</div>",s+="</div>",s+="</div>"),s+="</div>"}if("numberrange"!=d.type)return"color"==d.type?s='<input notmasked="notmasked" pid="'+d.id+'" class="simpleColor input" value="'+d.value+'">':"daterange"!=d.type?"daterange"==d.type?s='<input notmasked="notmasked" pid="'+d.id+'" class="datePicker input">':"phone"==d.type?s='<input notmasked="notmasked" pid="'+d.id+'" class="'+d.type+' input" value="'+d.render(!0)+'" type="text">':d.autoSearch?s='<div class="vc_autosearchInput">\t\t\t\t<div class="placeholder"><div class="placeholderghost">&nbsp;</div></div>\t\t\t\t<div class="autosearchInputCnt">\t\t\t\t<input notmasked="notmasked" '+n+' pid="'+d.id+'" class="'+d.type+' input" placeholder="'+(d.placeholder||"")+'" value="'+d.render(!0)+'" type="text">\t\t\t\t</div></div>':"password"==d.type?s="<input "+t+' pid="'+d.id+'" class="'+d.type+' input" placeholder="'+(d.placeholder||"")+'" value="'+d.render(!0)+'" type="password">':"label"==d.type?`<div ${t} ${n} pid="${d.id}" class="simpleColor inpLabel">${d.value}</div>`:"file_select"==d.type?`
                    <input ${t} ${n} pid="${d.id}" class="${d.type} input" placeholder="${d.placeholder||""}" value="${d.render(!0)}" type="text">
                    <button ${t} ${n} pid="${d.id}_Selector" class="simpleColor inpButton btn_select">...</button>
                `:"button"==d.type?`<button ${t} ${n} pid="${d.id}" class="simpleColor inpButton" value="${d.value}">${d.text}</button>`:s=`<input ${t} ${n} pid="${d.id}" class="${d.type} input" placeholder="${d.placeholder||""}" value="${d.render(!0)}" type="text">`:(s='<div class="numberrangeWrapper" pid="'+d.id+'">',s+='<div class="inputNumberrangeWrapperFrom">',s+='<input notmasked="notmasked" pid="'+d.id+'" class="datePicker input from" placeholder="From">',s+="</div>",s+='<div class="inputNumberrangeWrapperTo">',s+='<input notmasked="notmasked" pid="'+d.id+'" class="datePicker input to" placeholder="To">',s+="</div>",s+="</div>");s='<div class="numberrangeWrapper" pid="'+d.id+'">';return s+='<div class="inputNumberrangeWrapperFrom">',s+='<input index="0" '+n+' class="'+d.type+' input" placeholder="From" value="'+d.render(!0,0)+'">',s+="</div>",s+='<div class="inputNumberrangeWrapperTo">',s+='<input index="1" '+n+' class="'+d.type+' input" placeholder="To" value="'+d.render(!0,1)+'">',s+="</div>",s+="</div>"},d.render=function(e,t){return d.renders[d.type]?d.renders[d.type](e,t):_.isArray(d.value)&&void 0!==t?d.value[t]||"":d.value},d.sets={hours:function(e,t,n){d.value[t]||(d.value[t]={start:null,end:null}),d.value[t][n]=e},location:function(e){e?(e.country&&(d.value.country=e.country),e.latitude&&(d.value.latitude=e.latitude),e.longitude&&(d.value.longitude=e.longitude),e.place&&(d.value.place=e.place),e.radius&&(d.value.radius=e.radius),e.zip&&(d.value.zip=e.zip),void 0!==e.using&&(d.value.using=e.using)):d.value=d.default()},number:function(e){e=Number(e),d.value=e},numberrange:function(e,t){""!==e&&(e=Number(e)),_.isNumber(e)||(e=""),d.value[t]=e},cash:function(e){e=Number(e),_.isNumber(e)||(e=null),d.value=e},cashrange:function(e,t){""!==e&&(e=Number(e)),_.isNumber(e)||(e=""),d.value[t]=e},daterange:function(e,t){d.value[t]=e},image:function(e){"array"!=typeof e&&e?d.value.push(e):d.value=e},valuesmulti:function(e){-1<_.indexOf(d.value,e)?removeEqual(d.value,e):d.value.push(e)},valuesmultibig:function(e){-1<_.indexOf(d.value,e)?removeEqual(d.value,e):d.value.push(e)},valuesmultitree:function(e){d.value=e}},d.set=function(e,t,n){"___nochange"==e||(void 0===e?d.value=d.default():(d.calculation&&(e=d.calculation(e)),d.sets[d.type]?d.sets[d.type](e,t,n):d.value=e)),d._onChange&&d._onChange(d.value,d),d.onChange&&d.onChange(d.value,d)},d.get=function(){return d.dbConvert?d.dbConvert(d.value):d.value},"valuesmultitree"==d.type&&(d.clear=function(){_.each(d.treemap,function(e){e.active=!1})},d.convertValuesToAll=function(i,o){"names"==(i=i||"id")&&(i="name");var e=_.map(d.value,function(e){return d.treemap[e]}),r=[];return d.every({group:function(e,t,n,a){o&&r.push(e[i]),a()},value:function(e){r.push(e[i])}},e),r},d.convertValues=function(t){return"names"==(t=t||"id")&&(t="name"),_.map(d.value,function(e){return d.treemap[e][t]})},d.composeValues=function(e,n){var a={};return _.each(d.value,function(e,t){n[e]||(a[e]=!0)}),_.each(e,function(e,t){n[t]||(a[t]=!0)}),a},d.childselected=function(e,t,n){var a=d.composeValues(t,n),n=_.filter(e.values,function(e){if(a[e.id])return!0});return e.values.length==n.length},d.parentselected=function(e,t,n){var a=d.composeValues(t,n),i=function(e){return a[e.id]?e:e.parent?i(e.parent):null};return e?i(e):null},d.every=function(i,e,t){var o=function(e,t){for(var n=e.length,a=0;a<n;a++)value=e[a],value&&(value.values?i.group(value,t,a,function(){o(value.values,t+1)},a):i.value(value,t,a))};e=e||d.possibleValues,o(e,0)},d.preparemap=function(){d.treemap={},d.every({value:function(e,t){e.active=!1,d.treemap[e.id]=e},group:function(e,t,n,a){d.treemap[e.id]=e,_.each(e.values,function(t){t.parent=e,t.parents||(t.parents=[e]),_.each(e.parents||[],function(e){t.parents.push(e)})}),a()}})},d.preparemap()),d.searchValues=function(t){function i(e){(e.id==t||-1<e.name.toLowerCase().indexOf(t))&&(n[e.id]=e)}t=t.toLowerCase();var n={};return d.every({group:function(e,t,n,a){i(e),a()},value:i}),n},null===d.value&&(d.value=d.default()),d},Composite=function(e){(e=e||{}).type="composite";var i=new Parameter(e);return i.content={},i.template=e.template,i.add=function(e,t){(i.content[e]=t)._onChange=function(){i.collectValues()}},_.each(e.parameters,function(e,t){i.add(t,e)}),i.collectValues=function(){var n={};_.each(i.content,function(e,t){e.value&&(n[t]=e.value)}),i.set(n)},i.applyValues=function(){_.each(i.content,function(e,t){void 0!==(t=i.value[t])&&(e.value=t,e.applyValues&&e.applyValues())})},i.isValid=function(e,n){var a=!0;return _.each(i.content,function(e){var t=e.isValid(void 0,n);a=a&&t,!t&&"composite"!=t.type&&n&&e.require?e.el.addClass("error"):e.el.removeClass("error")}),a},i.input=function(){var e='<div class="composite" pid="'+i.id+'">';return(e+=i.template({content:i.content}))+"</div>"},i.render=i.input,i},flb=function(e){return e?e[0]&&e.substr?e[0].toUpperCase()+e.substr(1):e:""},emptyFunction=function(){return!0};var ___mobile=void 0,___tablet=void 0;isMobile=function(){return void 0!==___mobile?___mobile:___mobile=$("html").hasClass("mobile")},isTablet=function(){return void 0!==___tablet?___tablet:___tablet=$("html").hasClass("mobile")||$("html").hasClass("tablet")},convertToBase64=function(e){var t=e.indexOf(";base64,")+";base64,".length,t=e.substring(t);return window.atob(t)},os=function(){var e=null;return-1!=navigator.appVersion.indexOf("Win")&&(e="windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="macos"),-1!=navigator.appVersion.indexOf("X11")&&(e="unix"),-1!=navigator.appVersion.indexOf("Linux")?"linux":e},collectParameters=function(e,n){var a="?";return _.each(e,function(e,t){n&&-1!=_.indexOf(n,t)||!e||(a+=t+"="+e+"&")}),a=a.slice(0,-1)},addtouri=function(e,t,n){return n=t+"="+n,-1<e.indexOf("?")?e+="&"+n:e+="?"+n,e},rand=function(e,t){return e=parseInt(e),t=parseInt(t),Math.floor(Math.random()*(t-e+1))+e},trim=function(e){return rtrim(ltrim(e))},ltrim=function(e){return(e||"").replace(/^\s+/,"")},rtrim=function(e){return(e||"").replace(/\s+$/,"")},ltrimrn=function(e){return(e||"").replace(/^[\r\n\t ]+/,"")},rtrimrn=function(e){return(e||"").replace(/[\r\n\t ]+$/,"")},trimrn=function(e){return rtrimrn(ltrimrn(e))},returnDaysInRange=function(e){var t,n;return"ytd"==e&&(t=new Date,n=new Date(dateUtc(t).y,0,1),n=((t.getTime()-n.getTime())/1e3/60/60/24).toFixed(0)),"5d"==e&&(n=5),"1m"==e&&(n=31),"2m"==e&&(n=62),"3m"==e&&(n=93),"6m"==e&&(n=186),"1y"==e&&(n=365),"2y"==e&&(n=730),"3y"==e&&(n=1096),"5y"==e&&(n=1825),"10y"==e&&(n=3652),"max"==e?1e5:n},maskValue=function(e){(e=e||{}).decimal||(e.decimal="."),e.allowNegative||(e.allowNegative=!0),e.precision||(e.precision=0),e.thousands||(e.thousands=","),e.prefix||(e.prefix=""),e.suffix||(e.suffix=""),e.value&&(e.value=""+e.value);var t=e.value||"0",n=-1<t.indexOf("-")&&e.allowNegative?"-":"",a=t.replace(/[^0-9]/g,""),i=a.slice(0,a.length-e.precision),o=i=""===(i=(i=i.replace(/^0*/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,e.thousands))?"0":i;return 0<e.precision&&(i=a.slice(a.length-e.precision),a=new Array(e.precision+1-i.length).join(0),o+=e.decimal+a+i),-1<t.indexOf("-")&&(t=t.replace("-","")),n+e.prefix+o+e.suffix},Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2},progressBar=function(e){(e||e.el)&&(100<=e.progress&&(e.progress=0),100<=e.progress&&(e.status=""),100<=e.progress&&(e.addStatus=""),null!=typeof e.progress&&e.el.find(".bar").width(e.progress+"%"),null!=typeof e.status&&e.el.find(".status").html(e.status),null!=typeof e.addStatus&&e.el.find(".addStatus").html(e.addStatus))},GetBrowser=function(){var e,t=navigator.appName,n=navigator.userAgent,a=n.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return a&&null!=(e=n.match(/version\/([\.\d]+)/i))&&(a[2]=e[1]),(a=a?[a[1],a[2]]:[t,navigator.appVersion,"-?"])[0]},_saveAs=function(e){var t;window.navigator.msSaveOrOpenBlob?(t=new Blob([decodeURIComponent(e.file)],{type:"text/"+e.format+";charset=utf-8;"}),window.navigator.msSaveOrOpenBlob(t,e.name+"."+e.format)):saveAs(e)},saveAs=function(e){if("msie"==GetBrowser().toLowerCase())return message("Internet Explorer does not support this operation."),!1;e=e||{};var t=document.createElement("a");return document.body.appendChild(t),t.download=e.download||(e.name||"unknown")+"."+e.format.toLowerCase(),t.target="_blank",e.noA||("xlsx"==e.format.toLowerCase()&&(e.file="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+e.file),"csv"==e.format.toLowerCase()&&(e.file="data:text/csv;charset=utf-8,"+e.file),"pdf"==e.format.toLowerCase()&&(e.file="data:application/pdf;base64,"+e.file),"txt"==e.format.toLowerCase()&&(e.file="data:text;charset=utf-8,"+e.file)),t.href=e.file,t.click(),!0},b64toBlob=function(e,t,n){t=t||"",n=n||512;for(var a=atob(e),i=[],o=0;o<a.length;o+=n){for(var r=a.slice(o,o+n),s=new Array(r.length),l=0;l<r.length;l++)s[l]=r.charCodeAt(l);var u=new Uint8Array(s);i.push(u)}return new Blob(i,{type:t})},saveAsWithCordova=function(n,a,i){window.resolveLocalFileSystemURL("file:///storage/emulated/0/",function(e){e.getDirectory("Download",{exclusive:!1},function(e){e.getFile(a,{create:!0,exclusive:!1},function(e){var t=e.toURL();e.createWriter(function(e){e.onwriteend=function(e){sitemessage("File "+a+" successfully downloaded"),window.galleryRefresh&&window.galleryRefresh.refresh(t,function(e){},function(e){}),i&&i(t)},e.seek(0),e.write(n)},function(e){dialog({html:"Error: Could not create file writer, "+e.code,class:"one"})})},function(e){dialog({html:"Error: Could not create file, "+e.code,class:"one"})})},function(e){dialog({html:"Error: access to download folder, "+e.code,class:"one"})})},function(e){dialog({html:"Error: Could not create file, "+e.target.error.code,class:"one"})})},initUp=function(e,t){t=t||{};var n=this,a=$(window),i={up:function(){t.scrollTop?t.scrollTop():_scrollTop(0)},view:function(){200<a.scrollTop()?e.fadeIn(100):e.fadeOut(100)}};return n.destroy=function(){e.off("click",i.up),window.removeEventListener("scroll",i.view)},n.init=function(){return e.on("click",i.up),window.addEventListener("scroll",i.view),n},n},_scrollTop=function(e,t,n){t=t||$("body,html"),(n=void 0===n?200:n)?t.animate({scrollTop:e},n):t.scrollTop(e)},_scrollTo=function(e,t,n,a){var i=(e=e||$(this)).offset(),e=(e.height()-$(window).height())/2;i&&(e=i.top+e,t&&(e=e+t.scrollTop()-t.offset().top),_scrollTop(e,t,n))},_scrollToTop=function(e,t,n,a){if(a=a||0,e=(e=e||$(this)).offset()){if(e=e.top+a,t)try{e=e+t.scrollTop()-t.offset().top+a}catch(e){}_scrollTop(e,t,n)}},_scrollToBottom=function(e,t,n,a){a=a||0;var i=(e=e||$(this)).offset();i&&(i=i.top+a+e.height(),t&&(i=i+t.scrollTop()-t.offset().top+e.height()+a),_scrollTop(i,t,n))},offScroll=function(){var e;"undefined"!=typeof window&&(e=$(window).scrollTop(),$(window).bind("scroll",function(){$(window).scrollTop(e)}))},onScroll=function(){"undefined"!=typeof window&&$(window).unbind("scroll")},inView=function(e,o){(o=o||{}).inel||(o.inel=window),o.offset||(o.offset=0),o.f||(o.f="offset"),o.elOffset=0;try{o.elOffset=o.inel[o.f]().top}catch(e){o.elOffset=0}o.mode||(o.mode="part");var r=(t=$(o.inel)).scrollTop(),t=t.height(),s=r-o.offset,l=r+t+o.offset,u=r+o.offsetTop,c=r+t-o.offsetBottom,e=e.filter(function(){var e=$(this),t=e[o.f]().top,n=e.height(),a=t+n,i=s<=t&&t<l||a<=l&&s<a,a=s<=t&&a<=l;if("line"==o.mode)return t-r<u&&c<t+n;if("partall"==o.mode){if(a)return e.data("inView","all"),!0;if(i)return e.data("inView","part"),!0}return"part"==o.mode&&i||"all"==o.mode&&a||void 0});return"partall"==o.mode?e.sort(function(e,t){return e=$(e),t=$(t),e.data("inView")==t.data("inView")?0:"all"==e.data("inView")?-1:"part"==e.data("inView")?1:void 0}):e};var ease={linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}};SwipeParallax=function(g){function y(e){if("translate"==g.prop){if("up"==e)return"y";if("down"==e)return"y";if("left"==e)return"x";if("right"==e)return"x"}if("margin"==g.prop){if("up"==e)return"margin-bottom";if("down"==e)return"margin-top";if("left"==e)return"margin-left";if("right"==e)return"margin-right"}if("padding"==g.prop){if("up"==e)return"padding-bottom";if("down"==e)return"padding-top";if("left"==e)return"padding-left";if("right"==e)return"padding-right"}if("position"==g.prop)return"up"==e||"down"==e?e.position||"top":"left"==e||"right"==e?e.position||"left":void 0}function b(e,t){return e=_.clone(e),"up"==t&&(0<e.y&&(e.y=0),"margin"!=g.prop&&"padding"!=g.prop||(e.y=Math.abs(e.y)),e.x=0),"down"==t&&(e.y<0&&(e.y=0),"margin"!=g.prop&&"padding"!=g.prop||(e.y=Math.abs(e.y)),e.x=0),"left"==t&&(0<e.x&&(e.x=0),"margin"!=g.prop&&"padding"!=g.prop||(e.x=Math.abs(e.x)),e.y=0),"right"==t&&(e.x<0&&(e.x=0),"margin"!=g.prop&&"padding"!=g.prop||(e.x=Math.abs(e.x)),e.y=0),e}function a(e,t){t=t||{},w.animation&&w.animation.stop(),"translate"==g.prop&&(e.x||e.y,g.el.css({transform:""}),g.el.css({transition:""}),t.complete&&t.complete())}(g=g||{}).directions||(g.directions={}),g.prop||(g.prop="translate"),_.each(g.directions,function(e,t){e.i=t});var w=this;return w.goup=function(e){var t=y(e),n=5*(g.directions[e].trueshold||90);"top"!=t&&("up"!=e||"y"!=t)||"position"!=g.prop&&"translate"!=g.prop||(n=-n),"left"!=t||"position"!=g.prop&&"translate"!=g.prop||(n=-n),(e={})[t]=n+"px",a(e,{dontstop:!0,compele:function(){w.renew()}})},w.backfast=function(){_.each(g.directions,function(e){e.positionclbk&&e.positionclbk(0)})},w.backup=function(e){var t={};t[y(w.lastDirection=e)]="0px";var n=g.directions[e];a(t,{step:function(e,t){n&&n.positionclbk&&n.positionclbk(e)},compele:function(){w.renew()}})},w.lastDirection=null,w.animation=null,w.ended=!1,w.renew=function(){w.lastDirection=null,w.animation=null,w.ended=!1,w.animation&&w.animation.stop()},w.opposite=function(e,t){return"up"==e&&"down"==t||"down"==e&&"up"==t||"left"==e&&"right"==t||"right"==e&&"left"==t||void 0},w.init=function(){var v=0,h=null,m=!1;return console.log("p",g),g.el.swipe({allowPageScroll:g.allowPageScroll,swipeStatus:function(e,t,n,a,i,o,r,s){if(w.ended)return!1;if(console.log("phase",t),"start"==t)return m=!1,v=0,w.renew(),!0;if("cancel"!=t&&"end"!=t){var l=(d=r,p={end:{x:0,y:0},start:{x:0,y:0},last:{x:0,y:0}},f=_.toArray(d).length,_.each(d,function(e){_.each(e,function(e,t){p[t].x+=e.x/f,p[t].y+=e.y/f})}),p),u={x:l.last.x-l.start.x+v,y:l.last.y-l.start.y+v};if(!u.x&&!u.y)return!0;if(c=u,r=_.max(g.directions,function(e,t){return t=b(c,t),Math.abs(t.x||t.y)})){if(r.constraints&&!r.constraints())return h&&(w.backup(h.i),h=null),!1;if(h&&h.i!=r.i)if(th=!1,r.mintrueshold&&(d=b(u,r.i),l=b(u,h.i),Math.abs((d.x||d.y||0)-(l.x||l.y||0))<r.mintrueshold&&(th=!0)),th)r=h;else if(w.backup(h.i),r.cancellable)return h=null,!1;if(u=(u=b(u,(h=r).i)).x||u.y||0,!m&&Math.abs(u+v)<(r.mintrueshold||0))return!0;m=!0,r.positionclbk&&r.positionclbk(u),r.reverse&&(u=-u),r=h.i,u=u,r=y(r),"translate"!=g.prop?g.el.css(r,u+"px"):("x"==r&&g.el.css("transform","translate3d("+(u||0)+"px, 0, 0)"),"y"==r&&g.el.css("transform","translate3d(0, "+(u||0)+"px, 0)"))}else h=null}var c,d,p,f;"cancel"!=t&&"end"!=t||(h?(console.log("_direction == mainDirection",n,h),"end"==t&&h.clbk&&n==h.i&&h.clbk(),h.positionclbk&&h.positionclbk(0),w.backup(h.i)):w.backfast(),h=null)}}),w},w},SwipeParallaxNew=function(o){function r(e,t){e.positionclbk&&e.positionclbk(t)}(o=o||{}).directions||(o.directions={}),_.each(o.directions,function(e,t){e.i=t});var s=this;return s.clear=function(){o.el.css({transform:""}),o.el.css({transition:""}),_.each(o.directions,function(e){r(e,0)})},s.backfast=function(){_.each(o.directions,function(e){e.positionclbk&&e.positionclbk(0)})},s.init=function(){var i=null;return o.el.swipe({allowPageScroll:o.allowPageScroll,swipeStatus:function(e,t,n,a){if(i&&i.i!=n&&(t="cancel",n=i.i),"cancel"!=t&&"end"!=t||(i&&"end"==t&&i.clbk&&n==i.i&&i.clbk(),s.clear()),n&&o.directions[n]){if((n=o.directions[n]).constraints&&!n.constraints())return i=i&&null,!1;"start"==t&&(i=null),"move"==t&&20<a&&(r(i=n,a),n=a,"up"!=(t=i.i)&&"left"!=t||(n=-n),"x"==(a="up"==(a=t)||"down"==a?"y":"left"==a||"right"==a?"x":void 0)&&o.el.css("transform","translate3d("+(n||0)+"px, 0, 0)"),"y"==a&&o.el.css("transform","translate3d(0, "+(n||0)+"px, 0)"))}}}),s},s},Roller=function(e){var l=this;function t(){var n,o=i(),r=(o.offset().top,o.height()),s=c.height(),e=(n=[],_.each(a,function(e,t){n.push({id:t,e:e})}),n=_.sortBy(n,function(e){return-e.e.find(l.inner).height()}));_.each(e,function(e){var t,n,a=e.e,i=e.id;a!=o?(t=a.find(l.inner),n=(n=a).offset().top,e=0<(n=c.scrollTop()-n+l.offset)?n:0,0<(t=(a=t.height())-(s-l.offset))&&(e-=t),u[i].height(e=(e=e+a<=r?e:r-a)<0?0:e),d[i]=e):u[i].height(0)})}l.inner=(e=e||{}).inner||".cnt",l.selector=e.selector||".roller",l.elements=e.elements,l.offset=e.offset||0;var n=e.cnt,a={},u={},c=$(window),d={},i=function(){return _.max(a,function(e){return e.find(l.inner).height()})};return l.clear=function(){_.each(u,function(e){e.height(0)})},l.init=function(){return l.elements||(l.elements=n.find(l.selector)),l.elements.each(function(){var e=$(this),t=e.find(l.inner),n=e.attr("roller");a[n]=e,u[n]=$("<div>",{class:"pre"}),t.before(u[n])}),window.addEventListener("scroll",t),l},l.apply=function(){return l.clear(),t(),l},l.destroy=function(){l.clear(),window.removeEventListener("scroll",t)},l},Caption=function(i){var o=i.container,r=i.caption,s=i.offset||[0,0],l=!1,u=i._in||$(window),c=null,d=makeid(!0),p=i.pos||"top",f="cf_spacer",v="cf_caption",h="offset";i._in&&(h="position");var m=this;function g(){c&&c.remove(),c=null,o.find("."+f+"."+d).remove(),r.removeClass(v),r.width("auto"),r.css(p,"0"),l=!1}function e(){l&&r.width(o.width())}function t(){var e,t,n,a;o.is(":visible")&&(e=u.scrollTop(),t=o[h]().top-s[0],a=o[h]().top+o.height()-s[0]+s[1],m.addscroll&&(t+=e,a+=e),void 0!==i.iniHeight?a-=i.iniHeight:a-=r.height(),n=e+u.height(),i.calculations&&(i.calculations.bottom&&(a=i.calculations.bottom(r,s)),i.calculations.top&&(t=i.calculations.top(r,s))),"top"==p&&t<e&&e<a||"bottom"==p&&t<n&&n<a+r.height()?l||(g(),l=!0,a=0,a=i.removeSpacer?o.width():(c=$("<div>",{class:f+" "+d,height:i.spacerHeight||r.height(),width:r.width()}),r.before(c),c.width()),r.addClass(v),r.css(p,s[0]+"px"),r.css("z-index","100"),r.width(a)):l&&g())}function n(){u[0].addEventListener("scroll",t),window.addEventListener("resize",e)}function a(){u[0].removeEventListener("scroll",t),window.removeEventListener("resize",e)}return m.addscroll=!1,i._in&&(m.addscroll=!0),m.destroy=function(){g(),a()},m.init=function(){return o=o||r.parent(),n(),m},m.setOffset=function(e){s=e,g(),t()},m.setIn=function(e){e=e||$(window),u=e,a(),n(),g(),t()},m.action=t,m.clear=g,m},AJAX=function(e){function c(e,t,n){return t=t||{},n&&n.code?n.code:v.errorHandler&&t.errorHandler&&(t=v.errorHandler(e,t))?t:e}var d=this,p=e.user||!1,f=e.server||!1,v=e,h={};return _Node||$.ajaxSetup({cache:!1}),d.set={user:function(e){p=e}},d.clearCashe=function(){h={}},d.run=function(i){var n,e=(i=i||{}).url||f,a=i.dataType||"json",t=i.type||"POST",o=i.dataCashe||!1,r=i.data||{},s=i.action+"."+toDeepKey(r);if(!1===p||!p.extendAjaxData||i.anon&&!0===i.anon||i.imgur||i.up1||p.extendAjaxData(r,e),!1!==p&&p.signature&&i.signature&&(r.signature=p.signature()),o){var l=deep(h,s);if(l)return void(i.success&&i.success(_.clone(l)))}"undefined"!=typeof performance&&(n=performance.now());var u={json:function(e){var t,n=e,e="";n.root&&(n=n.root),i.imgur||i.up1?n.success&&(t="success"):(t=(n.Result||n.status||"").toLowerCase())||!n.result||n.error||(t="success"),t?"success"!=t&&"ok"!=t?(void 0!==i.errors&&1!=i.errors||(e=c(t,i)),"wrong token"==t&&v.unathorizated&&v.unathorizated(),i.fail&&i.fail(n,e||"network")):v.successHandler&&i.errorHandler&&v.successHandler(i)||(o&&deepInsert(h,s,_.clone(n)),i.success&&(!1!==p&&!i.noExtend&&p.extendFromAjaxData&&p.extendFromAjaxData(n),i.success(n))):(e=c("noresult",i),i.fail&&i.fail(null,e||"network"))},html:function(e){i.success&&i.success(e)}};i.before&&i.before(),i.preloader&&preloader(!0),_Node?(l={method:t,uri:e,rejectUnauthorized:!1},r&&(l.body=collectParameters(r).substr(1)),request(l,function(e,t,n){if(e)c(e),_SEO?d.run(i):i.fail&&i.fail(null);else if("json"==a){try{n=JSON.parse(n)}catch(e){c("Unexpected end of input TE"),i.fail&&i.fail(null)}u.json(n)}else u.html(n)})):(t={type:t,url:e,data:r,dataType:a,headers:i.headers,beforeSend:i.beforeSend,success:function(e){var t;i.preloader&&preloader(!1),t=function(){u[a](e)},"undefined"!=typeof performance?(n=performance.now()-n,i.timeout&&i.timeout>n?setTimeout(function(){t()},i.timeout-n):t()):t()},error:function(e,t,n){var a=null,n="";i.preloader&&preloader(!1),e.responseText?(a=JSON.parse(e.responseText),void 0!==i.errors&&1!=i.errors||(n=c(a.status,i,a.data))):n=c(null,i),i.fail&&i.fail(a,n||"network")}},i.imgur&&(t.url=v.imageServer+r.Action,delete r.Action,p&&(e=p.imgur.token?"Bearer "+p.imgur.token:"Client-ID "+p.imgur.clientId,t.headers={Authorization:e,Accept:"application/json"})),i.up1&&(t.url="https://pocketnet.app:8092/up",delete r.Action,p&&(r.api_key="c61540b5ceecd05092799f936e277552")),$.ajax(t))},d.api=function(e){e.main?d.apim(e):(void 0===e.errorHandler&&(e.errorHandler=!0),v.platform.apiproxy?(e.url="https://"+v.platform.apiproxy.host+":"+v.platform.apiproxy.port+"/"+(e.action||""),e.api=!0,d.run(e)):e.fail&&e.fail(null,c("proxy",e)||"network"))},d.apim=function(e){void 0===e.errorHandler&&(e.errorHandler=!0),e.url=v.apimproxy+"/"+(e.action||""),e.apim=!0,d.run(e)},d.fb=function(e){e.url=v.firebase+"/"+(e.action||"").split(".").join("/"),e.fb=!0,d.run(e)},d.rtchttp=function(e){e.url=v.rtchttp+"/"+(e.action||"").split(".").join("/"),e.rtchttp=!0,d.run(e)},d.rpc=function(t){var n;if(t.rpc=!0,void 0===t.nodeFix&&"undefined"!=v.platform.nodeid&&(n=t.fail||function(){},t.nodeFix=v.platform.nodeid,t.fail=function(e){!e||500!=e.statusCode&&521!=e.statusCode||e.data&&!_.isEmpty(e.data)?n(e):(v.platform.autochange(),v.platform.nodeid==t.nodeFix?n(e):d.rpc(t))}),v.platform.dontuseapiproxy){var e=parseInt(1e5*Math.random());return t.url=v.platform.sdk.system.nodeexdirect(),t.nodedirect=!0,void(t.url?(t.data=JSON.stringify({method:t.method,params:t.parameters,id:e}),a=t.success,t.success=function(e){a(deep(e,"result")||e)},d.run(t)):t.fail&&t.fail(null,"nodedirect"))}t.action="rpc-"+t.method,t.data={method:t.method,parameters:hexEncode(JSON.stringify(t.parameters||""))},v.platform.nodeid&&v.platform.sdk.system.nodeex(t.data);var a=t.success;t.success=function(e){a(deep(e,"data.result")||e)},d.api(t)},d},jsonrpc={CallStack:function(e,t,n,a){this._counter=0,this._enterFn=e,this._exitFn=n,this._enterScope=t,this._exitScope=a}},jsonrpc.CallStack.prototype={enter:function(){this._counter=this._counter<0?1:this._counter+1,1===this._counter&&this._enterFn.apply(this._enterScope,arguments)},exit:function(e){--this._counter,0===this._counter&&this._exitFn.apply(this._exitScope,arguments)}},jsonrpc.DelayedTask=function(e,t,n){this._fn=e||function(){},this._scope=t||void 0,this._args=n||[],this._id=null},jsonrpc.DelayedTask.prototype={delay:function(e,t,n,a){var i=this;this._fn=t||this._fn,this._scope=n||this._scope,this._args=a||this._args,this.cancel(),this._id=window.setInterval(function(){window.clearInterval(i._id),i._id=null,i._fn.apply(i._scope,i._args)},e)},cancel:function(){this._id&&(window.clearInterval(this._id),this._id=null)}},jsonrpc.JsonRpc=function(e){this._url=e,this.loading=new jsonrpc.Observable,this.loaded=new jsonrpc.Observable,this.unhandledFailure=new jsonrpc.Observable,this._loadingState=new jsonrpc.CallStack(this.loading.trigger,this.loading,this.loaded.trigger,this.loaded),this._requests=[],this._batchingMilliseconds=10,this._delayedTask=new jsonrpc.DelayedTask},jsonrpc.JsonRpc.prototype={setBatchingMilliseconds:function(e){this._batchingMilliseconds=e},call:function(){var e=this._getParams.apply(this,arguments);this._loadingState.enter(),this._requests.push(e),this._batchingMilliseconds?this._delayedTask.delay(this._batchingMilliseconds,this._sendRequests,this):this._sendRequests()},_sendRequests:function(){var a,i=this,o=this._requests,e=[];for(this._requests=[],a=0;a<o.length;a+=1)o[a].request.id=a,e.push(o[a].request);1===e.length&&(e=e[0]),i._doJsonPost(i._url,e,function(e,t){var n;if(e)n=i._isArray(t)?t:[t];else for(n=[],a=0;a<o.length;a+=1)n[a]={id:a,error:{message:t}};i._handleResponses(o,n)})},_handleResponses:function(e,t){for(var n,a,i=0;i<t.length;i+=1)a=e[(n=t[i]).id],this._handleResponse(a,n)},_handleResponse:function(e,t){var n=!t.error,t=n?t.result:t.error.message;this._loadingState.exit(),(n?e.success:e.failure).call(e.scope,t),e.callback.call(e.scope,n,t)},_getParams:function(){var e=this,t=Array.prototype.slice.call(arguments),n={request:{jsonrpc:"2.0",method:t.shift()}};for(n.request.params=[];1<t.length&&!this._isFunction(t[0]);){var a=t.shift();a&&n.request.params.push(a)}return this._isFunction(t[0])?(n.success=t[0],n.scope=t[1]):(n.success=t[0].success,n.failure=t[0].failure,n.callback=t[0].callback,n.scope=t[0].scope),n.success=n.success||function(){},n.failure=n.failure||function(){e.unhandledFailure.trigger.apply(e.unhandledFailure,arguments)},n.callback=n.callback||function(){},n},_isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},_isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},_doJsonPost:function(e,t,n){var a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){var e;4===a.readyState&&(e=a.getResponseHeader("Content-Type"),200!==a.status?n(!1,'Expected HTTP response "200 OK", found "'+a.status+" "+a.statusText+'"'):0!==e.indexOf("application/json")?n(!1,'Expected JSON encoded response, found "'+e+'"'):n(!0,JSON.parse(this.responseText)))},a.send(JSON.stringify(t))}},jsonrpc.Observable=function(){this._listeners=[]},jsonrpc.Observable.prototype={bind:function(e,t){return this._listeners.push(t={fn:e,scope:t||this}),t},unbind:function(e){-1!==(e=this._listeners.indexOf(e))&&this._listeners.splice(e,1)},trigger:function(){for(var e=0;e<this._listeners.length;e+=1)this._listeners[e].fn.apply(this._listeners[e].scope,arguments)}},before=function(e,t){e.before(t)},after=function(e,t){e.after(t)},html=function(e,t){e.html(t)},append=function(e,t){e.append(t)},replaceWith=function(e,t){e.replaceWith(t)},prepend=function(e,t){e.prepend(t)},offsetElement=function(e){for(var t=0,n=0;e;)t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft),e=e.offsetParent;return{top:Math.round(t),left:Math.round(n)}},getXPathForElement=function(e,t){for(var n,a,i="";e!==t.documentElement;){for(n=0,a=e;a;)1===a.nodeType&&a.nodeName===e.nodeName&&(n+=1),a=a.previousSibling;i="#"!=e.nodeName[0]?e.nodeName+"[position() = "+n+"]/"+i:e.nodeName.substr(1)+"()/"+i,e=e.parentNode}return(i="./"+t.documentElement.nodeName+"/"+i).replace(/\/$/,"")},decodeSeoLinks=function(e){return(e=e.replace(/;equal;/g,"=")).replace(/;ques;/g,"?")},encodeSeoLinks=function(e){return(e=e.replace(/=/g,";equal;")).replace(/\?/g,";ques;")};var splashScreen,splashScreenImg,stopRotation,logos,nextLogoIndex,zoomInDuration,rotatingDuration,zoomOutDuration,splashScreeninterval,copycleartext=function(e){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return!1}finally{document.body.removeChild(t)}}},copyText=function(e){e=trim(e.attr("text")||e.text()||e.val()),copycleartext(e)};function ecaretPosition(e,t,n){var a=e[0],i=document.createRange(),e=window.getSelection();i.setStart(a.childNodes[t],n),i.collapse(!0),e.removeAllRanges(),e.addRange(i)}function swipedetect(e,t,n){var a,i,o,r,s,l,u,c=t||function(e){};(e=e).addEventListener("touchstart",function(e){e=e.changedTouches[0],a="none",dist=0,i=e.pageX,o=e.pageY,u=(new Date).getTime()},!1),e.addEventListener("touchmove",function(e){},!1),e.addEventListener("touchend",function(e){e=e.changedTouches[0],r=e.pageX-i,s=e.pageY-o,(l=(new Date).getTime()-u)<=300&&(150<=Math.abs(r)&&Math.abs(s)<=100?a=r<0?"left":"right":150<=Math.abs(s)&&Math.abs(r)<=100&&(a=s<0?"up":"down")),c(a,r,s,l)},!1)}fastars=function(e){$.each(e,function(){var t=$(this);t.find("i").on("mouseenter",function(){var e;t.attr("value")||(e=$(this).attr("value"),t.attr("tempValue",e))}),t.find("i").on("mouseleave",function(){t.removeAttr("tempValue")})})},sQuestion=function(e){var i=this;return i.question=e.question,i.answers=e.answers,e.ajax,i.value=null,i.user=null,i.id=e.id||makeid(),i.results=[],i.save=function(){i.user?(localStorage.sQuestionUser=i.user,localStorage.sQuestionValue=i.value||""):(localStorage.sQuestionUser="",localStorage.sQuestionValue="")},i.summary=function(){return _.reduce(i.results||[],function(e,t){return e+t.count},0)},i.findResult=function(t){return _.find(i.results,function(e){return e.v==t})},i.send=function(n,a){i.user?app.ajax.run({data:{Action:"ADDSURVEY",ID:i.id,UserID:i.user,OptionID:n},success:function(e){i.value=n,i.save();var t=i.findResult(i.value);t?t.count++:i.results.push({v:i.value,count:1}),a&&a()}}):a&&a(!1)},i.results=function(t){app.ajax.run({data:{Action:"GETSURVEY",ID:i.id},success:function(e){i.results=_.map(e.Survey||[],function(e){return{v:e.OptionID,count:Number(e.count)}}),t&&t()}})},i.init=function(e){i.user=localStorage.sQuestionUser||makeid(),i.value=localStorage.sQuestionValue||null,i.save(),i.results(e)},i},search=function(t,o){var e=this;(o=o||{}).events||(o.events={});var r=null,s=null,l=!1,u=!1,c="0";e.placeholder=function(e){t.find("input").attr("placeholder",e)};var n,a,d={openResults:function(){r.hasClass("fastSearchShow")||(r.addClass("fastSearchShow"),$("html").on("click",d.closeclickResults))},closeResults:function(){$("html").off("click",d.closeclickResults),r.removeClass("fastSearchShow")},closeclickResults:function(e){0===r.has(e.target).length&&r.hasClass("fastSearchShow")&&d.closeResults()},clear:function(){r.find(".sminput").val(""),r.removeClass("searchActive"),r.removeClass("searchFilled")}},p={clear:function(e){r.find(".sminput").val(""),r.removeClass("searchActive"),r.removeClass("searchFilled"),d.closeResults(),o.events.clear&&o.events.clear()},search:function(e){e=e.val(),c=0,l=!1,d.closeResults(),o.events.search&&e&&(l=!0,r.addClass("searchActive"),o.events.search(e,function(e){c=0,l=!1,d.closeResults(),r.removeClass("searchActive"),u||r.removeClass("searchActive")},p,d))},showlast:function(e){var t=o.last.get();t.length&&o.last.tpl(t,function(e,t){s.html(e),d.openResults(),t&&t(s,d)})},fastsearch:function(n,e,t){var a,i=n.val();i&&o.events.fastsearch&&!l&&(r.addClass("searchActive"),u=!0,a=c=t||makeid(),o.events.fastsearch(i,function(e,t){a==c&&n.val()&&!l&&(u=!1,r.removeClass("searchActive"),e&&(s.html(e),d.openResults(),t&&t(s,d)))},e)),i?r.addClass("searchFilled"):(d.closeResults(),r.removeClass("searchFilled"),u&&r.removeClass("searchActive"),o.last&&p.showlast(n),o.events.clear&&o.events.clear(!0))}};return e.clear=p.clear,e.blur=function(){t.find("input").blur()},t.html(function(){o.class||(o.class="");var e=['<div class="searchIconLabel">'+(o.icon||'<i class="fa fa-search" aria-hidden="true"></i><i class="fas fa-circle-notch fa-spin"></i>')+"</div>",'<div class="searchInputWrapper"><input class="sminput" tabindex="2" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" id="text" maxlength="400" type="text" placeholder="'+(o.placeholder||"Search")+'"></div>','<div class="searchPanel"><div class="searchPanelWrapper"><div class="searchPanelItem" event="clear"><i class="fa fa-times-circle" aria-hidden="true"></i></div></div></div>'];return o.right&&(e.reverse(),o.class+=" right"),o.collectresults&&(e[1]='<div class="searchInputWrapper"><div class="sminput" contenteditable="true" tabindex="2" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" id="text" maxlength="400" type="text" placeholder="'+(o.placeholder||"Search")+'"></div></div>'),'<div class="search '+(o.class||"")+'"><div class="searchInput"><div class="searchInputIcon">'+e.join(" ")+'</div></div><div class="searchFastResultWrapper">'}()),r=t.find(".search"),s=t.find(".searchFastResultWrapper"),(a=r.find(".sminput")).on("keyup",function(e){var t;13!=(e.keyCode||e.which)&&(void 0===o.time&&(o.time=100),o.time?(t=makeid(),n=slowMade(function(){p.fastsearch(a,e,t)},n,o.time)):p.fastsearch(a,e))}),a.on("focus",function(){e.active=!0,$(this).val()?p.fastsearch(a):o.last&&p.showlast(a)}),a.on("blur",function(){e.active=!1}),a.on("keypress",function(e){13==(e.keyCode||e.which)&&p.search(a)}),r.find(".searchIconLabel").on("click",function(){!a.val()&&o.events.blank?o.events.blank():p.search(a)}),r.find(".searchPanelItem").on("click",function(){var e=$(this),t=e.attr("event");p[t]&&p[t](e)}),o.clbk&&o.clbk(r),e},thinput=function(e){$.each(e,function(){var e=$(this),t={"-1":"1",1:"0",0:"-1"};e.on("click",function(){var e=$(this).attr("value");$(this).attr("value",t[e])})})},editable=function(a){var i;(a=a||{}).el&&$.each(a.el,function(){var t=$(this);t.wrap("<div class='editable "+a.class+"'></div>"),t.addClass("editEl");var n=t.closest(".editable");n.append("<div class='editForm'><input type='text' value='"+a.el.text()+"'></div>\t\t\t\t\t\t <label><div class='lwr'><div class='editButton edt'><i class='fa fa-pencil'></i></div>\t\t\t\t\t\t <div class='editButton success'><i class='fa fa-check'></i></div>\t\t\t\t\t\t <div class='editButton fail'><i class='fa fa-times'></i></div></div></label>");var e=a.mmoneyparam||null;e&&n.find("input").maskMoney(e),n.find(".edt").on("click",function(){i=t.text(),a.synk?(a.el.closest(".editable").find("input").val(i),a.el.closest(".editable").addClass("editNow")):(n.find("input").val(i),n.addClass("editNow"))}),n.find(".success").on("click",function(){var e=n.find("input").val();a.synk?(a.el.text(e),a.el.closest(".editable").removeClass("editNow")):(t.text(e),n.removeClass("editNow")),a.success&&a.success(e)}),n.find(".fail").on("click",function(){t.text(i),a.fail&&a.fail(i,a),n.removeClass("editNow")}),n.find("input")[0].addEventListener("keyup",function(){a.input&&(e?a.input(n.find("input").maskMoney("unmasked",e)[0].value):a.input(n.find("input").val()))}),n.find("input").on("input",function(){a.synk&&a.el.closest(".editable").find("input").val(n.find("input").val())})})},initUpload=function(d){var a,e=(d=d||{}).el,t=d.multiple||!1,p=1024*(d.maxFileSize||10)*1024;function n(e){var t=$(this);function n(){a.removeClass("loading"),a.removeClass("hover"),a.removeClass("focus"),t.val(""),t[0].value=""}e.stopPropagation(),e.preventDefault(),a.removeClass("hover"),a.addClass("loading");var c=(void 0===e.dataTransfer?this:e.dataTransfer).files;_.each(c,function(e){e.id=makeid()}),d.onStartUpload&&(c=d.onStartUpload(c)),lazyEach({sync:!0,array:c,all:{success:function(){n(),d.onSuccess&&d.onSuccess()},fail:function(){n(),d.onFail&&d.onFail()}},action:function(s){var e,t,l=s.item,u=makeid();t=function(i){var n,a,o,e=new FileReader,t=(p/1024/1024).toFixed(0),r={filesize:"Your photo has size greater than "+t+"MB. Please upload a photo under "+t+"MB in size.",fileext:"Invalid format of picture. Only png and jpeg are allowed"};if(i)return d.onError&&d.onError(i,l,r[i]),s.fail(),0;n=c,a=function(a){var e=a.base64,t=function(e){var t,n;a.base64=e,e=l,t=a.base64,n=function(e){var n;a.base64=e,i?(d.onError&&d.onError(i,a,l,r[i]),s.fail()):((n=new FormData).append("file",l),_.each(d.data,function(e,t){"function"==typeof e&&(e=e()),"data"==t&&d.user&&d.user.extendAjaxData(e),(_.isArray(e)||_.isObject(e))&&(e=JSON.stringify(e)),n.append(t,e)}),d.beforeUpload&&d.beforeUpload(a,u),d.server?((e=new XMLHttpRequest).onreadystatechange=function(e){var t=function(e){(e=deep(e,"root"))&&"Success"==e.Result?(s.success(e),d.onUpload&&d.onUpload(e,u)):(d.onError&&d.onError("serverError",a,l),s.fail())};4==e.target.readyState&&(200==e.target.status?t(JSON.parse(e.target.response)):t())},e.open("POST",d.server),e.send(n)):d.action?d.action(a,s.success):s.success())},"image/jpeg"!=e.type&&"image/png"!=e.type&&"image/jfif"!=e.type||d.notexif||"undefined"==typeof EXIF?n&&n(t):EXIF.getData(e,function(){var a,i,o,r,s,e=EXIF.getAllTags(this);exifOrientation=e.Orientation,exifOrientation?(e=t,a=exifOrientation,i=function(e){n&&n(e)},o=new Image,r=document.createElement("canvas"),s=r.getContext("2d"),o.src=e,o.onload=function(){var e=o.width,t=o.height;switch(-1<$.inArray(a,[5,6,7,8])?(r.width=t,r.height=e):(r.width=e,r.height=t),a){case 1:s.drawImage(this,0,0,e,t);break;case 2:s.translate(e,0),s.scale(-1,1),s.drawImage(this,0,0,e,t);break;case 3:s.translate(e,t),s.rotate(Math.PI),s.drawImage(this,0,0,e,t);break;case 4:s.translate(0,t),s.scale(1,-1),s.drawImage(this,0,0,e,t);break;case 5:s.rotate(Math.PI/2),s.scale(1,-1),s.drawImage(this,0,0,e,t);break;case 6:s.rotate(Math.PI/2),s.translate(0,-t),s.drawImage(this,0,0,e,t);break;case 7:s.rotate(Math.PI/2),s.translate(e,-t),s.scale(-1,1),s.drawImage(this,0,0,e,t);break;case 8:s.rotate(-Math.PI/2),s.translate(-e,0),s.drawImage(this,0,0,e,t);break;default:return void s.drawImage(this,0,0,e,t)}var n=r.toDataURL("image/jpeg",.95);$(r).remove(),i(n)}):n&&n(t)})};"image/jpeg"==l.type||"image/png"==l.type||"image/jfif"==l.type?resize(e,2048,2048,t):t(e)},e.onload=(o=l,function(e){var t=(t=o.name.split("."))[t.length-1];a({base64:e.target.result,file:o,ext:t,filesCount:n.length})}),e.readAsDataURL(l)},(e=l).size>p?t("filesize"):function(e){if(e=(e=e.name.split("."))[e.length-1].toLowerCase(),d.ext)if(_.isArray(d.ext)){if(-1==_.indexOf(d.ext,e))return}else if(d.ext!=e)return;return 1}(e)?t(!1):t("fileext")}})}d.mode,d.data||(d.data={}),t=t?"multiple":"",e.html(),e.addClass("upload dropZone"),e.wrapInner('<div class="fileUploader"><div class="elContent"></div></div>'),e.find(".fileUploader").append('<div class="spinner"></div><div class="inputWrapper"><input type="file" '+t+"></div>"),a=d.dropZone||e,t=e.find("input"),void 0===window.FileReader&&(a.text("Не поддерживается браузером!"),a.addClass("error")),e.find("input").focus(function(){e.addClass("focus")}).blur(function(){e.removeClass("focus")}),a[0]&&(a[0].ondragover=function(){return a.addClass("hover"),!1},a.on("dragout",function(e){return a.removeClass("hover"),!1}),a[0].ondrop=n,t.on("change",n),t.on("click",function(){d.onStart&&d.onStart()}))},checkboxValue=function(e,t){t?e.prop("checked",!0):e.prop("checked",!1)},globalpreloader=function(e,t){var n;"undefined"!=typeof window&&(n=$("#globalpreloader"),t?n.addClass("dark"):n.removeClass("dark"),e?n.addClass("show"):n.removeClass("show"))},onlyNumbers=function(e){46==e.keyCode||8==e.keyCode||9==e.keyCode||27==e.keyCode||65==e.keyCode&&!0===e.ctrlKey||110==e.keyCode||190==e.keyCode||189==e.keyCode||109==e.keyCode||188==e.keyCode||35<=e.keyCode&&e.keyCode<=39||(e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()},settingsLocalstorage=function(e){function i(e){if("undefined"!=typeof localStorage&&o[e])try{localStorage[a+e]=JSON.stringify(o[e])}catch(e){return null}return this}function n(e){return"undefined"!=typeof localStorage&&localStorage[a+e]?o[e]=JSON.parse(localStorage[a+e]):o[e]={},this}var t=this,a=e.options.localStoragePrefix,o={};return t.get=function(e,t){if(n(e=0==e?"general":e),void 0===t){if(o[e])return o[e]}else if(null!=typeof o[e][t])return o[e][t]},t.setAll=function(n,a){return 0==n&&(n="general"),_.each(o[n],function(e,t){o[n][t]=a}),i(n)},t.set=function(e,t,n){return 0==e&&(e="general"),void 0!==t?(o[e]||(o[e]={}),o[e][t]=n):o[e]=n,i(e)},t.delete=function(e,t){return 0==e&&(e="general"),void 0!==t&&(o[e]||(o[e]={}),delete o[e][t],i(e)),this},t.clear=function(){_.each(getVars(localStorage),function(e,t){-1<t.indexOf(a)&&localStorage.removeItem(t)})},_.each(e.map,function(e){n(e.uri)}),t.prefix=a,t},mouse={getX:function(e){return e.pageX||(e.clientX?e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft:0)},getY:function(e){return e.pageY||(e.clientY?e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop:0)}},fixWhich=function(e){!e.which&&e.button&&(1&e.button?e.which=1:4&e.button?e.which=2:2&e.button&&(e.which=3))},fakeClick=function(e,t){(t=document.getElementById(t)).click?t.click():document.createEvent&&e.target!==t&&((e=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(e))},addToFunction=function(n,a){return function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);n&&n.apply(this,arguments),a&&a(this,arguments)}},"undefined"!=typeof window&&retry(function(){return window.jQuery},function(){var a=window.jQuery,i=a.event.special.dragout={current_elem:!1,setup:function(e,t,n){a("body").on("dragover.dragout",i.update_elem)},teardown:function(e){a("body").off("dragover.dragout")},update_elem:function(e){e.target!=i.current_elem&&(i.current_elem&&a(i.current_elem).parents().andSelf().each(function(){0==a(this).find(e.target).size()&&a(this).triggerHandler("dragout")}),i.current_elem=e.target,e.stopPropagation())}};a.browser||(a.browser={},a.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),a.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),a.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),a.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()))}),compressedNumber=function(e,t,n){e=Number(e).toFixed(0),n=n||999,t=t||0;for(var a=["k","m","b"],i=a.length,o=!1,r=0;r<i&&Math.abs(e)>n;r++)e/=1e3,e=Number(e.toFixed(t))==Number(e.toFixed(0))?e.toFixed(0):e.toFixed(t),o=r;return ret=e,!1!==o&&(ret+=a[o].toUpperCase()),ret},phoneecho=function(e){return 10!=e.length?e:"("+e.substr(0,3)+") "+e.substr(3,3)+"-"+e.substr(6,2)+e.substr(8,2)},numclass=function(e){return e&&Number(e)?0<Number(e)?"good":"bad":"neutral"},numclasscolor=function(e,t){return e&&Number(e)?0<Number(e)?t.good:t.bad:t.neutral},pluralform=function(e,t){return e<=1?t[0]:t[1]},videoImage=function(e){return"youtube"==(e=_.isObject(e)?e:parseVideo(e)).type?"https://img.youtube.com/vi/"+e.id+"/mqdefault.jpg":"vimeo"==e.type?"https://i.vimeocdn.com/video/"+e.id+"_320.jpg":"peertube"==e.type?null:void 0},hashFnv32a=function(e,t,n){for(var a=void 0===n?2166136261:n,i=0,o=e.length;i<o;i++)a^=e.charCodeAt(i),a+=(a<<1)+(a<<4)+(a<<7)+(a<<8)+(a<<24);return t?("0000000"+(a>>>0).toString(16)).substr(-8):a>>>0},hash_32b_to_16b=function(e){return 65535&e^(4294901760&e)>>>16},parseVideo=function(e){var t=e,n=t.match(/(peertube:\/\/)?(http:\/\/|https:\/\/|)?(player.|www.)?(pocketnetpeertube[0-9]*\.nohost\.me|peer\.tube|vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com)|bitchute\.com)\/((videos?\/|embed\/|watch\/?)*(\?v=|v\/)?)*([A-Za-z0-9._%-]*)(\&\S+)?/),a=null,i=null,o=null;return(n&&n[2]||t&&-1<t.indexOf("peertube://"))&&((-1<n.indexOf("youtube.com")||-1<n.indexOf("youtu.be"))&&(a="youtube",e="https://youtu.be/"+(i=n[9])),-1<n.indexOf("vimeo.com")&&(a="vimeo",i=n[9]),-1<n.indexOf("bitchute.com")&&(a="bitchute",i=n[9]),-1<n.indexOf("peertube://")&&(t.split("?")[1],a="peertube",i=`${n[9]}`,o=n[4])),{type:a,url:e,id:i,host_name:o}},nl2br=function(e){return e.replace(/\n/g,"<br/>")},trimHtml=function(e,t){for(var n,a=[],i=e.length,o=e,r=0,s=0,l=!1,u=!1,c=!1,d="",p=0;p<i&&r<t;p++){var f=e[p];"<"==f?(l=e[p+1]&&"/"==e[p+1]?c=!0:u=!0,d=""):">"==f?(c&&(n=d,-1<(n=_.indexOf(a,n))&&a.splice(n,1)),u&l&&a.push(d),l=u=c=!1,d=""):c||u?" "!=f&"/"!=f&l?d+=f:u&l&&(a.push(d),l=!1):l||r++,s++}return e.length>s&&(o=e.substr(0,s)+"&hellip;",_.each(a,function(e){"br"!=e&&"img"!=e&&(o=o+"</"+e+">")})),o},extMessageForL2=function(e){return e.length%2!=0&&(e+="0"),e},vis=function(e,t,n,a){n=n||0;var i={thousands:",",decimal:".",allowZero:!0,precision:0,prefix:"$ ",input:!1,allowNegative:!0};if(a=a||"&mdash;",t){if(void 0===e)return a;if("percent"==t)return(100*e).toFixed(n)+" %";if("dollars"==t)return i.value=Number(e).toFixed(n).toString(),maskValue(i);if("dollarshtml"==t)return i.prefix="$&nbsp;",i.value=Number(e).toFixed(n).toString(),maskValue(i);if("dollarslight"==t)return i.prefix="",i.value=Number(e).toFixed(n).toString(),maskValue(i);if("range0-100"==t)return{0:"0",1:"<25%",26:"<50%",51:"<75%",76:">75%"}[e];if("yesno"==t){if("yes"==e||1==e)return"Yes";if("no"==e||0==e)return"No";if(!e)return""}if("yesno12"==t){if("yes"==e||1==e)return"Yes";if("no"==e||2==e)return"No";if(!e)return""}if("number"==t)return _.isNumber(Number(e))&&"NaN"!=e.toString()&&"undefined"!=e.toString()&&"null"!=e.toString()?(e=Number(e).toFixed(n),i.prefix="",i.precision=n,i.value=e,maskValue(i)):a;if("date"==t)return convertDate(e)}return e},hexEncode=function(e){for(var t=0,n="",a=0;a<e.length;a++){for(255<(t=e.charCodeAt(a))&&(t-=848),t=t.toString(16);t.length<2;)t="0"+t;n+=t}return n},hexDecode=function(e){var t=0,n="";e=trim(e);for(var a=2;a<=e.length;a+=2)128<=(t=parseInt(e.substring(a-2,a),16))&&(t+=848),n+=t=String.fromCharCode("0x"+t.toString(16));return n},checkUrlForImage=function(t){if(t=t.split("?")[0].toLowerCase(),_.find([".jpg",".gif",".png",".jpeg"],function(e){if(-1<t.indexOf(e))return!0}))return!0},donottrustLink=function(e){return e.replace(/<a /g,'<a donottrust="donottrust" ')},clearScripts=function(e){return e.replace(/<script[^>]*?>[^<]*<\/script[^>]*?>/gim,"")},boolToNumber=function(e){return e?1:0},numberToBool=function(e){return!!e},findAndReplaceLink=function(e){if("undefined"!=typeof linkifyHtml)try{return linkifyHtml(e,{attributes:{cordovalink:"_system"}})}catch(e){}return(e||"").replace(/(^|[^A-Za-z0-9А-Яа-яёЁ\-\_])(https?:\/\/)?((?:[A-Za-z\$0-9А-Яа-яёЁ](?:[A-Za-z\$0-9\-\_А-Яа-яёЁ]*[A-Za-z\$0-9А-Яа-яёЁ])?\.){1,5}[A-Za-z\$рфуконлайнстРФУКОНЛАЙНСТ\-\d]{2,22}(?::\d{2,5})?)((?:\/(?:(?:\&amp;|\&#33;|,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#%\@&\?+\/\$.~=;:]+|\[[A-Za-z0-9А-Яа-яёЁ\-\_#\@%&\?+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#\@%&\?+\/\$.,~=;:]*\))*(?:,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#\@%&\?+\/\$.~=;:]*[A-Za-z0-9А-Яа-яёЁ\_#\@%&\?+\/\$~=]|\[[A-Za-z0-9А-Яа-яёЁ\-\_#\@%&\?+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#\@%&\?+\/\$.,~=;:]*\)))?)?)/gi,function(){var e,t=Array.prototype.slice.apply(arguments),n=t[1]||"",a=t[2]||"http://",i=t[3]||"",o=i+(t[4]||""),r=(t[2]||"")+t[3]+t[4];if(-1==i.indexOf(".")||-1!=i.indexOf(".."))return t[0];if((6<(i=i.split(".").pop()).length||-1==function(e,t){for(var n=0,a=(e||[]).length;n<a;n++)if(e[n]==t)return n;return-1}("info,name,aero,arpa,coop,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,ss,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,рф,укр,сайт,онлайн,срб,cat,pro,local".split(","),i))&&(!/^[a-zA-Z]+$/.test(i)||!t[2]))return t[0];t[0].indexOf("@");try{r=decodeURIComponent(r)}catch(e){}return r=((t=r=55<r.length?r.substr(0,53)+"..":r)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):"").replace(/&amp;/g,"&"),i={innerHTML:"<textarea>"+((e=o)||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+"</textarea>"},function e(){var t,n=arguments,a=n[0]||{},i=1,o=n.length,r=!1;for("boolean"==typeof a&&(r=a,a=n[1]||{},i=2),"object"==typeof a||isFunction(a)||(a={});i<o;++i)if(null!=(t=n[i]))for(var s in t){var l=a[s],u=t[s];a!==u&&(r&&u&&"object"==typeof u&&!u.nodeType?a[s]=e(r,l||(null!=u.length?[]:{}),u):void 0!==u&&(a[s]=u))}return a}(e=document.createElement("div"),i),0<=(t=(o=e.firstChild.value.replace(/([^a-zA-Z0-9#\@%;_\-.\/?&=\[\]])/g,encodeURIComponent)).indexOf("#/"))?o.substr(t+1):0<=(t=o.indexOf("#!"))&&o.substr(t+2).replace(/^\//,""),n+'<a cordovalink="_system" href="'+(a+o).replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" target="_blank">'+r+"</a>"})},hideString=function(e){for(var t="",n=0;n<e.length;n++)n<.666*e.length?t+="*":t+=e[n];return t},checkAddress=function(e){var t,d=function(e){for(var t="",n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},p=function(e,t){if(0==t)return int2bigInt(1,1,0);for(var n=e,a=1;a<t;a++)n=mult(n,e);return n},f=function(e,t){for(var n=[];n.length<t;)n.push(e);return n.join("")};return 25==(t=function(e){for(var t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",n=new Array,a=0;a<58;a++)n[t[a]]=int2bigInt(a,8,0);for(var i,o=e.length,r=int2bigInt(0,1,0),s=int2bigInt(58,8,0),a=0;a<o;a++)i=e[o-a-1],r=add(r,mult(n[i],p(s,a)));for(var l=bigInt2str(r,16),u=d(l),c=0;e[c]==t[0];c++);return l=u,0<c?f("\0",c)+u:l}(e)).length&&(e=t.substr(t.length-4),t=t.substr(0,t.length-4),e==d(sha256_digest(d(sha256_digest(t)))).substr(0,4))},superXSS=function(e,t){var n=e.length;return(e=filterXSS(e,t)).length&&n!=e.length?superXSS(e,t):e},clearStringXss=function(e){return filterXSS(e,{whiteList:[],stripIgnoreTag:!0})},getBase64=function(a){return new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(a),n.onload=()=>e(n.result),n.onerror=e=>t(e)})},findResponseError=t=>{var e=["response.data.errors","response.data.error"].map(e=>deep(t,e)).filter(e=>e)[0]||{};return"object"==typeof e?(Object.values(e)[0]||{}).msg:e},serialize=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},checkConnection=function(){if("undefined"!=typeof window){if(window.cordova&&navigator.connection&&navigator.connection.type){var e=navigator.connection.type,t={};return t[Connection.UNKNOWN]="UNKNOWN",t[Connection.ETHERNET]="ETHERNET",t[Connection.WIFI]="WIFI",t[Connection.CELL_2G]="2G",t[Connection.CELL_3G]="3G",t[Connection.CELL_4G]="4G",t[Connection.CELL]="CELL",t[Connection.NONE]="NONE",t[e]}return!window.cordova&&navigator.connection&&navigator.connection.type?navigator.connection.type:""}},stringEqTrig=function(e,t){function n(e){return e.split(/[ \t\v\r\n\f,.]+/).join(" ").toLowerCase().replace(/[^a-zа-я0-9&]*/g,"")}function a(e){for(var t,n={},a=-1;a<=e.length;a++){for(var i="",o=a-1;o<=a+1;o++)i+=t=(t=o)<0||t>=e.length?"_":e[t];n[i]=1}return n}t=t||"";var e=a(n(e=e||"")),i=a(n(t)),o=0,t=Math.max(_.toArray(e).length,_.toArray(i).length);return _.each(e,function(e,t){i[t]&&o++}),o/t},"undefined"==typeof window||(splashScreen=document.getElementById("splashScreen"))&&(splashScreenImg=document.getElementById("splashScreenImg"),stopRotation=!1,logos=["img/splashscreen/pocketnet-logo-16.svg","img/splashscreen/pocketnet-logo-17.svg","img/splashscreen/pocketnet-logo-15.svg","img/splashscreen/pocketnet-logo-14.svg","img/splashscreen/pocketnet-logo-18.svg","img/splashscreen/pocketnet-logo-19.svg"],nextLogoIndex=0,rotatingDuration=1e3,zoomOutDuration=zoomInDuration=500,hideSplashScreen=function(){stopRotation=!0},rotatingAnimationEnded=function(){splashScreenImg&&(stopRotation&&(splashScreenImg.classList.remove("rotate"),splashScreenImg.classList.add("zoom-out-rotate"),splashScreen.classList.add("fade-out"),setTimeout(()=>{null!=splashScreeninterval&&clearInterval(splashScreeninterval),splashScreen.remove()},2*zoomOutDuration)),setTimeout(()=>{splashScreenImg.src=logos[nextLogoIndex],nextLogoIndex=nextLogoIndex>=logos.length-1?0:nextLogoIndex+1},.5*rotatingDuration))},setTimeout(()=>{splashScreenImg&&(splashScreenImg.classList.remove("zoom-in"),splashScreenImg.classList.add("rotate"),rotatingAnimationEnded(),splashScreeninterval=setInterval(rotatingAnimationEnded,rotatingDuration))},zoomInDuration));
 /*_____*/ 
"undefined"==typeof _OpenApi&&(_OpenApi=!1),User=function(o,e){var i=this,t=(o.ajax,o.options.name,o.settings||null),a=0;i.imgur={clientId:"61175058f8e21f4",secret:"ea4020d8024dfb78d372d1cd21c2f3215c72ead4"};var n={private:{set:function(e){this.value=e||null},value:null},public:{set:function(e){this.value=e||null},value:null}};return i.signature=function(e,t,r){e=e||"pocketnetproxy",t=t||360;var o=i.keys(),a="date="+(new Date).toISOString()+",exp="+t+",s="+hexEncode(e),e=null;if(r){for(a=utcnow().getTime();(a=a+""+rand(0,9).toString()).length<32;);e=o.sign(Buffer.from(a))}else e=o.sign(bitcoin.crypto.sha256(Buffer.from(a)));return o={nonce:a,signature:e.toString("hex"),pubkey:o.publicKey.toString("hex"),address:i.address.value,v:1},r&&delete o.v,o},i.address={set:function(e){this.value=e||null},value:null},i.data={},i.features={},i.tokenExpired=function(){},i.prepare=function(e){i.tokenExpired(),o.platform.clear(!0),o.platform.prepareUser(function(){e&&e(a)})},i.signin=function(e,t){function r(){i.stay?o.platform.cryptography.api.aeswc.encryption(e,o.options.fingerPrint,{},function(e){localStorage.mnemonic=e}):localStorage.mnemonic="",i.isState(function(e){e?(localStorage.waslogged=!0,localStorage.popupsignup="showed",i.prepare(t)):t&&t(e)})}bitcoin.bip39.validateMnemonic(e)?i.setKeys(e,function(){r()}):i.setKeysPairFromPrivate(e,function(e){e?r():(localStorage.mnemonic="",a=0,t&&t(a))})},i.features={},i.signout=function(e){o.platform.firebase&&o.platform.firebase.destroy(),a=0,i.data={},localStorage.mnemonic="",t.clear(),n.public.set(),n.private.set(),o.platform.clear(),o.platform.matrixchat.destroy(),i.address.set(),o.platform.ws&&o.platform.ws.destroy(),o.platform.rtc&&o.platform.rtc.destoryAll(),e&&e()},i.getstate=function(){return a},i.isState=function(t){if(2!==a){if(n.private.value&&n.public.value)a=1;else{if(localStorage.mnemonic&&i.stay){var e=localStorage.mnemonic;return void o.platform.cryptography.api.aeswc.decryption(e,o.options.fingerPrint,{},function(e){e?bitcoin.bip39.validateMnemonic(e)?i.setKeys(e,function(){i.isState(t)}):i.setKeysPairFromPrivate(e,function(){i.isState(t)}):(_OpenApi||(localStorage.mnemonic=""),t(a=0))})}a=0}t(a)}else retry(function(){return 2!=a},function(){i.isState(t)})},i.validateVay=function(){if(console.log("self",i),!i.address.value)return"fu";var e=deep(o,"platform.sdk.user.storage.me");return console.log("MEEE!!",e),e&&e.relay&&(e=o.platform.sdk.registrations.storage[i.address.value])&&(!0===e||e<3)?"fuf":deep(o,"platform.sdk.user.storage.me.name")?void 0:"fu"},i.validate=function(){if(!i.address.value)return!1;var e=deep(o,"platform.sdk.user.storage.me");return!(e&&e.relay&&(e=o.platform.sdk.registrations.storage[i.address.value])&&(!0===e||e<3))&&deep(o,"platform.sdk.user.storage.me.name")},i.isItMe=function(e){return i.address.value&&i.address.value.toString("hex")==e},i.keysFromMnemo=function(e){return e=e||"",e=bitcoin.bip39.mnemonicToSeedSync(e.toLowerCase()),i.keysFromSeed(e)},i.keysFromSeed=function(e){return e=bitcoin.bip32.fromSeed(e).derivePath(o.platform.sdk.address.path(0)).toWIF(),bitcoin.ECPair.fromWIF(e)},i.setKeysPair=function(e,t){n.private.set(e.privateKey),n.public.set(e.publicKey),e=o.platform.sdk.address.pnet(),i.address.set(e.address),topPreloader(20),t&&t()},i.keysPairFromPrivate=function(t,e){t=t||"";var r=null;if(bitcoin.bip39.validateMnemonic(t.toLowerCase()))r=i.keysFromMnemo(t);else try{r=bitcoin.ECPair.fromPrivateKey(Buffer.from(t,"hex"))}catch(e){try{r=bitcoin.ECPair.fromWIF(t)}catch(e){console.log("E2",e)}}return r},i.setKeysPairFromPrivate=function(t,e){var r=null;try{r=bitcoin.ECPair.fromPrivateKey(Buffer.from(t,"hex"))}catch(e){try{r=bitcoin.ECPair.fromWIF(t)}catch(e){console.log("er2",e,t)}}r?i.setKeysPair(r,function(){e&&e(!0)}):e&&e(!1)},i.setKeys=function(e,t){e=i.keysFromMnemo(e),i.setKeysPair(e,t)},i.key=n.public,i.private=n.private,i.keys=function(){return bitcoin.ECPair.fromPrivateKey(n.private.value)},i.cryptoKeys=function(){var e=[];if(n.private.value)for(var t=1;t<13;t++){var r=bitcoin.bip32.fromSeed(n.private.value).derivePath(o.platform.sdk.address.path33(t)).toWIF(),r=bitcoin.ECPair.fromWIF(r);e.push({pair:r,public:r.publicKey.toString("hex")})}return e},i.stay=Number(localStorage.stay||"1"),i},topPreloader(25),"undefined"!=typeof module&&(module.exports=User);
 /*_____*/ 
nModule=function(){var s=this,i={templates:{}};return s.storage={els:{},templates:{}},s.options={},s.api={},s.map={},s.essenses={},s.iclbks={},s.inserts={wnd:{obj:wnd,storageKey:"wnd",after:!0},tooltip:{obj:tooltip,storageKey:"tooltip",after:!0}},s.anonimus=function(n,i){s.map.anonimus?n(!0):s.user.isState(function(e){if(e){if(!s.user.validate()&&(t=deep(s,"map.redirect.validate")))return s.redirect(i,t),void n(!1);n(!0)}else{var t;(t=deep(s,"map.redirect.auth"))&&s.redirect(i,t),n(!1)}})},s.shell=function(a,t,n){function o(e){e.el&&(n||s.nav.api.links(null,e.el,e.additionalActions||null),window.requestAnimationFrame(function(){bgImages(e.el,e.bgImages)})),"function"==typeof t&&t(e)}(a=a||{}).completeClbk=o,s.loadTemplate(a,function(e){s.renderTemplate(e,function(e){var t=!1;if(!_.isObject(a.el)||a.insert){var n=s.inserts[a.insert];if(n){var i=a[n.storageKey]||{};if(i.content=e,i.el=a.el,i.app=s.app,n.after&&(i.clbk=function(e){e=e||{},o(a=_.extend(a,e))}),i.destroy=function(e){if(a&&("auto"!=!e&&s.app.nav.api.history.removeParameters(["m"+a.id].concat(a.clearparameters||[])),a.destroy))return a.destroy(e)},s.container=new n.obj(i),a.container=s.container,s.container.essenseDestroy=i.destroy,n.after)return void topPreloader(100);(i=deep(s,"container.el"))&&(a.el=i),t=!0}else(i=s.app.el[a.el])&&(a.el=i)}"function"==typeof a.el&&(a.el=a.el()),t||a.el&&s.insertTemplate(a,e),a.animation||o(a)},a)})},s.insertTemplate=function(m,c){function u(){m.completeClbk&&m.completeClbk(m)}function p(e){m.el.find(".animation").contents().unwrap(),m.el.css("position",e.position),m.el.height(""),m.el.width(""),m.el.css("overflow",e.overflow)}var f="<div class='animation'></div>";if(m.inner||(m.inner=html),m.animation){if(m.animation.timeouts||(m.animation.timeouts=100),"fadeIn"==m.animation)return console.log("P",m),m.el.fadeOut(100),void setTimeout(function(){m.inner(m.el,c),m.el.fadeIn(200),u(),setTimeout(function(){m.postAnimation&&m.postAnimation(m)},200)},100);_.isObject(m.animation)&&(m.animation.hideOnAnimationPeriod&&m.animation.hideOnAnimationPeriod.fadeOut(m.animation.timeouts),setTimeout(function(){var e,t,n,i,a,o,s,l,r=(e=m.el.css("position"),t=m.el.css("overflow"),n=m.el.css("height"),i=m.el.css("width"),a=m.el.height(),o=m.el.width(),m.el.height(a),m.el.width(o),m.el.wrapInner(f),m.el.find(".animation").height(a+"px"),m.el.find(".animation").width(o+"px"),m.el.css("overflow","hidden"),"absolute"!=e&&"fixed"!=e&&m.el.css("position","relative"),{height:a,width:o,position:e,overflow:t,cssheight:n,csswidth:i}),d=m.el.find(".animation");"slide"==m.animation.id&&(m.inner=html,m.animation.direction||(m.animation.direction="onright"),d.addClass([m.animation.direction,m.animation.id,"leave"].join(" ")),d.on("transitionend",function(){m.el.html(f),(d=m.el.find(".animation")).addClass([m.animation.direction,m.animation.id,"enter"].join(" ")),m.inner(d,c),u(),m.el.height(d.height()+"px"),m.el.width(d.width()+"px"),setTimeout(function(){d.addClass("original"),d[0].addEventListener("transitionend",function(){p(r),m.animation.hideOnAnimationPeriod&&m.animation.hideOnAnimationPeriod.fadeIn(2*m.animation.timeouts),m.postAnimation&&m.postAnimation()})},m.animation.timeouts)})),"fadeInByElement"==m.animation.id&&(m.inner=html,m.animation.selector||(m.animation.selector=".fadeInByElement"),s=[],d.find(m.animation.selector).each(function(){s.unshift($(this))}),l=1,lazyEach({array:s,sync:!0,action:function(e){e.item.fadeOut(m.animation.timeouts/l),l+=.333,setTimeout(function(){e.success()},m.animation.timeouts/l)},all:{success:function(){m.el.html(f),(d=m.el.find(".animation")).addClass([m.animation.direction,m.animation.id,"enter"].join(" ")),m.inner(d,c),d.find(m.animation.selector).fadeOut(1),u(),m.el.height(d.height()+"px"),m.el.width(d.width()+"px");var e=[];d.find(m.animation.selector).each(function(){e.push($(this))});var t=0;lazyEach({array:e,sync:!0,action:function(e){e.item.fadeIn(m.animation.timeouts/t),t+=.333,setTimeout(function(){e.success()},m.animation.timeouts/t)},all:{success:function(){d.addClass("original"),p(r),m.postAnimation&&m.postAnimation()}}})}}}))},m.animation.timeouts))}else m.inner(m.el,c),m.notdisplay||(m.display||(m.display="block"),m.el.css("display",m.display)),m.postAnimation&&m.postAnimation()},s.renderTemplate=function(t,n,i){i=i||{},s.user.isState(function(e){i.data||(i.data={}),i.data.app=s.app,i.data.e=s.app.localization.e,i.data.state=e,i.data.module=s,i.data.user=s.user,i.data.essenseData=i.essenseData||{},i.rendered=t(i.data),i.clear&&(i.rendered=""),n&&n(i.rendered)})},s.loadTemplate=function(t,n){if((t=t||{}).name||(t.name="index"),i.templates[t.name])retry(function(){return!i.templates[t.name]},function(){s.loadTemplate(t,n)});else if(s.storage.templates[t.name]||t.clear)n&&n(s.storage.templates[t.name]);else{if(s.map&&s.map.id)if(e=deep(window,"pocketnetTemplates."+(t.turi||s.map.uri)+"."+t.name))return s.storage.templates[t.name]=_.template(e),void(n&&n(s.storage.templates[t.name]));i.templates[t.name]=!0;var e=s.map.pathtpl||s.map.path||"";_Node&&(e="https://pocketnet.app/"),e=t.common?e+"common":e+(s.componentsPath||"")+(t.turi||s.map.uri),e+="/templates/"+t.name+".html?v=122",s.ajax.run({url:e,type:"GET",dataType:"html",success:function(e){s.storage.templates[t.name]=_.template(e),n&&n(s.storage.templates[t.name]),i.templates[t.name]=!1}})}},s.fastTemplate=function(e,n,i,t){s.loadTemplate({name:e,turi:t||""},function(t){s.renderTemplate(t,function(e){n&&n(e,t)},{data:i||null})})},s.add=function(e,t){topPreloader(10);var n=_.clone(e),e=s.map.add,i=!0;t.restartModule&&(i=!1),"function"==typeof e&&(e=e(n,t)),n=_.extend(n,e),n=_.extend(n,t),s.user.isState(function(e){n.getdata(function(e){topPreloader(45),n.data=e||{},t.preshell&&t.preshell(),s.shell(n,function(e){topPreloader(100),e.clbk=addToFunction(e.clbk,function(){!e.history||!e.el||e.inWnd||e.noscroll||e.goback||_scrollTop(0,null,50),n.auto&&n.auto(e)}),n.init&&n.init(e)},i)},{state:e,settings:n})})},s.init=function(t,n){n=n||{},t=t||{},s.anonimus(function(e){e?(s.inited=!0,s.add(t,n)):(n.el&&n.el.html(""),n.clbk&&n.clbk("anonimus"))},n)},s.redirect=function(e,t){var n={};n.href=t,n.history=!0,n.open=!0,n.preshell=e.preshell,n.clbk=e.clbk,s.nav.api.load(n)},s.restart=function(e){(e=e||{}).restartModule=!0,s.stop(e),s.run(e)},s.addEssense=function(e,t,n){s.essenses=e;var i=new t(n),t=i.id||n.eid||"secondary";return(n.primary||n.loadDefault)&&(i.primary=!0),e[t=i.primary?"primary":t]?delete i:e[t]=i,e[t].destroyed=!1,e[t]},s.removeEssense=function(e,t){e[t]&&(e[t].destroy(),delete e[t])},s.closeContainer=function(e){var t=deep(s,"container.close");if(t)return t(null,e),!0},s.clearCanvas=function(e){e.clear=!0,s.shell(e)},s.parametersHandler=function(){_.each(s.essenses,function(e){e.parametersHandler&&e.parametersHandler()})},s},"undefined"!=typeof module&&(module.exports=nModule);
 /*_____*/ 
var electron=null;"undefined"!=typeof _Electron&&(electron=require("electron")),"undefined"==typeof _OpenApi&&(_OpenApi=!1),Nav=function(i){var o=this,c={navPrefix:"/",path:"components/",cashe:!0,history:!0,links:!0},r="index";_OpenApi&&(r="openapi.html");var a=null;"http"!=(a="undefined"!=typeof window?window.location.protocol.replace(":",""):a)&&"https"!=a&&!_Node||(a="web");var l={href:null},s={},d={},t={};function f(e){for(var n=deep(w,a+"."+e),r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);return n?n.apply(this,r):1==r.length?r[0]:void 0}o.wnds={};function u(r){return _.find(i.map,function(e,n){return e.href==r})}var p=["blockexplorer","pocketnet-crypto-challenge"],h="index",m={getindex:function(){return h},chain:[{href:h=i.curation()?"userpage":h,scroll:0}],clearAll:function(){var e=[{href:h,scroll:0}];m.chain=e,this.save()},clear:function(){var e=[{href:h,scroll:0}];1<m.chain.length&&(e.unshift(firstEl(m.chain)),e[0].scroll=0),m.chain=e,this.save()},load:function(){this.chain=JSON.parse(localStorage.backchain||"[]"),this.chain.length||this.clearAll()},save:function(){localStorage.backchain=JSON.stringify(this.chain||[])},add:function(n,e,r){var t=n.split("?")[0],a=parameters(n,!0);n=t+collectParameters(a,["back","ref","r"]);var o=!1;if(a.back||r)r=findIndex(m.chain,function(e){if(e.href==n)return!0}),m.chain.splice(0,r),o=m.chain[0];else if(t==h)m.clearAll();else{if(deep(m,"chain.0.href")==n)return;this.mapSearch(t,firstEl(m.chain))?((t=removeEqualRIObj(m.chain,{href:n}))&&1==t.index&&1<m.chain.length?(m.chain.splice(0,1),o=t.el):m.chain[0].scroll=e||0,m.chain.unshift({href:n,scroll:0})):m.clearAll()}return this.save(),o},get:function(){return 1<m.chain.length?m.chain[1]:null},mapSearch:function(e,n){if(n=n.href.split("?")[0],(n=deep(i,"backmap."+n))&&-1<n.childrens.indexOf(e))return!0}},v={removeParametersFromHref:function(e,n){if(!e)return e;var r=parameters(e,!0)||{};return _.each(n||[],function(e){delete r[e]}),(e=e.split("?")[0])+collectParameters(r)},addParametersToHref:function(e,n){if(!e)return e;var r=parameters(e,!0),r=_.extend(r,n);return(e=e.split("?")[0])+collectParameters(r)},addParameters:function(e,n){n=n||{};var r=parameters(),t=parameters(),r=_.extend(r,e);_.isEqual(t,r)||(delete r.back,r=l.href+collectParameters(r),void 0===n.removefromback&&(n.removefromback=!0),this.add(r,n))},addRemoveParameters:function(e,n,r){r=r||{},_.isArray(e)||(e=[e]),o.get.pathname();var t=parameters(),a=parameters(),a=_.extend(a,n);_.each(e,function(e){delete a[e]}),_.isEqual(t,a)||(t=l.href+collectParameters(a),void 0===r.removefromback&&(r.removefromback=!0),this.add(t,r))},removeParameters:function(e,n){n=n||{},_.isArray(e)||(e=[e]),o.get.pathname();var r=parameters(),t=!1;_.each(e,function(e){r[e]&&(t=!0),delete r[e]}),t&&(e=l.href+collectParameters(r),void 0===n.removefromback&&(n.removefromback=!0),this.add(e,n))},add:function(e,n){if((n=n||{}).inWnd){var r=parameters(e,!0);return r["m"+n.id]=!0,v.addParameters(r),void(o.wnds[n.id]=n)}!0!==c.history||_Node||_OpenApi||(n.removefromback||(n.goback=m.add(e,n.lastScroll,n.back)),history.state&&history.state.href==e||(o.addParameters&&(e=o.addParameters(e)),history.pushState({href:e,lfox:!0},null,e)))},changes(e,n){},openCurrent:function(){history.state&&history.state.lfox&&(k.removeWindows(history.state.href),history.state.href.split("?")[0]!=l.href?o.api.load({href:history.state.href,open:!0,loadDefault:!0,back:!0}):(k.removeWindows(history.state.href),_.isEmpty(o.wnds)?l.module&&l.module.parametersHandler&&l.module.parametersHandler(function(){}):_.each(o.wnds,function(e){e.module.parametersHandler&&e.module.parametersHandler()})))}},k={dynamicmap:function(e,n){o.dynamic?o.dynamic(e,n):n&&n()},removeWindows:function(e){var r=parameters(e,!0),t=[];_.each(o.wnds,function(e,n){r["m"+n]||(e=deep(e,"module.closeContainer"))&&(t.push(n),e("auto"))}),_.each(t,function(e){delete o.wnds[e]})},open:function(t){(t=t||{}).clbk||(t.clbk=emptyFunction),l.href;var a,e,n=!0;if((t.history||t.loadDefault)&&c.history){if(t.href==l.href&&l.module&&l.module.parametersHandler&&t.handler)return n=!1,v.add(t.completeHref,t),l.completeHref=t.completeHref,t.goback||_scrollTop(0,null,50),l.module.parametersHandler(function(){t.clbk(null,t),k.removeWindows(t.completeHref)}),void _.each(o.clbks.history,function(e){e(t.href)});if(t.completeHref!=l.completeHref||t.loadDefault){if(t.lastScroll=$(window).scrollTop(),t.reload||v.add(t.completeHref,t),l.module&&!t.inWnd)try{var r=l.module.stop(t.href);if(r&&_.isObject(r))return void(r.action&&r.action(function(){k.open(t)}));r&&"function"==typeof r&&(t.preshell=r)}catch(e){console.log("CANT DESTROY "+t.href),console.error(e)}t.href&&!t.inWnd&&(l.href=t.href,l.completeHref=t.completeHref,l.module=t.module,a=t.clbk,t.clbk=function(e,n,r){k.removeWindows(t.completeHref),t.goback&&_scrollTop(t.goback.scroll),a(e,n,r)}),t.module.active=!0,_.each(o.clbks.history,function(e){e(t.href)})}else n=!1}(n=!!t.restart||n)?((e=t).clbk=addToFunction(e.clbk,function(){k.links(null,e.el)}),e.module.nav=o,e.module.app=i,e.module.sdk=i.platform.sdk,e.module.user=i.user,e.module.ajax=i.ajax,e.module.componentsPath=c.path,e.module.data=e.data||{},e.module.essenseData=e.essenseData||{},e.module.run(e)):t.clbk(null,t)},loadSource:function(e,n){function r(){topPreloader(50),k.loadTemplates(e,function(){topPreloader(100),s[e.id]=!1,n(i.module(e.id))})}var t,a,o=i.module(e.id);s[e.id]?retry(function(){return!s[e.id]},function(){k.loadSource(e,n)}):(s[e.id]=!0,t=e.path||"",a=t+c.path+e.uri+"/index.js",topPreloader(20),k.loadRelations(e,function(){topPreloader(40),window.design&&(d[e.uri]||(importCss((e.uri.csspath||t)+c.path+e.uri+"/index.css"),d[e.uri]=!0)),c.cashe&&o?r():importScript(a,function(){r()},null,i,e.id)}))},loadTemplates:function(n,e){lazyEach({array:n.templates,action:function(e){i.module(n.id).loadTemplate({name:e.item},e.success)},all:{success:e}})},loadRelations:function(e,n){var r=_.filter(e.relations,function(e){if(!e.if||e.if())return!0});e.relationsSunc?(e=_.filter(r,function(e){if("css"==e.f)return!0}),_.each(e,function(e){importCss(e.src)}),e=_.filter(r,function(e){return(!_Node||!e.nodeIgnore)&&("js"==e.f||void 0)}),e=_.map(e,function(e){return{src:e.src,require:e.require}}),importScripts(e,t,function(){n()},null,null,i)):lazyEach({array:r,action:function(e){var n=e.item;t[n.src]||_Node&&n.nodeIgnore?e.success():("js"==n.f&&importScript(n.src,function(){t[n.src]=!0,e.success()},null,i,null,n.require),"css"==n.f&&(t[n.src]=!0,importCss(n.src),e.success()))},all:{success:function(){n()}}})},openInitialModules:function(e,n){_OpenApi?e():(n=_.filter(n||i.map,function(e){if(!0===e.now)return!0}),lazyEach({array:n,sync:!1,action:function(n){var e=n.item;k.load({href:e.href,open:!0,clbk:function(e){n.success&&n.success()}})},all:{success:e}}))},load:function(r){(r=r||{}).href||r.id?(r.clbk||(r.clbk=emptyFunction),void 0!==r.animation||isMobile()||(r.animation="fadeIn"),r.href&&(r.completeHref||(r.completeHref=r.href),r.href=r.href.split("?")[0],r.map=u(r.href)),r.id?r.map=i.map[r.id]:r.map&&(r.id=r.map.id),r.map?k.loadSource(r.map,function(e){e?(r.module=e,r.module.map=r.map,e=parameters(),i.localization.set(e.loc,function(){r.open?k.open(r):r.clbk(null,r)})):r.clbk("module haven't been loaded")}):k.dynamicmap(r,function(e,n){e?(r.clbk("map for module isn't exist"),r.href="page404",r.map=u(r.href)):(r.id=n.id,r.essenseData=_.extend(r.essenseData||{},n.extra||{})),k.load(r)})):r.clbk("href and id aren't exist")},externalLink:function(e){var n=e.attr("href").toLowerCase(),r=e.attr("external"),t="https://"+("localhost/"==(t=o.get.hostname())||electron||window.cordova?i.options.url+"/":t),e=_.find(p,function(e){return-1!=n.indexOf(e)});if(!(t=!((t=_OpenApi||r||(!n||-1<n.indexOf("mailto")||-1<n.indexOf("skype:")||-1<n.indexOf("/")||-1<n.indexOf(".")||"#"==n)&&-1==n.indexOf(t))||!e)||t))return!0},externalTarget:function(e){var n=e.attr("href"),r=n&&(-1<n.indexOf("/")||-1<n.indexOf("."))||_OpenApi;-1==n.indexOf("http")&&(_OpenApi&&(n=i.options.url+"/"+n,i.ref&&(n=o.api.history.addParametersToHref(n,{ref:i.ref}))),e.attr("href","https://"+n)),r&&e.attr("target","_blank"),"undefined"!=typeof window&&void 0!==window.cordova&&cordova.InAppBrowser&&e.off("click").on("click",function(){return cordova.InAppBrowser.open(n,e.attr("cordovalink")||"_blank"),!1})},thisSiteLink:function(e){var n="https://"+("localhost/"==(n=o.get.hostname())||electron||window.cordova?i.options.url+"/":n);return 1<(n=e.split(n)).length?n[1]:e},links:function(t,e,a){var n;c.links&&(n=null,(n=e?e.find("a"):$("a")).length&&n.each(function(){var e,n,r=$(this);r.attr("href")&&(k.externalLink(r)?(_SEO&&(n=r.attr("href"),n=decodeSeoLinks(n).replace("#!",""),(e=parameters(n,!0)).loc||(e.loc=i.localization.key),n="#!"+((n=n.split("?")[0])+collectParameters(e)),r.attr("href",encodeSeoLinks(n))),n=function(e){var n=k.thisSiteLink($(this).attr("href")),r=$(this).attr("handler")||null;return a&&a(e),k.go({action:t,href:n,history:!0,open:!0,handler:r}),!1},r.attr("fast")?(r.swipe({tap:n}),r.off("click").on("click",function(){return!1})):r.off("click").on("click",n)):r.attr("donottrust")?r.off("click").on("click",function(){var e=$(this).attr("href");return-1==e.indexOf("http")&&(e="http://"+e),o.api.load({open:!0,id:"anothersite",inWnd:!0,essenseData:{link:e}}),!1}):k.externalTarget(r))}))},go:function(e){var n,r;(e=e||{}).href&&(e.action||(e.action=k.load),"?"==e.href[0]&&(r=parameters(),n=parameters(e.href.substr(1)),r=_.extend(r,n),e.href=l.href+collectParameters(r,e.exclude)),e.action(e))}},w={file:{prefix:function(){var e,n=window.location.pathname;-1<n.indexOf("android")?c.navPrefix="/android_asset/www/":window.cordova?((e=n.split("/")).splice(e.length-1,1),c.navPrefix=e.join("/")+"/"):c.navPrefix=n},pathnameSearch:function(){var e=window.location;return w.file.pathname()+e.search},pathname:function(){return window.location.pathname.replace(c.navPrefix,"").replace(".html","").replace(".cordova","").replace("indexcordova","index")}},web:{pathnameSearch:function(){var e=window.location;return w.web.pathname()+e.search},pathname:function(){return window.location.pathname.replace(c.navPrefix,"")},seoRedirect:function(){var e=window.location,n=decodeSeoLinks(e.href.replace("#!","").replace(/&amp;/g,"&"));n!=e.href&&v.add(n)}}};return o.api={history:v,links:k.links,go:k.go,ini:k.openInitialModules,backChainIndex:function(){return m.getindex()},backChainGet:function(){return m.get()},backChainClear:function(){m.clear()},load:function(t){var a=t.clbk;t.clbk=function(e,n){var r=!1;e&&(console.log(t,e),r=!0),a&&a(r,n)},k.load(t)},loadDefault:function(e){(e=e||{}).href||(e.href=o.get.pathnameSearch()||r);var n=e.href.split("?")[0];"blank"!=e.href&&n||(e.href=r),n==r&&m.clearAll(),m.add(e.href),o.api.load(e)},loadSameThis:function(e,n){n.container&&n.container.close(),n={open:!0,href:e,essenseData:n.essenseData,history:n.history,inWnd:n.inWnd,inTooltip:n.inTooltip,animation:n.animation},this.load(n)},loadRelations:k.loadRelations},o.get={href:function(){var e=window.location,n=f("pathname");return decodeSeoLinks(n+e.search).replace("#!","")},pathname:function(){var e=f("pathname");return"blank"==e&&(e=r),decodeSeoLinks(e).replace("#!","")},pathnameSearch:function(){var e=f("pathnameSearch");return"blank"==e&&(e=r),decodeSeoLinks(e).replace("#!","")},hostname:function(){return window.location.hostname+"/"}},o.init=function(e){e=e||{},"undefined"!=typeof window&&(m.load(),f("prefix"),f("seoRedirect"),!0!==c.history||_OpenApi||(window.onpopstate=function(e){v.openCurrent()}),k.openInitialModules(function(){e.open=!0,e.history=!0,e.loadDefault=!0,_OpenApi?e.clbk&&e.clbk():o.api.loadDefault(e)}))},o.clbks={history:{}},i.options.nav&&(c=_.extend(c,i.options.nav)),o.relations=t,o.current=l,o},"undefined"!=typeof module&&(module.exports=Nav),topPreloader(45);
 /*_____*/ 
Validation=function(h){function e(){$(this).val()&&$(this).addClass("initedInput")}function t(){for(var e=0;e<=this.nmbr;e++)c[e]=!0;(y()?b:g)()}function i(){for(var e=0;e<=this.nmbr;e++)c[e]=!0;$(this).closest(".inputLabel").hasClass("novalidate")?this.addEventListener("keyup",t,!1):this.removeEventListener("keyup",t),this.getAttribute("norelax")&&y("noshow")}function a(){for(var e=$(this).val(),t=!1,i=!1,a=!1,n=!1,s=0;s<e.length;s++)t||-1=="qwertyuiopasdfghjklzxcvbnm".indexOf(e[s])?i||-1=="QWERTYUIOPLKJHGFDSAZXCVBNM".indexOf(e[s])?a||-1=="0123456789".indexOf(e[s])?n||-1=="!@#$%^&*()_-+=|/.,:;[]{}".indexOf(e[s])||(n=!0):a=!0:i=!0:t=!0;var r=0,d="";t&&r++,i&&r++,a&&r++,n&&r++,e.length<6&&r<3&&(d="simple"),e.length<6&&3<=r&&(d="medium"),8<=e.length&&r<3&&(d="medium"),8<=e.length&&3<=r&&(d="strong"),6<=e.length&&1==r&&(d="simple"),6<=e.length&&1<r&&r<4&&(d="medium"),6<=e.length&&4==r&&(d="strong"),8<=e.length&&4==r&&(d="super"),0==e.length&&(d=""),l.find("div").removeClass().addClass(d)}var f,l,u,n=h.form,c=[],s=this,v=h.errorPath||"",m=h.errorPathKey||"after",d={rpass:function(e){return n.find(".password").val()==$(e).val()},freeemaillist:function(e){var t=!0,e="@"+e.split("@")[1];return!(-1<FreeEmails.indexOf(e))&&t},checked:function(e){return e.is(":checked")}},p={"0001":"Fill in this field please","0002":"The email address for the recipient is invalid","0003":"Password must be minimum of 6 characters, with at least one number","0004":"Passwords do not match","0005":"The Name is invalid","0006":"The Name of Bank is invalid","0007":"The Phone Number Format is (XXX) XXX-XXXX","0008":"Please enter your work email","0011":"Please agree with it"},o={email:{r:/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,f:"0002"},pass:{r:/((?=.*\d)(?=.*[a-zA-Z]).{6,})/,f:"0003"},rpass:{r:/((?=.*\d)(?=.*[a-zA-Z]).{6,})/,f:"0003",a:d.rpass,fa:"0004"},name:{r:/^[a-zA-Zа-яА-Я0-9 .\-_@#&]{1,30}$/,f:"0005"},bank:{r:/^[a-zA-Z .,&]{3,30}$/,f:"0006"},phone:{r:/^[(]{0,1}[0-9]{3}[)]{0,1}[-\s\.]{0,1}[0-9]{3}[-\s\.]{0,1}[0-9]{4}$/,f:"0007"},date:{r:"empty",f:"0001"},time:{r:"empty",f:"0001"},number:{r:/[0-9]+/,f:"0009"},vendorcode:{r:/[0-9]{14}/,f:"0010"},empty:{r:"empty",f:"0001"},checkbox:{fa:"0011",a:d.checked}},b=h.success||function(){},g=h.fail||function(){},y=function(t,e){e=e||{};var i,a,n,s,d=0,l=0,o="";return f.each(function(e){d++,"all"!=t&&0==c[e]||($(this).closest(".inputLabel").removeClass("validate"),$(this).closest(".inputLabel").removeClass("novalidate"),r=L($(this)),1==r[0]?(l++,$(this).closest(".inputLabel").addClass("validate")):""==o&&($(this).closest(".inputLabel").addClass("novalidate"),o=r[1],a=$(this)))}),i=l==d,h.afterEach&&h.afterEach(l),"noshow"==t||e.noerrors||(n=i,s=o,e=a,u&&(u.remove(),u=null),0==n?e&&(e.hasClass("initedInput")||""!=e.val())&&(s=s,e=e,u||(u=$("<div>",{text:p[s],class:"validationFail"}),e&&(e=v?v(e):e)[m](u))):b()),i},L=function(e){var t=e.data("validate")||"name",i=e.val(),a=!0,n="0000";if("hidden"!=e.attr("type"))return""!=i||"checkbox"==e.attr("type")?t&&t in o&&(1==a&&("r"in o[t]&&("empty"==o[t].r?""===i?(a=!1,n=o[t].f):a=!0:o[t].r.test(i)?a=!0:(a=!1,n=o[t].f)),!0===a&&"fu"in o[t]&&(!0===o[t].fu(i)?a=!0:(a=!1,n=o[t].fuerror))),1==a&&"a"in o[t]&&(o[t].a(e)||(a=!1,n=o[t].fa))):(a=!1,n="0001"),[a,n]};return s.init=function(){n&&((f=h.inputsSelector?n.find(h.inputsSelector):n.find('input[type!="hidden"][data-validate!="none"]')).each(function(e){this.nmbr=e,c[e]=!1}),l=$("<div>",{class:"pwdDiff",html:"<div class='indicator'></div>"}),n.find(".password").after(l),f.each(function(){this.addEventListener?(this.addEventListener("blur",t,!1),this.addEventListener("change",t,!1),this.addEventListener("change",e,!1),this.addEventListener("keyup",i,!1),this.addEventListener("change",i,!1),$(this).hasClass("password")&&$(this).on("keyup",a)):this.onfocusout=t}))},s.validation=function(e){return y("all",e)},s.inputValidation=L,s.init(),s},"undefined"!=typeof module&&(module.exports=Validation);
 /*_____*/ 
SubscribePrivate=function(){var t=this;return t.address={set:function(e){this.v=e},v:""},t.validation=function(){if(!t.address.v)return"address"},t.serialize=function(){return t.address.v},t.export=function(e){return e?{vsaddress:t.address.v}:{address:t.address.v}},t.import=function(e){e.address&&(t.address.v=e.address),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="subscribePrivate",t},Subscribe=function(){var t=this;return t.address={set:function(e){this.v=e},v:""},t.validation=function(){if(!t.address.v)return"address"},t.serialize=function(){return t.address.v},t.export=function(e){return e?{vsaddress:t.address.v}:{address:t.address.v}},t.import=function(e){e.address&&(t.address.v=e.address),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="subscribe",t},Unsubscribe=function(){var t=this;return t.address={set:function(e){this.v=e},v:""},t.validation=function(){if(!t.address.v)return"address"},t.serialize=function(){return t.address.v},t.export=function(e){return e?{vsaddress:t.address.v}:{address:t.address.v}},t.import=function(e){e.address&&(t.address.v=e.address),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="unsubscribe",t},Blocking=function(){var t=this;return t.address={set:function(e){this.v=e},v:""},t.validation=function(){if(!t.address.v)return"address"},t.serialize=function(){return t.address.v},t.export=function(e){return e?{vsaddress:t.address.v}:{address:t.address.v}},t.import=function(e){e.address&&(t.address.v=e.address),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="blocking",t},Unblocking=function(){var t=this;return t.address={set:function(e){this.v=e},v:""},t.validation=function(){if(!t.address.v)return"address"},t.serialize=function(){return t.address.v},t.export=function(e){return e?{vsaddress:t.address.v}:{address:t.address.v}},t.import=function(e){e.address&&(t.address.v=e.address),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="unblocking",t},Comment=function(e){var r=this;return r.txid=e,r.id="",r.parentid="",r.answerid="",r.message={set:function(e){this.v=e||"",r.on.change&&r.on.change("message",this.v)},v:""},r.images={set:function(e){if(e)if(_.isArray(e)){if(10<e.length)return!1;this.v=e}else{if(!e)return;if(9<this.v.length)return!1;this.v.push(e)}else this.v=[];return r.on.change&&r.on.change("images",this.v),!0},remove:function(e){e?removeEqual(this.v,e):this.v=[]},get:function(){return _.map(this.v,function(e){return e})},v:[]},r.url={set:function(e){this.v=e||"",r.on.change&&r.on.change("url",this.v)},v:""},r.clear=function(){r.message.set(),r.images.set(),r.url.set()},r.on={},r.off=function(e){delete r.on[e]},r.validation=function(){return(!r.delete||!r.id)&&(r.images.v.length||r.url.v||r.message.v?r.message.v&&1e3<r.message.v.length?"messagelength":null:"content")},r.checkloaded=function(){return _.find(r.images.v,function(e){return-1<e.indexOf("data:image")})},r.uploadImages=function(i,e){lazyEach({array:r.images.v,action:function(t,s){var n,e=t.item;-1<e.indexOf("data:image")?(n=e.split(","))[1]&&i.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:n[1]},success:function(e){r.images.v[s]=deep(e,"data.link"),t.success()},fail:function(e){i.ajax.run({type:"POST",up1:!0,data:{file:n[1]},success:function(e){r.images.v[s]="https://"+i.options.url+":8092/i/"+deep(e,"data.ident"),console.log("self.images.v[index]",r.images.v[s]),t.success()},fail:function(e){t.success()}})}}):t.success()},all:{success:function(){e&&e()}}})},r.serialize=function(){var e=r.txid;return r.delete||(e+=JSON.stringify({message:encodeURIComponent(r.message.v),url:encodeURIComponent(r.url.v),images:_.map(r.images.v,function(e){return encodeURIComponent(e)})})),e+((r.parentid||"")+(r.answerid||""))},r.export=function(e){var t={postid:r.txid,answerid:r.answerid||"",parentid:r.parentid||""};return r.delete||(t.msg=JSON.stringify({message:encodeURIComponent(r.message.v),url:encodeURIComponent(r.url.v),images:_.map(r.images.v,function(e){return encodeURIComponent(e)})})),console.log("self.images.v",r.images.v),r.id&&(t.id=r.id),t},r.import=function(e){r.txid=e.postid,r.answerid=e.answerid,r.parentid=e.parentid,e.msgparsed=JSON.parse(e.msg),r.url.set(decodeURIComponent(e.msgparsed.url)),r.message.set(decodeURIComponent(e.msgparsed.message)),r.images.set(_.map(e.msgparsed.images,function(e){return decodeURIComponent(e)})),console.log("v.msgparsed",e.msgparsed),(e.txid||e.id)&&(r.id=e.txid||e.id)},r.alias=function(e){var t=new pComment;return t.import(r.export()),t.id=e,t.txid=r.txid,t},r.typeop=function(){return r.id?r.delete?"commentDelete":"commentEdit":r.type},r.ustate="comment",r.type="comment",r},СScore=function(){var t=this;return t.comment={set:function(e){this.v=e},v:""},t.address={set:function(e){this.v=e},v:""},t.value={set:function(e){this.v=e},v:0},t.ustate="comment_score",t.opreturn=function(){return t.address.v+" "+t.value.v},t.validation=function(){if(!t.comment.v||!t.address.v)return"comment"},t.serialize=function(){return t.comment.v+t.value.v},t.export=function(e){return e?{commentid:t.comment.v,value:t.value.v.toString(),vsaddress:t.address.v}:{commentid:t.comment.v,value:t.value.v.toString()}},t.import=function(e){e.commentid&&(t.comment.v=e.commentid),e.value&&(t.value.v=Number(e.value)),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="cScore",t},UpvoteShare=function(){var t=this;return t.share={set:function(e){this.v=e},v:""},t.address={set:function(e){this.v=e},v:""},t.value={set:function(e){this.v=e},v:""},t.ustate="score",t.opreturn=function(){return t.address.v+" "+t.value.v},t.validation=function(){if(!t.share.v||!t.value.v)return"share"},t.serialize=function(){return t.share.v+t.value.v},t.export=function(e){return e?{share:t.share.v,value:t.value.v,vsaddress:t.address.v}:{share:t.share.v,value:t.value.v}},t.import=function(e){e.share&&(t.share.v=e.share),e.value&&(t.value.v=e.value),e.vsaddress&&(t.address.v=e.vsaddress)},t.type="upvoteShare",t},ComplainShare=function(){var t=this;return t.share={set:function(e){this.v=e},v:""},t.reason={set:function(e){this.v=e},v:""},t.validation=function(){return t.share.v?t.reason.v?void 0:"reason":"share"},t.serialize=function(){return t.share.v+"_"+t.reason.v},t.export=function(){return{share:t.share.v,reason:t.reason.v}},t.import=function(e){e.share&&(t.share.v=e.share),e.reason&&(t.reason.v=e.reason)},t.type="complainShare",t},Share=function(e){var r=this;return r.clear=function(){r.message.set(),r.images.set(),r.tags.set(),r.url.set(),r.caption.set(),r.repost.set(),r.language.set(e),r.aliasid="",_.each(r.settings,function(e,t){r.settings[t]=null})},r.repost={set:function(e){this.v=e||"",_.each(r.on.change||{},function(e){e("repost",this.v)})},v:"",drag:!1},r.caption={set:function(e){this.v=e||"",_.each(r.on.change||{},function(e){e("caption",this.v)})},v:"",drag:!1},r.message={set:function(e){this.v=e||"",_.each(r.on.change||{},function(e){e("message",this.v)})},v:"",drag:!0},r.language={set:function(e){this.v=e||"",_.each(r.on.change||{},function(e){e("language",this.v)})},get:function(){return this.v},v:""},r.poll={set:function(e){this.v=e||{},_.each(r.on.change||{},function(e){console.log("poll",e),e("poll",this.v)})},remove:function(e){e?removeEqual(this.v,e):this.v={},_.each(r.on.change||{},function(e){e("poll",this.v)})},get:function(){return this.v},v:{},drag:!0},r.ustate=function(){return r.aliasid?"":"post"},r.tags={have:function(e){return-1<this.v.indexOf(e)},set:function(e){if(void 0===e)this.v=[];else if(_.isArray(e)){if(5<e.length)return!1;e=_.map(e,function(e){return e.replace("#","").toLowerCase()}),this.v=e}else{if(!e)return;if(e=e.replace("#","").toLowerCase(),4<this.v.length)return!1;removeEqual(this.v,e),this.v.push(e)}return _.each(r.on.change||{},function(e){e("tags",this.v)}),!0},remove:function(e){e?(removeEqual(this.v,e),_.each(r.on.change||{},function(e){e("tags",this.v)})):this.v=[]},get:function(){return _.map(this.v,function(e){return e})},v:[]},r.images={set:function(e){if(e)if(_.isArray(e)){if(10<e.length)return!1;this.v=e}else{if(!e)return;if(9<this.v.length)return!1;this.v.push(e)}else this.v=[];return _.each(r.on.change||{},function(e){e("images",this.v)}),!0},remove:function(e){e?removeEqual(this.v,e):this.v=[],_.each(r.on.change||{},function(e){e("images",this.v)})},get:function(){return _.map(this.v,function(e){return e})},v:[],drag:!0},r.url={set:function(e){return this.v=e||"",r.settings.image="",_.each(r.on.change||{},function(e){e("url",this.v)}),!0},v:"",drag:!0},r.on={change:{}},r.off=function(e){delete r.on[e]},r.default={a:["cm","r","i","u","p"],v:"p",videos:[],image:"a"},r.settings={a:"",v:"",videos:[],image:""},r.checkloaded=function(){return _.find(r.images.v,function(e){return-1<e.indexOf("data:image")})},r.uploadImages=function(i,e){lazyEach({array:r.images.v,action:function(t,s){var n,e=t.item;-1<e.indexOf("data:image")?(n=e.split(","))[1]&&i.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:n[1]},success:function(e){r.images.v[s]=deep(e,"data.link"),t.success()},fail:function(e){i.ajax.run({type:"POST",up1:!0,data:{file:n[1]},success:function(e){r.images.v[s]="https://"+i.options.url+":8092/i/"+deep(e,"data.ident"),t.success()},fail:function(e){t.success()}})}}):t.success()},all:{success:function(){e&&e()}}})},r.validation=function(){return r.message.v||r.caption.v||r.repost.v?r.language.v?r.itisvideo()&&!r.caption.v?"videocaption":r.url.v&&r.url.v.length&&!r.itisvideo()&&trim((trim(r.message.v)+trim(r.caption.v)).replace(r.url.v.length,"")).length<30&&!r.images.v.length?"url":!r.tags.v.length&&!r.repost.v&&"tags":"language":"message"},r.serialize=function(){return encodeURIComponent(r.url.v)+encodeURIComponent(r.caption.v)+encodeURIComponent(r.message.v)+_.map(r.tags.v,function(e){return encodeURIComponent(e)}).join(",")+r.images.v.join(",")+(r.aliasid||"")+(r.repost.v||"")},r.shash=function(){return bitcoin.crypto.sha256(r.serialize()+(r.repost.v||"")).toString("hex")},r.itisvideo=function(){if("a"!=r.settings.v&&r.url.v)return"peertube"==parseVideo(r.url.v).type||void 0},r.export=function(e){return e?{caption:r.caption.v,message:r.message.v,url:r.url.v,tags:r.tags.v,images:r.images.v,settings:_.clone(r.settings),language:r.language.v,txidEdit:r.aliasid||"",txidRepost:r.repost.v||"",poll:r.poll.v||{}}:{c:encodeURIComponent(r.caption.v),m:encodeURIComponent(r.message.v),u:encodeURIComponent(r.url.v),p:_.clone(r.poll.v),t:_.map(r.tags.v,function(e){return encodeURIComponent(e)}),i:r.images.v,s:_.clone(r.settings),l:r.language.v,txidEdit:r.aliasid||"",txidRepost:r.repost.v||""}},r.import=function(e){if(r.caption.set(e.c||e.caption),r.url.set(e.u||e.url),r.tags.set(e.t||e.tags),r.message.set(e.m||e.message),r.images.set(e.i||e.images),r.repost.set(e.r||e.txidRepost||e.repost),r.language.set(e.l||e.language||"en"),r.poll.set(e.p||e.poll||{}),e.txidEdit&&(r.aliasid=e.txidEdit),e.s)try{r.settings=e.s}catch(e){}else e.settings&&(r.settings=e.settings)},r.alias=function(e){var t=new pShare;return t.time=new Date,t._import(r.export()),t.txid=e||r.aliasid,t},r.optstype=function(e){return r.itisvideo()?"video":r.type},r.typeop=function(e){return r.itisvideo()?"video":r.aliasid?"share":r.type},e&&r.language.set(e),r.type="share",r},UserInfo=function(){var i=this;return i.clear=function(){i.image.set(),i.name.set(),i.language.set(),i.about.set(),i.site.set(),i.addresses.set()},i.checkloaded=function(){return-1<i.image.v.indexOf("data:image")},i.addresses={set:function(e){var t=this.v;e?_.isArray(e)?_.each(e,function(e){t.push(e)}):this.v.push(e):this.v=[],i.on.change&&i.on.change("addresses",this.v)},v:[]},i.keys={set:function(e){var t=this.v;e?_.isArray(e)?_.each(e,function(e){e&&t.push(e)}):this.v.push(e):this.v=[],i.on.change&&i.on.change("keys",this.v)},v:[]},i.image={set:function(e){this.v=e||"",i.on.change&&i.on.change("image",this.v)},v:""},i.name={set:function(e){this.v=e||"",i.on.change&&i.on.change("name",this.v)},v:""},i.ref={set:function(e){this.v=e||"",i.on.change&&i.on.change("ref",this.v)},v:""},i.language={set:function(e){this.v=e||"",i.on.change&&i.on.change("language",this.v)},v:""},i.about={set:function(e){this.v=e||"",i.on.change&&i.on.change("about",this.v)},v:""},i.site={set:function(e){this.v=e||"",i.on.change&&i.on.change("site",this.v)},v:""},i.uploadImage=function(t,s){var n,e=i.image.v;-1<e.indexOf("data:image")?(n=e.split(","))[1]&&t.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:n[1]},success:function(e){i.image.v=deep(e,"data.link"),s&&s()},fail:function(e){t.ajax.run({type:"POST",up1:!0,data:{file:n[1]},success:function(e){i.image.v="https://pocketnet.app:8092/i/"+deep(e,"data.ident"),s&&s()},fail:function(e){s&&s(e)}})}}):s&&s()},i.on={},i.off=function(e){delete i.on[e]},i.validation=function(){return 20<i.name.v.length?"namelength":-1<i.name.v.toLowerCase().replace(/[^a-z]/g,"").indexOf("pocketnet")&&"pocketnet"},i.serialize=function(){return encodeURIComponent(i.name.v)+encodeURIComponent(i.site.v)+i.language.v+encodeURIComponent(i.about.v)+i.image.v+JSON.stringify(i.addresses.v)+i.ref.v+i.keys.v.join(",")},i.alias=function(e){var t=new pUserInfo;return t._import(i.export()),t.txid=e,t},i.export=function(e){return e?{name:i.name.v,about:i.about.v,site:i.site.v,language:i.language.v,image:i.image.v,addresses:JSON.stringify(i.addresses.v||[]),ref:i.ref.v,keys:i.keys.v.join(",")}:{n:encodeURIComponent(i.name.v),l:i.language.v,a:encodeURIComponent(i.about.v),s:encodeURIComponent(i.site.v),i:i.image.v,b:JSON.stringify(i.addresses.v||[]),r:i.ref.v,k:i.keys.v.join(",")}},i.import=function(e){i.name.set(e.c||e.name),i.language.set(e.l||e.language),i.about.set(e.a||e.about),i.site.set(e.s||e.site),i.image.set(e.i||e.image),i.addresses.set(JSON.parse(e.b||e.addresses||"[]")),i.ref.set(e.r||e.ref),i.keys.set((e.k||e.keys||"").split(","))},i.type="userInfo",i},pUserInfo=function(){var s=this;return s.name="",s.image="",s.language="",s.about="",s.site="",s.txid="",s.ref="",s.postcnt=0,s.reputation=0,s.trial=!0,s.keys=[],s.subscribes=[],s.subscribers=[],s.recomendedSubscribes=[],s.blocking=[],s.address="",s.rc=0,s._import=function(e){s.name=decodeURIComponent(e.n||e.name||""),s.image=e.i||e.image,s.about=decodeURIComponent(e.a||e.about||""),s.language=e.l||e.language,s.site=decodeURIComponent(e.s||e.site||""),s.ref=e.r||e.ref,s.rc=e.rc||0,s.postcnt=e.postcnt||0,s.reputation=e.reputation||0,e.subscribes&&(s.subscribes=e.subscribes),e.subscribers&&(s.subscribers=e.subscribers),e.recomendedSubscribes&&(s.recomendedSubscribes=e.recomendedSubscribes),e.blocking&&(s.blocking=e.blocking),s.keys=e.k||e.keys||"",_.isArray(s.keys)||(s.keys=s.keys.split(",")),s.keys=_.filter(s.keys,function(e){return e}),e.txid&&(s.txid=e.txid);try{s.addresses=JSON.parse(e.b||e.addresses||"[]")}catch(e){}void 0!==e.trial&&(s.trial=e.trial),(e.adr||e.address)&&(s.address=e.adr||e.address),s.temp=e.temp||null},s.export=function(){var e={};return e.n=encodeURIComponent(s.name),e.image=s.image,e.a=encodeURIComponent(s.about),e.l=s.language,e.s=encodeURIComponent(s.site),e.r=s.ref,e.rc=s.rc,e.b=JSON.stringify(s.addresses||[]),e.adr=s.address,e.k=s.keys.join(","),e},s.social=function(){return{image:s.image,images:[s.image],title:s.name,html:{body:s.about,preview:s.about},text:{body:s.about,preview:s.about}}},s.import=function(e){e=JSON.parse(e),s._import(e)},s.relation=function(t,e){return e=e||"subscribes",_.find(s[e],function(e){return e.adddress==t||e.address==t||e==t})},s.addRelation=function(e,t){s[t=t||"subscribes"]||(s[t]=[]),s[t].push(e)},s.removeRelation=function(e,t){t=t||"subscribes",removeEqual(s[t],e)},s.type="userInfo",s},pShare=function(){var s=this;return s.url="",s.tags=[],s.message="",s.caption="",s.images=[],s.txid="",s.time=null,s.repost="",s.language="",s.poll={},s.comments=0,s.lastComment=null,s.reposted=0,s.on={},s.off=function(e){delete s.on[e]},s.default={a:["cm","i","u","p"],v:"p",videos:[],image:"a"},s.settings={a:"",v:"",videos:[],image:""},s.isEmpty=function(){return!s.message&&!s.caption&&0==s.tags.length&&0==s.images.length&&!s.url},s.findComment=function(t){return _.find(s.comments,function(e){return e.txid==t})},s.itisvideo=function(){if("a"!=s.settings.v&&s.url)return"peertube"==parseVideo(s.url).type||void 0},s._import=function(e,t){if(e.i&&!_.isArray(e.i)&&(e.i=[e.i]),e.t&&!_.isArray(e.t)&&(e.t=[e.t]),t?(s.message=e.m||e.message||"",s.caption=e.c||e.caption||"",s.tags=e.t||e.tags||[],s.url=e.u||e.url||""):(s.url=decodeURIComponent(e.u||e.url||""),s.message=decodeURIComponent((e.m||e.message||"").replace(/\+/g," ")),s.caption=decodeURIComponent((e.c||e.caption||"").replace(/\+/g," ")),s.tags=_.map(e.t||e.tags||[],function(e){return decodeURIComponent(e)})),s.poll=e.p||e.poll||{},e.myVal&&(s.myVal=Number(e.myVal)),s.language=e.l||e.language||"en",s.images=e.i||e.images||[],s.repost=e.r||e.repost||e.txidRepost||"",e.txid&&(s.txid=e.txid),e.txidEdit&&(s.txidEdit=e.txidEdit),s.temp=e.temp||null,e._time&&(s._time=e._time),e.comments&&(s.comments=e.comments),e.reposted&&(s.reposted=e.reposted),e.lastComment&&(s.lastComment=e.lastComment),e.s)try{s.settings=e.s}catch(e){}else e.settings&&(s.settings=e.settings)},s.export=function(){var e={};return e.m=encodeURIComponent(s.message),e.c=encodeURIComponent(s.caption),e.u=encodeURIComponent(s.url),e.t=_.map(s.tags||[],function(e){return encodeURIComponent(e)}),e.i=_.clone(s.images),e._time=s._time,e.s=_.clone(s.settings),e.l=s.language,e.p=s.poll,e},s.import=function(e){e=JSON.parse(e),s._import(e)},s.social=function(e){var t=e.platform.api.name(s.address),e={image:"",images:s.images||[],title:"Post by "+t,html:{body:s.renders.xssmessagec(),preview:trimHtml(s.renders.xssmessagec(),160).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")},text:{body:s.renders.text(),preview:trimHtml(s.renders.text(),130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")}};return!s.url||(t=videoImage(s.url))&&(e.image=t,e.images.unshift(t)),e.image||(e.image=s.images[0]),e},s.renders={captionclear:function(){return s.caption||""},caption:function(){return s.caption?trimrn(s.caption):s.message.length<100?trimrn(s.message):""},message:function(){return!s.caption&&s.message.length<100?"":trimrn(s.message)},messagec:function(){return s.caption||trimrn(s.message)},text:function(e){return e=e||s.renders.messagec(),trimrn(filterXSS(e,{whiteList:[],stripIgnoreTag:!0}))},xssmessagec:function(){var e=s.renders.messagec();return s.renders.xssmessage(e)},xssmessage:function(e){var i;return e=e||s.renders.message(),e="a"!=s.settings.v?nl2br(trimrn(findAndReplaceLink(filterXSS(e,{whiteList:[],stripIgnoreTag:!0})))):(i={"js-player":!0,plyr:!0,"medium-insert-images":!0,"medium-insert-images-grid":!0,"medium-insert-embeds":!0},(e=filterXSS(e,{stripIgnoreTag:!0,whiteList:{a:["href","title","target","cordovalink"],br:["style"],b:["style"],span:["style"],figure:["style"],figcaption:["style"],i:["style"],img:["src"],div:["data-plyr-provider","data-plyr-embed-id"],p:[],ul:[],ol:[],li:[],h2:[],h1:[],h3:[],h4:[],h5:[],em:[],u:[],blockquote:[],strong:[],picture:["img-type"],source:["srcset","type"],strike:[]},onIgnoreTagAttr:function(e,t,s,n){if("class"===t)return s=s.split(" "),t+'="'+(s=_.filter(s,function(e){return i[e]})).join(" ")+'"'}})).replace(/http:\/\//g,"https://")),trimrn(e)}},s.upvote=function(e){if(s.myVal&&"0"!=s.myVal)return null;var t=new UpvoteShare;return t.share.set(s.txid),t.value.set(e),t.address.set(s.address||""),s.myVal=Number(e),t},s.complain=function(e){var t=new ComplainShare;return t.share.set(s.txid),t.reason.set(e),t},s.alias=function(){var e=new Share;return e.import(s),e.aliasid=s.txid,e.time=s.time,e},s.type="share",s},pComment=function(){var s=this;return s.url="",s.message="",s.images=[],s.txid="",s.id="",s.time=0,s.timeUpd=0,s.children=0,s.address="",s.parentid="",s.answerid="",s.scoreDown=0,s.scoreUp=0,s.myScore=0,s.deleted=!1,s.my=function(e){return e=e.platform.sdk.address.pnet(),!(!s.address||!e||s.address!=e.address)},s._import=function(t){if(t.msgparsed)try{s.url=decodeURIComponent(t.msgparsed.url||""),s.message=decodeURIComponent((t.msgparsed.message||"").replace(/\+/g," ")),s.images=_.map(t.msgparsed.images||[],function(e){return decodeURIComponent(e)})}catch(e){console.log("ERROR",e,t.msgparsed)}s.txid=t.postid,s.answerid=t.answerid,s.parentid=t.parentid,s.scoreDown=Number(t.scoreDown||"0"),s.scoreUp=Number(t.scoreUp||"0"),t.myScore&&(s.myScore=t.myScore),t.deleted&&(s.deleted=!0),(t.id||t.txid)&&(s.id=t.id||t.txid)},s.import=function(e){e.msg&&(e.msgparsed=JSON.parse(e.msg)),s._import(e)},s.export=function(){return{id:s.id,postid:s.txid||"",answerid:s.answerid||"",parentid:s.parentid||"",msgparsed:{message:s.message,url:s.url,images:s.images},scoreDown:s.scoreDown,scoreUp:s.scoreUp,myScore:s.myScore,deleted:s.deleted}},s.upvote=function(e){if(s.myVal&&"0"!=s.myVal)return null;var t=new СScore;return t.comment.set(s.id),t.address.set(s.address||""),t.value.set(e),s.myScore=Number(e),t},s.delete=function(){var e=new Comment;return e.id=s.id,e.parentid=s.parentid,e.answerid=s.answerid,e.delete=!0,e},s.setTime=function(e,t){s.time=new Date,s.time.setTime(1e3*e),s.timeUpd=new Date,s.timeUpd.setTime(1e3*t)},s.social=function(e){var t=e.platform.api.name(s.address);return(t={image:"",images:s.images||[],title:"Comment by "+t,html:{body:s.renders.text(),preview:trimHtml(s.renders.text(),160).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")},text:{body:s.renders.text(),preview:trimHtml(s.renders.text(),130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")}}).image||(t.image=s.images[0]),t.image||(t.image=deep(e,"platform.sdk.usersl.storage."+s.address+".image")),t},s.renders={text:function(){return trimrn(filterXSS(s.message,{whiteList:[],stripIgnoreTag:!0}))},preview:function(){var e=filterXSS(s.message,{whiteList:[],stripIgnoreTag:!0}),e=joypixels.toImage(trimHtml(e,90));return nl2br(trimrn(e))},previewEmojidis:function(){var e=filterXSS(s.message,{whiteList:[],stripIgnoreTag:!0}),e=trimHtml(e,90);return nl2br(trimrn(e))}},s.type="comment",s},Img=function(e){var t=this;return t.type=(e=e||{}).type,t.name=e.name,t.app=e.app,t.refId=e.refId,t},kits={c:{userInfo:UserInfo,share:Share,complainShare:ComplainShare,upvoteShare:UpvoteShare,cScore:СScore,comment:Comment,unblocking:Unblocking,blocking:Blocking,unsubscribe:Unsubscribe,subscribe:Subscribe,subscribePrivate:SubscribePrivate},ini:{},alias:{userInfo:pUserInfo,share:pShare,comment:pComment}};
 /*_____*/ 
var storage,electron=null;"undefined"==typeof _OpenApi&&(_OpenApi=!1),"undefined"!=typeof _Electron&&(storage=(electron=require("electron")).OSBrowser,$("html").addClass("electron")),Platform=function(u,e){var b=this;b.app=u,b.lasttimecheck=null,b.real={PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd:!0,PLJvEixJkj85C4jHM3mt5u1ATwZE9zgFaA:!0,PRTugzBefzB1AA2Rw8VTBKf3BBPDjQND8y:!0,PCVt7H4vgjBDxifLz3uokbc1tD3MZwWwQh:!0,PJ3nv2jGyW2onqZVDKJf9TmfuLGpmkSK2X:!0,PLH8biT5rMdvE1zXFhsvNkzphVRK6cNM7p:!0,P92gc46iqLhCswPsbLxH7wjTfh9rhhNSux:!0,PXUYsENSv6QkQZEdiJTsfJmu3XxZvVmVfQ:!0,PXXaSczoZcuJEwxYKhaC9pV1JBvwi6UjSw:!0,PFV4UT9fhHsqkmCGsWsSCr55Pr1SMX6NL2:!0,PTcArXMkhsKMUrzQKn2SXmaVZv4Q7sEpBt:!0,PL9U1q1JmJezPh8GQb5dj5h5GavuCGcjYk:!0,PS4pYW4tpu6fwviz63CHLMxPA37fJ3GLvn:!0,PHmvLy9b5m2b7fvU7MSTw4mAkdshhdY4Nt:!0,PVpSK2qQXmG1SjAMJVMAMRLUkrzMjsJouL:!0,P8boyun9yF6QYn1fjGC1WABt4BQUL4STeh:!0,PA6biduJbWcQ97n5jz2jUqWHtenLpWTH7s:!0,P9EkPPJPPRYxmK541WJkmH8yBM4GuWDn2m:!0,PUYo1a6LxjnnBVi6uBjHUsZQS4FnbUwdAN:!0,PLFtS8H7ATooK53xRTw7YHsuK7jsn5tHgi:!0,PVJDtKPnxcaRDoQhqQj7FMNu46ZwB4nXVa:!0,PVjvMwapTA29biRTsksXUBuVVf2HVwY7ps:!0,PKSV2KXCdEtTtYb8rF3xMMgiiKe1oDstXR:!0},b.testaddresses=["PGiQ8j6fdtAJSH2sA7rZMB17GzqBTUVLCm","PF1umexG4Kvm8bkow1JiRF3s1vcBkYvKeg","PJJbtb1AEcRopQuuBiRbQbiec7WHNtAEsF","PSmGDYWzcPrrhvqFnGVxnhPbpsTK6LCZYd","PDQaeB3fGY3en5qMaq8AKZvev34Hgyx5UE","PAdUsDtP9onjpwHHxhbxxRcjtxD9fsW9Su","PRaYPD2NAVMcEXcUu2GsEQwqsG8md8H2dr","PHr8g7b4gJdSkiJFmQeoND2X8tRUKvB2An","PEwL86dE6MuKKaGPxooGyFCKocUP8B6jw8","PFV4UT9fhHsqkmCGsWsSCr55Pr1SMX6NL2","PRTugzBefzB1AA2Rw8VTBKf3BBPDjQND8y","P92gc46iqLhCswPsbLxH7wjTfh9rhhNSux","PSWxzYS4Y37tmnZ9oxKfm9ffVqLRBbFbjH","PHvQEGtYYpDpmHYuUwA4gF4ey1YitF2NRW","PA6biduJbWcQ97n5jz2jUqWHtenLpWTH7s","PKpdrwDVGfuBaSBvboAAMwhovFmGX8qf8S","PKerxto9tFT8dZJrNWFsimA3sBdBAkXsrE","PQsvaeBWB5WX3BsdWcNFmP1wy61P3gpRKf","PKerxto9tFT8dZJrNWFsimA3sBdBAkXsrE","PHNKYionoaBRVudUhqWzNrJyqxVxaDYqT7","PVCUYATJxi4yNM2sqThPxd3P6jJDrvuWJs","PLJvEixJkj85C4jHM3mt5u1ATwZE9zgFaA","PShAyCoM32HEEHqrdEYvQ1wRjeqZsmWqDa","PKLWLXN6kwmdkbYG981gyPj5jb7bgzhstj","PHdW4pwWbFdoofVhSEfPSHgradmrvZdbE5","P9jDYvkXHw4FtRZof661ddzmMyFRqGUjwN","P9EkPPJPPRYxmK541WJkmH8yBM4GuWDn2m","PFnN8SExxLsUjMKzs2avdvBdcA3ZKXPPkF","PSRFH9Ctq4wV1THes39izo3J4dHybLyT32","PVgqi72Qba4aQETKNURS8Ro7gHUdJvju78","P9tRnx73Sw1Ms9XteoxYyYjvqR88Qdb8MK","PQxuDLBaetWEq9Wcx33VjhRfqtof1o8hDz","PEHrffuK9Qiqs5ksqeFKHgkk9kwQN2NeuS","PP582V47P8vCvXjdV3inwYNgxScZCuTWsq","PQxuDLBaetWEq9Wcx33VjhRfqtof1o8hDz","PQ8AiCHJaTZAThr2TnpkQYDyVd1Hidq4PM","PK6Kydq5prNj13nm5uLqNXNLFuePFGVvzf","PR7srzZt4EfcNb3s27grgmiG8aB9vYNV82","PCAyKXa52WTBhBaRWZKau9xfn93XrUMW2s","PCBpHhZpAUnPNnWsRKxfreumSqG6pn9RPc","PEkKrb7WJgfU3rCkkU9JYT8jbGiQsw8Qy8","PBHvKTH5TGQYDbRHgQHTTvaBf7tuww6ho7","PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"],b.testchataddresses=["P9EkPPJPPRYxmK541WJkmH8yBM4GuWDn2m","PFnN8SExxLsUjMKzs2avdvBdcA3ZKXPPkF","PVgqi72Qba4aQETKNURS8Ro7gHUdJvju78","P9tRnx73Sw1Ms9XteoxYyYjvqR88Qdb8MK","PQxuDLBaetWEq9Wcx33VjhRfqtof1o8hDz","PEHrffuK9Qiqs5ksqeFKHgkk9kwQN2NeuS","PP582V47P8vCvXjdV3inwYNgxScZCuTWsq","PQxuDLBaetWEq9Wcx33VjhRfqtof1o8hDz","PQ8AiCHJaTZAThr2TnpkQYDyVd1Hidq4PM","PK6Kydq5prNj13nm5uLqNXNLFuePFGVvzf","PR7srzZt4EfcNb3s27grgmiG8aB9vYNV82","PCAyKXa52WTBhBaRWZKau9xfn93XrUMW2s","PCBpHhZpAUnPNnWsRKxfreumSqG6pn9RPc","PEkKrb7WJgfU3rCkkU9JYT8jbGiQsw8Qy8","PBHvKTH5TGQYDbRHgQHTTvaBf7tuww6ho7","PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"],b.focus=!0,b.currentBlock=0,b.online=void 0,b.avblocktime=45,b.repost=!0,b.videoenabled=!0,b.test=!1;var t=null,l=!1,p=new nModule;p.ajax=u.ajax,p.app=u,p.user=u.user,b.released={vidgets:{staking:!0}},b.mp={dollars:function(e,t){return void 0===(t=t||{}).precision&&(t.precision=2),t.allowNegative=!1,void 0===t.prefix&&(t.prefix="$&nbsp;"),t.value=Number(e).toFixed(t.precision),maskValue(t)},coin:function(e,t){return void 0===(t=t||{}).precision&&(t.precision=2,1<=e&&(t.precision=2),1e6<e&&(t.precision=0),e<.1&&(t.precision=4),e<.001&&(t.precision=8)),t.allowNegative=!1,t.value=Number(e).toFixed(t.precision),maskValue(t)},acoin:function(e,t){return void 0===(t=t||{}).precision&&(t.precision=2,1<=e&&(t.precision=2),e<.001&&(t.precision=8),1e6<e&&(t.precision=0)),t.allowNegative=!1,t.value=Number(e).toFixed(t.precision),maskValue(t)},coinwithsmall:function(e,t){void 0===(t=t||{}).precision&&(t.precision=2),void 0===t.dprecision&&(t.dprecision=6),void 0===t.suffix&&(t.suffix="PKOIN");var s=t.suffix;delete t.suffix,e=Number(Number(e).toFixed(t.dprecision));var n=Math.pow(10,t.precision);return t.allowNegative=!1,t.value=(Math.floor(e*n)/n).toFixed(t.precision),e=(e-t.value).toFixed(t.dprecision).substr(2+t.precision),'<div class="table coinwithsmall"><div class="bignum">'+maskValue(t)+'</div><div class="svlwr"><div><div div class="smallvalue">'+e+'</div><div class="suffix">'+s+"</div></div></div></div>"}},b.istest=function(){var e=b.testaddresses;if(b.sdk.address.pnet()&&-1<e.indexOf(b.sdk.address.pnet().address))return!0},b.values={alph:["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},b.__applications=function(){return{ui:{windows:{appname:"Pocketnet",id:"#windows",text:{name:"Windows",download:b.app.localization.e("e13222"),label:b.app.localization.e("e13223")},icon:'<i class="fab fa-windows"></i>',github:{name:"PocketnetSetup.exe",url:"https://api.github.com/repos/pocketnetapp/pocketnet.gui/releases/latest",page:"https://github.com/pocketnetteam/pocketnet.gui/releases/latest"}},macos:{appname:"Pocketnet",id:"#macos",text:{name:"macOS",download:b.app.localization.e("e13222"),label:b.app.localization.e("e132232")},icon:'<i class="fab fa-apple"></i>',github:{name:"PocketnetSetup.dmg",url:"https://api.github.com/repos/pocketnetapp/pocketnet.gui/releases/latest",page:"https://github.com/pocketnetteam/pocketnet.gui/releases/latest"}},currentos:{appname:"Pocketnet",id:"#linux",text:{name:"Linux",download:b.app.localization.e("e13222"),label:b.app.localization.e("e13224")},icon:'<i class="fab fa-linux"></i>',github:{name:"PocketnetSetup.deb",url:"https://api.github.com/repos/pocketnetapp/pocketnet.gui/releases/latest",page:"https://github.com/pocketnetteam/pocketnet.gui/releases/latest"}}},node:{windows:{appname:b.app.localization.e("e13225"),text:{name:"Windows",download:b.app.localization.e("e13226"),label:b.app.localization.e("e13227")},icon:'<i class="fab fa-windows"></i>',github:{name:"pocketnetcore_0.18.13_win_x64_setup.exe",url:"https://api.github.com/repos/pocketnetapp/pocketnet.core/releases/latest",page:"https://github.com/pocketnetteam/pocketnet.core/releases/latest"}},linux:{appname:b.app.localization.e("e13225"),text:{name:"Linux",download:b.app.localization.e("e13226"),label:b.app.localization.e("e13228")},icon:'<i class="fab fa-linux"></i>',github:{name:"Pocketnet_linux_x64.AppImage",url:"https://api.github.com/repos/pocketnetapp/pocketnet.core/releases/latest",page:"https://github.com/pocketnetteam/pocketnet.core/releases/latest"}}}}},b.errorHandler=function(e,t,s){var n=b.errors[e]||b.errors.network;if(n){var a=n.message;if(a){if(!(a="function"==typeof a?a(s):a))return;sitemessage(a)}return a=n.action,t&&a&&a(e,t,s),(n.text||function(){return""})()}return!1},b.errors={money:{action:function(e,n,a){var i=b.app.platform.sdk.address.pnet().address;topPreloader(10),b.sdk.node.transactions.get.balance(function(e,t,s){topPreloader(30),s?b.errorHandler(s,n,a):0<e?b.sdk.node.transactions.get.canSpend([i],function(e){topPreloader(100),e?sitemessage(b.errors.network.message()):dialog({html:b.app.localization.e("canSpendError"),btn1text:b.app.localization.e("daccept"),class:"one"})}):b.app.user.validate()?(topPreloader(100),b.app.platform.sdk.user.waitActions(function(e){e?dialog({html:b.app.localization.e("waitConf"),btn1text:b.app.localization.e("daccept"),class:"one"}):dialog({html:b.app.localization.e("noMoneyError"),btn1text:b.app.localization.e("daccept"),class:"one"})})):b.app.platform.sdk.ustate.me(function(e){topPreloader(40),e?b.app.platform.sdk.users.checkFreeMoney(i,function(e){topPreloader(100),e?b.errors[1].action():dialog({html:b.app.localization.e("noMoneyError"),btn1text:b.app.localization.e("daccept"),class:"one"})}):(topPreloader(100),sitemessage(b.errors.network.message()))})},i,!0)},relay:!0},privatekey:{message:function(){return b.app.localization.e("e13229")},relay:!0},network:{message:function(){return b.app.localization.e("e13230")},relay:!0},proxy:{message:function(){return b.app.localization.e("e13231")+" / 1"},relay:!0},proxymain:{message:function(){return b.app.localization.e("e13231")+" / 2"},relay:!0},node:{message:function(){return b.app.localization.e("e13232")},relay:!0},offline:{message:function(){return b.app.localization.e("e13231")},relay:!0},42:{message:function(){return b.app.localization.e("e13233")}},41:{message:function(){return b.app.localization.e("e13234")},relay:!0},40:{message:function(){return b.app.localization.e("e13235")}},39:{message:function(){return b.app.localization.e("e13236")}},38:{message:function(){return b.app.localization.e("e13237")}},37:{message:function(){return b.app.localization.e("e13238")}},35:{message:function(){return b.app.localization.e("e13239")}},34:{message:function(){return b.app.localization.e("e13240")}},33:{message:function(){return b.app.localization.e("e13241")}},32:{message:function(){return b.app.localization.e("e13242")}},31:{message:function(){return b.app.localization.e("e13243")}},30:{message:function(){return b.app.localization.e("e13244")}},29:{message:function(){return b.app.localization.e("e13245")}},28:{message:function(){return"Wait a bit before taking action"}},27:{message:function(){return b.app.localization.e("e13246")}},26:{message:function(){return b.app.localization.e("e13247")}},25:{message:function(){return b.app.localization.e("e13248")}},24:{message:function(){return b.app.localization.e("e13249")}},23:{message:function(){return b.app.localization.e("e13250")}},22:{message:function(){return b.app.localization.e("e13251")}},21:{message:function(){return b.app.localization.e("e13252")}},20:{message:function(){return b.app.localization.e("e13253")}},19:{message:function(){return b.app.localization.e("e13254")}},18:{message:function(){return b.app.localization.e("e13255")}},17:{message:function(){return b.app.localization.e("e13256")}},16:{message:function(){return b.app.localization.e("e13257")}},15:{message:function(){return b.app.localization.e("e13258")}},14:{message:function(){return b.app.localization.e("e13259")}},13:{message:function(){return b.app.localization.e("e13260")}},12:{message:function(){return b.app.localization.e("unexperror12")}},11:{message:function(){return b.app.localization.e("unexperror11")}},10:{message:function(){return b.app.localization.e("unexperror10")}},9:{message:function(){return b.app.localization.e("SelfSubscribeError")}},8:{message:function(){return b.app.localization.e("DoubleSubscribeError")}},7:{message:function(){return b.app.localization.e("InvalideSubscribeError")}},6:{message:function(){return b.app.localization.e("ChangeInfoLimitError")}},5:{message:function(){return b.app.localization.e("SelfScoreError")}},4:{message:function(){return b.app.localization.e("doubleLimitLight")}},3:{message:function(){var e=b.sdk.ustate.storage[b.sdk.address.pnet().address]||{};return b.app.localization.e("scoreLimitLight",(e.score_unspent||0)+(e.score_spent||0))}},2:{text:function(){var e=b.sdk.ustate.storage[b.sdk.address.pnet().address]||{};return b.app.localization.e("postLimitLight",(e.post_unspent||0)+(e.post_spent||0))}},1:{text:function(){return b.app.localization.e("checkScoreErrorLight")},action:function(){b.app.platform.sdk.user.waitActions(function(e){e?dialog({html:b.app.localization.e("waitConf"),btn1text:b.app.localization.e("daccept"),class:"one"}):dialog({html:b.app.localization.e("checkScoreError"),btn1text:b.app.localization.e("dyes"),btn2text:b.app.localization.e("dno"),success:function(){b.app.nav.api.load({open:!0,href:"filluser",history:!0})},fail:function(){}})})}},"-26":{message:function(){return b.app.localization.e("Error code: -26")},relay:!0},imageerror:{message:function(){return"An error occurred while loading images. Please try again"}}},b.parseUrl=function(e){e=e.replace("http:","https:").replace("http//","https://");var t,s,n=parseVideo(e),a=null;return n.type&&(a=e,"peertube"==n.type&&(a=`peertube://${n.host_name}/${n.id}`),"youtube"==n.type&&-1<e.indexOf("watch")&&(!(s=e.split("?"))[1]||(t=parameters(s[1])).v&&(a="https://youtu.be/"+t.v,n.id=t.v)),"vimeo"==n.type&&-1==e.indexOf("player")&&(s=(s=e.split("/"))[s.length-1],/[0-9]+/.test(s)&&(a="https://player.vimeo.com/video/"+s+"?portrait=0",n.id=s)),"bitchute"==n.type&&-1==e.indexOf("player")&&(s=(s=(a=(a=e).endsWith("/")?a.substr(0,a.length-1):a).split("/"))[s.length-1])[1]&&-1==e.indexOf("?")&&(a=`https://www.bitchute.com/video/${s}/`,n.id=s),n.url=a),n},b.objects={graph:function(e){var l=this;return l.el=e.el,l.series=[],l.id=makeid(),l.options=e.chart||{},l.shell=e.shell,l.stock=e.stock,l.unit=e.unit||"number",l.chartOptions=function(e){var t=function(e){(e=e||{}).sizeRatio||(e.sizeRatio=1);var t={colors:[],chart:{style:{fontFamily:"'Segoe UI', SegoeUI, 'Helvetica Neue', Helvetica, Arial, sans-serif"},backgroundColor:"transparent",spacing:[8*e.sizeRatio,8*e.sizeRatio,8*e.sizeRatio,8*e.sizeRatio],type:"spline"},rangeSelector:{inputEnabled:!1,selected:3},title:{text:""},subtitle:{text:""},exporting:{enabled:!1},xAxis:{crosshair:!0,labels:{enabled:!0,distance:15*e.sizeRatio,padding:5*e.sizeRatio,style:{fontSize:11*e.sizeRatio+"px",color:"#27a9e6"}},lineWidth:0,minorGridLineColor:"transparent",minorGridLineWidth:0,gridLineColor:"rgb(228, 221, 222)",gridLineWidth:0,minorTickLength:2*e.sizeRatio,tickWidth:+e.sizeRatio,tickColor:"transparent",title:{enabled:!1,text:"Date",y:10*e.sizeRatio,style:{fontSize:10*e.sizeRatio+"px",color:"rgb(30, 35, 40)"}},minPadding:.04,maxPadding:.04,offset:20*e.sizeRatio,tickPixelInterval:100*e.sizeRatio},yAxis:[{minPadding:0,maxPadding:0,offset:10,title:{enabled:!1,text:"",style:{fontSize:10*e.sizeRatio+"px",color:"rgb(30, 35, 40)"}},startOfWeek:0,lineWidth:0,lineColor:"transparent",minorTickLength:0,minorGridLineWidth:1,gridLineColor:"rgb(228, 221, 222)",gridLineWidth:1,tickLength:0,tickPixelInterval:100*e.sizeRatio,opposite:!0,labels:{enabled:!0,style:{fontSize:11*e.sizeRatio+"px",color:"#27a9e6"},padding:5*e.sizeRatio,distance:-25*e.sizeRatio,y:3*e.sizeRatio},tickColor:"rgb(228, 221, 222)"}],tooltip:{backgroundColor:"rgba(247,247,247,1)",crosshairs:!0,formatter:function(e){function t(e){return"datetime"==l.options.xtype?convertDate(dateToStr(e)):e}var s=deep(e.chart,"xAxis.0.userOptions.title.text")||deep(this,"points.0.series.name"),a=s?t(this.x)+" - <b>"+s+"</b><br/>":"<b>"+t(this.x)+"</b><br/>",e=(e.chart.series,this.x,_.clone(this.points)||[]);return _.each(e,function(e){var t=e.series.name,s=e.y,n=deep(e,"point.__view")||l.unit||"number";"dollars"==n&&(s=Number(e.y).toFixed(0),s=b.mp.dollars(s,{precision:0})),"percent"==n&&(s=Number(e.y).toFixed(2),s+=" %"),"number"==n&&(s=Number(s).toFixed(2)),n="","points"==l.options.displayType?e.to_objectGl&&(n=e.to_objectGl.name):e.to_object&&(n="("+e.to_object.Ticker+")"),a+='<span style="color:'+e.series.color+'">●</span> '+t+" "+n+": <b>"+s+"</b><br/>"}),a},shared:!0,useHTML:!0,style:{zIndex:"500"}},legend:{enabled:!0,itemStyle:{fontSize:10*e.sizeRatio+"px","font-weight":"500",padding:10*e.sizeRatio},symbolHeight:14*e.sizeRatio,symbolWidth:14*e.sizeRatio,padding:8*e.sizeRatio,lineHeight:16*e.sizeRatio,margin:24*e.sizeRatio,symbolPadding:2*e.sizeRatio,itemDistance:50*e.sizeRatio,align:"center",labelFormatter:function(){return this.name}},plotOptions:{bar:{dataLabels:{enabled:!0},pointPadding:.1,groupPadding:.1,animation:!1,borderColor:"rgba(52, 100, 166, 0.8)",color:"rgba(52, 100, 166, 0.3)"},pie:{size:"65%",dataLabels:{connectorWidth:+e.sizeRatio,distance:30*e.sizeRatio,connectorPadding:5*e.sizeRatio,padding:5*e.sizeRatio,style:{fontSize:16*e.sizeRatio+"px"}}},column:{animation:!1},bubble:{animation:!1,lineWidth:0,minSize:"4%",maxSize:"10%"},columnrange:{animation:!1,color:"rgba(33,33,33, 0.3)",borderColor:"transparent"},spline:{animation:!1,lineWidth:+e.sizeRatio,marker:{enabled:!0,lineColor:"transparent",radius:2*e.sizeRatio,states:{hover:{lineWidthPlus:0}}},states:{hover:{lineWidth:+e.sizeRatio,lineWidthPlus:0,marker:{fillColor:"#000",lineColor:"#000"},halo:{opacity:0}}}},areaspline:{animation:!1,lineWidth:+e.sizeRatio,fillOpacity:.2,marker:{enabled:!1,lineColor:"transparent",radius:4*e.sizeRatio,symbol:"circle",states:{hover:{lineWidthPlus:0}}},states:{hover:{lineWidth:+e.sizeRatio,lineWidthPlus:0,marker:{fillColor:"#000",lineColor:"#000"},halo:{opacity:0}}}},areasplinerange:{animation:!1,fillOpacity:.2,dashStyle:"dot"}},labels:{style:{fontSize:8*e.sizeRatio+"px"}},credits:{enabled:!1}};return e.pdf&&(t.plotOptions.pie.size="85%",t.legend.enabled=!0,t.chart.backgroundColor="#fff"),t}(e);return t.series=l.series,void 0!==l.options.xAxis&&(t.xAxis.labels.enabled=l.options.xAxis),l.options.bubbleSize&&(t.plotOptions.bubble.maxSize=l.options.bubbleSize),l.options.plotOptionsSeries&&(t.plotOptions.series=l.options.plotOptionsSeries),l.options.xAxisOpposite&&(t.xAxis.opposite=!0),l.options.yAxis&&(t.yAxis=t.yAxis.concat(l.options.yAxis)),l.options.secondYAxis&&t.yAxis.push({minPadding:0,maxPadding:0,offset:10,title:{enabled:!1,text:"",style:{fontSize:10*e.sizeRatio+"px",color:"rgb(30, 35, 40)"}},startOfWeek:0,lineWidth:0,lineColor:"transparent",minorTickLength:0,minorGridLineWidth:1,gridLineColor:"rgb(228, 221, 222)",gridLineWidth:1,tickLength:0,tickPixelInterval:100*e.sizeRatio,labels:{enabled:!0,style:{fontSize:11*e.sizeRatio+"px",color:"#27a9e6"},padding:5*e.sizeRatio,distance:-25*e.sizeRatio,y:3*e.sizeRatio},tickColor:"rgb(228, 221, 222)"}),_.each(t.yAxis,function(e){void 0!==l.options.ypadding&&(e.minPadding=l.options.ypadding,e.maxPadding=l.options.ypadding),void 0!==l.options.ytickAmount&&(e.tickAmount=l.options.ytickAmount)}),void 0!==l.options.xtype&&(t.xAxis.type=l.options.xtype),void 0!==l.options.categories&&(t.xAxis.categories=l.options.categories()),void 0!==l.options.reversed&&(t.xAxis.reversed=l.options.reversed),void 0!==l.options.disableXLabels&&(t.xAxis.labels.enabled=!1),void 0!==l.options.disableYLabels&&(t.yAxis[0].labels.enabled=!1,t.yAxis[0].offset=0),void 0!==l.options.yGridLineWidth&&(t.yAxis[0].gridLineWidth=l.options.yGridLineWidth),void 0!==l.options.disableTooltip&&(t.tooltip.enabled=!1),void 0!==l.options.xtitle&&(t.xAxis.title.enabled=!0,t.xAxis.title.text=l.options.xtitle),void 0!==l.options.ytitle&&(t.yAxis[0].title.enabled=!0,t.yAxis[0].title.text=l.options.ytitle),l.options.defaultTooltip&&delete t.tooltip.formatter,l.options.addLegend&&(t.legend.enabled=!0),l.options.removeLegend&&(t.legend.enabled=!1),l.options.tooltipFormatter&&(t.tooltip.formatter=l.options.tooltipFormatter),t.chart.type=l.options.type,t.chart.height=l.options.height||400,l.options.width&&(t.chart.width=l.options.width),t.yAxis[0].floor=l.options.floor,_.each(t.yAxis,function(n,e){n.labels.formatter=function(){var e=l.unit||"number";l.options.views&&l.options.views[n.index]&&(e=l.options.views[n.index].v);var t=this.value,s=this.axis.defaultLabelFormatter.call(this);return"number"!=e&&"dollars"!=e||(s=compressedNumber(t,2)),"number"==e?s:"percent"==e?s+" %":"dollars"==e?"$ "+s:void 0}}),void 0!==l.options.ymax&&(t.yAxis[0].max=l.options.ymax),void 0!==l.options.ymin&&(t.yAxis[0].min=l.options.ymin),t},l.rarefied=function(e,i){return _.each(e,function(e){var t=e.data.length;if(3*i<t){for(var s=t/i,n=[e.data[0]],a=1;a<t-1;a++)a%Number(s.toFixed(0))||n.push(e.data[a]);n.push(e.data[t-1]),e.data=n}}),e},l.exportToPdf=function(e,s,t){t=t||{},e.el.html("<div class='chart'></div>"),e.pdf=!0;var n,a,i,o,r,c,d=l.chartOptions(e);t.prepareOptions&&t.prepareOptions(d),d?(e.maxPointsCount&&l.rarefied(d.series,e.maxPointsCount),n=(deep(d,"chart.height")||400)*e.sizeRatio,a=(deep(d,"chart.width")||700)*e.sizeRatio,(e=e.el.find(".chart")).height(n),e.width(a),d.chart.height=n,d.chart.width=a,d.chart.renderTo=e[0],(i={}).chart=new Highcharts.Chart(d),i.ratio=a/n,i.series=d.series,i.caption=l.options.caption,(o=document.createElement("canvas")).width=a,o.height=n,r=i.chart.getSVG(),(c=new Image).onload=function(){o.getContext("2d").drawImage(c,0,0,a,n);try{i.img=o.toDataURL("image/jpeg")}catch(e){var t=document.createElement("canvas");t.width=a,t.height=n,canvg(t,r,{ignoreDimensions:!0,ignoreMouse:!0,ignoreAnimation:!0,scaleWidth:t.width,scaleHeight:t.height}),i.img=t.toDataURL("image/png"),$(t).remove()}$(o).remove(),s(i)},c.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(r)))):s&&s(null)},l.render=function(e,t){var s,n=(e=e||{}).el||l.el;n&&(s=l.chartOptions(e),e.prepareOptions&&e.prepareOptions(s),s?(e.maxPointsCount&&l.rarefied(s.series,e.maxPointsCount),l.shell({name:"graph",el:n,animation:"fadeIn",data:{me:l,id:l.id,options:l.options}},function(e){s.chart.renderTo=e.el.find('.chart[id="'+l.id+'"]')[0],l.stock?l.chart=new Highcharts.stockChart(s):l.chart=new Highcharts.Chart(s),t&&t(e.el)})):t&&t(null))},l.destroy=function(){l.chart.destroy(),l.el.html("")},l}},b.clbks={online:{_app:function(){b.app.options.successHandler({online:!0})}},offline:{},_focus:{},focus:function(t){u.user.isState(function(e){e&&(b.update(),_.each(b.clbks._focus,function(e){e(t)}))})},api:{actions:{subscribe:{},unsubscribe:{},subscribePrivate:{},blocking:{},unblocking:{}}}},b.papi={horizontalLenta:function(e,t,n){(n=n||{}).horizontal=!0;var s='<div class="horizontalLentaWrapper"><div class="horizontalLentacaption"><span>'+(n.caption||"")+`</span></div><div class="showmorebywrapper"><div class="showmoreby"></div></div>
            <div class="controlleft controlhor" dir="left"><i class="fas fa-chevron-left"></i></div><div class="controlright controlhor"><i class="fas fa-chevron-right"></i></div>
            </div>`;e.html(s),n.window=e.find(".showmorebywrapper"),s=e.find(".showmoreby"),b.papi.clenta(s,t,n),e.find(".controlhor").on("click",function(){var e=$(this).attr("dir")||"right",t=n.window.scrollLeft(),s=.9*n.window.width();n.window.animate({scrollLeft:s=t+("left"==e?-s:s)},100)})},clenta:function(e,t,s){var n=(s=s||{}).id||makeid();u.nav.api.load({open:!0,id:"lenta",el:e,eid:n,mid:n,animation:!1,essenseData:{author:s.author,video:s.video,comments:s.comments,enterFullScreenVideo:s.fullscreenvideo,openapi:s.openapi,renderclbk:s.renderclbk,ready:s.ready,window:s.window,horizontal:s.horizontal,second:!0,loaderkey:s.loaderkey,hasshares:s.hasshares,opensvi:s.opensvi,from:s.from,compact:s.compact,r:s.r,shuffle:s.shuffle,page:s.page,period:s.period,filter:s.filter,ended:s.ended,afterload:s.afterload},clbk:t})},lenta:function(e,t,s,n){n=n||{};var a=makeid();_.isArray(e)||(e=[e]),u.nav.api.load({open:!0,id:"lenta",el:t,eid:a,mid:a,animation:!1,essenseData:{notscrollloading:!0,txids:e,comments:n.comments,enterFullScreenVideo:n.fullscreenvideo,openapi:n.openapi,renderclbk:n.renderclbk,ready:n.ready,second:!0},clbk:s})},post:function(t,s,n,a){a=a||{},b.sdk.node.shares.getbyid(t,function(e){b.sdk.node.shares.users(e,function(){u.nav.api.load({open:!0,href:"post",el:s,eid:t+(a.eid||""),clbk:n,essenseData:{hr:a.hr,share:t,removemargin:!0,repost:a.repost,level:a.level,fromempty:a.fromempty,nocommentcaption:a.nocommentcaption,eid:t+(a.eid||""),comments:a.comments,video:a.video,autoplay:a.autoplay,opensvi:a.opensvi}})})})},channel:function(e,t,s,n){b.sdk.users.get(e,function(){u.nav.api.load({open:!0,href:"channel",el:t,eid:e+(n.eid||""),clbk:s,essenseData:{id:e}})})},comment:function(e,t,s,n){u.nav.api.load({open:!0,id:"comments",el:t,eid:e+"post",essenseData:{txid:e,showall:!0,init:!0,preview:!1,fromtop:!0,commentPs:n.commentPs,openapi:n.openapi},clbk:s})}},b.ui={images:function(e,t,s){return _.isArray(e)||(e=[e]),!!(t=t||e[0])&&(e=_.map(e,function(e){return{src:e}}),b.app.nav.api.load({open:!0,href:"imagegallery",inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:e,gid:"uiimages"},clbk:function(){s&&s()}}),!0)},share:function(e){e=e||{},globalpreloader(!0,!0),setTimeout(function(){u.nav.api.load({open:!0,id:"share",inWnd:!0,eid:"postin",clbk:function(e,t){globalpreloader(!1)},essenseData:{close:function(){},post:function(){},absolute:!0,repost:e.repost}})},50)},showmykeyfast:function(){u.nav.api.load({open:!0,inWnd:!0,href:"pkview",essenseData:{dumpkey:!0},clbk:function(e,t){}})},showmykey:function(e){e=e||{},dialog({html:e.text||b.app.localization.e("e13188"),btn1text:b.app.localization.e("e13261"),btn2text:e.faillabel||b.app.localization.e("e13262"),class:"zindex accepting accepting2 ",success:function(){isMobile()||u.nav.api.load({open:!0,href:"userpage?id=accounts",history:!0,handler:!0,essenseData:{dumpkey:!isMobile()},clbk:function(e,t){}}),u.nav.api.load({open:!0,inWnd:!isMobile(),history:isMobile(),href:"pkview",essenseData:{dumpkey:!0},clbk:function(e,t){}})},fail:function(){e.fail&&e.fail()}})},wallet:{send:function(s,n,a){s=s||{};var i="papiwalletsend";globalpreloader(!0,!0),s.action=s.htls?"htls":"send",s.class="api",s.api=!0;var o=null;return new Promise((t,e)=>{s.sendclbk=function(e){t(e),o&&o.closeContainer()},u.nav.api.load({open:!0,id:"wallet",inWnd:!a,el:a||null,eid:i,mid:i,animation:!1,essenseData:s,clbk:function(e,t){o=t,globalpreloader(!1),n&&n(e,t)}})})}}},b.api={keypair:function(t){var s=null;if(bitcoin.bip39.validateMnemonic(t))var e=bitcoin.bip39.mnemonicToSeedSync(t),e=bitcoin.bip32.fromSeed(e).derivePath(u.platform.sdk.address.path(0)).toWIF(),s=bitcoin.ECPair.fromWIF(e);else try{s=bitcoin.ECPair.fromPrivateKey(Buffer.from(t,"hex"))}catch(e){try{s=bitcoin.ECPair.fromWIF(t)}catch(e){}}return s},clearname:function(e){return(e||"").replace(/[^a-zA-Z0-9_ ]/g,"")},name:function(e){return(e=deep(u,"platform.sdk.usersl.storage."+e+".name")||deep(u,"platform.sdk.users.storage."+e+".name"))&&this.clearname(e)},authorlink:function(e){var t=deep(u,"platform.sdk.usersl.storage."+e+".name");return t?encodeURIComponent(t.toLowerCase()):"author?address="+e},upbutton:function(t,s){if("undefined"!=typeof window){function n(){return 1280<a.width()?"full":"mini"}s=s||{};var e=this,a=$(window),i=null,o=null,r={resize:function(){var e=n();e!=o&&(i.css("right",""),i.css("top",""),i.css("bottom",""),i.css("width","")),"full"==(o=e)&&(s.rightEl&&i.css("width",s.rightEl.offset().left+"px"),s.top&&i.css("top",s.top()))},scroll:function(){a.scrollTop()>=(void 0===s.scrollTop?250:s.scrollTop)?i.addClass("active"):i.removeClass("active")},click:function(){s.click?s.click(i.hasClass("active")):_scrollTop(0)}};return e.init=function(){var e;o=n(),e="",e+='<div class="upbutton '+(s.class||"")+'">',e+='<div class="full">',e+='<div class="fulltable table">',e+='<div class="fullcell icon">',e+=s.icon||'<i class="fas fa-chevron-up"></i>',e+="</div>",e+='<div class="fullcell label">',e+=s.text||"To the top",e+="</div>",e+='<div class="fullcell label likeicon">',e+="</div>",e+="</div>",e+="</div>",e+='<div class="mini">',e+=s.icon||'<i class="fas fa-chevron-up"></i>',e+="</div>",t.html(e+="</div>"),i=t.find(".upbutton"),window.addEventListener("scroll",r.scroll),window.addEventListener("resize",r.resize),i.swipe({tap:r.click}),r.resize(),r.scroll()},e.apply=function(){r.resize(),r.scroll()},e.destroy=function(){window.removeEventListener("scroll",r.scroll),window.removeEventListener("resize",r.resize),t.html("")},e.init(),e}},plissing:function(n){var a=function(){var e=n.el.find(".plissingCnt"),t=[];n.left&&t.push("left"),n.white&&t.push("white"),e.length&&a.remove(),n.el.append('<div class="plissingCnt"></div>'),(e=n.el.find(".plissingCnt")).addClass(t.join(" "));var s="",t=function(){s+='            <div class="plissingWrapperCell">',s+='                <div class="pilsing">',s+="                    <div></div>",s+="                    <div></div>",s+="                </div>",s+="            </div>"};s+='<div class="plissingWrapper">',s+='<div class="plissingWrapperTable table">',n.left||t(),s+='            <div class="plissingTipCell">',s+='                <div class="plissingTip all">',s+=n.text||"",s+="                </div>",n.textHover&&(s+='                <div class="plissingTip hover">',s+=n.textHover||"",s+="                </div>"),s+="            </div>",n.left&&t(),s+="    </div>",s+="</div>",e.html(s),setTimeout(function(){e.addClass("active")},200)};return this.init=function(){a()},this.destroy=function(){var e=n.el.find(".plissingCnt");e.removeClass("active"),setTimeout(function(){e.remove()},300)},this.init(),this},tooltip:function(s,e,n,t){if(!s.hasClass("tooltipstered")){var a={debug:!1,contentAsHTML:!0,interactive:!0,interactiveTolerance:400,onlyOne:!0,delay:100,trigger:"click"};return a.theme=(t=t||{}).theme||"lighttooltip",a.position||(a.position="left"),a.height||(a.height=420),a.maxWidth||(a.maxWidth=270),a.content=e,a.functionReady=function(e,t){n&&n($(t.tooltip),s)},a.functionInit=function(e,t){},s.tooltipster(a),s.tooltipster("show"),s}},electron:{storage:{},notifications:function(e,t){"undefined"!=typeof _Electron&&(this.storage[t]=e,e=_.reduce(this.storage,function(e,t){return e+t},0),electron.ipcRenderer.send("update-badge",e||null),electron.ipcRenderer.send("update-badge-tray",e||null))}},inputs:{user:function(s){function n(){s.el}return s.onChange=function(e){s._onChange&&s._onChange(e);var t=!1;try{t=bitcoin.address.fromBase58Check(e)}catch(e){}t?b.sdk.users.get(e,function(){b.sdk.users.storage[e],n()}):n()},s}},actions:{unsubscribe:function(a,i){var e=new Unsubscribe;e.address.set(a),topPreloader(10),b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s,n;e&&(s=deep(u,"platform.sdk.users.storage."+b.app.user.address.value.toString("hex")),n=b.sdk.users.storage[a],s&&s.removeRelation({adddress:a}),n&&n.removeRelation(a,"subscribers"),n=deep(b.clbks,"api.actions.unsubscribe")||{},_.each(n,function(e){e(a)})),topPreloader(100),i(e,t)})},subscribe:function(a,i){var e=new Subscribe;e.address.set(a),topPreloader(10),b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s,n;e&&(s=deep(u,"platform.sdk.users.storage."+b.app.user.address.value.toString("hex")),n=b.sdk.users.storage[a],s&&(s.removeRelation({adddress:a}),s.addRelation({adddress:a,private:!1}),s.removeRelation(a,"recomendedSubscribes")),n&&(n.removeRelation(a,"subscribers"),n.addRelation(a,"subscribers")),n=deep(b.clbks,"api.actions.subscribe")||{},_.each(n,function(e){e(a)}),b.sdk.activity.adduser("subscribe",a)),topPreloader(100),i(e,t)})},blocking:function(n,a){var e=new Blocking;e.address.set(n),topPreloader(10),b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s;e&&((s=deep(u,"platform.sdk.users.storage."+b.app.user.address.value.toString("hex")))&&s.addRelation(n,"blocking"),s=deep(b.clbks,"api.actions.blocking")||{},_.each(s,function(e){e(n)})),topPreloader(100),a(e,t)})},unblocking:function(n,a){var e=new Unblocking;e.address.set(n),topPreloader(10),b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s;e&&(s=deep(u,"platform.sdk.users.storage."+b.app.user.address.value.toString("hex")),b.sdk.users.storage[n],s&&s.removeRelation(n,"blocking"),s=deep(b.clbks,"api.actions.unblocking")||{},_.each(s,function(e){e(n)})),topPreloader(100),a(e,t)})},notificationsTurnOff:function(e,t){b.api.actions.subscribe(e,t)},subscribeWithDialog:function(t,e){menuDialog({items:[{text:b.app.localization.e("e13263"),class:"itemmain",action:function(e){b.api.actions.notificationsTurnOn(t,e)}},{text:b.app.localization.e("e13264"),action:function(e){b.api.actions.subscribe(t,e)}}]})},notificationsTurnOn:function(a,i){var e=new SubscribePrivate;e.address.set(a),topPreloader(10),b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s,n;e&&(s=deep(u,"platform.sdk.users.storage."+b.app.user.address.value.toString("hex")),n=b.sdk.users.storage[a],s&&(s.removeRelation({adddress:a}),s.addRelation({adddress:a,private:!0}),s.removeRelation(a,"recomendedSubscribes")),n&&(n.removeRelation(a,"subscribers"),n.addRelation(a,"subscribers")),n=deep(b.clbks,"api.actions.subscribePrivate")||{},b.sdk.activity.adduser("subscribe",a),_.each(n,function(e){e(a)})),topPreloader(100),i(e,t)})},htls:function(e){b.app.platform.ui.wallet.send({id:e},function(){})}},metmenu:function(n,a,i){var e,o=b.sdk.node.shares.storage.trx[a];o||(e=_.find(b.sdk.node.transactions.temp.share,function(e){return e.txid==a}))&&((o=new pShare)._import(e),o.temp=!0,o.address=b.app.platform.sdk.address.pnet().address);var r=o.address,c={};c.share=o,b.app.platform.sdk.ustate.me(function(s){p.fastTemplate("metmenu",function(e,t){b.api.tooltip(n,function(){return c.share=b.sdk.node.shares.storage.trx[a],c.mestate=s,t(c)},function(e){e.find(".opennewwindow").on("click",function(){var e="https://pocketnet.app/";c.share.itisvideo()?e+="index?video=1&v="+a:e+="index?post?s="+a,(window.cordova?cordova.InAppBrowser:window).open(e,"_blank")}),e.find(".htls").on("click",function(){i.htls(a),n.tooltipster("hide")}),e.find(".socialshare").on("click",function(){i.sharesocial(a),n.tooltipster("hide")}),e.find(".subscribe").on("click",function(){b.api.actions.subscribe(r,function(e,t){e||b.errorHandler(t,!0)}),n.tooltipster("hide")}),e.find(".unsubscribe").on("click",function(){b.api.actions.unsubscribe(r,function(e,t){e||b.errorHandler(t,!0)}),n.tooltipster("hide")}),e.find(".complain").on("click",function(){i.complain(a),n.tooltipster("hide")}),e.find(".donate").on("click",function(){i.donate(a),n.tooltipster("hide")}),e.find(".block").on("click",function(){b.api.actions.blocking(r,function(e,t){e||b.errorHandler(t,!0)}),n.tooltipster("hide")}),e.find(".edit").on("click",function(){var s=null,e=c.share.alias(),t=e.shash();"a"==e.settings.v?u.nav.api.load({open:!0,href:"article",inWnd:!0,history:!0,essenseData:{share:e,hash:t,save:function(e){},close:function(){},complete:function(){},closeContainer:function(){}}}):u.nav.api.load({open:!0,id:"share",animation:!1,inWnd:!0,_id:c.share.txid,essenseData:{share:e,notClear:!0,hash:t,absolute:!0,cancel:function(){var e=deep(s,"container.close");e&&e()},post:function(){var e=deep(s,"container.close");e&&e()}},clbk:function(e,t){s=t}}),n.tooltipster("hide")}),e.find(".videoshare").on("click",function(){i.videoShare(o),n.tooltipster("hide")})})},c,"components/lenta")})}},b.sdk={registrations:{storage:{},clbks:{},remove:function(t){var e;(t=!t&&b.sdk.address.pnet()?b.sdk.address.pnet().address:t)&&(e=b.sdk.registrations.storage[t],delete b.sdk.registrations.storage[t],e&&(b.sdk.registrations.save(),_.each(this.clbks,function(e){e(t)})))},add:function(t,e){b.sdk.registrations.storage[t]=e||!0,b.sdk.registrations.save(),_.each(this.clbks,function(e){e(t)})},showprivate:function(e){!e&&b.sdk.address.pnet()&&(e=b.sdk.address.pnet().address);var t=b.sdk.registrations.storage[e];return!b.sdk.registrations.storage[e+"rm"]&&t&&t<=5},donotshowprivate:function(t){!t&&b.sdk.address.pnet()&&(t=b.sdk.address.pnet().address),b.sdk.registrations.storage[t+"rm"]=!0,b.sdk.registrations.save(),_.each(this.clbks,function(e){e(t)})},load:function(){var e={},t=localStorage.registrations||"{}";if(t)try{e=JSON.parse(t)}catch(e){}b.sdk.registrations.storage=e},save:function(){localStorage.registrations=JSON.stringify(b.sdk.registrations.storage||{})}},relayTransactions:{storage:{},arranges:["userInfo"],send:function(d){b.app.user.isState(function(e){var c;e&&(c=b.sdk.relayTransactions.get(),b.sdk.address.pnet(),_.isEmpty(c)?d&&d():b.sdk.node.transactions.get.balance(function(e){var s=_.clone(b.sdk.relayTransactions.arranges);_.each(c,function(e,t){-1==_.indexOf(s,t)&&s.push(t)}),lazyEach({array:s,sync:!0,action:function(e){var r=e.item,t=c[r];t&&t.length?("userInfo"==r&&(t=[t[t.length-1]]),lazyEach({sync:!0,array:t,action:function(a){var i,o=a.item;o.sending?a.success():((i=new kits.c[o.type]).import(o),i.fromrelay=!0,o.sending=!0,b.sdk.node.transactions.create.commonFromUnspent(i,function(e,t){var s=b.errors[t]||{};if(delete o.sending,t&&"userInfo"==r){var n=bitcoin.crypto.hash256(JSON.stringify(o));return"18"==t&&n!=l&&(l=n,u.nav.api.load({open:!0,href:"test",inWnd:!0,essenseData:{caption:b.app.localization.e("e13265"),failedrelay:i}})),void(d&&d())}t&&(!s||s.relay)||("userInfo"==r?delete c[r]:c[r]=_.filter(c[r],function(e){return e.txid!=o.txid}),b.sdk.relayTransactions.save()),a.success()}))},all:{success:e.success}})):e.success()},all:{success:function(){d&&d()}}})}))})},withtemp:function(e){var t=b.sdk.relayTransactions.get()[e]||[],e=_.toArray(b.sdk.node.transactions.temp[e]||{});return t.concat(e)},get:function(){var e=b.sdk.address.pnet(),t=b.sdk.relayTransactions;return e?(e=b.sdk.address.pnet().address,t.storage[e]||{}):{}},add:function(e,t){var s=b.sdk.relayTransactions;s.storage[e]||(s.storage[e]={}),s.storage[e][t.type]||(s.storage[e][t.type]=[]),s.storage[e][t.type].push(t),s.save()},load:function(){var e={},t=localStorage.relayTransactions||"{}";if(t)try{e=JSON.parse(t)}catch(e){}b.sdk.relayTransactions.storage=e},save:function(){localStorage.relayTransactions=JSON.stringify(b.sdk.relayTransactions.storage||{})}},experiment:{pfa:function(){}},imagesH:{storage:{},add:function(e,t){var s=b.sdk.imagesH;s.storage[e]=t,s.save()},delete:function(t,s){var n=b.sdk.imagesH;n.storage[t]?b.app.ajax.run({type:"DEL",imgur:!0,data:{Action:"image/"+n.storage[t]},success:function(e){delete n.storage[t],s&&s()},fail:function(){s&&s()}}):s&&s()},save:function(){localStorage.imagesH=JSON.stringify(b.sdk.imagesH.storage||{})},load:function(e){var t={};try{t=JSON.parse(localStorage.imagesH||"{}")}catch(e){}b.sdk.imagesH.storage=t,e&&e()}},articles:{storage:[],empty:function(e){return{id:e||makeid(),caption:{value:""},images:[],content:null,tags:[],u:""}},copy:function(e){var s=this.empty();return s.id=e.id,s.u=e.u,s.caption.value=e.caption.value,s.images=_.clone(e.images),_.each(e.content,function(e,t){s.content[t]=_.clone(e)}),s},getImages:function(e){(t=$("<div>")).html(e);var t=t.find(".medium-insert-images img"),s=[];return $.each(t,function(){var e=$(this).attr("src");e&&e.length<1e3&&s.push(e)}),s},getVideos:function(e){(t=$("<div>")).html(e);var t=t.find(".js-player"),s=[];return $.each(t,function(){var e={type:$(this).attr("data-plyr-provider"),id:$(this).attr("data-plyr-embed-id")};e.type&&e.id&&s.push(e)}),s},lightVideo:function(e){return _.each(e,function(e,t){var s=e.value,n=$("<div>");n.html(s),s=n.find(".plyrvideo"),$.each(s,function(){var e=$(this);e.html('<div class="js-player" data-plyr-provider="'+e.attr("provider")+'" data-plyr-embed-id="'+e.attr("eid")+'"></div>')}),e.value=n.html()}),e},echo:function(e){return _.reduce(e.content||{},function(e,t){return e+t.value},"")},save:function(){var e=b.sdk.address.pnet().address;localStorage[e+"articles"]=JSON.stringify(b.sdk.articles.storage||[])},load:function(){var e={},t=b.sdk.address.pnet().address;if(t=localStorage[t+"articles"]||"[]")try{e=JSON.parse(t)}catch(e){}return e},init:function(e){var t=b.sdk.articles.load();b.sdk.articles.storage=t,e&&e()}},theme:{all:{white:{name:b.app.localization.e("e13266"),class:"stwhite"},black:{name:b.app.localization.e("e13267"),class:"stblack"}},default:"white",current:null,save:function(){var e=b.sdk.theme.current;localStorage.usertheme=e},load:function(e){var t=b.sdk.theme;t.current=localStorage.usertheme||t.default,t.set(),e&&e()},set:function(e){var t=b.sdk.theme,s=$("html");(e=e||t.current||t.default)&&t.all[e]&&(_.each(t.all,function(e){s.removeClass(e.class)}),s.addClass(t.all[e].class),t.current=e,t.save())}},usersettings:{meta:{win:{name:b.app.localization.e("e13268"),id:"win",type:"BOOLEAN",value:!0},transactions:{name:b.app.localization.e("e13269"),id:"transactions",type:"BOOLEAN",value:!0},upvotes:{name:b.app.localization.e("e13270"),id:"upvotes",type:"BOOLEAN",value:!0},downvotes:{name:"Downvotes receive",id:"downvotes",type:"BOOLEAN",value:!1},comments:{name:b.app.localization.e("e13271"),id:"comments",type:"BOOLEAN",value:!0},answers:{name:b.app.localization.e("e13272"),id:"answers",type:"BOOLEAN",value:!0},followers:{name:b.app.localization.e("e13273"),id:"followers",type:"BOOLEAN",value:!0},rescued:{name:b.app.localization.e("e13274"),id:"rescued",type:"BOOLEAN",value:!0},commentScore:{name:b.app.localization.e("e13275"),id:"commentScore",type:"BOOLEAN",value:!0},embedvideo:{name:b.app.localization.e("e13276"),id:"embedvideo",type:"BOOLEAN",value:!0},videoautoplay:{name:b.app.localization.e("e13277"),id:"videoautoplay",type:"BOOLEAN",value:!0},autostart:{name:b.app.localization.e("e13278"),id:"autostart",type:"BOOLEAN",value:void 0},vidgetchat:{name:b.app.localization.e("e13279"),id:"vidgetchat",type:"BOOLEAN",value:!0},vidgettags:{name:b.app.localization.e("e13280"),id:"vidgettags",type:"BOOLEAN",value:!0},vidgetlastcomments:{name:b.app.localization.e("e13281"),id:"vidgetlastcomments",type:"BOOLEAN",value:!0},vidgetstaking:{name:"Staking Pocketcoin vidget",id:"vidgetstaking",type:"BOOLEAN",value:!0},telegram:{type:"STRINGANY",name:b.app.localization.e("e13282"),id:"telegram",placeholder:b.app.localization.e("e13282"),value:JSON.parse(localStorage.getItem("telegrambot"))&&JSON.parse(localStorage.getItem("telegrambot")).token||""},tgfrom:{type:"VALUES",name:b.app.localization.e("e13283"),id:"tgfrom",placeholder:b.app.localization.e("e13284"),possibleValues:[],possibleValuesLabels:[],value:""},tgto:{type:"VALUES",name:b.app.localization.e("e13287"),id:"tgto",placeholder:b.app.localization.e("e13284"),defaultValue:"",value:"",possibleValues:[],possibleValuesLabels:[]},tgfromask:{name:b.app.localization.e("e13285"),id:"tgfromask",type:"BOOLEAN",value:!1},tgtoask:{name:b.app.localization.e("e13286"),id:"tgtoask",type:"BOOLEAN",value:!1},enablePeertube:{name:"Use PeerTube for uploading videos",id:"enablePeertube",type:"BOOLEAN",value:!1},hierarchicalShares:{name:"Hierarchical Post Feed",id:"hierarchicalShares",type:"BOOLEAN",value:!1},historicalShares:{name:"Historical Post Feed",id:"historicalShares",type:"BOOLEAN",value:!1}},create:function(e){var t=b.sdk.usersettings.meta;return new Parameter(t[e])},createall:function(){var s=b.sdk.usersettings.create,e=b.sdk.usersettings.meta,n={};return _.each(e,function(e,t){n[t]=s(t)}),n},compose:function(e){var i=b.sdk.usersettings,t=i.createall(),o=i.meta,s={notifications:{class:"notifications",name:b.app.localization.e("notifications"),options:{win:t.win,transactions:t.transactions,upvotes:t.upvotes,downvotes:t.downvotes,comments:t.comments,answers:t.answers,followers:t.followers,rescued:t.rescued,commentScore:t.commentScore}},video:{name:b.app.localization.e("video"),options:{embedvideo:t.embedvideo,videoautoplay:t.videoautoplay}}};return b.released.vidgets.staking||delete s.vidgets.options.vidgetstaking,b.app.user.features.telegram&&(s.integrations={name:b.app.localization.e("e13289"),options:{telegram:t.telegram,tgto:t.tgto,tgtoask:t.tgtoask}}),electron&&(s.system={name:b.app.localization.e("system"),options:{autostart:t.autostart}}),_.each(t,function(e,a){e.onChange=function(e){var t;if("BOOLEAN"===o[a].type&&(o[a].value=boolnum(e)),"STRINGANY"===o[a].type&&(o[a].value=e),"VALUES"===o[a].type&&(t=o[a].possibleValues.indexOf(String(e)),o[a].value=o[a].possibleValuesLabels[t],o[a].valueId=Number(e)),i.save(),electron&&"autostart"==a){const s=require("electron-is");if(!s.macOS()){const n=require("auto-launch");let e=new n({name:"Pocketnet",path:electron.remote.app.getPath("exe"),isHidden:!0});o[a].value?e.enable():e.disable()}}window.cordova}}),{c:s,o:t}},save:function(){var n={},a=b.sdk.usersettings.meta;_.each(a,function(e,t){var s;"VALUES"===e.type?"tgto"===t||"tgfrom"===t?(s=a.telegram&&a.telegram.value)&&(n[t]={...a[t],[s]:{possibleValues:e.possibleValues&&e.possibleValues.map(e=>String(e)),possibleValuesLabels:e.possibleValuesLabels,value:e.value}}):(n[t]={},n[t].possibleValues=e.possibleValues&&e.possibleValues.map(e=>String(e)),n[t].possibleValuesLabels=e.possibleValuesLabels,n[t].value=e.value):n[t]=e}),localStorage.usersettings=JSON.stringify(n)},load:function(){var e={},t=localStorage.usersettings;if(t)try{e=JSON.parse(t)}catch(e){}return e},init:function(t){var e=b.sdk.usersettings.load(),n=b.sdk.usersettings.meta;if(b.app.platform.sdk.address.pnet()&&b.istest()?b.app.user.features.telegram=1:b.app.user.features.telegram=0,_.each(e,function(e,t){var s;n[t]&&("object"==typeof e?n&&n[t]&&("tgto"===t||"tgfrom"===t?(s=n.telegram&&n.telegram.value)&&(n[t]=e,n[t].value=e[s].value,n[t].possibleValues=e[s].possibleValues&&e[s].possibleValues.map(function(e){return String(e)}),n[t].possibleValuesLabels=e[s].possibleValuesLabels):(n[t].value=e.value,n[t].possibleValues=e.possibleValues&&e.possibleValues.map(function(e){return String(e)}),n[t].possibleValuesLabels=e.possibleValuesLabels)):n[t].value=e,"telegram"===t&&b.app.platform.sdk.address.pnet()&&b.istest()&&-1===location.href.indexOf("userpage?id=usersettings")&&b.app.platform.sdk.system.get.telegramGetMe(e.value))}),electron){const s=require("electron-is");if(s.macOS())t&&t();else{const a=require("auto-launch");let e=new a({name:"Pocketnet",path:electron.remote.app.getPath("exe"),isHidden:!0});void 0===n.autostart.value&&(e.enable(),n.autostart.value=!0,b.sdk.usersettings.save()),e.isEnabled().then(e=>{n.autostart.value=e,t&&t()}).catch(e=>{n.autostart.value=isEnabled,t&&t()})}}else t&&t()}},keys:{clbks:{},haskeys:function(){b.sdk.keys.need().then(e=>Promise.reject("empty")).catch(e=>"exist"==e?Promise.resolve():Promise.reject(e))},error:function(e){dialog({html:"Pocketnet chat ask you to generate encryption keys. But some error with your profile update was occuried:<br><b>"+e+"</b>",btn1text:"Edit profile",class:"one",success:function(){b.app.nav.api.load({open:!0,href:"userpage?id=test",history:!0})}})},init:function(){return b.sdk.keys.need().then(e=>{if(b.loadingWithErrors)return Promise.reject("loadingWithErrors");var t=new UserInfo;t.name.set(e.name),t.language.set(e.language),t.about.set(e.about),t.site.set(e.site),t.image.set(e.image),t.addresses.set(e.addresses),t.ref.set(e.ref),t.keys.set(_.map(b.app.user.cryptoKeys(),function(e){return e.public}));var s=t.validation();return s?(b.sdk.keys.error(e="pocketnet"==s?"To avoid user confusion using Pocketnet in name is reserved":"namelength"==s?"The name length can be more than 20 symbols":"Undefined Error"),Promise.reject(s)):new Promise((s,n)=>{dialog({html:"Pocketnet chat ask you to generate encryption keys. Do you want to proceed?",btn1text:"Generate Encryption Keys",btn2text:b.app.localization.e("dno"),success:function(){b.sdk.node.transactions.create.commonFromUnspent(t,function(e,t){e?b.sdk.users.getone(b.app.platform.sdk.address.pnet().address,function(){s("processing")}):(b.sdk.keys.error(b.errorHandler(t).text()),n(t))})},fail:function(){n("no")},close:function(){n("close")}})})}).catch(e=>Promise.resolve(e))},need:function(){return new Promise((t,s)=>{b.app.user.isState(function(e){return e?0<_.toArray(b.sdk.node.transactions.temp.userInfo||{}).length||b.sdk.address.pnet()&&0<deep(b.sdk.relayTransactions.storage,b.sdk.address.pnet().address+".userInfo.length")?s("processing"):!(e=b.sdk.user.storage.me)||_.isEmpty(e)?s("me"):e.temp||e.relay||e.fromstorage?s("temprelaystorage"):e.keys&&e.keys.length?s("exist"):t(e):void s("state")})})}},user:{storage:{},extendMe:function(e){deep(b,"sdk.node.transactions.temp.subscribe")},meUpdate:function(e){b.sdk.user.get(e,!0)},get:function(a,e){var i=b.sdk.user.storage;b.sdk.user._get(function(e,t){var s,n;!t&&b.sdk.address.pnet()&&(s=b.sdk.address.pnet().address,_.isEmpty(e)?(e=JSON.parse(b.app.settings.get(s,"last_user")||"{}"),_.isEmpty(e)||((n=new pUserInfo)._import(e),n.address=s,n.regdate=new Date,n.regdate.setTime(1e3*e.regdate),n.fromstorage=!0,b.sdk.usersl.storage[s]=e=n,b.sdk.users.storage[s]=n,i.me=n)):b.app.settings.set(s,"last_user",JSON.stringify(e))),a&&a(e,t)},e),u.settings.set()},_get:function(e,t){var s,n,a,i,o=b.sdk.user.storage;!o.me||t?(o.me={},s=!1,(a=deep(b,"sdk.node.transactions.temp.userInfo"))&&!_.isEmpty(a)?(s=!0,(i=new pUserInfo)._import(_.toArray(a)[0]),(o.me=i).temp=!0,e&&e(o.me,s)):b.sdk.address.pnet()?(n=b.sdk.address.pnet().address,(t=deep(b.sdk.relayTransactions.storage,n+".userInfo"))&&t.length?(s=!0,a=t[t.length-1],(i=new pUserInfo)._import(a),(o.me=i).relay=!0,e&&e(o.me,s)):b.sdk.users.get(n,function(){o.me=b.sdk.users.storage[n]||{},e&&e(o.me,s)})):e&&e(o.me)):e&&e(o.me)},waitActions:function(s){b.sdk.node.transactions.get.unspent(function(e){var t="inf";_.each(e,function(e){e=b.sdk.node.transactions.waitSpend(e),("inf"==t||e<t)&&(t=e)}),b.sdk.node.transactions.haveTemp()&&("inf"==t||10<t)&&(t=10),s&&s(t)})},subscribeRef:function(e){var n=b.app.platform.sdk.address.pnet().address,a=localStorage[n+"subscribeRef"];a&&(delete localStorage.ref,b.sdk.users.get(a,function(){var s=b.sdk.usersl.storage[a];s&&b.sdk.node.transactions.get.unspents(function(e){b.sdk.node.transactions.get.canSpend([n],function(e){var t;e&&(delete localStorage[n+"subscribeRef"],t=s.image,e='<div class="refaddWrapper">',e+='<div class="refaddHeader">',e+=b.app.localization.e("e13290")+" "+(s.name||a)+"?",e+="</div>",e+='<div class="refaddTable table">',e+='<div class="imageCell">',e+='<div class="usericon" image="'+(t||"")+'">',t||(e+='<svg width="40" height="40" data-jdenticon-value="'+a+'"></svg>'),e+="</div>",e+="</div>",e+='<div class="nameCell">',e+=s.name||a,e+="</div>",e+="</div>",e+="</div>",dialog({html:e,btn1text:b.app.localization.e("dyes"),btn2text:b.app.localization.e("dno"),class:"refadd",success:function(){topPreloader(10),b.api.actions.notificationsTurnOn(a,function(e,t){t||delete localStorage[n+"subscribeRef"],topPreloader(100)})},fail:function(){delete localStorage[n+"subscribeRef"]},close:function(){delete localStorage[n+"subscribeRef"]}}))})})},!0)),e&&e()},me:function(){var e=b.app.platform.sdk.address.pnet();if(e)return b.app.platform.sdk.users.storage[e.address]}},processes:{storage:{},level:function(t){if(this.storage.p&&void 0!==t){var e=_.find(this.storage.p,function(e){return e.reputation>t&&e.prev<=t});return e?{perc:(t-e.prev)/(e.reputation-e.prev),level:e.level,reputation:e.reputation,bonus:e.bonus}:{level:999,max:!0}}return null},get:function(e){this.storage,e&&e(null)},gifts:function(e){e&&e(null)}},ustate:{storage:{},clbks:{},validationcurrent:function(e,t,s){var n=b.sdk.ustate.storage[e=!e&&state?b.sdk.address.pnet().address:e],a=!0,e=!1;return n?(n.trial?(a=!1,e="trial"):("postunspent"==t&&n.post_unspent<=0&&(a=!1),"scoreunspent"==t&&n.score_unspent<=0&&(a=!1)),a||(e=t)):(a=!1,e="info"),e},attention:function(s,n){var a=b.sdk.ustate.storage,i=b.sdk.address.pnet().address;b.app.user.isState(function(e){if(e){var t=a[i];if(!(e=b.sdk.user.storage.me)||!e.image||!e.name)return void(n&&n("notuserinfo"));if(!t)return void(n&&n("notinfo"));if(t.post_unspent<=s)return void(n&&n("postunspent"));if(t.score_unspent<=s)return void(n&&n("scoreunspent"))}n&&n(!1)})},meUpdate:function(e){b.sdk.ustate.me(e,!0)},me:function(s,e){var n=b.sdk.ustate.storage;b.sdk.ustate._me(function(e){var t;b.sdk.address.pnet()&&(t=b.sdk.address.pnet().address,_.isEmpty(e)?(e=JSON.parse(b.app.settings.get(t,"last_ustate")||"{}"),_.isEmpty(e)||(n[t]=e)):b.app.settings.set(t,"last_ustate",JSON.stringify(e))),s&&s(e)},e),u.settings.set()},_me:function(s,n){var a=b.sdk.ustate.storage;b.app.user.isState(function(e){var t;e?(t=b.sdk.address.pnet().address,b.sdk.ustate.get(t,function(){s&&s(a[t])},n)):s&&s({})})},get:function(e,t,s){_.isArray(e)||(e=[e]);var n=this.storage;b.sdk.node.transactions.temp,s||(e=_.filter(e,function(e){if(!n[e])return!0})),(e=_.uniq(e)).length?b.app.api.rpc("getuserstate",[(e||[]).join(",")]).then(e=>{e&&!_.isArray(e)&&(e=[e]),_.each(e||[],function(e){n[e.address]=e}),t&&t(e)}).catch(e=>{t&&t([])}):t&&t()}},notifications:{storage:{},inited:!1,clbks:{added:{},seen:{}},clearlocalstorage:function(){for(var e=Object.keys(localStorage),t=e.length;t--;)e[t]&&-1<e[t].indexOf("notificationsv")&&-1==e[t].indexOf("notificationsv14")&&localStorage.removeItem(e[t])},load:function(){var e={};try{e=JSON.parse(localStorage[b.sdk.address.pnet().address+"notificationsv14"]||"{}")}catch(e){}this.import(e)},save:function(){this.clearlocalstorage();var e=this.export();b.currentBlock&&1==this.inited&&(e.notifications=_.uniq(e.notifications,function(e){return e.txid||makeid()}),e.notifications=firstEls(e.notifications,50),localStorage[b.sdk.address.pnet().address+"notificationsv14"]=JSON.stringify(e))},seenall:function(){_.each(this.storage.notifications,function(e){e.seen||(e.seen=b.app.platform.currentTime())}),this.save(),_.each(this.clbks.seen,function(e){e()})},seen:function(e){var s=this;_.each(e,function(t){var e=_.find(s.storage.notifications,function(e){return e.txid==t});e&&(e.seen=b.currentTime())}),s.save(),_.each(s.clbks.seen,function(e){e()})},import:function(e){var t=[];_.each(e.notifications,function(e){var n={};_.each(e,function(e,t){var s;e.exported?((s=new kits.alias[e.type])._import(e.exported),n[t]=s):n[t]=e}),t.push(n)}),t.length&&(this.storage.notifications=t),e.block&&(this.storage.block=e.block)},export:function(){var t=[];return _.each(this.storage.notifications,function(e){var s={};_.each(e,function(e,t){e&&(e.export?s[t]={exported:e.export(),type:e.type}:s[t]=e)}),t.push(s)}),{block:this.storage.block,notifications:t}},init:function(){return _OpenApi?Promise.reject("openapi"):(this.inited=!1,this.loading=!0,this.load(),this.storage.block||(this.storage.block=b.currentBlock),this.storage.notifications||(this.storage.notifications=[]),this.getNotifications())},wsBlock:function(e){this.storage.block=e,this.save()},addFromWs:function(t){t.nblock||(t.nblock=b.currentBlock),("transaction"!=t.msg||t.address!=b.sdk.address.pnet().address||deep(t,"tx.coinbase"))&&this.storage.notifications&&(this.storage.notifications.unshift(t),_.each(this.clbks.added,function(e){e([t],!0)}),this.save())},getNotificationsInfo:function(t,n){var a=this;a.loading=!0,t=_.filter(t,function(t){return!(t.loading||t.loaded||!b.ws.messages[t.msg]||t.commentid&&_.find(a.storage.notifications,function(e){return e.commentid==t.commentid})||"transaction"==t.msg&&t.txinfo&&t.txinfo.pockettx)}),t=_.sortBy(t,function(e){return-Number(e.nblock)}),t=firstEls(t,50),lazyEach({array:t,action:function(e){var t=e.item,s=null;t.loading=!0,t.mesType&&(s=b.ws.messages[t.mesType]),(s=t.msg&&!s?b.ws.messages[t.msg]:s)?s.loadMore(t,function(){t.loaded=!0,t.loading=!1,e.success()},!0):e.success()},sync:!0,all:{success:function(){a.loading=!1;var e=_.filter(t,function(e){if("transaction"!=e.msg||e.address!=b.sdk.address.pnet().address)return!0}),s=[];_.each(e,function(t){_.find(a.storage.notifications,function(e){if(t.txid&&e.txid==t.txid)return!0})||(s.push(t),a.storage.notifications&&a.storage.notifications.push(t))}),_.each(a.clbks.added,function(e){e(s)}),n&&n()}}})},getNotifications:function(){var n=this;return n.inited||n.loading?b.sdk.node.get.timepr().then(e=>(console.log("GETMISSED",n.storage.block),b.sdk.missed.get(n.storage.block))).then(({block:e,notifications:s})=>(n.storage.block=e.block,new Promise((e,t)=>{n.getNotificationsInfo(s,function(){n.inited=!0,n.save(),e()})}))).catch(e=>(console.log("E",e),n.inited=!1,n.loading=!1,Promise.reject(e))):n.init()},find:function(t){return _.find(this.storage.notifications,function(e){return e.txid==t})}},missed:{get:function(e){function s(){return{block:{block:b.currentBlock,contentsLang:{},msg:"newblocks"}}}return console.log("block",e,b.currentBlock),b.sdk.address.pnet()?b.currentBlock?e?b.currentBlock==e?Promise.resolve(s()):b.app.api.rpc("getmissedinfo",[b.sdk.address.pnet().address,e]).then(e=>{if(!e||!e.length)return Promise.resolve(s());var t=e.slice(1)||[],t=_.sortBy(t,function(e){return-e.nblock});return e[0].msg="newblocks",Promise.resolve({block:e[0],notifications:t})}):Promise.reject("block"):Promise.reject("currentblock"):Promise.reject("address")}},contents:{storage:{},loading:{},groups:[{key:"art",caption:"Articles"},{key:"post",caption:"Posts"}],gets:function(e,s){s=s||"popularity";var n=group(e,function(e){return"a"==e.settings.v?"art":"post"}),e=_.filter(this.groups,function(e){if(n[e.key])return!0});return _.map(e,function(e){var t=n[e.key];return{g:e,items:t=s?_.sortBy(t,function(e){if("popularity"==s)return-Number(e.scoreSum)}):t}})},getsorteditems:function(e,t){var t=this.gets(e,t),s=[];return _.each(t,function(e){_.each(e.items,function(e){s.push(e)})}),s},get:function(t,n){var a=b.sdk.contents.storage,i=b.sdk.contents.loading,e=b.sdk.contents.get,s=deep(a,t+".time");s&&s.addMinutes(100)>new Date?n&&n(deep(this,"storage."+t+".data")):i[t]?retry(function(){return!i[t]},function(){e(t,n)}):(i[t]=!0,b.app.api.rpc("getcontents",[t]).then(e=>{var s=[];_.each(e||[],function(e){if(e.content)try{var t={caption:filterXSS(decodeURIComponent(e.content),{whiteList:[],stripIgnoreTag:!0}),time:new Date(e.time),txid:e.txid,settings:JSON.parse(e.settings),scoreCnt:Number(e.scoreCnt),scoreSum:Number(e.scoreSum),score:0};t.scoreCnt&&(t.score=Number(t.scoreSum)/Number(t.scoreCnt)),s.push(t)}catch(e){}}),a[t]={data:s,time:new Date},i[t]=!1,n&&n(s)}).catch(e=>{}))}},usersl:{storage:{}},users:{loading:{},storage:{},extend:function(t,e){function s(e){_.each(e.blocking,function(e){t.addRelation(e.vsaddress,"blocking")}),_.each(e.unblocking,function(e){t.removeRelation(e.vsaddress,"blocking")}),_.each(e.subscribe,function(e){t.removeRelation({adddress:e.vsaddress}),t.addRelation({adddress:e.vsaddress,private:!1})}),_.each(e.subscribePrivate,function(e){t.removeRelation({adddress:e.vsaddress}),t.addRelation({adddress:e.vsaddress,private:!0})}),_.each(e.unsubscribe,function(e){t.removeRelation({adddress:e.vsaddress})})}var n;e&&b.sdk.address.pnet()&&t.address==b.sdk.address.pnet().address&&(n=b.sdk.node.transactions.temp||{},e=b.sdk.relayTransactions.get(),s(n),s(e))},prepareuser:function(e,t,s){var n=b.sdk.node.transactions.temp,a=b.sdk.relayTransactions.storage,i=new pUserInfo;if(i.regdate=new Date,s&&n.userInfo&&!_.isEmpty(n.userInfo)&&t==b.sdk.address.pnet().address)i._import(_.toArray(n.userInfo)[0]),i.regdate.setTime(1e3*b.currentTime()),i.temp=!0;else if(s&&t==b.sdk.address.pnet().address&&a[t]&&a[t].userInfo&&a[t].userInfo.length)a=a[t].userInfo,i._import(a[a.length-1]),i.regdate.setTime(1e3*b.currentTime()),i.relay=!0;else{if(!e)return;i._import(e),i.regdate.setTime(1e3*e.regdate)}return i.address=t,b.real[t]&&(i.real=!0),b.sdk.users.extend(i,s),i},getone:function(s,n,e,t){var a,i=b.sdk.users.storage,o=b.sdk.users.loading;s&&!i[s]||t?o[s]?retry(function(){return!o[s]},function(){n&&n()}):(o[s]=!0,a=[[s]],e&&a.push("1"),b.app.user.isState(function(t){b.app.api.rpc("getuserprofile",a).then(e=>{o[s]=!1,"undefined"!=typeof pUserInfo&&(e=e[0],e=b.sdk.users.prepareuser(e,s,t),i[s]=e,b.sdk.usersl.storage[s]=e),n&&n()}).catch(e=>{o[s]=!1,n&&n(null,e)})})):n&&n()},get:function(t,a,s){t=_.isArray(t)?t:[t];var i=b.sdk.users.storage;s&&(i=b.sdk.usersl.storage),t=_.filter(t,function(e){return!!e&&(!i[e]||!!(i[e].temp||i[e].relay||i[e].fromstorage)||void 0)}),(t=_.uniq(t)).length?b.app.user.isState(function(n){var e=[t||[]];s&&e.push("1"),b.app.api.rpc("getuserprofile",e).then(s=>{_.each(t||[],function(t){var e=_.find(s,function(e){if(e.address==t)return!0}),e=b.sdk.users.prepareuser(e,t,n);i[t]=e,b.sdk.usersl.storage[t]=e}),a&&a()}).catch(e=>{a&&a(null,e)})}):a&&a()},requestFreeMoney:function(t){var s=b.sdk.address.pnet();s?(s=s.address,this.checkFreeMoney(s,function(e){e?(e={address:s,captcha:b.sdk.captcha.done},b.app.api.fetchauth("free/registration",e).then(e=>{t&&t(!0)}).catch(e=>{t&&t(null,e)})):t&&t(null)})):t&&t(null)},giveFreeMoney:function(o,r,c,d,l){this.checkFreeMoney(o,function(e){var n,a,i;e?(n=[{address:o,amount:d=d||2e-5},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d},{address:o,amount:d}],e=bitcoin.bip39.mnemonicToSeedSync(r),bitcoin.crypto.sha256(Buffer.from(e)),e=bitcoin.bip32.fromSeed(e).derivePath(u.platform.sdk.address.path(0)).toWIF(),a=bitcoin.ECPair.fromWIF(e),i=b.sdk.address.pnet(a.publicKey,"p2pkh").address,b.sdk.wallet.txbase([i],_.clone(n),null,null,function(e,t,s){e?c&&c(e):(s=b.app.platform.sdk.node.transactions.create.wallet(t,s,a),s=Math.min(1e-6*s.virtualSize(),6e-6),b.app.platform.sdk.wallet.txbase([i],_.clone(n),s,null,function(e,s,t){e?(b.sdk.node.transactions.releaseCS(s),c&&c(e)):(t=b.app.platform.sdk.node.transactions.create.wallet(s,t,a),b.app.platform.sdk.node.transactions.send(t,function(e,t){t?(b.sdk.node.transactions.releaseCS(s),-26!=t&&-25!=t&&16!=t||l?c&&c(t):b.sdk.users.giveFreeMoney(o,r,c,d,!0)):(t=_.map(s,function(e){return{txid:e.txId,vout:e.vout}}),b.app.platform.sdk.node.transactions.clearUnspents(t),c&&c(null,e,d*n.length))}))}))},l)):c&&c("nofree")})},checkFreeMoney:function(t,s){b.sdk.users.get(t,function(){deep(b,"sdk.users.storage2."+t+".name")?s&&s(!1):b.sdk.address.registration(t,function(e){e?s&&s(!1):b.sdk.node.transactions.get.balance(function(e){0<e?s&&s(!1):s&&s(!0)},t,!0)})})},giveFreeRef:function(e,t,s,o,r){this.checkFreeRef(e,function(e){var n,a,i;e?(n=[{address:t,amount:r=r||.005}],e=bitcoin.bip39.mnemonicToSeedSync(s),bitcoin.crypto.sha256(Buffer.from(e)),e=bitcoin.bip32.fromSeed(e).derivePath(u.platform.sdk.address.path(0)).toWIF(),a=bitcoin.ECPair.fromWIF(e),i=b.sdk.address.pnet(a.publicKey,"p2pkh").address,b.sdk.wallet.txbase([i],_.clone(n),null,null,function(e,t,s){e?o&&o(e):(s=b.app.platform.sdk.node.transactions.create.wallet(t,s,a),s=Math.min(1e-6*s.virtualSize(),5e-4),b.app.platform.sdk.wallet.txbase([i],_.clone(n),s,null,function(e,s,t){e?(b.sdk.node.transactions.releaseCS(s),o&&o(e)):(t=b.app.platform.sdk.node.transactions.create.wallet(s,t,a),b.app.platform.sdk.node.transactions.send(t,function(e,t){t?(b.sdk.node.transactions.releaseCS(s),o&&o(t)):(t=_.map(s,function(e){return{txid:e.txId,vout:e.vout}}),b.app.platform.sdk.node.transactions.clearUnspents(t),o&&o(null,e,r))}))}))},!0)):o&&o("nofree")})},requestFreeRef:function(t,s){var n=b.sdk.address.pnet();n?(n=n.address,this.checkFreeRef(n,function(e){e?b.app.api.fetch("freeRef",{referal:n,referrer:t}).then(e=>{s&&s(!0)}).catch(e=>{s&&s(null,deep(d,"data")||{})}):s&&s(null)})):s&&s(null)},checkFreeRef:function(e,t){e?b.sdk.users.get(e,function(){deep(b,"sdk.users.storage2."+e+".name")?t&&t(!1):t&&t(!0)}):t&&t(!0)},addressByName:function(t,s){var n=!0;try{bitcoin.address.fromBase58Check(t)}catch(e){n=!1}n?s&&s(t):(n=(n=_.find(b.sdk.usersl.storage,function(e){if(e.name==t)return!0}))||_.find(b.sdk.users.storage,function(e){if(e.name==t)return!0}))?s&&s(n.address):b.app.api.rpc("getuseraddress",[t]).then(e=>{e=deep(e,"0.address"),s&&s(e||null)}).catch(e=>{s&&s(null,e)})},nameExist:function(s,t){var e=b.app.map;e[s]||_.find(e,function(e,t){return e.uri==s||e.href==s||void 0})?t&&t("pnetsystem"):b.app.api.rpc("getuseraddress",[encodeURIComponent(s)]).then(e=>{e=deep(e,"0.address"),t&&t(e||!1)}).catch(e=>{t&&t(!1)})},replacePattern:function(e,t,s){var n=/@([^,]+),/g,a=e.match(n);return a?(s=t(a,s),e.replace(n,s)):e}},newmaterials:{storage:{},clbks:{update:{}},update:function(e){e={sub:e.sharesSubscr||0,video:deep(e,"contentsLang.video."+b.app.localization.key)||0,common:deep(e,"sharesLang."+b.app.localization.key)||(deep(e,"contentsLang.share."+b.app.localization.key)||0)+(deep(e,"contentsLang.video."+b.app.localization.key)||0)},_.each(e,function(e,t){b.sdk.newmaterials.storage[t]=(b.sdk.newmaterials.storage[t]||0)+e}),_.each(b.sdk.newmaterials.clbks.update,function(e){e(b.sdk.newmaterials.storage)})},clear:function(){b.sdk.newmaterials.storage={},_.each(b.sdk.newmaterials.clbks.update,function(e){e(b.sdk.newmaterials.storage)})},see:function(e){b.sdk.newmaterials.storage[e]=0,_.each(b.sdk.newmaterials.clbks.update,function(e){e(b.sdk.newmaterials.storage)})}},captcha:{storage:{},current:null,done:null,load:function(e){b.sdk.captcha.done=localStorage.capcha||null,e&&e()},save:function(){b.sdk.captcha.done?localStorage.capcha=b.sdk.captcha.done:delete localStorage.capcha},get:function(s,e){e&&(this.current=null),b.app.api.fetch("captcha",{captcha:this.done||this.current||null}).then(t=>{b.sdk.captcha.current=t.id,t.id!=b.sdk.captcha.done&&(b.sdk.captcha.done=null),b.sdk.captcha.save(),t.result&&!t.done?b.sdk.captcha.make(t.result,function(e){e?s&&lbk(null,e):(t.done=!0,s&&s(t))}):s&&s(t)}).catch(e=>{s&&s(null,e)})},make:function(e,t){b.app.api.fetchauth("makecaptcha",{captcha:this.current||null,text:e}).then(e=>{b.sdk.captcha.done=e.id,b.sdk.captcha.save(),t&&t(null,e)}).catch(e=>{t&&t(e)})}},exchanges:{storage:{},info:{},find:function(t){var e=b.sdk.exchanges.get();return _.find(e,function(e){return e.info.address==t})},get:function(){var n=[];return _.each(b.sdk.exchanges.storage,function(e,s){_.each(e,function(e,t){_.each(e,function(e){n.push({pocaddress:t,currency:s,info:e})})})}),n=_.filter(n,function(e){if(e.info)return!0}),n=_.sortBy(n,function(e){return Number(e.info.time)})},load:function(e){b.sdk.exchanges.storage=JSON.parse(localStorage[b.sdk.address.pnet().address+"exchanges2"]||"{}"),e&&e()},save:function(e){localStorage[b.sdk.address.pnet().address+"exchanges2"]=JSON.stringify(b.sdk.exchanges.storage||{}),e&&e()},remove:function(s,t){var n=b.sdk.exchanges.storage;n[s]||(n[s]={}),_.each(n[s],function(e){delete e[t]}),_.each(n[s],function(e,t){_.isEmpty(e)&&delete n[s][t]}),_.isEmpty(n[s])&&delete n[s],this.save()},reactivate:function(t,s){b.app.ajax.run({data:{Action:"REACTIVATEPOCDEAL",Currency:t.currency.toUpperCase(),Address:t.address},success:function(e){b.sdk.exchanges.status(t.currency,t.address,s)},fail:function(){s&&s("server")}})},address:function(t,s){var n=b.sdk.exchanges.storage,a=this;n[t.currency]||(n[t.currency]={}),n[t.currency][t.address]||(n[t.currency][t.address]={}),b.app.ajax.run({data:{Action:"GETADDRESSFORPOC",Currency:t.currency,address:t.address},success:function(e){e.Address?(n[t.currency][t.address][e.Address.Address]={address:e.Address.Address,amount:t.amount,currencyAmount:t.currencyAmount,time:b.currentTime()},a.save(),b.sdk.exchanges.info[e.Address.Address]=e.Address,s&&s(null,{pocaddress:t.address,currency:t.currency,info:n[t.currency][t.address]},e.Address)):s&&s("error",null)},fail:function(){s&&s("server")}})},statuses:function(t,n){n||(n=[],_.each(b.sdk.exchanges.storage,function(e,s){_.each(e,function(e,t){_.each(e,function(e){n.push({Currency:s.toUpperCase(),Address:e.address})})})})),b.app.ajax.run({data:{Action:"GETPOCDEALSTATUS",List:JSON.stringify(n)},success:function(e){e.Deal?(_.isArray(e.Deal)||(e.Deal=[e.Deal]),_.each(e.Deal,function(e){b.sdk.exchanges.info[e.Address]=e}),t&&t(null,e.Deal)):t&&t("empty",null)},fail:function(){t&&t("server")}})},status:function(e,t,s){b.app.ajax.run({data:{Action:"GETPOCDEALSTATUS",Currency:e,Address:t},success:function(e){e.Deal?s&&s(null,e.Deal):s&&s("empty",null)},fail:function(){s&&s("server")}})},rates:function(t){b.app.ajax.run({data:{Action:"GETPOCRATES"},success:function(e){var s={};e.Rate||(e.Rate=[]),_.each(e.Rate,function(e,t){s[e.Currency.toLowerCase()]=Number(e.Rate)/1e8}),t&&t(s)},fail:function(){t&&t("server")}})}},wallet:{txbaseFeesMeta:function(n,a,i,o,r,c){b.sdk.wallet.txbase([n],_.clone(a),null,null,function(e,t,s){e?c&&c(e):(s=b.app.platform.sdk.node.transactions.create.wallet(t,s,i),s=Math.min(s.virtualSize()*o,.0999),r([n],_.clone(a),s,null,function(e,s,n){e?c&&c(e):(e=b.app.platform.sdk.node.transactions.create.wallet(s,n,i),b.app.platform.sdk.node.transactions.send(e,function(e,t){t?c&&c(t):(t=_.map(s,function(e){return{txid:e.txId,vout:e.vout}}),b.app.platform.sdk.node.transactions.clearUnspents(t),c&&c(null,e,s,n))}))}))},!0)},txbase:function(e,a,i,o,r,t){i=i||0,o=o||"include";var c=_.reduce(a,function(e,t){return e+Number(t.amount)},0);"include"!=o&&(c+=i),c<=0?r&&r("total"):b.sdk.node.transactions.get.unspents(function(e){var s=[];_.each(e,function(e,t){e=_.filter(e,b.sdk.node.transactions.canSpend),_.each(e,function(e){e.amount&&s.push(e)})});var t,n,e=_.reduce(s,function(e,t){return e+Number(t.amount)},0);s.length?e<c?r&&r("money"):(e=_.sortBy(s,function(e){return Math.abs(e.amount-c)}),t=[],n=0,_.each(e,function(e){n<c&&(t.push(e),n+=e.amount)}),c<n&&0<n.toFixed(8)-c.toFixed(8)&&a.push({address:t[0].address,amount:n-c}),"include"==o&&(a[0].amount=a[0].amount-i,a[0].amount<=0)?r&&r("fee"):r&&r(null,t,a)):r&&r("unspents")},e,t)},drawSpendLine:function(a,i,e){b.app.platform.sdk.node.transactions.get.canSpend(e||null,function(e,t){var s,n;0<t&&e<t?(a.css("position","relative"),a.find(".spendLine").length||a.append('<div class="spendLine"><div class="line"></div></div>'),s=a.find(".spendLine .line"),n=a.find(".spendLine .line"),0==e?n.addClass("bad"):n.removeClass("bad"),s.animate({width:100*e/t+"%"},140)):a.find(".spendLine").remove(),i&&i()})},saveTempInfoWallet:function(e,t,s){var n,a,i;e&&(n=b.sdk.node.transactions.temp,i=b.sdk.node.transactions.tempOptions,a={type:"wallet",txid:e},i=deep(i,a.type+".count")||"many",n[a.type]&&"one"!=i||(n[a.type]={}),(n[a.type][e]=a).inputs=t,a.outputs=s,b.sdk.node.transactions.saveTemp())},txBaseFeesWithCache:function(e,t,s,n,a){b.sdk.wallet.txbaseFees(e,t,s,n,function(e,t,s,n){e?a&&a(e):a&&a(null,t)})},txbaseFees:function(e,t,s,n,a){b.sdk.wallet.txbaseFeesMeta(e,t,s,n,b.sdk.wallet.txbase,a)},embed:function(e,t){t&&(t=[Buffer.from(t,"utf8")],t=bitcoin.payments.embed({data:t}),e.push({address:t.output,amount:0}))},send:function(e,t,s,n,a){e=[{address:e,amount:s}],(s=b.api.keypair(t.replace(/\+/g," ")))?(t=b.sdk.address.pnetsimple(s.publicKey,"p2pkh").address,this.embed(e,a),b.sdk.wallet.txBaseFeesWithCache(t,e,s,1e-6,function(e,t){e?n&&n(e):n&&n(null,t)},!0)):n&&n("privatekey")},sendFromInputs:function(e,s,t,n,a){var i,o=[{address:e,amount:n=n||_.reduce(s,function(e,t){return e+t.amount},0)}];t?(i=b.app.platform.sdk.node.transactions.create.wallet(s,o,t),e=Math.min(1e-6*i.virtualSize(),.0999),o[0].amount=o[0].amount-e,o[0].amount<0?a&&a("dust"):(i=b.app.platform.sdk.node.transactions.create.wallet(s,o,t),_.each(s,function(e){e.cantspend=!0}),b.app.platform.sdk.node.transactions.send(i,function(e,t){t?(b.sdk.node.transactions.releaseCS(s),a&&a(t)):(t=_.map(s,function(e){return{txid:e.txid,vout:e.vout}}),b.app.platform.sdk.wallet.saveTempInfoWallet(e,s,o),b.app.platform.sdk.node.transactions.clearUnspents(t),a&&a(null,e,n*o.length))}))):a&&a("privatekey")},sendmany:function(e,t,s,n){var a=b.api.keypair(e.replace(/\+/g," "));a?(e=b.sdk.address.pnetsimple(a.publicKey,"p2pkh").address,this.embed(t,n),b.sdk.wallet.txBaseFeesWithCache(e,t,a,1e-6,function(e,t){e?s&&s(e):s&&s(null,t)},!0)):s&&s("privatekey")},sendmanyoutputs:function(e,t,s,n,a,i){for(var o=[],r=0;r<n;r++)o.push({address:t,amount:s/n});this.sendmany(e,o,a,i)}},addresses:{storage:{},init:function(e){b.sdk.addresses.storage.addresses||(b.sdk.addresses.storage.addresses=[]),b.sdk.addresses.storage.addressesobj||(b.sdk.addresses.storage.addressesobj=[]);var t=localStorage[b.sdk.address.pnet().address+"addressesNum"]||1;t<10&&(t=10);for(var s=0;s<t;s++)b.sdk.addresses.addWalletAddress(s);b.sdk.addresses.save(),e&&e()},save:function(){b.sdk.addresses.storage.addresses.length&&(localStorage[b.sdk.address.pnet().address+"addressesNum"]=b.sdk.addresses.storage.addresses.length)},addWalletAddress:function(e){void 0===e&&(e=b.sdk.addresses.storage.addresses.length);var t=b.sdk.address.wallet(e);return b.sdk.addresses.storage.addresses[e]=t.address,(b.sdk.addresses.storage.addressesobj[e]=t).address},getFirstRandomAddress:function(e){var t=b.sdk.addresses.storage.addresses.length?(t=_.toArray(b.sdk.addresses.storage.addresses),(t=_.first(t,10))[rand(0,t.length-1)]):b.sdk.addresses.addWalletAddress();e&&e(t)},addNewWalletAddress:function(e){var n,t;b.sdk.addresses.storage.addresses.length?(n=null,lazyEach({array:b.sdk.addresses.storage.addresses,action:function(t){var s;n?t.success():(s=t.item,b.sdk.node.transactions.get.unspent(function(e){e.length||(n=s),t.success()},s))},all:{success:function(){n=n||b.sdk.addresses.addWalletAddress(),e&&e(n)}}})):(t=b.sdk.addresses.addWalletAddress(),e&&e(t))}},address:{storage:{},path:function(e){return"m/44'/0'/0'/"+e+"'"},path33:function(e){return"m/33'/0'/0'/"+e+"'"},pnetsimple:function(e){return bitcoin.payments.p2pkh({pubkey:e})},pnet:function(e,t){var s=!1;if(e?s=!0:e=b.app.user.key.value,!e)return null;var n=this.storage[t=t||"p2pkh"];if(n&&!s)return n;if("p2pkh"==t||"p2wpkh"==t)return a=bitcoin.payments[t]({pubkey:e}),this.storage[t]=a;if("p2sh"==t){var a=bitcoin.payments.p2wpkh({pubkey:e}),a=bitcoin.payments.p2sh({redeem:a});return this.storage[t]=a}},wallet:function(e,t){return e=bitcoin.bip32.fromSeed(t||b.app.user.private.value).derivePath(u.platform.sdk.address.path(e)).toWIF(),e=bitcoin.ECPair.fromWIF(e).publicKey,e=bitcoin.payments.p2wpkh({pubkey:e}),bitcoin.payments.p2sh({redeem:e})},dumpKeys:function(e){return e=bitcoin.bip32.fromSeed(b.app.user.private.value).derivePath(u.platform.sdk.address.path(e)).toWIF(),bitcoin.ECPair.fromWIF(e)},dumpPrivKey:function(e){return e=bitcoin.bip32.fromSeed(b.app.user.private.value).derivePath(u.platform.sdk.address.path(e)).toWIF(),bitcoin.ECPair.fromWIF(e).privateKey},registration:function(e,t){b.app.api.rpc("getaddressregistration",[[e]]).then(e=>{e=deep(e,"0.date")||0,t&&t(0<e)}).catch(e=>{t&&t(null,e)})}},remote:{storage:{},failed:{},get:function(t,s,e){var n=this.storage,a=this.failed;a[t]?s&&s(null):n[t]?s&&s(n[t]):(n[t]={},b.app.api.fetch(e||"urlPreview",{url:t}).then(e=>{e=deep(e,"og"),n[t]=e,n[t]||(a[t]=!0),s&&s(n[t])}).catch(e=>{a[t]=!0,s&&s(null)}))}},activity:{latest:{},clear:function(){b.sdk.activity.latest={},b.sdk.activity.save()},addtagsearch:function(e){e={id:bitcoin.crypto.hash256(e).toString("hex"),index:e.toLowerCase(),value:e},b.sdk.activity.add("search","tags",e)},addsearch:function(e){e={id:bitcoin.crypto.hash256(e).toString("hex"),index:e.toLowerCase(),value:e},b.sdk.activity.add("search","str",e)},adduser:function(t,s){s&&b.sdk.users.get([s],function(){var e=b.sdk.users.storage[s];e&&(e={id:s,index:e.name.toLowerCase(),name:e.name,image:e.image,address:s},b.sdk.activity.add(t,"user",e))})},add:function(e,t,s){var n=b.sdk.activity.latest;if(!s.index)return"index";if(!s.id)return"id";var a={index:s.index,id:s.id,type:t};if("user"==t){if(!s.name||!s.address||!s.image)return"validation";a.data={name:s.name,address:s.address,image:s.image}}if("str"==t||"tags"==t){if(!s.value)return"validation";a.data={value:s.value}}a.date=b.currentTime(),n[e]||(n[e]=[]),n[e]=_.filter(n[e],function(e){return e.id!=s.id&&e.index!=s.index}),n[e].unshift(a),n[e]=firstEls(n[e],50),b.sdk.activity.save()},save:function(){localStorage.latestactivity=JSON.stringify({activity:b.sdk.activity.latest})},load:function(e){var t={};try{t=JSON.parse(localStorage.latestactivity||"{}")}catch(e){}t.activity||(t.activity={}),b.sdk.activity.latest=t.activity,e&&e()}},categories:{data:{all:{en:[{name:"Memes/Funny",tags:["funny","memes"],id:"c2"},{name:"Politics",tags:["politics"],id:"c3"},{name:"Crypto",tags:["crypto"],id:"c4"},{name:"Technology/Science",tags:["technology","science"],id:"c5"},{name:"Faith/Religion",tags:["faith","religion"],id:"c55"},{name:"Investing/Finance",tags:["investing","finance"],id:"c6"},{name:"Auto/Racing",tags:["auto","racing"],id:"c7"},{name:"Sports",tags:["sports"],id:"c8"},{name:"Gaming",tags:["gaming"],id:"c9"},{name:"Space",tags:["space"],id:"c10"},{name:"Art/Music",tags:["art","music"],id:"c11"},{name:"News/Commentary",tags:["news","commentary"],id:"c12"},{name:"History",tags:["history"],id:"c13"},{name:"Story time",tags:["storytime"],id:"c14"},{name:"Film/Animation",tags:["film","animation"],id:"c15"},{name:"Nature/Animals",tags:["nature","animals"],id:"c16"},{name:"Travel/Architecture",tags:["travel","architecture"],id:"c17"},{name:"DIY",tags:["diy"],id:"c18"}],ru:[{name:"Мемы/Юмор",tags:["мемы","юмор"],id:"c2"},{name:"Политика",tags:["политика"],id:"c3"},{name:"Криптовалюта",tags:["Криптовалюта"],id:"c4"},{name:"Наука/Технологии",tags:["технологии","наука"],id:"c5"},{name:"Вера/Религия",tags:["вера","религия"],id:"c55"},{name:"Финансы/Инвестиции",tags:["финансы","инвестиции"],id:"c6"},{name:"Автомобили/Гонки",tags:["auto","racing"],id:"c7"},{name:"Спорт",tags:["спорт"],id:"c8"},{name:"Игры",tags:["игры"],id:"c9"},{name:"Космос",tags:["космос"],id:"c10"},{name:"Искусство/Музыка",tags:["искусство","музыка"],id:"c11"},{name:"Новости/Комментарии",tags:["новости","комментарии"],id:"c12"},{name:"История",tags:["история"],id:"c13"},{name:"Время историй",tags:["истории"],id:"c14"},{name:"Кино/Анимация",tags:["кино","анимация"],id:"c15"},{name:"Природа/Животные",tags:["Природа","животные"],id:"c16"},{name:"Путешествия/Архитектура",tags:["путешествия","архитектура"],id:"c17"},{name:"Сделай сам",tags:["сделайсам"],id:"c18"}],cmn:[{name:"模因/幽默",tags:["模因","幽默"],id:"c2"},{name:"政治",tags:["政治"],id:"c3"},{name:"加密貨幣",tags:["加密貨幣"],id:"c4"},{name:"科學/技術",tags:["技術","科學"],id:"c5"},{name:"信仰/宗教",tags:["信仰","宗教"],id:"c55"},{name:"金融/投資",tags:["金融","投資"],id:"c6"},{name:"汽車/賽車",tags:["汽車","賽車"],id:"c7"},{name:"運動",tags:["運動"],id:"c8"},{name:"遊戲",tags:["遊戲"],id:"c9"},{name:"空間",tags:["空間"],id:"c10"},{name:"藝術/音樂",tags:["藝術","音樂"],id:"c11"},{name:"新聞/評論",tags:["新聞","評論"],id:"c12"},{name:"歷史",tags:["歷史"],id:"c13"},{name:"故事時間",tags:["故事時間"],id:"c14"},{name:"電影/動畫",tags:["電影","動畫"],id:"c15"},{name:"自然/動物",tags:["自然","動物"],id:"c16"},{name:"旅遊/建築",tags:["旅遊","建築"],id:"c17"},{name:"自己做",tags:["自己做"],id:"c18"}],kr:[{name:"밈/유머",tags:["밈","유머"],id:"c2"},{name:"정치",tags:["정치"],id:"c3"},{name:"암호 화폐",tags:["암호 화폐"],id:"c4"},{name:"과학/기술",tags:["기술","과학"],id:"c5"},{name:"신앙/종교",tags:["신앙","종교"],id:"c55"},{name:"금융/투자",tags:["금융","투자"],id:"c6"},{name:"자동차/레이싱 ",tags:["자동차","레이싱"],id:"c7"},{name:"스포츠",tags:["스포츠"],id:"c8"},{name:"계략",tags:["계략"],id:"c9"},{name:"우주",tags:["우주"],id:"c10"},{name:"예술/음악",tags:["예술","음악"],id:"c11"},{name:"뉴스/댓글",tags:["뉴스","댓글"],id:"c12"},{name:"역사",tags:["역사"],id:"c13"},{name:"이야기의 시간",tags:["이야기의시간"],id:"c14"},{name:"영화/애니메이션",tags:["영화","애니메이션"],id:"c15"},{name:"자연/동물",tags:["자연","동물"],id:"c16"},{name:"여행/건축",tags:["여행","건축"],id:"c17"},{name:"너 스스로해라",tags:["너스스로해라"],id:"c18"}],fr:[{name:"Mèmes/Humour",tags:["mèmes","humour"],id:"c2"},{name:"Politique",tags:["politique"],id:"c3"},{name:"Crypto-monnaie",tags:["Crypto-monnaie"],id:"c4"},{name:"Technologie/Scientifique",tags:["technologie","scientifique"],id:"c5"},{name:"Foi/Religion ",tags:["foi","religion"],id:"c55"},{name:"Finances/Investissements",tags:["finances","investissements"],id:"c6"},{name:"Voitures/Courses",tags:["voitures","courses"],id:"c7"},{name:"Sport",tags:["Sport"],id:"c8"},{name:"Jeux",tags:["jeux"],id:"c9"},{name:"Espace",tags:["espace"],id:"c10"},{name:"Art/Musique",tags:["art","musique"],id:"c11"},{name:"Nouvelles/Commentaires",tags:["nouvelles","commentaires"],id:"c12"},{name:"histoire",tags:["histoire"],id:"c13"},{name:"Le temps des histoires",tags:["Letempsdeshistoires"],id:"c14"},{name:"Cinéma/Animation",tags:["cinéma","animation"],id:"c15"},{name:"Nature/Animaux",tags:["nature","animaux"],id:"c16"},{name:"Voyage/Architecture",tags:["voyage","architecture"],id:"c17"},{name:"Fais le toi-même",tags:["faisletoi-même"],id:"c18"}],es:[{name:"Memes/Humor ",tags:["мемы","юмор"],id:"c2"},{name:"Política",tags:["política"],id:"c3"},{name:"Criptomoneda",tags:["criptomoneda"],id:"c4"},{name:"Tecnología/Сientífica ",tags:["tecnología","científica"],id:"c5"},{name:"Fe/Religión ",tags:["fe","religión"],id:"c55"},{name:"Finanzas/Inversiones",tags:["finanzas","inversiones"],id:"c6"},{name:"Coches/Carreras",tags:["coches","carreras"],id:"c7"},{name:"Deporte",tags:["deporte"],id:"c8"},{name:"Juegos",tags:["juegos"],id:"c9"},{name:"Espacio",tags:["espacio"],id:"c10"},{name:"Arte/Musical ",tags:["arte","musical"],id:"c11"},{name:"Noticias/Comentarios",tags:["noticias","comentarios"],id:"c12"},{name:"Historia",tags:["historia"],id:"c13"},{name:"Tiempo de historias",tags:["Tiempo de historias"],id:"c14"},{name:"Cine/Animación",tags:["cine","animación"],id:"c15"},{name:"Naturaleza/Animales",tags:["naturaleza","animales"],id:"c16"},{name:"Viajes/Arquitectura",tags:["viajes","arquitectura"],id:"c17"},{name:"Hazlo tu mismo",tags:["hazlotumismo"],id:"c18"}],de:[{name:"Meme/Humor ",tags:["meme","hunor"],id:"c2"},{name:"Politik",tags:["politik"],id:"c3"},{name:"Kryptowährung",tags:["Kryptowährung"],id:"c4"},{name:"Wissenschaft/Technologie ",tags:["technologie","wissenschaft"],id:"c5"},{name:"Glaube/Religion",tags:["glaube","religion"],id:"c55"},{name:"Finanzen/Investitionen ",tags:["finanzen","investitionen"],id:"c6"},{name:"Autos/Rennen ",tags:["autos","rennen"],id:"c7"},{name:"Sport",tags:["sport"],id:"c8"},{name:"Spielen",tags:["spielen"],id:"c9"},{name:"Weltraum",tags:["weltraum"],id:"c10"},{name:"Kunst/Musik ",tags:["kunst","music"],id:"c11"},{name:"Neuigkeiten/Kommentare",tags:["neuigkeiten","kommentare"],id:"c12"},{name:"Geschichte",tags:["geschichte"],id:"c13"},{name:"Zeit der Geschichten",tags:["zeit der geschichten "],id:"c14"},{name:"Film/Animation ",tags:["film","animation"],id:"c15"},{name:"Natur/Tiere ",tags:["natur","tiere"],id:"c16"},{name:"Reisen/Architektur ",tags:["reisen","architektur"],id:"c17"},{name:"Mach es selbst",tags:["machesselbst"],id:"c18"}]}},settings:{tags:{},selected:{},added:{}},clbks:{selected:{},added:{},tags:{},removed:{}},fromTags:function(e,t){var s={categories:[],tags:[]},n={},a=b.sdk.categories.get();return _.each(a,function(t){_.filter(e,function(e){return-1<_.indexOf(t.tags,e.toLowerCase())}).length==t.tags.length&&(s.categories.push(t),_.each(t.tags,function(e){n[e]=!0}))}),_.each(e,function(e){n[e]||s.tags.push(e)}),s},getaddedtags:function(e){return e=e||b.app.localization.key,b.sdk.categories.data.all[e]||(e="en"),b.sdk.categories.settings.selected[e],_.map(b.sdk.categories.settings.tags[e]||{},function(e,t){return t})},gettags:function(e,t){var s=[],n=e||b.app.localization.key;b.sdk.categories.data.all[n]||(n="en");var a=b.sdk.categories.settings.selected[n]||{},e=_.map(b.sdk.categories.settings.tags[n]||{},function(e,t){return t}),n=b.sdk.categories.get(n);return _.each(n,function(e){a[e.id]&&(s=s.concat(e.tags))}),t||(s=s.concat(e)),s="onlytags"===t?e:s},gettagsmap:function(e){var t=b.sdk.categories.gettags(e,!0),e=b.sdk.categories.gettags(e),s={};return _.each(e,function(e){s[e]={selected:!0,fixed:-1<_.indexOf(t,e)}}),s},remove:function(t,e){var s=b.sdk.categories.settings,n=e||b.app.localization.key;b.sdk.categories.data.all[n]||(n="en"),delete s.added[n][t],s=(e=b.sdk.categories.settings.selected[n]||{})[t],delete e[t],b.sdk.categories.save(),s&&_.each(b.sdk.categories.clbks.selected,function(e){e(t,!1,n)}),_.each(b.sdk.categories.clbks.removed,function(e){e(t,n)})},add:function(t,e){if(!t.id)return"id";if(!t.name)return"name";if(!t.tags)return"tags";if(!t.tags.length)return"tags";t.tags=_.map(t.tags,function(e){return e.replace("#","").toLowerCase()});var s=b.sdk.categories.settings,n=e||b.app.localization.key;return b.sdk.categories.data.all[n]||(n="en"),(e=_.find(s.added[n],function(e){if(e.name==t.name)return!0}))&&e.id!=t.id?"doublename":(s.added[n]||(s.added[n]={}),s.added[n][t.id]={name:t.name,id:t.id,tags:t.tags},_.each(b.sdk.categories.clbks.added,function(e){e(id,n)}),b.sdk.categories.save(),!1)},tag:function(t,e){if(!t)return"emptyid";var s=b.sdk.categories.settings,n=e||b.app.localization.key;return b.sdk.categories.data.all[n]||(n="en"),s.tags[n]||(s.tags[n]={}),s.tags[n][t]?delete s.tags[n][t]:s.tags[n][t]=!0,b.sdk.categories.save(),_.each(b.sdk.categories.clbks.tags,function(e){e(t,s.tags[n][t],n)}),!1},geteslected:function(e){var t=b.sdk.categories.get(),s=b.sdk.categories.settings,n=e||b.app.localization.key;return b.sdk.categories.data.all[n]||(n="en"),s.selected[n]||(s.selected[n]={}),_.filter(t,function(e){return s.selected[n][e.id]})},clear:function(e,t){var s=b.sdk.categories.settings,n=e||b.app.localization.key;b.sdk.categories.data.all[n]||(n="en"),t||(s.selected[n]={}),s.tags[n]={},b.sdk.categories.save(),_.each(b.sdk.categories.clbks.selected,function(e){e(null,!1,n)})},select:function(t,e){if(!t)return"emptyid";var s=b.sdk.categories.get(e);if(!_.find(s,function(e){return e.id==t}))return"cantonfound";var n=b.sdk.categories.settings,a=e||b.app.localization.key;return b.sdk.categories.data.all[a]||(a="en"),n.selected[a]||(n.selected[a]={}),n.selected[a][t]?delete n.selected[a][t]:n.selected[a][t]=!0,b.sdk.categories.save(),_.each(b.sdk.categories.clbks.selected,function(e){e(t,n.selected[a][t],a)}),!1},get:function(e){var t=e||b.app.localization.key,e=_.map(b.sdk.categories.settings.added[t]||{},function(e){return(e=_.clone(e)).added=!0,e});return(b.sdk.categories.data.all[t]||b.sdk.categories.data.all.en).concat(e)},getbyid:function(t,e){return e=b.sdk.categories.get(e),_.find(e,function(e){return e.id==t})||null},search:function(t){return _.filter(b.sdk.categories.get(),function(e){return-1<e.name.toLowerCase().indexOf(t)||.7<stringEqTrig(e.name,t)})},getwithselected:function(e){e=e||b.app.localization.key,b.sdk.categories.data.all[e]||(e="en");var s=b.sdk.categories.settings.selected[e]||{},e=b.sdk.categories.get();return _.map(e,function(e){var t=_.clone(e);return t.selected=!!s[e.id],t})},save:function(){localStorage.categoriessettings=JSON.stringify({settings:b.sdk.categories.settings})},load:function(e){var t={};b.sdk.categories.clbks.selected={},b.sdk.categories.clbks.removed={},b.sdk.categories.clbks.added={},b.sdk.categories.clbks.tags={};try{t=JSON.parse(localStorage.categoriessettings||"{}")}catch(e){}t.settings||(t.settings={}),b.sdk.categories.settings=t.settings,b.sdk.categories.settings.tags||(b.sdk.categories.settings.tags={}),b.sdk.categories.settings.selected||(b.sdk.categories.settings.selected={}),b.sdk.categories.settings.added||(b.sdk.categories.settings.added={}),e&&e()}},tags:{storage:{cloud:null,all:["love","followback","instagramers","socialsteeze","tweegram","photooftheday","20likes","amazing","smile","follow4follow","like4like","look","instalike","igers","picoftheday","food","instadaily","instafollow","followme","girl","instagood","bestoftheday","instacool","carryme","follow","colorful","style","swag","fun","instagramers","model","socialsteeze","food","smile","pretty","followme","nature","lol","dog","hair","sunset","swag","throwbackthursday","instagood","beach","friends","hot","funny","blue","life","art","photo","cool","carryme","bestoftheday","clouds","amazing","socialsteeze","fitness","followme","all_shots","textgram","family","instago","igaddict","awesome","girls","instagood","my","bored","baby","music","red","green","water","bestoftheday","black","party","white","yum","flower","carryme","night","instalove","photo","photos","pic","pics","socialsteeze","picture","pictures","snapshot","art","beautiful","instagood","picoftheday","photooftheday","color","all_shots","exposure","composition","focus","capture","moment","hdr","hdrspotters","hdrstyles_gf","hdri","hdroftheday","hdriphonegraphy","hdr_lovers","awesome_hdr"]},ex:{news:!0,images:!0,videos:!0,politics:!0,funny:!0,art:!0,photo:!0},search:function(t,e){t=t.toLowerCase().replace(/[^a-z0-9_]/g,"");var s=_.filter(this.storage.all,function(e){if(-1<e.indexOf(t))return!0}),s=_.uniq(s);e&&e(lastEls(s,7))},get:function(e,t,s,n){e=[e||""],t?e.push(t.toString()):e.push(""),s?e.push(s.toString()):e.push(""),e.push(b.app.localization.key),b.app.api.rpc("gettags",e).then(e=>{n&&n(e)}).catch(e=>{n&&n([],e)})},filterEx:function(e){var t=this.ex;return _.filter(e,function(e){if(!t[e.tag])return!0})},getfastsearch:function(t){var s=this.storage,n=this;retry(function(){return b.currentBlock},function(){var e;n.get("",150,(e=b.currentBlock)-e%1e3-2e4,function(e){e&&e.length&&(s.all=_.map(e,function(e){return e.tag})),t&&t()})})},cloudUpdate:function(e){b.app.platform.sdk.tags.cloud(e,!0)},cloud:function(s,e){var n=this.storage,t=this;n.cloud&&!e?s&&s(n.cloud):retry(function(){return b.currentBlock},function(){var e;t.get("",50,(e=b.currentBlock)-e%1e3-23700,function(e,t){t||(n.cloud=e),s&&s(n.cloud,t)})})}},search:{storage:{all:{},fs:{},posts:{},users:{},tags:{}},clear:function(){this.storage={all:{},fs:{},posts:{},users:{},tags:{}}},add:function(e,t,s,n,a,i){var o=this.storage;if(o[t][i]||(o[t][i]={}),o[t][i][e])for(var r=0;r<a;r++)s.data[r]&&(o[t][i][e].data[n+r]=s.data[r]);else o[t][i][e]=s},preview:function(e,t,s,n,a){var i=this.storage;if("fs"!=t&&"all"!=t&&(i[t]||(i[t]={}),i[t][a]||(i[t][a]={}),i[t][a][e]))for(var o=0;o<n;o++)i[t][a][e].data[s+o]||(i[t][a][e].data[s+o]={preview:!0,index:s+o})},get:function(e,t,s,n,a,i,o){o=o||"pocketnet";var r=b.sdk.search;a=a||b.currentBlock,t=t||"fs",r.preview(a,t,s,n,o),e=trim(e.replace(/[^а-яА-Яa-zA-Z0-9\# _]+/g,""));var c=[encodeURIComponent(e),t,a,(s||0).toString(),(n||10).toString()];"pocketnet"!=o&&c.push(o),e.length?b.app.api.rpc("search",c).then(e=>{"fs"!=t&&("all"==t?_.each(e,function(e,t){r.add(a,t,e,s,n,o)}):(e=e[t]||{data:[]},r.add(a,t,e,s,n,o))),i&&i(e,a)}).catch(e=>{i&&i({})}):i&&i({})}},postscores:{storage:{},get:function(e,t,s){var n=b.sdk.postscores;!n.storage[e]||s?b.app.api.rpc("getpostscores",[e]).then(e=>{_.each(e,function(e){n.storage[e.posttxid]||(n.storage[e.posttxid]=[]),n.storage[e.posttxid].push({address:e.address,value:e.value})}),t&&t(null)}).catch(e=>{t&&t(e,null)}):t&&t()}},likes:{storage:{},who:{},extendshares:function(e,a){a=a||[];var i=b.sdk.likes.storage;_.each(e,function(e){var t,s,n=deep(b.app.platform,"sdk.node.shares.storage.trx."+e);n&&i[e]&&void 0===n.myVal&&(n.myVal=Number(i[e])),n&&(!(t=n.lastComment)||(s=_.find(a,function(e){return e==t.id}))&&i[s]&&t&&!t.myscore&&b.sdk.address.pnet()&&(t.myScore=Number(i[s]),_.each(b.sdk.comments.upvoteClbks,function(e){e(null,t,t.myscore,b.sdk.address.pnet().address)}))),n&&(n.who=b.sdk.likes.who[e])}),_.each(a,function(e){})},get:function(s,n){var a,i=b.sdk.likes;(s=_.filter(s,function(e){if(!i.storage[e])return!0})).length?(a=[],_.each(s,function(e){e=deep(b,"sdk.node.shares.storage.trx."+e),(e=deep(e,"lastComment.id"))&&a.push(e)}),b.app.user.isState(function(e){var t;e?(t="",(e=b.app.platform.sdk.address.pnet())&&(t=e.address),b.app.api.rpc("getpagescores",[s,t,a]).then(e=>{_.each(e,function(e){e.posttxid&&(e.value&&(i.storage[e.posttxid]=e.value),i.who[e.posttxid]=e.postlikers),e.cmntid&&e.myscore&&(i.storage[e.cmntid]=e.myscore)}),_.each(s,function(e){i.storage||(i.storage[e]="0")}),i.extendshares(s,a),n&&n(null)}).catch(e=>{n&&n(e,null)})):(_.each(s,function(e){i.storage[e]="0"}),i.extendshares(s),n&&n(null))})):n&&n()}},comments:{storage:{},sendclbks:{},upvoteClbks:{},find:function(e,t,s){var n=b.sdk.comments.storage,s=deep(n,e+"."+(s||"0"))||[];return _.find(s,function(e){return e.id==t})},address:function(e,t,s){return(s=b.sdk.comments.find(e,t,s))?s.address:""},users:function(e,s){e=_.map(e,function(e){return e.address}),b.sdk.users.get(e,function(e,t){s&&s(e,t)},!0)},info:function(e,t){b.sdk.comments.storage;var s=b.sdk.comments.ini;b.app.api.rpc("getcomments",["","",e]).then(e=>{e=s(e),t&&t(null,e)}).catch(e=>{t&&t(e)})},checkSign:function(e,t,s){return!0},toLastComment:function(e){return{address:e.address,answerid:e.answerid,parentid:e.parentid,id:e.id,children:e.children||0,postid:e.txid,block:b.currentBlock,msg:JSON.stringify({message:e.message,images:e.images}),time:e.time,timeUpd:e.timeUpd,scoreDown:0,scoreUp:0,myScore:0}},ini:function(e){var t=b.sdk.comments.storage;t.all||(t.all={}),b.sdk.relayTransactions.get();var s=_.map(e||[],function(e){var t=new pComment;return t.import(e),t.setTime(e.time,e.timeUpd),t.children=e.children,t.address=e.address,t.verify=!0,_.each(b.sdk.relayTransactions.withtemp("comment"),function(e){"comment"!=e.optype&&e.optype||e.parentid==t.id&&t.children++}),t});return _.each(b.sdk.relayTransactions.withtemp("cScore"),function(t){var e=_.find(s,function(e){return e.id==t.commentid});e&&!e.myScore&&(e.myScore=Number(t.value),0<t.value?e.scoreUp++:e.scoreDown++)}),_.each(s,function(e){t.all[e.id]=e}),s},getbyid:function(e,s){var t=b.sdk.comments.storage,a=b.sdk.comments.ini,n="",i=b.sdk.address.pnet();i&&(n=i.address),_.isArray(e)||(e=[e]),t.all||(t.all={}),(e=_.filter(e,function(e){if(e&&!t.all[e])return!0})).length?b.app.api.rpc("getcomments",["","",n,e]).then(n=>{var t=group(b.sdk.relayTransactions.withtemp("comment"),function(e){return e.optype||"comment"});_.each(["commentEdit","commentDelete"],function(e){_.each(t[e],function(t){var e=t.optype,s=_.find(n,function(e){if(e.id==(t.id||t.txid))return!0});"commentEdit"==e&&s&&s.id==t.id&&(s.msg=t.msg,s.timeUpd=t.timeUpd),"commentDelete"==e&&s&&s.id==t.id&&(s.deleted=!0)})});var e=a(n);b.sdk.comments.users(e,function(e,t){s&&s(e,t)})}).catch(e=>{s&&s(e)}):s&&s("tmp")},temps:function(n,a,i){var t=group(b.sdk.relayTransactions.withtemp("comment"),function(e){return e.optype||"comment"}),o=[];_.each(["comment","commentEdit","commentDelete"],function(e){_.each(t[e],function(t){var e,s;t.postid==a&&(i||"")==(t.parentid||"")&&(e=t.optype||"comment",s=_.find(n,function(e){if(e.id==(t.id||t.txid))return!0}),"comment"==e&&(s||n.push(t)),"commentEdit"==e&&s&&s.id==t.id&&(s.msg=t.msg,s.timeUpd=t.timeUpd),"commentDelete"==e&&s&&s.id==t.id&&(s.deleted=!0,o.push(s.id)))})})},get:function(t,n,a,e){var i=b.sdk.comments.storage,o=b.sdk.comments.ini,s="",r=b.app.platform.sdk.address.pnet();r&&(s=r.address),i[t]||(i[t]={}),b.app.api.rpc("getcomments",[t,n||"",s]).then(e=>{b.sdk.comments.temps(e,t,n);var s=o(e);i[t][n||"0"]=s,b.sdk.comments.users(s,function(e,t){a&&a(s,t)})}).catch(e=>{a&&a(null,e)})},last:function(t){var s=this.ini,e=b.app.platform.sdk.address.pnet();e&&e.address,b.app.api.rpc("getlastcomments",["7","",b.app.localization.key]).then(e=>{e=_.filter(e,function(e){return!e.deleted}),t&&t(s(e))}).catch(e=>{t&&t([],e)})},upvote:function(s,n){var a=deep(b.sdk,"comments.storage.all."+s.comment.v),i=b.app.platform.sdk.address.pnet().address;_.each(b.sdk.comments.upvoteClbks,function(e){e(null,a,s.value.v,i,!0)}),b.sdk.node.transactions.create.commonFromUnspent(s,function(e,t){e?(a&&(a.myScore=s.value.v,0<s.value.v&&a.scoreUp++,s.value.v<0&&a.scoreDown++),n&&n(null,a,s.value.v),_.each(b.sdk.comments.upvoteClbks,function(e){e(null,a,s.value.v,i)})):(n&&n(t,null),_.each(b.sdk.comments.upvoteClbks,function(e){e(t,a,null,i)}))})},delete:function(n,a,i){var o=b.sdk.comments.storage;a.txid=n,b.sdk.node.transactions.create.commonFromUnspent(a,function(e,t){var s;e?(o[n]||(o[n]={}),(s=_.find(o[n][a.parentid||"0"]||[],function(e){return e.id==a.id}))&&(s.deleted=!0),i&&i(null,e)):i&&i(t,null)})},send:function(n,e,a,i,o,r,c){var d=b.sdk.comments.storage;e.answerid=i,e.parentid=a,r&&(e.id=r),e.uploadImages(b.app,function(){return e.checkloaded()?(o&&o("imageerror",null),void _.each(b.sdk.comments.sendclbks,function(e){e("imageerror")})):void b.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){var s;e?((s=new pComment).import(e),s.temp=!0,s.address=e.address,e=b.currentTime(),s.children=0,s.setTime(e,e),!(e=deep(b.app.platform,"sdk.node.shares.storage.trx."+n))||a&&"0"!=a||e.comments++,d[n]||(d[n]={}),d[n][a||"0"]||(d[n][a||"0"]=[]),e=findIndex(d[n][a||"0"],function(e){if(e.id==r)return!0}),r&&-1!=e?(s.children=d[n][a||"0"][e].children,s.id=r,d[n][a||"0"][e]=s,d.all||(d.all={}),d.all[s.id]=s):d[n][a||"0"].push(s),o&&o(null,s),_.each(b.sdk.comments.sendclbks,function(e){e(null,s,n,a,i,r,c,!0)})):(o&&o(t,null),_.each(b.sdk.comments.sendclbks,function(e){e(t)}))})})}},node:{storage:{balance:{}},loading:{},updating:null,update:function(){function e(){b.sdk.node.loading.update=!0,lazyEach({array:t,action:function(e){var t=deep(b.sdk.node,e.item);t?t(e.success):e.success()},all:{success:function(){b.sdk.node.loading.update=!1}}})}var t=["get.lastBlockHeader"];e(),this.updating=retry(function(){return!b.sdk.node.loading.update},function(){e()},4e4,!0)},get:{info:function(t){b.app.api.rpc("getnodeinfo").then(e=>{t&&t(e)}).catch(e=>{t&&t(null,e)})},timepr:function(){if(b.lasttimecheck){var e=new Date;if(b.lasttimecheck.addSeconds(10)>e)return Promise.resolve()}return b.app.api.rpc("getnodeinfo").then(e=>{var t=deep(e,"time")||0;return b.currentBlock=deep(e,"lastblock.height")||localStorage.lastblock||0,b.timeDifference=0,localStorage.lastblock=b.currentBlock,t&&(e=new Date,b.lasttimecheck=e,b.timeDifference=t-Math.floor(e.getTime()/1e3),b.timeDifferenceTimeZone=t-Math.floor((e.getTime()+6e4*e.getTimezoneOffset())/1e3)),Promise.resolve()})},time:function(t){b.sdk.node.get.timepr().then(()=>{t&&t()}).catch(e=>{t&&t(null,e)})},address:function(){return"undefined"!=typeof _Test&&_Test?b.nodes_test[0]:b.nodes[1]},balance:function(t,s){var n=b.sdk.node.storage.balance;b.app.api.rpc("getBalance",["*",6]).then(e=>{n[t]=e.result,s&&s(n[email])}).catch(e=>{s&&s(n[email],e)})}},account:{import:function(e,t){b.app.api.rpc("importAddress",[e,e,1]).then(e=>{t&&t()}).catch(e=>{t&&t()})},get:function(e,t){b.app.api.rpc("getAccount",[e,1]).then(e=>{t&&t(e.result)}).catch(e=>{t&&t()})},getset:function(t,s,n){b.sdk.node.account.get(s,function(e){e?n&&n():b.sdk.node.account.import(t,s,n)})}},shares:{storage:{},loading:{},parameters:{stor:{},defaults:{period:"4320"},get:function(){var e=b.sdk.node.shares.parameters.meta,s={};return _.each(e,function(e,t){s[t]=new Parameter(e()),s[t]._onChange=function(e){b.sdk.node.shares.parameters.stor[t]=s[t].value,b.sdk.node.shares.parameters.save()}}),s},meta:{period:function(){var e=b.sdk.node.shares.parameters.stor.period||b.sdk.node.shares.parameters.defaults.period;return{type:"VALUES",name:b.app.localization.e("period"),id:"period",placeholder:b.app.localization.e("period"),possibleValues:["1440","4320","10080","43200","262080"],possibleValuesLabels:[b.app.localization.e("periodday"),b.app.localization.e("period3day"),b.app.localization.e("period7day"),b.app.localization.e("period31day"),b.app.localization.e("period182day")],value:e,defaultValue:e}}},load:function(e){var t={};try{t=JSON.parse(localStorage.sharessettings||"{}")}catch(e){}b.sdk.node.shares.parameters.stor=t.stor||{},e&&e()},save:function(){localStorage.sharessettings=JSON.stringify({stor:b.sdk.node.shares.parameters.stor})}},clbks:{added:{}},default:function(e){var t=deep(u,"user.address.value");return t&&(t=deep(b,"sdk.users.storage."+t),30<=_.map(deep(t,"subscribes")||[],function(e){return e.adddress}).length)?"sub":"common"},getWithTemp:function(t){var e,n=deep(b.app.platform,"sdk.node.shares.storage.trx."+t);return n||(e=_.find(b.sdk.relayTransactions.withtemp("share"),function(e){return e.txid==t}),(n=new pShare)._import(e,!0),n.temp=!0,s.relay&&(n.relay=!0),n.address=b.app.platform.sdk.address.pnet().address),n},users:function(e,t){var s=[];_.each(e||[],function(e){s.push(e.address),(e=deep(e,"lastComment.address"))&&s.push(e)}),b.sdk.users.get(s,t,!0)},add:function(t){this.storage[t.txid]=t,_.each(this.clbks.added,function(e){e(t)})},tempLikes:function(i){_.each(b.sdk.relayTransactions.withtemp("upvoteShare"),function(t){var s=t.share;_.find(i,function(e){if(e.txid==s)return e.upvote(t.value),e.scnt||(e.scnt=0),e.score||(e.score=0),e.scnt++,e.score=Number(e.score||0)+Number(t.value),!0})});var t=group(b.sdk.relayTransactions.withtemp("comment"),function(e){return e.optype||"comment"});_.each(["comment","commentEdit","commentDelete"],function(e){e=t[e],_.each(e,function(n){var a;n.parentid||(a=n.postid,_.find(i,function(e){if(e.txid==a){var t=n.optype||"comment",s=e.lastComment;return"comment"==t&&(e.comments++,(!s||Number(s.timeUpd)<Number(n.timeUpd))&&((e.lastComment=n).id=n.txid)),"commentEdit"==t&&s&&s.id==n.id&&(t=e.lastComment.time,e.lastComment=n,e.lastComment.time=t),"commentDelete"==t&&s&&s.id==n.id&&(e.lastComment.deleted=!0,e.comments--),!0}}))})})},txids:function(e,t,s){this.getbyid(e.txids,t,s)},getbyidsp:function(e,t,s){this.getbyids(e.txids,e.begin,10,t,s)},getbyids:function(t,e,s,n,a){var i=this.storage,o=bitcoin.crypto.hash256(JSON.stringify("txids"),"utf8"),r={};if(r.count=s=s||10,i.ids||(i.ids={}),i.ids[o]&&!a||(i.ids[o]=[]),t.length){if(i.ids[o].length){if(!e){var c=i.ids[o][i.ids[o].length-1];if(c==t[t.length-1])return void(n&&n([],null,r));e=c}}else e=e||t[0];e=_.indexOf(t,e),s=_.clone(t).splice(e,s),this.getbyid(s,function(e){i.ids[o]=[],_.each(t,function(e){i.trx[e]&&i.ids[o].push(i.trx[e])}),n&&n(e,null,r)},a)}else n&&n([],null,r)},getbyid:function(t,n,e){var a=this.storage;a.trx||(a.trx={});var i=this.loading,o=[],s=[];function r(e){retry(function(){if(!(s=_.filter(s,function(e){if(i[e])return!0})).length)return!0},function(){e()},20)}_.isArray(t)||(t=[t]);var c,d,l=_.filter(t,function(e){return e});e||(t=_.filter(t,function(e){return!!e&&(!a.trx[e]||void o.push(a.trx[e]))})),t=_.filter(t,function(e){return!!e&&(!i[e]||void s.push(e))}),s.length,t.length?(c=[t],d=b.sdk.node.transactions.temp,b.sdk.address.pnet(),_.each(t,function(e){i[e]=!0}),b.app.user.isState(function(s){b.app.api.rpc("getrawtransactionwithmessagebyid",c).then(e=>{e&&!_.isArray(e)&&(e=[e]),e=_.sortBy(e,function(e){return _.indexOf(t,e.txid)}),e=_.filter(e||[],function(e){if(e.address)return!0}),_.each(t,function(e){delete i[e]}),e=_.map(e||[],function(e){var t=new pShare;return t._import(e),t.txid=e.txid,t.time=new Date,t.address=e.address,t.time.setTime(1e3*e.time),t.score=e.scoreSum,t.scnt=e.scoreCnt,a.trx[t.txid]=t,s&&d.share&&d.share[t.txid]&&delete d.share[t.txid],b.sdk.node.shares.takeusers(e,s),t}),o=o.concat(e),b.sdk.node.shares.tempLikes(o),r(function(){n&&n(o,null,{count:t.length})})}).catch(e=>{n&&n(null,e,{})})})):r(function(){var e=_.map(l,function(e){return a.trx[e]});n&&n(e,null,{count:e.length},!0)})},transform:function(e,s){var n=this.storage;n.trx||(n.trx={});var a=b.sdk.node.transactions.temp;return e=_.filter(e||[],function(e){if(e.address)return!0}),e=_.map(e||[],function(e){var t=new pShare;return t._import(e),t.txid=e.txid,t.time=new Date,t.address=e.address,t.time.setTime(1e3*e.time),t.score=e.scoreSum,t.scnt=e.scoreCnt,t.edit=e.edit||!1,t.info=null,e.ranks?t.info=e.ranks:(e.BOOST||e.DPOST||e.DREP||e.LAST5||e.LAST5||e.LAST5R||e.POSTRF||e.PREP||e.PREPR||e.UREP)&&(t.info={BOOST:e.BOOST,DPOST:e.DPOST,DREP:e.DREP,LAST5:e.LAST5,LAST5R:e.LAST5R,POSTRF:e.POSTRF,PREP:e.PREP,PREPR:e.PREPR,UREP:e.UREP,UREPR:e.UREPR}),s&&a.share&&a.share[t.txid]&&delete a.share[t.txid],n.trx[t.txid]=t}),b.sdk.node.shares.tempLikes(e),e},takeusers:function(e,s){_.each(e,function(e){var t=e.userprofile;t&&(e=b.sdk.users.prepareuser(t,t.address,s),b.sdk.usersl.storage[t.address]=e)})},get:function(e,n,t){t=t||"getrawtransactionwithmessage",this.storage,b.app.user.isState(function(s){b.app.api.rpc(t,e).then(e=>{var t=b.sdk.node.shares.transform(e,s);b.sdk.node.shares.takeusers(e,s),n&&n(t)}).catch(e=>{n&&n([],e)})})},getex:function(e,a,t){t=t||"getrawtransactionwithmessage",this.storage,b.app.user.isState(function(n){b.app.api.rpc(t,e,{rpc:{ex:!0}}).then(e=>{e.contents||(e.contents=[]);var t,s=e.contents;e.contents=b.sdk.node.shares.transform(e.contents,n),b.sdk.node.shares.takeusers(s,n),e.users&&b.sdk.node.shares.takeusers(_.map(e.users,function(e){return{userprofile:e}}),n),e.videos&&(t=b.sdk.videos.storage,s=_.map(e.videos,function(e,t){return{meta:parseVideo(t),link:t}}),b.sdk.videos.catchPeertubeLinks(e.videos,s),_.each(s,function(e){t[e.link]=t[e.meta.id]=e})),a&&a(e)}).catch(e=>{a&&a([],e)})})},recommended:function(i,o,r){i=i||{},b.app.user.isState(function(s){i.count||(i.count="30"),s&&(i.address=b.sdk.address.pnet().address);var e,t,n=b.sdk.node.shares.storage,a="recommended";"cache"==r&&n[a]?o&&o(n[a],null,i):(t=[],t=["30",e=i.period||b.sdk.node.shares.parameters.stor.period||b.sdk.node.shares.parameters.defaults.period||"4320",e*(i.page||0)||"",b.app.localization.key],i.video&&t.push("video"),b.sdk.node.shares.get(t,function(e,t){e?b.sdk.node.shares.loadvideoinfoifneed(e,i.video,function(){s&&_.each(b.sdk.relayTransactions.withtemp("blocking"),function(t){_.each(e,function(e){e.address==t.address&&(e.blocking=!0)})}),i.video&&(e=_.filter(e,function(e){if(e.url){var t=u.platform.parseUrl(e.url);return!("youtube"!=t.type&&"vimeo"!=t.type&&"bitchute"!=t.type&&"peertube"!=t.type||!b.sdk.videos.storage[e.url]||!b.sdk.videos.storage[e.url].data)||void 0}})),n[a]=e,o&&o(n[a],t,i)}):o&&o(e,t,i)},"gethotposts"))})},common:function(r,c,d){b.app.user.isState(function(t){(r=r||{}).count||(r.count=10),t&&(r.address=b.sdk.address.pnet().address);var s,n,e,a=(r.address||"")+"_"+(r.author||"")+"_"+(r.begin||"")+"_"+b.app.localization.key,i=(b.sdk.node.transactions.temp,b.sdk.node.shares.storage),o=b.sdk.node.shares;"cache"==d&&i[a]?(s=null,n=0,r.txid||(s=!0),_.filter(i[a],function(e,t){return i.trx[e.txid]=e,s&&n<r.count?(n++,!0):void(e.txid==r.txid&&(s=!0))}),c&&c(i[a],null,r)):(i[a]||(i[a]=[]),"clear"==d&&(i[a]=[]),r.txid||i[a].length&&(e=0<r.count?i[a][i[a].length-1]:i[a][0],r.txid=e.txid),r.txid||(r.txid=r.begin||""),e="",e=[e="1"==r.author?r.address:e,r.author||"",r.txid||"",r.count,r.author?"":b.app.localization.key],o.get(e,function(s,e){s&&(t&&(r.author&&r.author!=r.address||_.each(b.sdk.relayTransactions.withtemp("share"),function(e){var t=new pShare;t._import(e,!0),t.temp=!0,e.relay&&(t.relay=!0),t.address=e.address,e.txidEdit?replaceEqual(s,{txid:e.txidEdit},t):s.unshift(t)}),_.each(b.sdk.relayTransactions.withtemp("blocking"),function(t){_.each(s,function(e){e.address==t.address&&(e.blocking=!0)})})),_.each(s||[],function(e){0<r.count?i[a].push(e):i[a].unshift(e)}),b.sdk.node.transactions.saveTemp()),c&&c(s,e,r)}))})},loadvideoinfoifneed:function(e,t,s){b.sdk.videos.infoshares(e).then(e=>{s&&s()}).catch(e=>{s&&s()})},getusercontents:function(e,t,s){b.app.platform.sdk.node.shares.hierarchical(e,t,s,{method:"getusercontents"})},hierarchical:function(r,c,d,l){l=l||{},b.app.user.isState(function(a){(r=r||{}).count||(r.count=10),r.lang||(r.lang=b.app.localization.key),r.height||(r.height=0),r.tagsfilter||(r.tagsfilter=[]),r.begin||(r.begin=""),a&&(r.address=b.sdk.address.pnet().address);var i=r.count+(r.address||"")+"_"+(r.lang||"")+"__"+r.tagsfilter.join(",")+"_"+(r.begin||"")+(r.video?"video":"");r.author&&(i+=r.author);var s,n,e,o=b.sdk.node.shares.storage,t=b.sdk.node.shares;"cache"==d&&o[i]?(s=null,n=0,r.txid||(s=!0),_.each(o[i],function(e,t){return o.trx[e.txid]=e,s&&n<r.count?(n++,!0):void(e.txid==r.txid&&(s=!0))}),c&&c(o[i],null,r)):(o[i]&&"clear"!=d||(o[i]=[]),r.txid||o[i].length&&(e=0<r.count?o[i][o[i].length-1]:o[i][0],r.txid=e.txid),r.txid||(r.txid=r.begin||""),r.tagsfilter=_.map(r.tagsfilter,function(e){return encodeURIComponent(e)}),r.video&&!b.videoenabled&&(r.tagsfilter=["video"]),e=[Number(r.height),r.txid,r.count,r.lang,r.tagsfilter,r.video&&b.videoenabled?"video":""],r.author&&e.unshift(r.author),t.getex(e,function(e,t){var s=e.contents||[],n=e.height;_.each(s,function(e){e.info&&(e.info.BLOCK=n)}),r.blocknumber=n,s?b.sdk.node.shares.loadvideoinfoifneed(s,r.video,function(){a&&_.each(b.sdk.relayTransactions.withtemp("blocking"),function(t){_.each(s,function(e){e.address==t.address&&(e.blocking=!0)})}),r.video&&(s=_.filter(s,function(e){if(e.url){var t=u.platform.parseUrl(e.url);return!("youtube"!=t.type&&"vimeo"!=t.type&&"bitchute"!=t.type&&"peertube"!=t.type||!b.sdk.videos.storage[e.url]||!b.sdk.videos.storage[e.url].data)||void 0}})),_.each(s||[],function(e){0<r.count?o[i].push(e):o[i].unshift(e)}),b.sdk.node.transactions.saveTemp(),c&&c(s,t,r)}):c&&c(s,t,r)},l.method||"gethierarchicalstrip"))})}},transactions:{unspent:null,storage:{},loading:{},unspentLoading:{},temp:{},clbks:{},tempOptions:{userInfo:{count:"one"}},getCoibaseTypeN:function(e,t){var s=null;if(!e.vout||!e.vout.length||!t)return null;var n=e.vout[0],a=e.vout.length;if(!n||a<=1)return null;try{var i=bitcoin.script.decompile(Buffer.from(n.scriptPubKey.hex,"hex")),o=i.length;if(!o)return null;for(var r=0,c=a-1;0<c;c--){r++;var d,l=e.vout[c];deep(l,"scriptPubKey.addresses.0")==t&&i[o-r]&&((d=i[o-r])==bitcoin.opcodes.OP_WINNER_POST&&(s="post"),d==bitcoin.opcodes.OP_WINNER_COMMENT&&(s="comment"),d==bitcoin.opcodes.OP_WINNER_POST_REFERRAL&&(s="postref"),d==bitcoin.opcodes.OP_WINNER_COMMENT_REFERRAL&&(s="commentref"))}}catch(e){console.log("E",e)}return s},getCoibaseType:function(e,n){var a=null;return _.each(e.vout,function(e){if(deep(e,"scriptPubKey.addresses.0")==n)try{var t=bitcoin.script.decompile(Buffer.from(e.scriptPubKey.hex,"hex")),s=_.find(t,function(e){return e==bitcoin.opcodes.OP_WINNER_POST||e==bitcoin.opcodes.OP_WINNER_COMMENT||e==bitcoin.opcodes.OP_WINNER_POST_REFERRAL||e==bitcoin.opcodes.OP_WINNER_COMMENT_REFERRAL});(a=(a=(a=(a=s)==bitcoin.opcodes.OP_WINNER_POST?"post":a)==bitcoin.opcodes.OP_WINNER_COMMENT?"comment":a)==bitcoin.opcodes.OP_WINNER_POST_REFERRAL?"postref":a)==bitcoin.opcodes.OP_WINNER_COMMENT_REFERRAL&&(a="commentref")}catch(e){console.log("ERR",e)}}),a},getOpreturn:function(e){var s=[];return _.each(e.vout,function(e){try{var t=bitcoin.script.decompile(Buffer.from(e.scriptPubKey.hex,"hex"));t[0]==bitcoin.opcodes.OP_RETURN&&s.push(t[1].toString())}catch(e){}}),s.join("")},addressFromScryptSig:function(e){return(e=e&&e.split(" ")[1])?(e=bitcoin.ECPair.fromPublicKey(Buffer.from(e,"hex")),b.sdk.address.pnetsimple(e.publicKey).address):""},toUT:function(e,s,n){var t=_.find(e.vout,function(t){return _.find(t.scriptPubKey.addresses,function(e){return e==s&&(void 0===n||n==t.n)})}),a=deep(e,"vin.0.coinbase")||"nonstandard"==deep(e,"vout.0.scriptPubKey.type")||!1;return{txid:e.txid,vout:t.n,address:s,confirmations:e.confirmations||0,coinbase:a||e.coinstake,amount:t.value,scriptPubKey:t.scriptPubKey.hex,pockettx:e.pockettx}},toUTs:function(s,n){var a=[];return _.each(s.vout,function(e){var t;_.find(e.scriptPubKey.addresses,function(e){return e==n})&&(t=deep(s,"vin.0.coinbase")||"nonstandard"==deep(s,"vout.0.scriptPubKey.type")||!1,e={txid:s.txid,vout:Number(e.n),address:n,confirmations:s.confirmations,coinbase:t||s.coinstake,amount:e.value,scriptPubKey:e.scriptPubKey.hex,pockettx:s.pockettx},a.push(e))}),a},waitSpend:function(e){return e.confirmations<=11&&e.pockettx?11-e.confirmations:0!=e.confirmations||e.coinbase||e.coinstake?e.confirmations<100&&(e.coinbase||e.coinstake)?100-e.confirmations:0:1},releaseCS:function(e){_.each(e,function(e){delete e.cantspend})},canSpend:function(e){return!e.cantspend&&!e.block&&(!b.sdk.node.transactions.waitSpend(e)||void 0)},sign:function(e,t){e=e.toHex(),b.app.api.rpc("signrawtransactionwithkey",[e,[]]).then(e=>{t&&t(e)}).catch(e=>{t&&t(null,e)})},send:function(e,t){e=e.toHex(),b.app.api.rpc("sendrawtransaction",[e]).then(e=>{t&&t(e)}).catch(e=>{t&&t(null,e)})},saveTemp:function(e){b.sdk.address.pnet()&&b.app.settings.set(b.sdk.address.pnet().address,"temp2",JSON.stringify(b.sdk.node.transactions.temp)),e&&e()},loadTemp:function(e){var t=b.sdk.address.pnet();b.sdk.node.transactions.temp=t?JSON.parse(b.app.settings.get(b.sdk.address.pnet().address,"temp2")||"{}"):{},e&&e()},findTemp:function(t){var e=this.temp,s=null;return _.each(e,function(e){e[t]&&(s=e[t])}),s},clearTempHard:function(){b.sdk.node.transactions.temp={},b.sdk.node.transactions.saveTemp(),_.each(b.sdk.node.transactions.clbks,function(e){e()})},clearTemp:function(n,a,e){var t=this.temp,i=null;return _.each(t,function(e,t){var s=e[n];s&&(s.outputs?(s.outputs[a]&&(s.outputs[a].deleted=!0),_.filter(s.outputs,function(e){return!e.deleted}).length||(delete e[n],i=s)):(delete e[n],i=s))}),i},checkTemps:function(e){var s=this.checkTemp,n=this.temp,t=[],a=!1;_.each(n,function(e){_.each(e,function(e){t.push(e)})}),lazyEach({array:t,action:function(t){s(t.item,function(e){e&&_.each(n,function(e){e[t.item.txid]&&(a=!0,delete e[t.item.txid])}),b.sdk.node.transactions.saveTemp(),t.success()})},all:{success:function(){a&&_.each(b.sdk.node.transactions.clbks,function(e){e()}),e&&e()}}})},checkTemp:function(e,s){e&&e.txid?b.sdk.node.transactions.get.tx(e.txid,function(e,t){s&&(t=deep(t,"code")||null,s(-5==t||-8==t||0<deep(e,"confirmations")))}):s&&s(null)},tempInputs:function(){var e=this.temp,t=[];return _.each(e,function(e){_.each(e,function(e){e.inputs&&_.each(e.inputs,function(e){t.push(e)})})}),t},tempOutputs:function(){if(!b.sdk.address.pnet())return[];var e=this.temp,s=[],n=[b.sdk.address.pnet().address].concat(b.sdk.addresses.storage.addresses||[]);return _.each(e,function(e){_.each(e,function(e){e.outputs&&_.each(e.outputs,function(t){_.find(n,function(e){if(e==t.address)return!0})&&s.push(t)})})}),s},tempBalanceOutputs:function(){var e=this.tempOutputs();return _.reduce(e,function(e,t){return t.deleted?e:e+t.amount},0)},tempBalance:function(){return this.tempBalanceOutputs()},haveTemp:function(){var e=this.temp,t=0;return _.each(e,function(e){_.each(e,function(e){t++})}),t},blockUnspents:function(e){var s=b.sdk.node.transactions;_.each(e,function(t){_.each(s.unspent,function(e){(e=_.find(e,function(e){return e.txid==t.txid&&e.vout==t.vout}))&&(e.block=!0)})})},unblockUnspents:function(e){var s=b.sdk.node.transactions;_.each(e,function(t){_.each(s.unspent,function(e){(e=_.find(e,function(e){return e.txid==t.txid&&e.vout==t.vout}))&&delete e.block})})},setUnspentoptimizationInterval:function(){t||(b.sdk.node.transactions.unspentOptimization(),t=setInterval(function(){b.sdk.node.transactions.unspentOptimization()},3e5))},clearUnspentoptimizationInterval:function(){t&&(clearInterval(t),t=null)},unspentOptimization:function(){var e,t=b.sdk.node.transactions,s=b.sdk.address.pnet();s&&t.unspent&&200<(e=_.filter(t.unspent[s.address]||[],function(e){return b.sdk.node.transactions.canSpend(e)&&e.amount})).length&&(e=_.filter(e,function(e,t){return t<180}),t=b.app.user.keys(),b.sdk.wallet.sendFromInputs(s.address,e,t,0,function(e,t){}))},clearUnspents:function(e){var n=!1,t=b.sdk.node.transactions,a=0,i=b.sdk.address.pnet();_.each(e,function(s){_.each(t.unspent,function(e,t){(e=removeEqual(e,{txid:s.txid,vout:s.vout}))&&(n=!0,i&&t==i.address&&(a+=Number(e.amount)))})}),n&&_.each(t.clbks,function(e){e(-a)})},get:{lenta:{common:function(){}},balanceAr:function(a,e,t,i){this.unspents(function(e,t){var s=0,n=[];_.each(e,function(e){i&&(e=_.filter(e,b.sdk.node.transactions.canSpend));var t=_.reduce(e,function(e,t){return e+Number(t.amount)},0);n=n.concat(e),s+=t}),a&&a(s,n,t)},e,t)},allBalanceUpdate:function(e){b.sdk.node.transactions.get.allBalance(e,!0)},allBalance:function(e,t){var s=[b.sdk.address.pnet().address].concat(b.sdk.addresses.storage.addresses||[]);this.balanceAr(e,s,t)},canSpend:function(e,s){e=e||[b.sdk.address.pnet().address].concat(b.sdk.addresses.storage.addresses||[]),_.isArray(e)||(e=[e]),this.balance(function(e,t){t=_.filter(t,b.sdk.node.transactions.canSpend),t=_.reduce(t,function(e,t){return e+Number(t.amount)},0),s&&s(t,e)},e)},balance:function(n,e,t,a){_.isArray(e)?this.balanceAr(n,e,t,a):this.unspent(function(e,t){a&&(e=_.filter(e,b.sdk.node.transactions.canSpend));var s=_.reduce(e,function(e,t){return e+Number(t.amount)},0);n&&n(s,e,t)},e,t)},_unspent:function(t){b.sdk.node.transactions;var e=b.sdk.address.pnet();b.app.api.rpc("listUnspent",[1,9999999,[e.address]]).then(e=>{t&&t(e||[])}).catch(e=>{t&&t([])})},_unspents:function(e,t,n){var a={};lazyEach({array:t,action:function(t){var s=t.item;b.sdk.node.transactions.get.unspent(function(e){a[s]=e,t.success()},s,n)},all:{success:function(){e&&e(a)}}})},unspents:function(t,s,n){function e(){(s=_.filter(s,function(e){return a.unspent[e]&&!n?(i[e]=a.unspent[e],!1):a.unspentLoading[e]=!0})).length?b.app.api.rpc("txunspent",[s,1,9999999]).then(e=>{a.unspent||(a.unspent={}),_.each(e,function(e){b.sdk.node.transactions.clearTemp(e.txid,e.vout)}),_.each(s,function(e){a.unspentLoading[e]=!1,a.unspent[e]=[],i[e]=[]}),_.each(e||[],function(e){var t=e.address;removeEqual(a.unspent[t],{txid:e.txid,vout:e.vout}),a.unspent[t].push(e),i[t].push(e)}),_.each(b.sdk.node.transactions.clbks,function(e){e()}),t&&t(i)}).catch(e=>{a.unspent||(a.unspent={}),_.each(s,function(e){a.unspent[e]=[],a.unspentLoading[e]=!1,i[e]=[]}),t&&t(null,e)}):t&&t(i)}var a=b.sdk.node.transactions;a.unspent||(a.unspent={});var i={};_.filter(s,function(e){if(a.unspentLoading[e])return!0}).length?retry(function(){if(!_.filter(s,function(e){if(a.unspentLoading[e])return!0}).length)return!0},function(){e()},10):e()},unspent:function(t,s,e){var n=b.sdk.node.transactions;n.unspent||(n.unspent={}),(s=b.sdk.address.pnet()?s||b.sdk.address.pnet().address:s)?n.unspentLoading[s]?retry(function(){if(!n.unspentLoading[s])return!0},function(){t&&t(n.unspent[s])},10):n.unspent[s]&&!e?t&&t(n.unspent[s]):(n.unspentLoading[s]=!0,b.app.api.rpc("txunspent",[[s],1,9999999]).then(e=>{n.unspent||(n.unspent={}),n.unspent[s]=e||[],n.unspentLoading&&(n.unspentLoading[s]=!1),t&&t(n.unspent[s])}).catch(e=>{n.unspent||(n.unspent={}),n.unspent[s]=[],n.unspentLoading&&(n.unspentLoading[s]=!1),t&&t(n.unspent[s],e)})):t&&t()},tx:function(t,s){b.sdk.node.transactions.loading[t]?retry(function(){if(!b.sdk.node.transactions.loading[t])return!0},function(){s&&s(b.sdk.node.transactions.storage[t])},40):b.sdk.node.transactions.storage[t]?s&&s(b.sdk.node.transactions.storage[t]):(b.sdk.node.transactions.loading[t]=!0,b.app.api.rpc("getrawtransaction",[t,1]).then(e=>{b.sdk.node.transactions.loading[t]=!1,b.sdk.node.transactions.storage[t]=e,s&&s(e)}).catch(e=>{b.sdk.node.transactions.loading[t]=!1,s&&s(null,e)}))}},htls:{plcreate:function(a,i,o,r,c){b.sdk.node.shares.getbyid(a,function(){if(!(n=b.sdk.node.shares.storage.trx[a]))return c("item");var e=965704,t=n.address,{txb:s,payment:n}=b.sdk.node.transactions.htls.create(o,r,a,t,i,e);c&&c(s,{address:t,time:e,payment:n,htlc:n.htlc,tdif:e-b.currentBlock})})},create:function(e,t,s,n,a,i){function o(e,t){t=t||100;for(var s=Buffer.from(e),n=0;n<t;n++)s=bitcoin.crypto.sha256(s);return s.toString("hex")}var r=b.app.user.keys(),c=r.privateKey,s=(d=s,o(o(c.toString("hex"))+"_"+d,10)),d=bitcoin.payments.htlc({htlc:{secret:s,lock:i,reciever:n,sender:b.sdk.address.pnetsimple(r.publicKey).address}});if(!(c=_.find(t,function(e){return"htlc"==e.key})))return Promise.reject("htlcout");var l=[{scriptPubKey:d.output,amount:c.amount}],u={};return _.each(t,function(e){e.address&&(u[l.push(e)-1]=!0)}),console.log("htlc",{secret:s,lock:i,reciever:n,sender:b.sdk.address.pnetsimple(r.publicKey).address}),{txb:b.sdk.node.transactions.create.wallet(e,l,null,!0),payment:d,secret:s}},withdrawal:function(e,t,s,n){n=n||{};var a=0;s=s||0,e=_.map(e,function(e){return a+=e.value,{vout:e.n,scriptPubKey:e.scriptPubKey.hex,amount:e.value,type:e.scriptPubKey.type,txid:e.txid}}),s=[{address:t,amount:a-s}],n=b.sdk.node.transactions.create.wallet(e,s,null,!1,n),b.sdk.node.transactions.send(n,function(e,t){t&&sitemessage(t)})}},create:{commonFromUnspent:function(a,i,o,r){var c,e;o=o||{},b.sdk.address.pnet()&&!a.fromrelay&&(c=b.sdk.address.pnet().address,!(e=u.platform.sdk.registrations.storage[c])||3!=e&&4!=e||(o.relay=c)),a.checkloaded&&a.checkloaded()?i&&i(null,"resourses"):b.sdk.node.transactions.get.unspent(function(e){if(!(e=_.filter(e,b.sdk.node.transactions.canSpend)).length&&!o.relay)return o.update?void(i&&i(null,"money")):(o.update=!0,void b.sdk.node.transactions.create.commonFromUnspent(a,i,o,r));var t=[];e.length&&(t=[{txId:e[e.length-1].txid,vout:e[e.length-1].vout,amount:e[e.length-1].amount,scriptPubKey:e[e.length-1].scriptPubKey}]),60<e.length&&t.push({txId:e[e.length-2].txid,vout:e[e.length-2].vout,amount:e[e.length-2].amount,scriptPubKey:e[e.length-2].scriptPubKey}),b.sdk.node.transactions.create[a.type](t,a,function(e,t,s){if(!(e||-26!=t&&-25!=t&&16!=t||o.update))return o.update=!0,void b.sdk.node.transactions.create.commonFromUnspent(a,i,o,r);var n=u.platform.sdk.registrations.storage[c];n&&4==n&&(b.sdk.registrations.add(c,5),(n=deep(u,"modules.menu.module.restart"))&&n()),i&&i(e,t,s)},o,r)},deep(o,"address.address"),o.update)},wallet:function(e,t,s,n,a){a=a||{};var i=s||b.app.user.keys(),o=new bitcoin.TransactionBuilder;return o.addNTime(b.timeDifference||0),_.each(e,function(e){"htlc"==e.type?o.addInput(e.txid,e.vout,null,Buffer.from(e.scriptPubKey,"hex"),a):o.addInput(e.txid,e.vout,null,Buffer.from(e.scriptPubKey,"hex"))}),_.each(t,function(e){o.addOutput(e.scriptPubKey||e.address,Number((1e8*e.amount).toFixed(0)))}),_.each(e,function(e,t){var s,n;"htlc"!=e.type?0!=e.address.indexOf("P")?0!=e.address.indexOf("Z")||-1<(n=_.indexOf(b.sdk.addresses.storage.addresses,e.address))&&(s=b.sdk.addresses.storage.addressesobj[n],n=b.sdk.address.dumpKeys(n),o.sign({prevOutScriptType:"p2sh-p2wpkh",redeemScript:s.redeem.output,vin:t,keyPair:n,witnessValue:Number((1e8*e.amount).toFixed(0))})):o.sign(t,i):o.sign({prevOutScript:Buffer.from(e.scriptPubKey,"hex"),prevOutScriptType:"htlc",vin:t,keyPair:i})}),n?o:o.build()},common:function(a,i,o,r,c){c=c||{};var d,l,u,p,f,m,g,h,v=b.sdk.node.transactions.temp,k=b.sdk.node.transactions.tempOptions,e=i.validation();e?r&&r(null,e):(d=c.keys||b.app.user.keys(),l=c.address||b.sdk.address.pnet(),(u=new bitcoin.TransactionBuilder).addNTime(b.timeDifference||0),p=0,_.each(a,function(e,t){u.addInput(e.txId,e.vout,null,Buffer.from(e.scriptPubKey,"hex")),p+=Number(e.amount)}),p*=1e8,f=Buffer.from(bitcoin.crypto.hash256(i.serialize()),"utf8"),m=i.typeop?i.typeop(b):i.type,g=m,i.optstype&&i.optstype(b)&&(g=i.optstype(b)),e=[Buffer.from(m,"utf8"),f],h=[],i.opreturn&&e.push(Buffer.from(i.opreturn())),e=bitcoin.payments.embed({data:e}),u.addOutput(e.output,0),h.push({amount:0,deleted:!0,address:l.address}),b.sdk.node.transactions.get.unspent(function(e){if(c.relay)return(t=i.export(!0)).txid=makeid(),t.address=c.relay,t.type=i.type,t.time=b.currentTime(),t.timeUpd=t.time,t.optype=m,t.relay=!0,b.sdk.relayTransactions.add(c.relay,t),void(r&&r(t));e.length<50&&2e7<p&&(n=Number((p/2).toFixed(0)),p-=n,u.addOutput(l.address,n),h.push({address:l.address,amount:n})),u.addOutput(l.address,Number((p-(o||0)).toFixed(0))),h.push({address:l.address,amount:Number((p-(o||0)).toFixed(0))}),_.each(a,function(e,t){u.sign(t,d)});var t,s,n=u.build().toHex();c.pseudo?((t=i.export(!0)).txid=makeid(),r&&r(t,null)):(s=_.map(a,function(e){return{txid:e.txId,vout:e.vout}}),b.app.platform.sdk.node.transactions.blockUnspents(s),b.app.api.rpc("sendrawtransactionwithmessage",[n,i.export(),g]).then(e=>{var t=i.export(!0);t.txid=e,t.address=l.address,t.type=i.type,t.time=b.currentTime(),t.timeUpd=t.time,t.optype=m;var s=deep(k,i.type+".count")||"many";v[i.type]&&"one"!=s||(v[i.type]={}),(v[i.type][e]=t).inputs=a,t.outputs=_.map(h,function(e){return{address:e.address,amount:e.amount/1e8,deleted:e.deleted}}),b.sdk.node.transactions.saveTemp(),e=_.map(a,function(e){return{txid:e.txId,vout:e.vout}}),b.app.platform.sdk.node.transactions.clearUnspents(e),i.ustate&&(e=i.ustate,(e="function"==typeof i.ustate?i.ustate():e)&&((e=b.sdk.ustate.storage)[l.address]&&(e[l.address][i.ustate+"_spent"]++,e[l.address][i.ustate+"_unspent"]--),_.each(b.sdk.ustate.clbks,function(e){e()}))),r&&r(t)}).catch(e=>{b.app.platform.sdk.node.transactions.unblockUnspents(s),r&&r(null,e.code,f)}))},l.address))},telegramSend:function(e,t){console.log("message",e);var s=t.telegram.value,n=t.tgto.possibleValuesLabels.indexOf(t.tgto.value);const a={chat_id:Number(t.tgto.possibleValues[n]),parse_mode:"HTML"};let i=(e.caption.v?"<b>"+e.caption.v+"</b>":"")+"\n "+e.message.v+"\n ";const o=e.images.v;i=i.replace(/<br>|<br\/>/g,"\n"),i=i.replace(/<\/p>/g,"</p>\n"),i=(e=>{const t={stripIgnoreTag:!0,whiteList:{a:["href"]}};return["b","strong","i","em","u","ins","s","strike","del","code","pre"].forEach(e=>{t.whiteList[e]=[]}),filterXSS(e,t).replace(/<a href>(.*)<\/a>/g,"$1").replace(/<a>(.*)<\/a>/g,"$1")})(i),e.url.v&&-1===i.indexOf(e.url.v)&&(i+="\n\n"+e.url.v);let r="sendMessage",c="text";1===o.length?(r="sendPhoto",c="caption",a.photo=o[0]):1<o.length&&(r="sendMediaGroup",c="caption",e=o.map((e,t)=>{const s={type:"photo",media:e};return 1===t&&(s.parse_mode="HTML",s.caption=i),s}),a.media=JSON.stringify(e)),a[c]=i,s=`https://api.telegram.org/bot${s}/${r}`,fetch(s,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(e){e.ok||sitemessage("Telegram error. "+e.description)}).catch(e=>sitemessage("Telegram error"))},share:function(e,t,s,n,a){var i,o=JSON.parse(JSON.stringify(t));!a&&b.app.user.features.telegram&&((i=b.sdk.usersettings.meta).tgtoask.value?dialog({html:"Do you really want send message to Telegram?",btn1text:"Send",btn2text:"Cancel",class:"zindex",success:()=>{this.telegramSend(o,i)}}):this.telegramSend(t,i)),this.common(e,t,1,s,n)},userInfo:function(e,t,s,n){this.common(e,t,1,s,n)},upvoteShare:function(e,t,s,n){this.common(e,t,1,s,n),b.sdk.activity.adduser("like",t.address.v)},complainShare:function(e,t,s,n){this.common(e,t,1,s,n)},comment:function(e,t,s,n){this.common(e,t,1,s,n)},commentShare:function(e,t,s,n){this.common(e,t,1,s,n)},cScore:function(e,t,s,n){this.common(e,t,1,s,n),b.sdk.activity.adduser("like",t.address.v)},unsubscribe:function(e,t,s,n){this.common(e,t,1,s,n)},subscribe:function(e,t,s,n){this.common(e,t,1,s,n)},blocking:function(e,t,s,n){this.common(e,t,1,s,n)},unblocking:function(e,t,s,n){this.common(e,t,1,s,n)},subscribePrivate:function(e,t,s,n){this.common(e,t,1,s,n)}}},fee:{estimate:function(t){b.app.api.rpc("estimateSmartFee",[1]).then(e=>{e.feerate=1e-5,t&&t(e)}).catch(e=>{t&&t({feerate:1e-5})})}},sys:{revokeproxy:function(t,s){b.app.ajax.api({action:"nodes.revoke",data:t,signature:!0,success:function(e){removeEqual(b.app.platform.nodes,{host:t.host}),s&&s(!1,e.data)},fail:function(e){s&&s(deep(e,"error")||deep(e,"data")||"Undefined Error")}})},createproxy:function(e,t){b.app.ajax.api({action:"nodes.create",data:e,signature:!0,success:function(e){t&&t(!1,e.data)},fail:function(e){t&&t(deep(e,"data")||deep(e,"error")||"Undefined Error")}})},updateproxy:function(e,t){delete(e=_.clone(e)).stable,delete e.statistic,b.app.ajax.api({action:"nodes.update",data:e,signature:!0,success:function(e){t&&t(!1,e.data)},fail:function(e){t&&t(deep(e,"data")||deep(e,"error")||"Undefined Error")}})},createlocally:function(t,e){_.find(this.userlist,function(e){if(e.host==t.host)return!0})?e&&e(b.app.localization.e("e13292")):(t.addedby=b.sdk.address.pnet().address,t.date=new Date,this.userlist.unshift(t),this.save(),e&&e(null,t))},updatelocally:function(t,e){var s=_.find(this.userlist,function(e){if(e.host==t.host)return!0});s?(s.ws=t.ws,s.port=t.port,s.name=t.name,this.save(),e&&e(null,s)):e&&e(b.app.localization.e("e13293"))},revokelocally:function(e,t){removeEqual(this.userlist,{host:e.host}),this.save(),t&&t(null)},userlist:[],save:function(){localStorage.usernodes=JSON.stringify({list:this.userlist})},load:function(){var e={};try{e=JSON.parse(localStorage.usernodes||"{}")}catch(e){}this.userlist=e.list||[]}}},pool:{current:null,info:function(e,t){b.sdk.users.get(e.addresses,t)},dumpKey:function(e,s,n){this.expand(e,function(e){var t=_.indexOf(e.addresses,s);-1==t?n&&n(null):n&&n(e.private[t])})},expand:function(s,i){b.app.user.isState(function(e){var a,t;e?(t=b.sdk.address.pnet().address,-1<(e=_.indexOf(s.addresses,t))?(t=s.aes[e],e=b.app.user.private.value.toString("hex"),b.cryptography.disabled&&i&&i(null,"disabledcryptography"),b.cryptography.api.aeswc.decryption(t,e,{},function(e){a=e;var n={addresses:s.addresses,private:[],aes:s.aes,_key:a};lazyEach({array:s.keys,action:function(t,s){var e=t.item;b.cryptography.api.aeswc.decryption(e,a,{},function(e){e&&(n.private[s]=e,t.success())})},sync:!0,all:{success:function(){i&&i(n)}}})})):i&&i(null,"address")):i&&i(null,"state")})},export:function(n,e){var a={addresses:n.addresses,keys:[],aes:n.aes};lazyEach({array:n.private,action:function(t,s){var e=t.item;b.cryptography.api.aeswc.encryption(e,n._key,{},function(e){a.keys[s]=e,t.success()})},sync:!0,all:{success:function(){e&&e(a)}}})},push:function(t,e,s,n,a){t.addresses.push(e),t.private.push(s),b.cryptography.api.aeswc.encryption(n,s,{},function(e){t.aes.push(e),a&&a(t)})},remove:function(e,t){var s=b.sdk.pool.get(),n=_.indexOf(e.addresses,t);return-1<n&&(e.addresses.splice(n,1),e.private&&e.private.splice(n,1),e.keys&&e.keys.splice(n,1),e.aes&&e.aes.splice(n,1),delete s.map[t],!0)},add:function(e,t,s){var n=b.sdk.pool,a=n.get(),i=b.app.user.keysPairFromPrivate(t);if(i){var o=b.sdk.address.pnetsimple(i.publicKey).address,t=i.privateKey.toString("hex");if(a.map[o]){if(i=a.map[o],1<a.packs[i].addresses.length)return void(s&&s(null,"hasinanotherpack"));delete a.map[o],delete a.packs[i]}this.push(e,o,t,e._key,function(){n.currentMap(),s&&s(e)})}else s&&s(null,"failedkeypair")},new:function(s){var n=b.sdk.pool,a={addresses:[],private:[],aes:[],_key:null},i=[null,null];b.app.user.isState(function(e){if(e){var t=u.user.private.value;if(t)return e=t.toString("hex"),t=b.sdk.address.pnet().address,a._key=b.cryptography.api.random.crypto(),void n.push(a,t,e,a._key,function(e){n.export(e,function(e){i[0]=e,s&&s(i[0],i[1])})});i[1]="key"}else i[1]="state";s&&s(i[0],i[1])})},init:function(i){var o=b.sdk.pool;b.app.user.isState(function(e){var n,a;e&&!_Node?(n=o.get(),a=b.sdk.address.pnet().address,e=n.map[a],o.current=n,e?i&&i(n.packs[e],e):o.new(function(e,t){var s;e?(s=makeid(),n.map[a]=s,n.packs[s]=e,o.save()):sitemessage(t),i&&i(e,s)})):i&&i()})},get:function(){var e=b.sdk.pool.current;return e||(e=localStorage.pool)&&JSON.parse(e)||{map:{},packs:{}}},getPack:function(e){var t=b.sdk.pool.get();if(e=t.map[e])return[t.packs[e],e]},currentMap:function(){var s=b.sdk.pool.current;s.map={},_.each(s.packs,function(e,t){_.each(e.addresses,function(e){s.map[e]=t})})},save:function(e){var t=b.sdk.pool;b.app.user.isState(function(e){e&&t.current&&(t.currentMap(),localStorage.pool=JSON.stringify(t.current))})}},discussions:{fromChatId:function(e){var t=b.sdk.chats.storage[e];return t?b.sdk.discussions.fromChats([t])[e]:null},fromChats:function(e,a){var i={};return _.each(e||b.sdk.chats.storage,function(e){var t=e.id,s={chat:e};if("share"==e.type){var n=t.split("_")[1],e=t.split("_")[0];if(s.author=n,b.sdk.node.shares.storage.trx&&(s.share=b.sdk.node.shares.storage.trx[e]),a&&n!=a)return}i[t]=s}),i},info:function(e,t){var s=_.map(e,function(e){return e.chat});b.sdk.chats.info(s,function(){var e=b.sdk.discussions.fromChats(s);t&&t(e)})}},tempmessenger:{clbks:{},init:function(e){var t=b.sdk.address.pnet().address,s=bitcoin.crypto.hash256(t+b.app.options.fingerPrint).toString("hex"),t={device:s,address:t,signature:(t=b.app.user.keys()).sign(Buffer.from(bitcoin.crypto.hash256(s),"utf8")).toString("hex"),publicKey:t.publicKey.toString("hex")};b.clientrtctemp=new platformRTC({user:t,platform:b}),b.clientrtctemp.init(function(){}),e&&e()},getChat:function(e){e.rtc=b.clientrtctemp.api.getChat(e.id,e.users)},getChats:function(e){b.clientrtctemp&&b.clientrtctemp.getchats(e)}},messenger:{clbks:{},load:{messages:function(e,t){_.isArray(e)||(e=[e]),e=_.map(e,function(e){return e.f}),b.sdk.users.get(e,t,!0)}},getChat:function(e){e.rtc=b.clientrtc.api.getChat(e.id,e.users)},connectToChat:function(e,s){b.clientrtc.api.connectToChat({id:e.id,addresses:e.addresses},function(e,t){s&&s(e,t)})},init:function(e){var t=b.sdk.address.pnet().address,s=bitcoin.crypto.hash256(t+b.app.options.fingerPrint).toString("hex"),t={device:s,address:t,signature:(t=b.app.user.keys()).sign(Buffer.from(bitcoin.crypto.hash256(s),"utf8")).toString("hex"),publicKey:t.publicKey.toString("hex")};b.clientrtc=new platformRTC({user:t,platform:b}),t=b.app.platform.sdk.chats.get("messenger"),b.clientrtc.initChats(t),b.clientrtc.init(function(){b.clientrtc.api.login(function(){b.clientrtc.clbks.chat.messenger=function(e,t){var s;b.sdk.chats.storage[t.id]||(e=e||{},(s=b.sdk.chats.empty(t.id,"messenger")).rtc=t,e.addresses&&(s.users=e.addresses),b.sdk.chats.storage[t.id]=s,b.sdk.chats.info([s],function(){_.each(b.sdk.messenger.clbks||{},function(e){e("chat",s)})}),b.sdk.chats.save())},b.clientrtc.clbks.message.messenger=function(e,t){_.each(b.sdk.messenger.clbks||{},function(e){e("message",t)})},b.clientrtc.api.getRelayed()})}),e&&e()}},chats:{clbks:{},storage:{},_info:{shares:function(e,t){var e=_.filter(e,function(e){if("share"==e.type)return!0}),s=_.map(e,function(e){return e.id.split("_")[0]});b.sdk.node.shares.getbyid(s,function(){var e=_.map(s,function(e){return b.sdk.node.shares.storage.trx[e]||null}),e=_.filter(e,function(e){return e});b.app.platform.sdk.node.shares.users(e,function(){t&&t()})})},messenger:function(e,t){var s=[];_.each(e,function(e){_.each(e.users,function(e){s.push(e)}),b.app.platform.sdk.users.get(s,function(){t&&t()})})}},info:function(e,t){var s=this;s._info.shares(e,function(){s._info.messenger(e,function(){t&&t()})})},empty:function(e,t){return e={id:e||makeid(),type:t||"sys",time:b.currentTime()},"messenger"==t&&(e.users=[]),e},remove:function(t){_.each(b.sdk.chats.clbks,function(e){e(b.sdk.chats.storage[t],"remove")}),delete b.sdk.chats.storage[t],b.sdk.chats.save()},removeTemp:function(){_.each(b.sdk.chats.clbks,function(e){e(null,"removeTemp")})},addTemp:function(e,t,s){var n=b.sdk.chats.empty(e,t);_.each(b.sdk.chats.clbks,function(e){e(n,"addTemp",s)})},add:function(t,e){if(b.sdk.chats.storage[t])return b.sdk.chats.storage[t].time=b.currentTime(),b.sdk.chats.save(),_.each(b.sdk.chats.clbks,function(e){e(b.sdk.chats.storage[t],"addtwice")}),b.sdk.chats.storage[t];var s=b.sdk.chats.empty(t,e);return b.sdk.chats.storage[s.id]=s,_.each(b.sdk.chats.clbks,function(e){e(s,"add")}),b.sdk.chats.save(),s},light:function(){var s={};return _.each(b.sdk.chats.storage,function(e,t){s[t]={id:e.id,type:e.type,time:e.time,users:e.users}}),s},save:function(){var e=b.sdk.address.pnet().address;localStorage[e+"chats_4"]=JSON.stringify(b.sdk.chats.light())},load:function(e){var t={},s=b.sdk.address.pnet().address;if(s=localStorage[s+"chats_4"]||"{}")try{t=JSON.parse(s)}catch(e){console.log("ERR",e)}b.sdk.chats.storage=t,e&&e()},get:function(t){return _.filter(b.sdk.chats.storage,function(e){return"share"==t?"6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"==e.id||void 0:e.type==t})}},esystem:{requestes:{},clbks:{tick:{}},tickstate:{},tickstatehash:[],inited:!1,proxy:{settings:{meta:{dbEnable:{name:b.app.localization.e("e13294"),id:"dbEnable",type:"BOOLEAN",value:!1,dbId:"dbEnable"},dbHost:{name:b.app.localization.e("e13295"),id:"dbHost",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"db.host"},dbPort:{name:b.app.localization.e("e13296"),id:"dbPort",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"db.port"},dbMax:{name:b.app.localization.e("e13297"),id:"dbMax",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"db.max"},dbIdleTimeoutMillis:{name:b.app.localization.e("e13298"),id:"dbIdleTimeoutMillis",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"db.idleTimeoutMillis"},dbName:{name:b.app.localization.e("e13299"),id:"dbName",type:"STRING",value:"",dbId:"db.name"},dbUser:{name:b.app.localization.e("e13300"),id:"dbUser",type:"STRING",value:"",dbId:"db.user"},dbPassword:{name:b.app.localization.e("e13301"),id:"dbPassword",type:"password",value:"",dbId:"db.password"},server:{name:b.app.localization.e("e13302"),id:"server",type:"BOOLEAN",value:!1,dbId:"server"},serverPortHttps:{name:b.app.localization.e("e13303"),id:"serverPortHttps",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"ports.https"},serverPortWss:{name:b.app.localization.e("e13304"),id:"serverPortWss",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"ports.wss"},serverSslKeyUpload:{name:b.app.localization.e("e13305"),id:"serverSslKeyUpload",type:"file",value:"",upload:{},dbId:"ssl.key"},serverSslCertUpload:{name:b.app.localization.e("e13306"),id:"serverSslCertUpload",type:"file",value:"",upload:{},dbId:"ssl.cert"},serverSslPassphrase:{name:b.app.localization.e("e13307"),id:"serverSslPassphrase",type:"password",value:"",dbId:"ssl.passphrase"},serverFirebaseAdminSDK:{name:b.app.localization.e("e13308"),id:"serverFirebaseAdminSDK",type:"file",value:"",upload:{},dbId:"fbk"},pocketNetAuthTransactionCrane:{name:b.app.localization.e("e13309"),id:"pocketNetAuthTransactionCrane",type:"STRING",value:"",dbId:"refkey"},captchaEnable:{name:b.app.localization.e("e13310"),id:"captchaEnable",type:"BOOLEAN",value:!0,dbId:"captcha"},iplimiterEnable:{name:b.app.localization.e("e13311"),id:"iplimiterEnable",type:"BOOLEAN",value:!0,dbId:"iplimiter"}},create:function(e){var t=b.sdk.esystem.proxy.settings.meta;return new Parameter(t[e])},createall:function(){var s=(e=b.sdk.esystem.proxy.settings).create,e=e.meta,n={};return _.each(e,function(e,t){n[t]=s(t)}),n},compose:function(t){t=t||{};var e=(s=b.sdk.esystem.proxy.settings).createall(),s=(s.meta,{server:{name:b.app.localization.e("e13312"),options:{server:e.server,serverPortHttps:e.serverPortHttps,serverPortWss:e.serverPortWss,serverSslKeyUpload:e.serverSslKeyUpload,serverSslCertUpload:e.serverSslCertUpload,serverSslPassphrase:e.serverSslPassphrase}},db:{name:b.app.localization.e("e13313"),options:{dbEnable:e.dbEnable,dbHost:e.dbHost,dbMax:e.dbMax,dbIdleTimeoutMillis:e.dbIdleTimeoutMillis,dbName:e.dbName,dbUser:e.dbUser,dbPassword:e.dbPassword}},firebase:{name:b.app.localization.e("e13314"),options:{serverFirebaseAdminSDK:e.serverFirebaseAdminSDK}},other:{name:b.app.localization.e("e13315"),options:{pocketNetAuthTransactionCrane:e.pocketNetAuthTransactionCrane,captchaEnable:e.captchaEnable,iplimiterEnable:e.iplimiterEnable}}});return _.each(e,function(e){deep(t,e.dbId)&&(e.value=deep(t,e.dbId))}),{c:s,o:e}}}},node:{settings:{meta:{Enable:{name:b.app.localization.e("e13316"),id:"Enable",type:"BOOLEAN",value:!1,dbId:"Enable"},BinPath:{name:b.app.localization.e("e13317"),id:"binPath",type:"FILE_SELECT",upload:{},value:"",dbId:"BinPath"},ConfPath:{name:b.app.localization.e("e13318"),id:"confPath",type:"FILE_SELECT",upload:{},value:"",dbId:"ConfPath"},DataPath:{name:b.app.localization.e("e13319"),id:"dataPath",type:"FILE_SELECT",upload:{},value:"",dbId:"DataPath"},SetPrivateKey:{name:b.app.localization.e("e13320"),id:"setPrivateKey",type:"BUTTON",value:"#link_to_wallets",text:b.app.localization.e("e13321"),dbId:"SetPrivateKey"},state:{name:b.app.localization.e("e13322"),id:"state",type:"LABEL",value:"",dbId:"control.state"},addresses:{name:b.app.localization.e("e13323"),id:"addresses",type:"LABEL",value:"",dbId:"control.addresses"},lastBlock:{name:b.app.localization.e("e13324"),id:"lastBlock",type:"LABEL",value:"-",dbId:"control.lastBlock"}},create:function(e){var t=b.sdk.esystem.node.settings.meta;return new Parameter(t[e])},createall:function(){var s=(e=b.sdk.esystem.node.settings).create,e=e.meta,n={};return _.each(e,function(e,t){n[t]=s(t)}),n},compose:function(t){t=t||{};var e=(s=b.sdk.esystem.node.settings).createall(),s=(s.meta,{control:{name:b.app.localization.e("control"),options:{state:e.state,lastBlock:e.lastBlock,addresses:e.addresses}},setup:{name:b.app.localization.e("setup"),options:{Enable:e.Enable,DataPath:e.DataPath,SetPrivateKey:e.SetPrivateKey}}});return _.each(e,function(e){deep(t,e.dbId)&&(e.value=deep(t,e.dbId))}),{c:s,o:e}}}},destroy:function(){electron&&(electron.ipcRenderer.off("proxy-message",this.response),this.inited=!1)},request:function(e,t,s){t={action:e,id:makeid(),data:t},b.sdk.esystem.requestes[t.id]={id:t.id,clbk:function(e,t){s&&s(e,t)}},electron.ipcRenderer.send("proxy-message",t)},tick:function(e,t){var s=b.sdk.esystem,n=bitcoin.crypto.hash256(JSON.stringify(t)),a=n.join("")!==s.tickstatehash.join("");s.tickstatehash=n,s.tickstate=t.data||{},_.each(s.clbks.tick,function(e){e&&e(s.tickstate,a)})},response:function(e,t){var s=b.sdk.esystem.requestes[t.id];s&&(s.clbk&&s.clbk(t.error,t.data),delete b.sdk.esystem.requestes[t.id])},init:function(){electron&&(this.clbks.tick={},this.tickstate={},this.tickstatehash=[],this.tickstate={settings:{nedbkey:"settings",nedbpath:{settings:"./data/settings"},nodes:{defaults:[Object],stable:[Array]},server:!0,ports:{https:8888,wss:8088},ssl:{key:"./cert/key.pem",cert:"./cert/cert.pem",passphrase:"password"},dbEnable:!0,db:{host:"localhost",port:5432,max:10,idleTimeoutMillis:3e4,user:"postgres",database:"login",password:"password"},refkey:"",captcha:!0,iplimiter:!0},state:{},proxyReady:!0},electron.ipcRenderer.on("proxy-message",this.response),electron.ipcRenderer.on("proxy-message-tick",this.tick),this.inited=!0)}},system16:{requestes:{},clbks:{tick:{}},tickstate:{},tickstatehash:[],inited:!1,proxy:{settings:{meta:{server:{name:b.app.localization.e("e13302"),id:"server",type:"BOOLEAN",value:!1,dbId:"server"},serverPortHttps:{name:b.app.localization.e("e13303"),id:"serverPortHttps",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"ports.https"},serverPortWss:{name:b.app.localization.e("e13304"),id:"serverPortWss",type:"NUMBER",value:"",format:{Precision:0,groupSeparator:""},dbId:"ports.wss"},serverSslKeyUpload:{name:b.app.localization.e("e13305"),id:"serverSslKeyUpload",type:"file",value:"",upload:{},dbId:"ssl.key"},serverSslCertUpload:{name:b.app.localization.e("e13306"),id:"serverSslCertUpload",type:"file",value:"",upload:{},dbId:"ssl.cert"},serverSslPassphrase:{name:b.app.localization.e("e13307"),id:"serverSslPassphrase",type:"password",value:"",dbId:"ssl.passphrase"},serverFirebaseAdminSDK:{name:b.app.localization.e("e13308"),id:"serverFirebaseAdminSDK",type:"file",value:"",upload:{},dbId:"fbk"},pocketNetAuthTransactionCrane:{name:b.app.localization.e("e13309"),id:"pocketNetAuthTransactionCrane",type:"STRING",value:"",dbId:"refkey"},captchaEnable:{name:b.app.localization.e("e13310"),id:"captchaEnable",type:"BOOLEAN",value:!0,dbId:"captcha"},iplimiterEnable:{name:b.app.localization.e("e13311"),id:"iplimiterEnable",type:"BOOLEAN",value:!0,dbId:"iplimiter"}},create:function(e){var t=b.sdk.system16.proxy.settings.meta;return new Parameter(t[e])},createall:function(){var s=(e=b.sdk.system16.proxy.settings).create,e=e.meta,n={};return _.each(e,function(e,t){n[t]=s(t)}),n},compose:function(t){t=t||{};var e=(s=b.sdk.system16.proxy.settings).createall(),s=(s.meta,{server:{name:b.app.localization.e("e13312"),options:{server:e.server,serverPortHttps:e.serverPortHttps,serverPortWss:e.serverPortWss,serverSslKeyUpload:e.serverSslKeyUpload,serverSslCertUpload:e.serverSslCertUpload,serverSslPassphrase:e.serverSslPassphrase}},firebase:{name:b.app.localization.e("e13314"),options:{serverFirebaseAdminSDK:e.serverFirebaseAdminSDK}},other:{name:b.app.localization.e("e13315"),options:{pocketNetAuthTransactionCrane:e.pocketNetAuthTransactionCrane,captchaEnable:e.captchaEnable,iplimiterEnable:e.iplimiterEnable}}});return _.each(e,function(e){deep(t,e.dbId)&&(e.value=deep(t,e.dbId))}),{c:s,o:e}}}},node:{settings:{meta:{Enable:{name:b.app.localization.e("e13316"),id:"Enable",type:"BOOLEAN",value:!1,dbId:"Enable"},BinPath:{name:b.app.localization.e("e13317"),id:"binPath",type:"FILE_SELECT",upload:{},value:"",dbId:"BinPath"},ConfPath:{name:b.app.localization.e("e13318"),id:"confPath",type:"FILE_SELECT",upload:{},value:"",dbId:"ConfPath"},DataPath:{name:b.app.localization.e("e13319"),id:"dataPath",type:"FILE_SELECT",upload:{},value:"",dbId:"DataPath"},SetPrivateKey:{name:b.app.localization.e("e13320"),id:"setPrivateKey",type:"BUTTON",value:"#link_to_wallets",text:b.app.localization.e("e13321"),dbId:"SetPrivateKey"},state:{name:b.app.localization.e("e13322"),id:"state",type:"LABEL",value:"",dbId:"control.state"},addresses:{name:b.app.localization.e("e13323"),id:"addresses",type:"LABEL",value:"",dbId:"control.addresses"},lastBlock:{name:b.app.localization.e("e13324"),id:"lastBlock",type:"LABEL",value:"-",dbId:"control.lastBlock"}},create:function(e){var t=b.sdk.system16.node.settings.meta;return new Parameter(t[e])},createall:function(){var s=(e=b.sdk.system16.node.settings).create,e=e.meta,n={};return _.each(e,function(e,t){n[t]=s(t)}),n},compose:function(t){t=t||{};var e=(s=b.sdk.system16.node.settings).createall(),s=(s.meta,{control:{name:b.app.localization.e("control"),options:{state:e.state,lastBlock:e.lastBlock,addresses:e.addresses}},setup:{name:b.app.localization.e("setup"),options:{Enable:e.Enable,DataPath:e.DataPath,SetPrivateKey:e.SetPrivateKey}}});return _.each(e,function(e){deep(t,e.dbId)&&(e.value=deep(t,e.dbId))}),{c:s,o:e}}}},destroy:function(){electron&&(electron.ipcRenderer.off("proxy-message",this.response),this.inited=!1)},request:function(e,t,s){t={action:e,id:makeid(),data:t},b.sdk.system16.requestes[t.id]={id:t.id,clbk:function(e,t){s&&s(e,t)}},electron.ipcRenderer.send("proxy-message",t)},tick:function(e,t){var s=b.sdk.system16,n=bitcoin.crypto.hash256(JSON.stringify(t)),a=n.join("")!==s.tickstatehash.join("");s.tickstatehash=n,s.tickstate=t.data||{},_.each(s.clbks.tick,function(e){e&&e(s.tickstate,a)})},response:function(e,t){var s=b.sdk.system16.requestes[t.id];s&&(s.clbk&&s.clbk(t.error,t.data),delete b.sdk.system16.requestes[t.id])},init:function(){this.clbks.tick={},this.tickstate={},this.tickstatehash=[],electron&&(electron.ipcRenderer.on("proxy-message",this.response),electron.ipcRenderer.on("proxy-message-tick",this.tick)),this.inited=!0}},system:{refreshNodes:function(e){b.sdk.system.get.nodes(!0,e)},nodeexdirect:function(e){return b.nodeid?e?"http://"+b.nodeid.host+":"+b.nodeid.port:b.nodeid.rpcuser&&b.nodeid.rpcpwd?"http://"+b.nodeid.rpcuser+":"+b.nodeid.rpcpwd+"@"+b.nodeid.host+":"+b.nodeid.port:null:null},nodeex:function(e){b.nodeid&&(b.nodeid.locally?e.nodelocally=JSON.stringify({host:b.nodeid.host,port:b.nodeid.port,ws:b.nodeid.ws,rpcuser:b.nodeid.rpcuser,rpcpass:b.nodeid.rpcpwd}):e.node=b.nodeid.host)},get:{nodes:function(e,t){b.nodes&&b.nodes.length&&!e?t&&t():b.app.ajax.api({action:"nodes.get",success:function(e){b.nodes=[],(e=e.data).nodes&&e.nodes.length&&(b.nodes=e.nodes,_.each(b.nodes,function(e){e.locally=!1})),b.nodes=b.nodes.concat(b.app.platform.sdk.node.sys.userlist),b.nodes=_.filter(b.nodes,function(e){return"Unknown peer"!=e.nodename}),b.nodes&&b.nodes.length&&(b.nodeid||(b.nodeid=b.nodes[0])),t&&t(!0)},fail:function(e){b.nodes=_.clone(b.app.platform.sdk.node.sys.userlist),b.nodes&&b.nodes.length&&(b.nodeid||(b.nodeid=b.nodes[0])),t&&t(!1)}})},info:function(s){b.app.ajax.api({action:"logs",signature:!0,success:function(e){s&&s(null,e.data)},fail:function(e,t){s&&s(deep(e,"statusCode")||t)}})},stats:function(s){b.app.ajax.api({action:"stats",signature:!0,success:function(e){s&&s(null,deep(e,"data.stats"))},fail:function(e,t){s&&s(deep(e,"statusCode")||t)}})},applyMessagesFromTG:function(e,a,r,c){var d=b.sdk.usersettings.meta,l=d.telegram&&d.telegram.value;e.forEach(e=>{var t=(e,t,s)=>{-1===d[e].possibleValues.indexOf(String(s))&&(d[e].possibleValues.push(String(s)),d[e].possibleValuesLabels.push(t),d[e][l]&&d[e][l].possibleValues?(d[e][l].possibleValues.push(String(s)),d[e][l].possibleValuesLabels.push(String(t))):(d[e][l]={},d[e][l].possibleValues=[String(s)],d[e][l].possibleValuesLabels=[t]))};const i=e=>{const n=new Share;(a=function(e){if("<b>"!==e.slice(3,6))return[e];var t=new RegExp("</b>.*"),s=new RegExp("<b>.*</b>");return title=e.replace(t,"</b>"),[e=e.replace(s,""),title]}(e))[1]&&n.caption.set(a[1]),n.message.set(a[0]),n.images.set(b.app.platform.sdk.articles.getImages(e));var t,s,a=(t=(t=e).split(/[,.!?;:()<> \n\r]/g),s=_.filter(t,function(e){if("#"==e[0])return!!e.replace(/#/g,"")}),_.each(s,function(e,t){s[t]=e.replace(/\#/g,"")}),s);n.tags.set(a),n.settings.videos=b.app.platform.sdk.articles.getVideos(e),n.settings.v="a",b.sdk.node.transactions.create.commonFromUnspent(n,function(e,t){if(topPreloader(100),e)try{var s=new pShare;s._import(e,!0),s.temp=!0,s.address=e.address,n.aliasid&&(s.edit="true"),b.app.platform.sdk.node.shares.add(s),b.app.platform.sdk.user.survey()}catch(e){console.log(e)}else i?i(!1,errors[t]):(t=b.app.platform.errorHandler(t,!0))&&sitemessage(t)},null,!0)};var o,{chat:s}=e,n=s.username?" (@"+s.username+")":"";t("tgto",n=s.title+n,s.id),t("tgfrom",n,s.id),console.log("renderClbk",c),c&&c(),a&&s.id===Number(r)&&(o=e.entities||e.caption_entities||[],((t,e,s)=>{var n=(s,e)=>new Promise(t=>{s&&e?fetch(`https://api.telegram.org/bot${s}/getFile?file_id=${e}`).then(e=>e.json()).then(e=>{e.ok&&e.result?u.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:`https://api.telegram.org/file/bot${s}/${e.result.file_path}`},success:function(e){e.success?(e=e.data&&e.data.link,t(String(e))):t("")}}):t("")}).catch(()=>t("")):t("")});const a=e=>{s(e)};withImages=(e,t)=>{let s="<p>"+e+"</p>";for(path of t)path&&(s+=`<div class="medium-insert-images"><figure><img src=${path}></figure></div>`);a(s)},e||a(t);const i=[];if(Array.isArray(e)){const r=[];for(const c of e)r.push(c.file_id);var o=[...new Set(r)];const token=JSON.parse(localStorage.getItem("telegrambot"))&&JSON.parse(localStorage.getItem("telegrambot")).token||"";for(const d of o){const path=n(token,d);path&&i.push(path)}}else if("object"==typeof e){const path=n(token,e.file_id);path&&i.push(path)}Promise.all(i).then(e=>withImages(t,e))})((e=>{let t="",s=0;for(ent of o){var n=ent.offset,a=e.slice(s,n);t+=a,a=((e,t)=>{switch(t.type){case"italic":return"<i>"+e+"</i>";case"bold":return"<b>"+e+"</b>";case"underline":return"<u>"+e+"</u>";case"text_link":return`<a href='${t.url}' target='_blank' rel='noopener noreferrer'>${e}</a>`;default:return e}})(e.substr(ent.offset,ent.length),ent),t+=a,s=n+ent.length}return t+=e.slice(s),t})(e.text||e.caption||"").replace(/[␤␍␊↵⏎]+/g,"\n").replace(/\n/g,"<br>"),e.photo,i))})},dialogOfTG:function(e,t,s){e.length&&t&&(this.openedDialog=!0,dialog({html:b.app.localization.e("e13325"),btn1text:b.app.localization.e("e13326"),btn2text:b.app.localization.e("ucancel"),class:"zindex",success:()=>{var e=JSON.parse(localStorage.getItem("telegramMessages")||"[]");this.applyMessagesFromTG(e,!0,t,s),localStorage.setItem("telegramMessages","[]"),this.openedDialog=!1},fail:()=>{this.applyMessagesFromTG(e,!1,t,s),localStorage.setItem("telegramMessages","[]"),this.openedDialog=!1}}))},telegramUpdateAbort:"undefined"!=typeof AbortController?new AbortController:null,telegramUpdates:function(c=0,d){c=c||0;var e=localStorage.getItem("telegrambot"),t=e&&JSON.parse(e)&&JSON.parse(e).token||"";this.telegramUpdates=this.telegramUpdates.bind(this),e=`https://api.telegram.org/bot${t}/getUpdates?offset=${c}&timeout=100`,t={method:"GET",signal:this.telegramUpdateAbort.signal};const s=e=>{if(e.ok){const{result:a}=e;var{meta:t}=b.sdk.usersettings;const i=[];a.forEach(e=>{const{channel_post:t}=e;if(-1<(e=i.findIndex(e=>t&&t.media_group_id===e.media_group_id))){const s=i[e];s&&!s.capiton&&t&&t.caption&&(s.caption=t.caption),s&&!s.caption_entities&&t&&t.caption_entities&&(s.caption_entities=t.caption_entities),e=t.photo&&1<t.photo.length?t.photo[1]:t.photo&&t.photo.length?t.photo[0]:"",!s.photo&&t.photo?s.photo=[e]:s.photo&&t.photo&&(s.photo=[...s.photo,e])}else t&&(t.photo=[t.photo&&1<t.photo.length?t.photo[1]:t.length?t.photo[0]:""],i.push(t))});const{tgfrom:o}=t;var s=o.possibleValuesLabels.indexOf(o.value);const r=o.possibleValues[s];e=JSON.parse(localStorage.getItem("telegramMessages")||"[]"),i.findIndex(e=>String(e.chat.id)===String(r));var n=(s=i.filter(e=>String(e.chat.id)===String(r))).length?[...e,...s]:e;localStorage.setItem("telegramMessages",JSON.stringify(n)),e=i.filter(e=>String(e.chat.id)!==String(r)),t.tgfromask.value&&s.length&&!this.openedDialog?(s=JSON.parse(localStorage.getItem("telegramMessages")),this.dialogOfTG(s,r,d)):t.tgfromask.value&&this.openedDialog?this.applyMessagesFromTG(e,!0,r,d):t.tgfromask.value?this.applyMessagesFromTG(e,null,null,d):this.applyMessagesFromTG(i,!0,r,d),this.openedDialog||localStorage.setItem("telegramMessages","[]"),b.sdk.usersettings.save(),c=a.length?a[a.length-1].update_id:0,this.telegramUpdates(c+1,d)}};fetch(e,t).then(e=>e.json()).then(e=>s(e))},telegramGetMe:function(s,e,n,a){e&&(this.telegramUpdateAbort.abort(),this.telegramUpdateAbort=new AbortController);const t=document.querySelector("div[parameter='telegram'].iWrapper");t&&t.remove(),s&&fetch(`https://api.telegram.org/bot${s}/getMe`).then(e=>e.json()).then(e=>{if(a&&a(e.ok),e.ok){localStorage.setItem("telegrambot",JSON.stringify({...e.result,token:s}));const{tgfrom:t}=b.sdk.usersettings.meta;e=t.possibleValuesLabels.indexOf(t.value),e=t.possibleValues[e],this.dialogOfTG(JSON.parse(localStorage.getItem("telegramMessages")||"[]"),e),this.telegramUpdates(null,n)}}).catch(e=>{e&&console.log(e,"error after try telegram update")})},openedDialog:!1}},videos:{storage:{},infoshares:function(e){return e=_.filter(_.map(e,function(e){return e.url}),function(e){return!!e}),b.sdk.videos.info(e)},clearstorage:function(e){e&&(delete this.storage[e],"peertube"==(e=parseVideo(e)).type&&delete window.peertubeglobalcache[e.id])},info:function(e){var s=b.sdk.videos.storage,e=_.map(e,function(e){return{meta:parseVideo(e),link:e}});return(e=_.filter(e,function(e){return!(!e.meta.type||s[e.link]&&!s[e.link].waitTranscoding)})).length?(e=group(e,function(e){return e.meta.type}),e=_.map(e,function(e,t){return b.sdk.videos.types[t]?b.sdk.videos.types[t](e).then(e=>(_.each(e,function(e){s[e.link]=s[e.meta.id]=e}),Promise.resolve())).catch(e=>Promise.resolve()):Promise.reject("typehandler")}),Promise.all(e).catch(e=>Promise.resolve())):Promise.resolve()},paddingplaceholder:function(a,e,i,o){return b.sdk.videos.info([a]).catch(e=>Promise.resolve()).then(()=>{e(function(e){var t,s,n;b.sdk.videos.storage[a]&&b.sdk.videos.storage[a].data&&(t=b.sdk.videos.storage[a].data,n=(s=o?o():e.el.find(".jsPlayerLoading")).width(),s.css("padding-top",`${n/(2*t.aspectRatio)}px`),s.css("padding-bottom",`${n/(2*t.aspectRatio)}px`)),i&&i(e)})})},catchPeertubeLinks:function(s,e){window.peertubeglobalcache||(window.peertubeglobalcache={}),e.forEach(e=>{const t=s[e.link];t&&(new Date(t.createdAt).getTime()<new Date(2021,4,19).getTime()&&(t.aspectRatio=1.78),t&&(e.data={image:"https://"+t.from+t.previewPath,views:t.views,duration:t.duration,aspectRatio:t.aspectRatio||1,isLive:t.isLive}),window.peertubeglobalcache[e.meta.id]=t)})},types:{youtube:function(e){return e=_.map(e,function(e){return e.data={image:videoImage(e.link),views:0},e}),Promise.resolve(e)},vimeo:function(e){return b.sdk.videos.types.youtube(e)},peertube:async function(t){return b.app.api.fetch("peertube/videos",{urls:t.map(e=>e.link)}).then(e=>(b.sdk.videos.catchPeertubeLinks(e,t),Promise.resolve(t)))},bitchute:function(e){return e=_.map(e,function(n){return new Promise((t,s)=>{var e=n.link.replace("/embed/","/video/");$.ajax({url:"https://pocketnet.app:8888/bitchute",data:{url:hexEncode(e)},type:"POST",success:function(e){if(e.data.video&&e.data.video.as)return t(e.data.video);s()}})}).then(e=>(n.data={views:0,image:e.preview},Promise.resolve(n)))}),Promise.all(e)}},volume:.5,save:function(){localStorage.videovolume=b.sdk.videos.volume||.5},load:function(){var e=localStorage.videovolume;void 0===e&&(e="0.5"),b.sdk.videos.volume=Number(e)},init:function(e){b.sdk.videos.load(),e&&e()}}},b.Firebase=function(s){var a=this,n="undefined"!=typeof window&&window.cordova&&"undefined"!=typeof FirebasePlugin,i=null,o=deep(window,"BuildInfo.packageName")||window.location.hostname||window.pocketnetdomain;function r(){return s.app.options.device}function c(){return s.sdk.address.pnet()?s.sdk.address.pnet().address:null}return"localhost"==o&&(o="pocketnet.app"),a.storage={data:{},key:"firebasetokens_v1",clear:function(){a.storage.data={},this.save()},load:function(){var e={},t=localStorage[a.storage.key]||"{}";if(t)try{e=JSON.parse(t)}catch(e){}a.storage.data=e},save:function(){localStorage[a.storage.key]=JSON.stringify(a.storage.data)},get:function(e,t,s){return deep(a.storage.data,o+"."+s+"."+t+"."+e)},set:function(e,t,s){a.storage.data[o]||(a.storage.data[o]={}),a.storage.data[o][s]||(a.storage.data[o][s]={}),a.storage.data[o][s][t]||(a.storage.data[o][s][t]={}),a.storage.data[o][s][t][e]=!0,this.save()}},a.api={revoke:function(e,t){if(!c())return Promise.reject()},revokeDevice:function(e){return a.app.api.fetchauth("firebase/revokedevice",{device:r()},{proxy:e})},setToken:function(t,s,n){return t?n?a.request.setToken(s,n).then(e=>(a.storage.set(n,t,s),Promise.resolve())):Promise.reject("proxy"):Promise.reject("address")},existanother:function(e,t){function s(e,s){return _.find(e||{},function(e,t){return t!=s})}var n;return!!(n=s(n=a.storage.data[o]||{},e))||!!s(n,t)},exist:function(e,t,s){return a.storage.get(e,t,s)?Promise.resolve(!0):a.request.mytokens(e).then(e=>(e=_.find(e.tokens,function(e){return e.token==s&&e.id==o}))?Promise.resolve(e):Promise.resolve(!1))},checkProxy:function(e){return a.request.info(e).then(e=>{if(-1==(e.id||"").split(",").indexOf(o))return Promise.reject("proxyfirebaseid")})}},a.revokeall=function(){return FirebasePlugin.unregister(),a.storage.clear(),a.request.revokeall()},a.set=function(t){if(!i)return Promise.reject("emptytoken");var s=c(),n=i;return console.log("getaddress",c()),a.api.checkProxy(t).then(e=>a.api.exist(t,s,n)).then(e=>e?Promise.resolve():a.api.existanother(t,s)?a.revokeall():void 0).then(e=>a.api.setToken(s,n,t)).catch(e=>(console.log("E",e),Promise.resolve()))},a.request={revokeall:function(){return s.app.api.fetchauthall("firebase/revokedevice",{device:r()})},info:function(e){return s.app.api.fetchauth("firebase/info",{},{proxy:e})},mytokens:function(e){return s.app.api.fetchauth("firebase/mytokens",{},{proxy:e})},revoke:function(e,t){return s.app.api.fetchauth("firebase/revoke",{token:e},{proxy:t})},revokeDevice:function(e){return s.app.api.fetchauth("firebase/revokedevice",{device:r()},{proxy:e})},setToken:function(e,t){return s.app.api.fetchauth("firebase/set",{device:r(),token:e,id:o},{proxy:t})}},a.get=function(t){n&&FirebasePlugin.getToken(function(e){i=e,console.log("currenttoken",i),t&&t(i)},function(e){console.error(e,"fcmToken not set on server"),t&&t()}),t&&t()},a.permissions=function(t){FirebasePlugin.hasPermission(function(e){e?a.get(t):FirebasePlugin.grantPermission(function(e){e&&a.get(t)})})},a.events=function(){FirebasePlugin.onMessageReceived(e=>{(e=e||{}).data&&s.ws.messageHandler(e.data),e.tap?(s.ws.destroyMessages(),s.app.nav.api.load({open:!0,href:"notifications",history:!0})):"undefined"==typeof cordova||(e=deep(cordova,"plugins.notification.badge"))&&e.increase(1,function(e){})})},a.init=function(e){console.log("self.initself.init"),a.prepare(function(e){!e||(e=s.app.api.get.current())&&a.set(e.id).catch(e=>{console.log("error",e)})}),e&&e()},a.prepare=function(e){a.storage.load(),n?(a.events(),a.permissions(e)):e&&e()},a.destroy=function(e){i=null,n?a.revokeall().then(e).catch(e=>{}):e&&e()},a},b.WSn=function(d){var t,l=this,u=d.app,s=!1,i=0,o=null;function e(){s||(s=!1,l.close(),a())}function n(){l.destroyMessages()}function r(e){l.hideallnotificationsel&&(e?(l.hideallnotificationsel.html('<div class="hidenf">'+d.app.localization.e("hideallnotifications")+"</div>"),l.hideallnotificationsel.find("div").on("click",n)):l.hideallnotificationsel.html(""))}l.connected={},l.online=!1,l.onlineCheck=!1,l.fastMessages=[],l.app=u,l.loadingMissed=!1,l.tempates={_share:function(e,t){return e=e.caption||e.message,"undefined"!=typeof joypixels?joypixels.toImage(filterXSS(trimHtml(e,t||20))):filterXSS(trimHtml(e,t||20))},share:function(e,t,s){var n="",a=e.caption||e.message,i=20;s&&(a="",e.caption&&(a=a+""+e.caption+" "),e.message&&(a=a+""+e.message),i=180);var o=linkify.find(a);_.each(o,function(e){a=a.replace(e.href,"")});var r=filterXSS(trimHtml(a,i),{stripIgnoreTag:!0,whiteList:{b:["style"]}}),c=_.map(e.images,function(e){return{i:e,v:!1}}),d=parseVideo(e.url||"");return u.curation()?"":(n='<div class="sharepreview"><div class="shareprwrapper table">',c.length&&!s&&(i=c[0],n+='<div class="tcell forimage">',n+='<div class="img" image="'+clearStringXss(i.i)+'">',i.v&&(n+='<div class="vstyle">',n+='<i class="fas fa-play"></i>',n+="</div>"),n+="</div>",n+="</div>"),n+='<div class="tcell fortext">',2<r.length&&(n+="<div><span>"+r+"</span></div>"),c.length&&s&&(n+='<div class="shareimages commentprev">',n+='<div class="imagesContainer">',_.each(c,function(e){n+='<div class="imagesWrapper">',n+='<div class="image" image="'+clearStringXss(e.i)+'" i="'+clearStringXss(e.i)+'">',e.v&&(n+='<div class="vstyle">',n+='<i class="fas fa-play"></i>',n+="</div>"),n+="</div>",n+="</div>"}),n+="</div>",n+="</div>"),(c.length||o.length||e.tags.length||d.type)&&(n+='<div class="additionalcontent">',d.type?n+="<b>"+flb(l.app.localization.e("video"))+'</b> <i class="fas fa-play"></i> ':(c.length&&(n+=flb(l.app.localization.e("timages"))+" ("+c.length+") "),o.length&&(n+=flb(l.app.localization.e("tlinks"))+" ("+o.length+") "),e.tags.length&&(n+=flb(l.app.localization.e("e13280"))+" ("+e.tags.length+") ")),n+="</div>"),n+="</div>",t&&(n+='<div class="tcell extra">',n+=t,n+="</div>"),n+="</div>                    </div>")},transaction:function(e,t){var s='<div class="transactionmessage">';return s+='<div class="transactionmessagewrapper table">',t&&(s+='<div class="tcell formessage">',s+=clearStringXss(t),s+="</div>"),s+='<div class="tcell foramount">',s+="+"+d.mp.coin(clearStringXss(e.amountall||e.tx.amount)),isMobile()||(s+=" PKOIN"),s+="</div>",(s+="</div>")+"</div>"},comment:function(e,t){var s=e.renders.preview(),n='<div class="commentmessage">';return n+='<div class="commentmessagewrapper table">',n+='<div class="tcell fortext">',s&&(n+='<div class="commenttext commentprev"><span>',n+=s,n+="</span></div>"),e.images.length&&(n+='<div class="commentimages commentprev">',n+='<div class="imagesContainer">',_.each(e.images,function(e){n+='<div class="imagesWrapper">',n+='<div class="image imageCommentOpen" image="'+e+'" i="'+e+'">',n+="</div>",n+="</div>"}),n+="</div>",n+="</div>"),n+="</div>",n+="</div>",n+="</div>"},commentScore:function(e,t){var s=e.renders.preview(),n='<div class="commentmessage">';return n+='<div class="commentmessagewrapper table">',n+='<div class="tcell fortext">',s&&(n+='<div class="commenttext commentprev"><span>',n+=s,n+="</span></div>"),e.images.length&&(n+='<div class="commentimages commentprev">',n+='<div class="imagesContainer">',_.each(e.images,function(e){n+='<div class="imagesWrapper">',n+='<div class="image imageCommentOpen" image="'+clearStringXss(e)+'" i="'+clearStringXss(e)+'">',n+="</div>",n+="</div>"}),n+="</div>",n+="</div>"),n+="</div>",t&&(n+='<div class="tcell forthumbs">',n+=t,n+="</div>"),n+="</div>",n+="</div>"},star:function(e){return'<div class="messagestar" count="'+e+'">'+e+(electron?"★":'<i class="fas fa-star"></i>')+"</div>"},thumbs:function(e){var t=electron?e<0?"👎":"👍":e<0?'<i class="fas fa-thumbs-down fa-flip-horizontal"></i>':'<i class="fas fa-thumbs-up"></i>';return'<div class="messagethumbs" value="'+clearStringXss(e)+'">'+t+"</div>"},_user:function(e){return filterXSS(deep(e,"name")||e.address)},user:function(e,t,s,n,a,i){if(!e||!e.name)return t;var o="",r=deep(e,"image"),c='<a href="'+encodeURI(clearStringXss(e.name.toLowerCase()))+'">';return o+='<div class="cwrapper table">                    <div class="cell cellforimage">                        <div class="icon">',s&&(o+=c),o+='<div class="usericon" image="'+clearStringXss(r||"")+'">',deep(d,"real."+e.address)&&(o+='<div class="realperson">',o+='<span class="fa-stack fa-2x">',o+='<i class="fas fa-certificate fa-stack-2x"></i>',o+='<i class="fas fa-check fa-stack-1x"></i>',o+="</span>",o+="</div>"),o+="</div>",s&&(o+="</a>"),o+='</div>                    </div>                    <div class="ccell">                        <div class="infomain">                            <div class="caption">',e.address!=d.sdk.address.pnet().address&&(s&&(o+=c),o+='<b class="adr">'+filterXSS(deep(e,"name")||e.address)+"</b>",s&&(o+="</a>")),n&&(o+=" "+clearStringXss(n)),o+='</div>                            <div class="tips">'+t+"                            </div>                        </div>",o+=l.tempates.time(i),o+="</div>",a&&(o+='<div class="ccell extra">',o+=a,o+="</div>"),o+"</div>"},time:function(e){var t="",s="";return e&&((t=new Date).setTime(1e3*clearStringXss(e)),s+='<div class="time">',s+='<span class="realtime" time="'+t+'">'+u.reltime(t)+"</span>",s+="</div>"),s},subscribe:function(e){var t=deep(u,"platform.sdk.users.storage."+d.sdk.address.pnet().address),s="",n='<div class="subscribeWrapper table">';return n+='<div class="scell forsubscribe">',n+='<button class="subscribe ghost + '+(s=t&&t.relation(e.address,"subscribes")?"disabled":s)+'">',n+='<i class="far fa-check-circle"></i> ',n+="Follow</button>",(n+="</div>")+"</div>"}},l.showedIds={},l.messages={registered:{loadMore:function(e,t){l.connected[e.addr]=!0}},connectionfailed:{loadMore:function(e){}},cScore:{electronSettings:{size:"medium"},fastMessageEvents:function(a,e){e.el.find(".commentprev").on("click",function(){d.sdk.node.shares.getbyid(a.comment.txid,function(e,t,s,n){d.app.nav.api.load({open:!0,href:"post?s="+a.comment.txid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:a.comment.txid,reply:{answerid:a.comment.id,parentid:a.comment.parentid||"",noaction:!0}}})})})},loadMore:function(t,s,e){d.sdk.users.get([t.addrFrom],function(){t.user=d.sdk.users.storage[t.addrFrom]||{},t.user.address=t.addrFrom,t.i="👍",t.value<0&&(t.i="👎"),d.sdk.comments.getbyid(t.commentid,function(e){t.comment=deep(d.sdk.comments,"storage.all."+t.commentid),e&&(0<t.upvoteVal?t.comment.scoreUp++:t.comment.scoreDown++),t.comment&&t.comment.deleted,s()})})},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!!(e.user&&e.comment&&d.sdk.usersettings.meta.commentScore.value)}},notificationData:function(e){var t={};return e.user&&e.comment&&!e.comment.deleted&&0<e.upvoteVal&&(t.text=l.tempates._user(e.user)+" "+l.app.localization.e("e13328"),t.caption=l.app.localization.e("e13329")),_.isEmpty(t)?null:t},fastMessage:function(e){var t="",s="";if(e.user&&e.user.address){var n=d.sdk.user.me();if(n&&n.relation(e.user.address,"blocking"))return s}return e.comment&&!e.comment.deleted&&0<e.upvoteVal&&(t=d.sdk.usersettings.meta.commentScore.value?l.tempates.commentScore(e.comment):t)&&(s+=l.tempates.user(e.user,'<div class="text">'+t+"</div>",!0,d.app.localization.e("upvoteCommentMessage")+":",l.tempates.thumbs(e.upvoteVal),e.time)),s},clbks:{}},reshare:{loadMore:function(s,n,e){d.sdk.users.get([s.addrFrom],function(){s.user=d.sdk.users.storage[s.addrFrom]||{},s.user.address=s.addrFrom,d.sdk.node.shares.getbyid([s.txid,s.txidRepost],function(e,t){(e=e||[])[0]&&(s.share=e[0]),e[1]&&(s.shareReposted=e[1]),n()})})},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!!e.share}},notificationData:function(e){var t={};return e.user&&e.share&&(t.caption=l.tempates._user(e.user)+" "+l.app.localization.e("e13330"),t.text=l.tempates._share(e.shareReposted,100)),_.isEmpty(t)?null:t},fastMessage:function(e){var t="",s="";if(e.user&&e.user.address){var n=d.sdk.user.me();if(n&&n.relation(e.user.address,"blocking"))return s}return(t=e.share&&e.shareReposted?l.tempates.share(e.share,null,!0)+'<div class="sharedivide">&middot;&middot;&middot;</div>'+l.tempates.share(e.shareReposted,null,!0):t)&&(s+=l.tempates.user(e.user,t,!0," "+l.app.localization.e("e13331"),'<div class="repostshare"><i class="fas fa-share"></i></div>',e.time)),s},fastMessageEvents:function(a,e){e.el.find(".sharepreview").on("click",function(){d.sdk.node.shares.getbyid(a.txid,function(e,t,s,n){d.app.nav.api.load({open:!0,href:"post?s="+a.txid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:a.txid}})})})},clbks:{}},postfromprivate:{loadMore:function(s,n,e){s.addrFrom?d.sdk.users.get([s.addrFrom],function(){s.user=d.sdk.users.storage[s.addrFrom]||{},s.user.address=s.addrFrom,s.txids&&!s.txid&&(s.txid=s.txids),d.sdk.node.shares.getbyid(s.txid,function(e,t){(e=e||[])[0]&&(s.share=e[0]),n()})}):n()},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!!e.share}},notificationData:function(e){var t={};return e.user&&e.share&&(t.caption=l.tempates._user(e.user)+" "+l.app.localization.e("e13332"),t.text=l.tempates._share(e.share,100)),_.isEmpty(t)?null:t},fastMessage:function(e){var t="",s="";return(t=e.share?l.tempates.share(e.share,null,!0):t)&&(1<e.postsCnt&&e.postsCnt,s+=l.tempates.user(e.user,t,!0," "+l.app.localization.e("e13332"),null,e.time)),s},fastMessageEvents:function(a,e){e.el.find(".sharepreview").on("click",function(){d.sdk.node.shares.getbyid(a.txid,function(e,t,s,n){d.app.nav.api.load({open:!0,href:"post?s="+a.txid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:a.txid}})})})},clbks:{}},sharepocketnet:{loadMore:function(s,n,e){s.addrFrom="PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd",s.addrFrom?d.sdk.users.get([s.addrFrom],function(){s.user=d.sdk.users.storage[s.addrFrom]||{},s.user.address=s.addrFrom,s.txids&&!s.txid&&(s.txid=s.txids),d.sdk.node.shares.getbyid(s.txid,function(e,t){(e=e||[])[0]&&(s.share=e[0]),n()})}):n()},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!!e.share}},notificationData:function(e){var t={};return e.user&&e.share&&(t.caption=l.tempates._user(e.user),t.text=l.tempates._share(e.share,100)),_.isEmpty(t)?null:t},fastMessage:function(e){var t,s="";return e.share&&(t=l.tempates.share(e.share,null,!0))&&(s+=l.tempates.user(e.user,t,!0,null,null,e.time)),s},fastMessageEvents:function(a,e){e.el.find(".sharepreview").on("click",function(){d.sdk.node.shares.getbyid(a.txid,function(e,t,s,n){d.app.nav.api.load({open:!0,href:"post?s="+a.txid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:a.txid}})})})},clbks:{}},transaction:{electronSettings:{size:"small"},loadMore:function(o,r,c){function e(e,t){var s,n,a,i;!t&&e?(o.txinfo=e,s=o.addr,d.sdk.node.transactions.unspent||(d.sdk.node.transactions.unspent={}),(n=d.sdk.node.transactions.unspent)[s]||(n[s]=[]),(a=deep(d.sdk.node.transactions.temp,"share."+o.txid))&&!c&&(o.temp=a,o.temp.temp=!1,"share"==o.temp.type&&((i=new pShare)._import(o.temp,!0),i.address=d.sdk.address.pnet().address,i.scnt="0",i.score="0",i.myVal=0,d.sdk.node.shares.storage.trx||(d.sdk.node.shares.storage.trx={}),d.sdk.node.shares.storage.trx[o.txid]=i),delete d.sdk.node.transactions.temp.share[o.txid]),deep(d.sdk.node.transactions.temp,"userInfo.0")&&"userInfo"==o.type&&(d.sdk.node.transactions.temp.userInfo={}),t=d.sdk.node.transactions.toUTs(e,s),_.each(t,function(e){d.sdk.node.transactions.clearTemp(o.txid,e.vout,!0),c||(removeEqual(n[s],{txid:o.txid,vout:e.vout}),n[s].push(e))}),d.sdk.address.pnet()&&(a=d.sdk.address.pnet().address,(i=d.sdk.registrations.storage[a])&&3==i&&(d.sdk.registrations.add(a,4),d.sdk.relayTransactions.send())),o.tx=d.sdk.node.transactions.toUT(e,o.addr,o.nout),o.amountall=_.reduce(t,function(e,t){return e+t.amount},0),o.address=d.sdk.node.transactions.addressFromScryptSig(deep(o.txinfo,"vin.0.scriptSig.asm")),o.opmessage=d.sdk.node.transactions.getOpreturn(o.txinfo),o.cointype=d.sdk.node.transactions.getCoibaseTypeN(o.txinfo,d.sdk.address.pnet().address),d.sdk.users.getone(o.address||"",function(){o.address&&(o.user=d.sdk.usersl.storage[o.address]||{address:o.address}),_.each(d.sdk.node.transactions.clbks,function(e){e(o.amountall)}),r&&r(o)},"userInfo"!=o.type,"userInfo"==o.type)):r&&r()}o.txinfo?e(o.txinfo):d.sdk.node.transactions.get.tx(o.txid,e)},refs:{},notificationData:function(e,t){var s={};return e.tx&&(e.tx.coinbase?(s.caption=l.app.localization.e("e13333"),s.text=l.app.localization.e("e13334")+" "+d.mp.coin(e.tx.amount)+" "+l.app.localization.e("e13335")+" 'activity'!",s.topic="pos"):e.address!=t.address&&e.user&&(.05<=e.amountall||.05<=e.tx.amount)&&(s.text=l.tempates._user(e.user)+" sent "+d.mp.coin(e.tx.amount)+" PKOIN to you",e.opmessage?s.text=s.text+" "+l.app.localization.e("e13336")+' "'+e.opmessage+'"':s.text=s.text+"!",s.caption=l.app.localization.e("e13333")+": "+l.tempates._user(e.user),s.topic="transactions")),_.isEmpty(s)?null:s},fastMessage:function(e,t){var s,n="";if(e.tx)if(e.tx.coinbase)d.sdk.usersettings.meta.win.value&&(s="coinbaseSuccess",e.cointype&&(s+=e.cointype),n+=l.tempates.user(d.sdk.users.storage[d.sdk.address.pnet().address],l.tempates.transaction(e,'<div class="text">'+d.app.localization.e(s,d.mp.coin(clearStringXss(e.amountall||e.tx.amount)))+"</div>"),!1,null,null,e.time));else if(!d.sdk.address.pnet()||e.address!=d.sdk.address.pnet().address){if(e.address){var a=d.sdk.user.me();if(a&&a.relation(e.address,"blocking"))return n}d.sdk.usersettings.meta.transactions.value&&e.user&&e.user.name&&(.05<=e.amountall||.05<=e.tx.amount)&&(a=d.app.localization.e("userSent",d.mp.coin(e.amountall||e.tx.amount)),e.opmessage&&(a+=" "+l.app.localization.e("e13336")+" <span>&ldquo;"+e.opmessage+"&rdquo;</span>"),n+=l.tempates.user(e.user,"",!0,a,l.tempates.transaction(e),e.time))}return n},audio:{unfocus:"water_droplet",if:function(e){if(e.temp)return!1;if(!e.tx)return!1;if(e.tx.coinbase){if(!d.sdk.usersettings.meta.win.value)return!1}else{if(e.address==d.sdk.address.pnet().address)return!1;if(!d.sdk.usersettings.meta.transactions.value)return!1}return!0}},clbks:{}},newblocks:{loadMore:function(e,t){var s,n;e.block<=d.currentBlock?t&&t(0):(s=d.sdk.node.transactions,n=d.currentBlock-e.block,d.currentBlock=e.block,d.lasttimecheck=new Date,i=e.block,localStorage.lastblock=d.currentBlock,n&&d.sdk.newmaterials.update(e),d.sdk.notifications.wsBlock(e.height),_.each(s.unspent,function(e){_.each(e,function(e){e.confirmations=(e.confirmations||0)+(n||0)})}),d.sdk.user.subscribeRef(),t(n))},refs:{},fastMessage:function(e){return""},clbks:{transactions:function(){_.each(d.sdk.node.transactions.clbks,function(e){e()})}}},"new block":{loadMore:function(e,t){var s;e.height<=d.currentBlock||(s=d.sdk.node.transactions,d.currentBlock=e.height,d.lasttimecheck=new Date,localStorage.lastblock=d.currentBlock,i=d.currentBlock,d.sdk.notifications.wsBlock(e.height),_.each(s.unspent,function(e,t){_.each(e,function(e){e.confirmations||(e.confirmations=0),e.confirmations++})}),d.sdk.newmaterials.update(e),d.sdk.user.subscribeRef(),d.matrixchat.init(),setTimeout(function(){d.sdk.relayTransactions.send()},3e4),t())},refs:{},fastMessage:function(e){return""},clbks:{transactions:function(){_.each(d.sdk.node.transactions.clbks,function(e){e()})},interface:function(){"undefined"!=typeof $&&$(".temptransaction").removeClass("temptransaction")}}},comment:{electronSettings:{size:"medium"},fastMessageEvents:function(s,e){e.el.find(".commentprev").on("click",function(){d.sdk.node.shares.getbyid(s.posttxid,function(e,t){d.app.nav.api.load({open:!0,href:"post?s="+s.posttxid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:s.posttxid,reply:{answerid:s.commentid,parentid:s.parentid||"",noaction:!0}}})})}),e.el.find(".reply").on("click",function(){d.sdk.node.shares.getbyid(s.posttxid,function(e,t){d.app.nav.api.load({open:!0,href:"post?s="+s.posttxid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:s.posttxid,reply:{answerid:s.commentid,parentid:s.parentid||""}}})})})},loadMore:function(n,t,e){d.sdk.users.get([n.addrFrom],function(){var e,s;n.user=d.sdk.users.storage[n.addrFrom]||{},n.user.address=n.addrFrom,!n.commentid&&n.txid&&(n.commentid=n.txid),e=n.posttxid,s=function(){var e=[n.commentid];n.txid=n.commentid,d.sdk.comments.getbyid(e,function(){var e;n.comment=deep(d.sdk.comments,"storage.all."+n.commentid),n.comment&&(d.sdk.comments.storage[n.comment.txid]||(d.sdk.comments.storage[n.comment.txid]={}),e=n.comment.parentid||"0",d.sdk.comments.storage[n.comment.txid][e]&&d.sdk.comments.storage[n.comment.txid][e].push(n.comment)),t()})},e?d.sdk.node.shares.getbyid(e,function(e,t){(e=e||[])[0]&&(n.share=e[0]),s()}):s()})},notificationData:function(e){var t={};return"post"==e.reason&&e.comment&&e.share&&e.user&&(t.text=e.comment.renders.previewEmojidis(),t.topic="comments",t.caption=l.tempates._user(e.user)+" "+l.app.localization.e("e13337")),"answer"==e.reason&&e.comment&&e.share&&e.user&&(t.text=e.comment.renders.previewEmojidis(),t.topic="answers",t.caption=l.tempates._user(e.user)+" "+l.app.localization.e("e13338")),_.isEmpty(t)?null:t},fastMessage:function(e){var t="",s="",n="";if(n+='<div class="tcell foranswer">',n+='<button class="reply ghost">'+l.app.localization.e("reply")+"</button>",n+="</div>",e.user&&e.user.address){var a=d.sdk.user.me();if(a&&a.relation(e.user.address,"blocking"))return s}return"post"==e.reason&&e.comment&&e.share&&e.user&&(!d.sdk.usersettings.meta.comments||d.sdk.usersettings.meta.comments.value)&&(t=l.tempates.comment(e.comment,l.tempates.share(e.share)))&&(s+=l.tempates.user(e.user,'<div class="text">'+t+"</div>",!0," "+l.app.localization.e("e13337"),n,e.time)),"answer"==e.reason&&e.comment&&e.share&&e.user&&(!d.sdk.usersettings.meta.answers||d.sdk.usersettings.meta.answers.value)&&(t=l.tempates.comment(e.comment))&&(s+=l.tempates.user(e.user,'<div class="text">'+t+"</div>",!0," "+l.app.localization.e("e13338"),n,e.time)),s},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!(!("post"==e.mesType&&e.comment&&e.share&&e.user)||d.sdk.usersettings.meta.comments&&!d.sdk.usersettings.meta.comments.value)||!(!("answer"==e.mesType&&e.comment&&e.share&&e.user)||d.sdk.usersettings.meta.answers&&!d.sdk.usersettings.meta.answers.value)||void 0}},clbks:{}},event:{electronSettings:{size:"small"},loadMore:function(s,n,a){s.addrFrom?d.sdk.users.get([s.addrFrom],function(){var e,t;s.user=d.sdk.users.storage[s.addrFrom]||{},s.user.address=s.addrFrom,"userInfo"!=s.mesType||a||(t=d.sdk.users.storage[d.sdk.address.pnet().address])&&(delete t.temp,delete t.relay,(e=deep(u,"modules.menu.module.restart"))&&e(),(e=deep(u,"nav.clbks.history.navigation"))&&e(),t.rc++),"upvoteShare"==s.mesType?d.sdk.node.shares.getbyid(s.posttxid,function(e,t){(e=e||[])[0]&&(s.share=e[0],t&&!a&&(s.share.score=Number(s.share.score)+Number(s.upvoteVal),s.share.scnt=Number(s.share.scnt)+1)),s.electronSettings.size="medium",n()}):("subscribe"!=s.mesType&&"unsubscribe"!=s.mesType||a||(e=d.sdk.users.storage[s.addrFrom],(t=d.sdk.users.storage[d.sdk.address.pnet().address])&&("subscribe"==s.mesType&&t.addRelation(s.addrFrom,"subscribers"),"unsubscribe"==s.mesType&&t.removeRelation(s.addrFrom,"subscribers")),e&&("subscribe"==s.mesType&&e.addRelation({adddress:d.sdk.address.pnet().address,private:!1}),"unsubscribe"==s.mesType&&e.removeRelation({adddress:d.sdk.address.pnet().address,private:!1}))),n())}):n()},refs:{},audio:{unfocus:"water_droplet",if:function(e){return!(!("upvoteShare"==e.mesType&&e.share&&2<e.upvoteVal)||d.sdk.usersettings.meta.upvotes&&!d.sdk.usersettings.meta.upvotes.value)||!("subscribe"!=e.mesType||d.sdk.usersettings.meta.followers&&!d.sdk.usersettings.meta.upvotes.followers)||!("userInfo"!=e.mesType||d.sdk.usersettings.meta.rescued&&!d.sdk.usersettings.meta.rescued.value)}},fastMessageEvents:function(a,e){"subscribe"==a.mesType&&a.user&&e.el.find(".subscribe").on("click",function(){var s=$(this);s.hasClass("disabled")||(s.addClass("disabled"),d.api.actions.subscribe(a.user.address,function(e,t){e||(l.app.platform.errorHandler(t,!0),s.removeClass("disabled"))}))}),"upvoteShare"==a.mesType&&a.share&&e.el.find(".sharepreview").on("click",function(){d.sdk.node.shares.getbyid(a.posttxid,function(e,t,s,n){d.app.nav.api.load({open:!0,href:"post?s="+a.posttxid,inWnd:!isMobile(),history:isMobile(),clbk:function(e,t){u.nav.wnds.post=t},essenseData:{share:a.posttxid}})})})},notificationData:function(e){var t={};return"userInfo"==e.mesType&&(t.text=l.app.localization.e("e13339"),t.topic="rescued",t.caption=l.app.localization.e("e13340")),"subscribe"==e.mesType&&e.user&&(t.text=l.tempates._user(e.user)+" "+l.app.localization.e("e13341"),t.topic="followers",t.caption=l.app.localization.e("e13342")),"upvoteShare"==e.mesType&&e.share&&e.user&&2<e.upvoteVal&&(t.text=l.tempates._user(e.user)+" "+l.app.localization.e("e13343")+", "+e.upvoteVal+" ★",t.topic="upvotes",t.caption=l.app.localization.e("e13344")),_.isEmpty(t)?null:t},fastMessage:function(e){var t,s="",n="",a="",i="";if(e.user&&e.user.address){var o=d.sdk.user.me();if(o&&o.relation(e.user.address,"blocking"))return n}return"userInfo"==e.mesType&&d.sdk.usersettings.meta.rescued&&d.sdk.usersettings.meta.rescued.value,"subscribe"==e.mesType&&(d.sdk.usersettings.meta.followers&&!d.sdk.usersettings.meta.followers.value||(s="",a=d.app.localization.e("subscribeUserMessage"),i=l.tempates.subscribe(e.user))),"upvoteShare"==e.mesType&&e.share&&(t="upvoteShareMessage",e.upvoteVal<=2&&d.sdk.usersettings.meta.downvotes.value,2<e.upvoteVal&&d.sdk.usersettings.meta.upvotes.value&&(e.upvoteVal<=2&&(t="downvoteShareMessage"),o=l.tempates.star(e.upvoteVal),s='<div class="text">'+l.tempates.share(e.share)+"</div>",a=d.app.localization.e(t),i=o)),(a||s)&&(n+=l.tempates.user(e.user,s||"",!0,a,i,e.time)),n},clbks:{}},message:{loadMore:function(e,t,s){e.address&&d.sdk.users.get([e.address],function(){e.user=d.sdk.users.storage[e.address],e.user&&(e.user.address=e.address,t())})},refs:{},audio:{unfocus:"water_droplet"},fastMessageEvents:function(e,t){t.el.find(".tochat").on("click",function(){})},fastMessage:function(e){var t="";if(e.user&&e.user.address){var s=d.sdk.user.me();if(s&&s.relation(e.user.address,"blocking"))return t}return s=l.tempates.subscribe(e.user,l.app.localization.e("e13345")),t+l.tempates.user(e.user,'<div class="text">'+s+"</div>",!0)},clbks:{}}},l.reconnect=e;var a=function(a){d.app.api.get.currentwss().then(n=>{(t=n.dummy||new ReconnectingWebSocket(n.url)).onmessage=function(e){var t=e=e.data;try{t=JSON.parse(e||"{}")}catch(e){}if(t)return"proxy-message-tick"==t.type?n.proxy.system.tick(t.data):"changenode"!=t.type?"proxy-settings-changed"==t.type?n.proxy.changed(t.data):void l.messageHandler(t):void 0},t.onopen=function(){var t,s;l.connected={},l.getMissed(),i=d.currentBlock||0,t=null,s=n.proxy,u.user.isState(function(e){e&&l.addAccount(null,t,s)}),a&&a()},n.proxy.clbks.changed.wss=function(){e()},t.onclose=function(){delete n.proxy.clbks.changed.wss},t.init&&t.init()}).catch(e=>{a&&a(e)})},c=function(e,t,s,n){e.timeout&&clearTimeout(e.timeout),d.focus?e.timeout=setTimeout(function(){e.el.fadeOut(300),setTimeout(function(){e.el.remove(),removeEqual(l.fastMessages,{id:e.id}),e.destroyclbk&&n&&e.destroyclbk(),s||p()},300)},t):setTimeout(function(){c(e,t,s)},100)},p=function(){var s=0,e=4,t=2,n=0;isMobile()&&(e=1,t=0);var a=l.fastMessages.length-e,i=!1;l.fastMessages.length>=e&&_.each(l.fastMessages,function(e,t){isMobile()||e.expanded||e.el.hasClass("smallsize")||(e.el.addClass("smallsize"),i=!0)}),setTimeout(function(){t&&l.fastMessages.length>=t?(n=50,r(!0)):r(!1),s+=n,_.each(l.fastMessages,function(e,t){t<a?c(e,1,!0):(isMobile()||(s+=5),isMobile()||e.el.css("bottom",s+"px"),s+=e.el.outerHeight())})},i?300:3)};l.getMissed=function(){return i<1||l.loadingMissed?Promise.resolve():(l.loadingMissed=!0,d.sdk.node.get.timepr().then(e=>d.sdk.missed.get(i)).then(({block:e,notifications:t})=>{l.messageHandler(e,function(){l.loadingMissed=!1,i=0,t&&lazyEach({array:t,action:function(e){l.messageHandler(e.item,e.success)},all:{success:function(){}}})})}).catch(e=>(l.loadingMissed=!1,Promise.reject(e))))},l.destroyMessages=function(){_.each(l.fastMessages,function(e,t){c(e,1,!0)}),setTimeout(function(){p()},301)},l.fastMessage=function(e,t){var s=makeid(!0);e='<div class="fastMessage" id="'+s+'">            <div class="fmCnt">'+e+'</div>            <div class="close">                <i class="fa fa-times" aria-hidden="true"></i>            </div>            </div>',$("body").append(e);var n=$("#"+s),a={id:s,el:n,html:e,destroyclbk:t};return bgImages(n),l.fastMessages.push(a),d.app.nav.api.links(null,n,function(){c(a,1)}),c(a,5e3,!1,!0),a.el.on("click",function(){a.expanded||(a.el.removeClass("smallsize"),a.expanded=!0,p(),setTimeout(function(){p()},300))}),a.el.on("mouseenter",function(){clearTimeout(a.timeout)}),a.el.on("mouseleave",function(){c(a,5e3,!1,!0)}),a.el.find(".close").on("click",function(e){return c(a,1,!1,!0),e.preventDefault(),!1}),isMobile()&&new SwipeParallaxNew({el:a.el,directions:{up:{trueshold:50,positionclbk:function(e){},clbk:function(){a.el.remove(),c(a,1,!1,!0)}}}}).init(),p(),a},l.messageHandler=function(n,a){var i,e;((n=n||{}).msg||n.mesType)&&(i=null,"transaction"==n.msg&&n.mesType&&(n.type=n.mesType,delete n.mesType),n.mesType&&(i=l.messages[n.mesType]),n.msg&&!i&&(i=l.messages[n.msg]),n.electronSettings||(n.electronSettings={}),(i=i||{}).checkHandler&&!i.checkHandler(n,i)||(e=function(t){n.loadedData=!0;var e=deep(i,"audio");if(_.each(i.clbks,function(e){e(n,t)}),!_Node){if(e&&!window.cordova&&(e.if&&!e.if(n,t)||(e.focus&&d.focus&&ion.sound.play(e.focus),e.unfocus&&!d.focus&&ion.sound.play(e.unfocus))),i.fastMessage&&!i.refs.all&&!i.refs[n.RefID]&&(e=i.fastMessage(n,t))){if(l.showedIds[n.txid])return;l.showedIds[n.txid]=!0;var s=l.fastMessage(e,function(){d.sdk.notifications.seen([n.txid])});i.fastMessageEvents&&i.fastMessageEvents(n,s),n.loaded=!0,d.sdk.notifications.addFromWs(n),"undefined"!=typeof _Electron&&!d.focus&&s.html&&electron.ipcRenderer.send("electron-notification",{html:s.html,settings:n.electronSettings})}!i.header||d.focus||!d.titleManager||(s=i.header(n))&&d.titleManager.add(s)}a&&a()},i.electronSettings&&(n.electronSettings=_.clone(i.electronSettings)),i.loadMore?i.loadMore(n,e):e()))},l.send=function(e){if(t)try{t.send(e)}catch(e){}},l.close=function(){s||(s=!0,o=null,l.connected={},t&&t.close(),t=null,s=!1)},l.destroy=function(){l.close(),l.loadingMissed=!1,i=0},l.wait=function(e,t){retry(function(){return!o||!o[e]||Math.floor((new Date).getTime()/1e3)>o[e]+1||!!l.connected[e]||void 0},t)},l.addAccount=function(e,t,s){e=e||d.app.user.keys();var n=d.sdk.address.pnet(e.publicKey).address+"addressesNum";localStorage[n],l.addAddresses([{kp:e,n:0}],t,s)},l.addAddresses=function(e,t,s){var n=0;lazyEach({array:e,sync:!0,action:function(t){l.addAddress(t.item.kp,t.item.n,function(e){e&&n++,t.success()},s)},all:{success:function(){t&&t(0!=n)}}})},l.addAddress=function(e,t,s,n){var a=(t?d.sdk.address.wallet(t,e.privateKey):d.sdk.address.pnet(e.publicKey)).address;l.connected[a]?s&&s(!0):(n={signature:d.app.user.signature(),address:a,device:d.app.options.device,block:d.currentBlock||0,node:n.current?n.current.key:null},d.sdk.system.nodeex(n),(o=o||{})[a]=Math.floor((new Date).getTime()/1e3),l.wait(a,function(){l.connected[a]?s&&s(!0):s&&s(!1)}),l.send(JSON.stringify(n)))},l.removeAddresses=function(e){_.each(e,function(e,t){l.removeAddress(t)})},l.removeAccount=function(){l.destroy()},l.removeAddress=function(e){var t={msg:"unsubscribe",addr:e};delete l.connected[e],delete o[e],l.send(JSON.stringify(t))},l.init=function(e){_OpenApi||(s=!1,l.onlineCheck=!0,_Node||(l.onlineCheck=deep(window,"navigator.onLine")||!1),l.online=l.onlineCheck,l.connected={},a(),l.hideallnotificationsel=$("#hideallnotifications")),e&&e()},setTimeout(function(){d.matrixchat.notify.event()},6e3)},b.convertUTCSS=function(e){return e=utcStrToDate(e),b.timeDifference&&e.addSeconds(-b.timeDifference),convertDate(dateToStr(e))},b.convertUTCSSrel=function(e){return e=utcStrToDate(e),b.timeDifference&&e.addSeconds(-b.timeDifference),u.reltime(e)},b.currentTimeSS=function(){var e=new Date;return b.timeDifference&&e.addSeconds(b.timeDifference),dateToStrUTCSS(e)},b.currentTime=function(){var e=Math.floor((new Date).getTime()/1e3);return b.timeDifference&&(e+=b.timeDifference),e},b.Cryptography=function(e){var n,r=this,i=[19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],o="undefined"!=typeof window?window.crypto||window.msCrypto:_crypto;return r.helpers={keyFromString:function(e,t,s){_Node?(PBKDF2.pbkdf2Sync(e,"helper",1,32,"sha512"),s(e)):new PBKDF2(e,"helper",1,t).deriveKey(null,function(e){s(e)})},keyForAes:function(e,t){function s(e){o.subtle?o.subtle.importKey("raw",aesjs.utils.utf8.toBytes(e),{name:"AES-CBC"},!1,["encrypt","decrypt"]).then(function(e){t&&t(e)}).catch(function(e){console.log(e)}):t&&t("")}128<=e.length?s(e):r.helpers.keyFromString(e,16,function(e){s(e)})}},r.api={random:{crypto:function(e,t){return t=t||256,t=new Uint8Array(t/8),o.getRandomValues?o.getRandomValues(t):getRandomValues(t),t=aesjs.utils.hex.fromBytes(t),e&&e(t),t}},rsa:{settings:{hashL:"256",name:"RSA-OAEP",length:4096},createKeys:function(t){var e=this.settings;o.subtle.generateKey({name:e.name,modulusLength:e.length,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-"+e.hashL}},!0,["encrypt","decrypt"]).then(function(e){t&&t(e)}).catch(function(e){console.error(e)})},exportKeys:function(e,t){var s={},n=this.exportKey;lazyEach({array:["public","private"],synk:!0,action:function(t){n(e[t.item+"Key"],t.item,function(e){s[t.item]=e,t.success()})},all:{success:function(){t&&t(s)}}})},exportKey:function(e,t,s){o.subtle.exportKey(t="private"==t?"pkcs8":"public"==t?"spki":"jwk",e).then(function(e){s&&s(convertArrayBufferToString(e))}).catch(function(e){console.error(e)})},importKeys:function(e,t){var s=this.importKey,n={};lazyEach({array:["public","private"],action:function(t){s(e[t.item],t.item,function(e){n[t.item+"Key"]=e,t.success()})},all:{success:function(){t&&t(n)}}})},importKey:function(e,t,s){var n=r.api.rsa.settings,a=[],i="jwk";"public"==t&&(a=["encrypt"],i="spki"),"private"==t&&(a=["decrypt"],i="pkcs8"),o.subtle.importKey(i,convertStringToArrayBuffer(e),{name:n.name,hash:{name:"SHA-"+n.hashL}},!0,a).then(function(e){s&&s(e)}).catch(function(e){console.error(e)})},encrypt:function(e,t,s){t=convertStringToArrayBuffer(t),o.subtle.encrypt({name:"RSA-OAEP"},e,t).then(function(e){s&&s(convertArrayBufferToString(e))}).catch(function(e){console.error(e)})},decrypt:function(e,t,s){t=convertStringToArrayBuffer(t),o.subtle.decrypt({name:"RSA-OAEP"},e,t).then(function(e){s&&s(convertArrayBufferToString(e))}).catch(function(e){console.error(e),s&&s("")})}},aeswc:{pwd:{encryption:function(e,t,s){r.api.aeswc.encryption(e,n,t,s)},decryption:function(e,t,s){r.api.aeswc.decryption(e,n,t,s)}},cryptoPair:function(t,s){t.privateEncrypted?s&&s(t):r.api.aeswc.pwd.encryption(t.private,{},function(e){t.privateEncrypted=e,s&&s(t)})},uncryptoPair:function(t,s){return t.private?s&&s(t):r.api.aeswc.pwd.decryption(t.privateEncrypted,{},function(e){t.private=e,s&&s(t)}),t},encryption:function(e,t,s,n){(s=s||{}).charsetEnc=s.charsetEnc||"utf8",s.charsetDec=s.charsetDec||"hex";var a=aesjs.utils[s.charsetEnc].toBytes(e);r.helpers.keyForAes(t,function(e){o.subtle.encrypt({name:"AES-CBC",iv:new Uint8Array(i)},e,a).then(function(e){e=aesjs.utils[s.charsetDec].fromBytes(new Uint8Array(e)),n&&n(e)}).catch(function(e){console.error(e)})})},decryption:function(e,t,s,n){(s=s||{}).charsetEnc=s.charsetEnc||"utf8",s.charsetDec=s.charsetDec||"hex";var a=new Uint8Array(aesjs.utils[s.charsetDec].toBytes(e));r.helpers.keyForAes(t,function(e){o.subtle?o.subtle.decrypt({name:"AES-CBC",iv:new Uint8Array(i)},e,a).then(function(e){e=aesjs.utils[s.charsetEnc].fromBytes(new Uint8Array(e)),n&&n(e)}).catch(function(e){n&&n("")}):n&&n("")})}}},r.messages={chat:{encryptions:function(e,t,s){s&&s()},encryption:function(e,t,s,n){s&&s()},decryptions:function(a,e,t){var s=[],i=_.map(e,function(e,t){return s.push(e),t}),o={};lazyEach({array:s,synk:!0,action:function(t,e){var s=t.item,n=i[e];s?r.messages.chat.decryption(a,s,function(e){o[n]=e,t.success()}):(o[n]=s,t.success())},all:{success:function(){t(o)}}})},decryption:function(e,t,s){s&&s("")}},decryption:function(e,t,s,n){function a(e){r.api.rsa.decrypt(e,t,function(e){r.api.aeswc.decryption(s,e,{},n)})}_.isObject(e)?a(e):r.api.rsa.importKey(e,"private",function(e){a(e)})},encryption:function(e,t,s,a){a=a||r.api.random.crypto();var i=[];lazyEach({array:e,action:function(t,s){function n(e){r.api.rsa.encrypt(e,a,function(e){i[s]={key:e,user:t.item.user},t.success()})}var e=t.item.key;_.isObject(e)?n(e):r.api.rsa.importKey(e,"public",function(e){n(e)})},all:{success:function(){r.api.aeswc.encryption(t,a,{},function(e){s&&s({keys:i,message:e})})}}})}},r.prepare=function(t){o.subtle||(r.disabled=!0),u.user.isState(function(e){e?(e=u.user.private.value)?(n=e.toString("hex"),t&&t(!1)):t&&t("key"):t&&t("state")})},r},b.autoUpdater=function(){var n,a;electron&&(n=null,a=function(){n=n||dialog({html:b.app.localization.e("e13347"),btn1text:b.app.localization.e("dyes"),btn2text:b.app.localization.e("e13348"),success:function(){globalpreloader(!0),electron.ipcRenderer.send("quitAndInstall"),n=null},fail:function(){n=null,setTimeout(a,864e5)}})},electron.ipcRenderer.on("updater-message",function(e,t){var s;"info"==t.type&&("update-downloaded"==t.msg&&a(),t.msg,"update-available"==t.msg&&(t.linux||t.macos)&&(n||!b.app.platform.applications.ui[os()]||(s=b.app.platform.applications.ui[os()]).github&&s.github.url&&(n=dialog({html:b.app.localization.e("e13349"),btn1text:b.app.localization.e("dyes"),btn2text:b.app.localization.e("e13348"),success:function(){require("electron").shell.openExternal(s.github.page),n=null},fail:function(){n=null,setTimeout(a,864e5)}})))),t.type}))},b.nodes=e||null,b.clearStorageFast=function(){_.each(b.sdk,function(e,t){"users"!=t&&"usersl"!=t&&e.storage&&(e.storage={})}),b.sdk.likes.who={},b.sdk.node.transactions.storage={}},b.clearStorage=function(){_.each(b.sdk,function(e,t){e.storage&&(e.storage={})}),b.sdk.search.storage={all:{},fs:{},posts:{},users:{},tags:{}},b.sdk.node.shares.storage={trx:{}},b.sdk.likes.who={},b.sdk.node.transactions.storage={},delete b.sdk.node.transactions.unspent},b.clearStorageLight=function(){u.platform.sdk.node.transactions.storage={},_.each(u.platform.sdk.node.shares.storage,function(e,t){"trx"!=t&&delete u.platform.sdk.node.shares.storage[t]})},b.clearlocal=function(){b.sdk.tags.storage.cloud=null,b.sdk.newmaterials.clear()},b.clear=function(e){b.app.nav.addParameters=null,b.sdk.articles.storage=[],b.sdk.notifications.clbks.seen={},b.sdk.notifications.clbks.added={},b.sdk.notifications.inited=!1,b.sdk.notifications.loading=!1,b.sdk.ustate.clbks={},b.sdk.registrations.clbks={},b.sdk.node.storage={balance:{}},e?b.clearStorageFast():b.clearStorage(),u.peertubeHandler&&u.peertubeHandler.clear(),b.sdk.node.transactions.clearUnspentoptimizationInterval(),b.sdk.node.transactions.unspentLoading={},electron&&(electron.ipcRenderer.send("update-badge",null),electron.ipcRenderer.send("update-badge-tray",null)),b.ws&&b.ws.destroy(),b.clientrtctemp&&b.clientrtctemp.destroy(),b.focusListener&&b.focusListener.destroy(),n()},b.restart=function(t){u.errors.clear(),b.clear(),u.user.isState(function(e){b.prepare(t,e)})},b.update=function(e){b.updating||b.preparingUser||b.preparing||(b.updating=makeid(),setTimeout(function(){b.updating=!1},9e4),lazyEach({array:["ustate.meUpdate","user.meUpdate","node.get.time","node.transactions.checkTemps","node.transactions.get.allBalanceUpdate","tempmessenger.getChats"],action:function(e){var t=e.item;deep(b.sdk,t)(function(){e.success()})},all:{success:function(){e&&e()}}}))},b.appstate=function(){b.loadingWithErrors&&_.isEmpty(b.app.errors.state)&&(b.loadingWithErrors=!1,b.restart(function(){b.prepareUserData(function(){b.app.reload(function(){})})}))},b.directdialog=function(n){return new Promise((t,e)=>{var s=dialog({html:b.app.localization.e("pdirectdialog"),btn1text:b.app.localization.e("dyes"),btn2text:b.app.localization.e("dno"),success:function(){b.app.api.set.current(n.id).then(e=>{t()}).catch(t)},fail:function(){t()},class:"zindex"});b.app.api.wait.ready("useexternal").then(e=>{s.destroy(),t()})})},b.prepare=function(t){b.preparing=!0,b.sdk.registrations.load(),b.sdk.relayTransactions.load(),b.applications=b.__applications(),b.sdk.theme.load(),b.sdk.system16.init(),setTimeout(function(){b.initSounds()},3e3),b.app.errors.clbks&&(b.app.errors.clbks.platform=b.appstate),a(),b.app.api.wait.ready("use",3e3).then(e=>new Promise((t,e)=>{setTimeout(function(){b.app.api.changeProxyIfNeed().then(e=>{e||!(e=b.app.api.get.direct())?t():b.directdialog(e).then(t)}).catch(e)},50)})).then(e=>{b.ws=new b.WSn(b),b.firebase=new b.Firebase(b),b.state.load(),b.focusListener=b.FocusListener(b),b.focusListener.init(),b.titleManager=new b.TitleManager,b.sdk.captcha.load(),b.sdk.tags.getfastsearch(),b.sdk.node.get.time(),b.sdk.videos.init(),b.preparing=!1,b.prepareUser(t),"undefined"!=typeof PeerTubePocketnet&&(b.app.peertubeHandler=new PeerTubePocketnet(b.app),b.app.peertubeHandler.init())}).catch(e=>{console.log("ERROR",e)})},b.prepareUserData=function(e){lazyActions([b.sdk.node.transactions.loadTemp,b.sdk.ustate.meUpdate,b.firebase.init,b.sdk.tempmessenger.init,b.sdk.user.meUpdate,b.sdk.categories.load,b.sdk.activity.load,b.sdk.node.shares.parameters.load],function(){b.loadingWithErrors=!_.isEmpty(b.app.errors.state),b.loadingWithErrors&&b.sdk.notifications.init().catch(e=>{}),e&&e()})};var n=function(){var e,t=b.app.platform.sdk.address.pnet();b.app.user.features.telegram=0,b.enablePeertube=!1,t&&(e=t.address,t=b.testchataddresses,-1<b.testaddresses.indexOf(b.sdk.address.pnet().address)&&(b.enablePeertube=!0),-1<t.indexOf(e)?b.app.user.features.telegram=1:b.app.user.features.telegram=0)};b.prepareUser=function(t){b.preparingUser=!0,b.matrixchat.destroy(),n(),u.user.isState(function(e){e?lazyActions([b.sdk.node.transactions.loadTemp,b.sdk.addresses.init,b.sdk.ustate.me,b.sdk.usersettings.init,b.sdk.imagesH.load,b.ws.init,b.firebase.init,b.sdk.categories.load,b.sdk.activity.load,b.sdk.node.shares.parameters.load,b.sdk.node.transactions.checkTemps,b.sdk.user.get],function(){b.sdk.node.transactions.setUnspentoptimizationInterval(),b.sdk.relayTransactions.send(),b.matrixchat.init(),b.preparingUser=!1,b.loadingWithErrors=!_.isEmpty(b.app.errors.state),t&&t(),setTimeout(function(){lazyActions([b.cryptography.prepare,b.sdk.pool.init,b.sdk.articles.init,b.sdk.tempmessenger.init,b.sdk.chats.load,b.sdk.user.subscribeRef],function(){}),b.loadingWithErrors&&b.sdk.notifications.init().catch(e=>{})},2e3)}):(b.preparingUser=!1,t&&t())})},b.matrixchat={el:null,inited:!1,initing:!1,clbks:{ALL_NOTIFICATIONS_COUNT:{},NOTIFICATION:{}},destroy:function(){window.matrixchat&&window.matrixchat.destroy(),$("#matrix").empty(),b.matrixchat.el=null,b.matrixchat.inited=!1,b.matrixchat.clbks={ALL_NOTIFICATIONS_COUNT:{},NOTIFICATION:{}}},import:function(e){b.matrixchat.imported?e&&e():(b.matrixchat.imported=!0,electron?(console.log("HERE"),e&&e()):importScript("chat/matrix-element.min.js",e))},init:function(){b.matrixchat.inited||b.matrixchat.initing||(b.matrixchat.initing=!0,u.user.isState(function(e){var t;b.matrixchat.initing=!1,e&&(t=b.app.platform.sdk.address.pnet().address,b.testchataddresses,e=deep(u,"platform.sdk.user.storage.me"),window.testpocketnet&&e&&!_.isEmpty(e)&&!(e.temp||e.relay||e.fromstorage)&&b.matrixchat.import(function(){b.matrixchat.inited=!0;var e=b.app.user.private.value.toString("hex"),e=`<div class="wrapper matrixchatwrapper">
                                    <matrix-element
                                        address="${t}"
                                        privatekey="${e}"
                                        pocketnet="`+(isMobile()?"":"true")+`"
                                        mobile="`+(isMobile()?"true":"")+`" 
                                    >
                                    </matrix-element>
                                </div>`;$("#matrix").append(e),b.matrixchat.el=$(".matrixchatwrapper"),b.matrixchat.initevents()},null,u))}))},initevents:function(){b.matrixchat.el&&(isMobile()&&b.matrixchat.el.swipe({allowPageScroll:"auto",swipeLeft:function(e,t,s,n){b.matrixchat.core&&b.matrixchat.core.backtoapp()}}),b.matrixchat.clbks.NOTIFICATION.global=b.matrixchat.notify.event)},notify:{tpl:function(e){if(b.ws){console.log("self.ws",b.ws);var t=b.ws.tempates,s="";if(e.ctype){var n={encrypted:"e13345",message:"e133452",invite:"e133451"}[e.ctype];if(n)return'<div class="fastMessage">                <div class="fmCnt">'+(s+t.user({image:e.icon,name:e.title,address:""},"",!0,b.app.localization.e(n),"",dateNow()))+'</div>                <div class="close">                    <i class="fa fa-times" aria-hidden="true"></i>                </div>                </div>'}}},event:function(e){"undefined"==typeof _Electron||b.focus||(e=b.matrixchat.notify.tpl(e))&&electron.ipcRenderer.send("electron-notification",{html:e,settings:{size:"small"}})}},link:function(e){e.update({block:{height:b.currentBlock}}),e.backtoapp=function(e){b.matrixchat.el&&b.matrixchat.el.removeClass("active"),b.matrixchat.core&&(b.matrixchat.core.hiddenInParent=!0),e&&(e=e.replace("https://"+b.app.options.url+"/",""),b.app.nav.api.load({open:!0,href:e,history:!0}))},e.apptochat=function(){b.matrixchat.el&&b.matrixchat.el.addClass("active"),b.matrixchat.core&&(b.matrixchat.core.hiddenInParent=!1)},b.matrixchat.core=e,b.matrixchat.core.hiddenInParent=!0,e.externalLink(b.matrixchat),b.app.platform.ws.messages.newblocks.clbks.newsharesLenta=b.app.platform.ws.messages["new block"].clbks.matrixchat=function(){e.update({block:{height:b.currentBlock}})};var t=deep(u,"modules.menu.module.restart");t&&t(),(t=deep(u,"nav.clbks.history.navigation"))&&t()},unlink:function(){b.matrixchat.core&&(b.matrixchat.core.hiddenInParent=!1,b.matrixchat.core.destroyExternalLink()),delete b.app.platform.ws.messages["new block"].clbks.matrixchat,delete b.matrixchat.core;var e=deep(u,"modules.menu.module.restart");e&&e(),(e=deep(u,"nav.clbks.history.navigation"))&&e()},transaction:function(e,t){b.matrixchat.core&&t&&b.matrixchat.core.mtrx.transaction(t,e)}},b.initSounds=function(){"undefined"!=typeof ion&&(ion.prepare(),ion.sound({sounds:[{name:"water_droplet"},{name:"glass"}],volume:.5,path:"js/vendor/ion.sound/sounds/",preload:!0}))},b.FocusListener=function(n){function t(e){o(e)}function s(){c()}var a=this,i=null,o=function(e){r(e,!0)},r=function(e,t){var s=(s=n.currentTime())-(i||s);a.focus=!0,120<s&&(window.cordova||electron||isInStandaloneMode())&&(a.clearStorageLight(),a.sdk.node.transactions.get.allBalance(null,!0),a.sdk.notifications.getNotifications().catch(e=>{})),a.clbks.focus(s),a.titleManager&&a.titleManager.clear()},c=function(){a.focus=!1,i=n.currentTime()};window.focus();var d=!(a.focus=!0);return a.init=function(){if(d=!0,window.cordova)return document.addEventListener("pause",c,!1),void document.addEventListener("resume",r,!1);var e;electron&&((e=electron.remote.getCurrentWindow()).on("hide",c),e.on("minimize",c),e.on("restore",r),electron.ipcRenderer.on("pause-message",s),electron.ipcRenderer.on("resume-message",r)),$(window).on("focus",r),$(window).on("blur",c)},a.destroy=function(){if(d){if(d=!1,window.cordova)return document.removeEventListener("pause",c,!1),void document.removeEventListener("resume",r,!1);var e;electron&&((e=electron.remote.getCurrentWindow()).off("hide",c),e.off("minimize",c),e.off("restore",r),electron.ipcRenderer.off("pause-message",s),electron.ipcRenderer.off("resume-message",t)),$(window).off("focus",r),$(window).off("blur",c)}},a};var a=function(){};return b.TitleManager=function(){var s="",n=null;return this.add=function(e){e=$("<div>").html(e).text(),n&&clearInterval(n),s=s||document.title||"Pocketnet";var t=0;n=setInterval(function(){t++,document.title=t%2?e:s},700)},this.clear=function(){n&&clearInterval(n),n=null,s&&(document.title=s),s=""},this},b.state={save:function(){b.nodeid?localStorage.nodeid2=JSON.stringify(b.nodeid):delete localStorage.nodeid2},load:function(){if(b.nodes&&b.nodes.length){try{b.nodeid=JSON.parse(localStorage.nodeid2)}catch(e){}b.nodeid||(b.nodeid=b.nodes[0])}}},b.navManager=function(){electron&&_Electron&&electron.ipcRenderer.on("nav-message",function(e,t){"action"==t.type&&(t=t.msg,b.app.nav.api.load({open:!0,href:t,history:!0}))})},b.navManager(),b.app=u,"undefined"!=typeof HTLS&&(b.htls=new HTLS),b.cryptography=new b.Cryptography,b.autoUpdater(),b},"undefined"!=typeof module&&(module.exports=Platform),topPreloader(65);
 /*_____*/ 
var platformRTC=function(e){var l=(e=e||{}).user||{},h=e.platform||null,e=hash_32b_to_16b(hashFnv32a(makeid()));function g(){var a=this,s=h.app.ajax.rtchttp;return a.storage={chat:{},allchats:null},a.info={chat:function(t,n){a.storage.chat[t]?n&&n(a.storage.chat[t]):s({action:"info.address.chat",data:{address:l.address,id:t},success:function(e){e.data&&(a.storage.chat[t]=e.data),n&&n(a.storage.chat[t])},fail:function(){n&&n(null)}})},chats:function(e,t){(e=_.filter(e,function(e){return!a.storage.chat[e]})).length?s({action:"info.address.chats",data:{address:l.address,ids:e},success:function(e){_.each(e.data||{},function(e,t){a.storage.chat[t]=e}),t&&t(!0)},fail:function(){t&&t()}}):t&&t(!0)},allchats:function(t){a.storage.allchats?t&&t(!0):s({action:"info.address.allchats",data:{address:l.address},success:function(e){_.each(e.data||{},function(e,t){a.storage.chat[t]=e}),t&&t(!0)},fail:function(){t&&t()}})}},a.update={chat:function(e,t,n){var s=deep(a.storage,"chat."+e);s||(a.storage.chat[e]=s={messages:{count:0,unreaded:0},users:[]}),s.messages.count=(s.messages.count||0)+Math.abs(t),s.messages.unreaded=(s.messages.unreaded||0)+t,n&&(s.users=n),s.unreaded<0&&(s.unreaded=0)}},a.get={relayed:function(t){s({action:"relayed.address",data:{address:l.address},success:function(e){t&&t(e.data)},fail:function(){t&&t(null)}})},chats:{users:function(e,t){s({action:"chats.users",data:{chats:e.join(",")},success:function(e){t&&t(e.data)},fail:function(){t&&t(null)}})},messages:function(e,t){s({action:"info.chat.messages",data:{id:e},success:function(e){t&&t(e.data)},fail:function(){t&&t(null)}})}}},a.put={chat:{messages:function(e,t){var n;e&&((n=e.get.lastmessages(50)).length?s({action:"put.chat.messages",data:{id:e.id,messages:hexEncode(JSON.stringify(n)),address:l.address},success:function(e){t&&t(!0)},fail:function(){t&&t(!1)}}):t&&t(!1))}}},a}function m(e,t,c){var i=this;function n(){i.clbks={receive:{message:{},messages:{}},send:{message:{}}}}return i.storage=new MessageStorage({id:e}),i.clbks={},i.addresses=t||[],i.id=e,i.disconnectTimeout=null,i.send=function(e){var t,n,s,a=(t=e,t={tm:h.currentTimeSS(),f:l.address,t:"",m:t,ex:{s:""}},n=t,s=h.app.user.keys(),e=n.tm+n.f+n.t+n.m,e=s.sign(Buffer.from(bitcoin.crypto.hash256(e),"utf8")),n.ex.s=e.toString("hex"),n.ex.p=s.publicKey.toString("hex"),t);i.storage.AddMessage(a,!0),c.send&&c.send(a),_.each(i.clbks.send.message||{},function(e){e(a)})},i.connect=function(e){c.connect(e)},i.leave=function(e){c.leave(e)},i.receive={message:function(t){i.storage.AddMessage(t,!0),_.each(i.clbks.receive.message||{},function(e){e(t)})},messages:function(t){t&&!_.isEmpty(t)&&(i.storage.MergeDB(t),_.each(i.clbks.receive.messages||{},function(e){e(t)}))}},i.get={lastmessages:function(e){var t=i.storage._db||{},t=_.sortBy(_.clone(t),function(e){if(e.tm){var t=e.tm;return 17==e.tm.length&&(e.tm=t+"0"),Number(e.tm)}});return(t=_.map(t,function(e){return(e=_.clone(e)).m=encodeURIComponent(e.m),e})).length>e&&t.splice(0,t.length-e),t},message:function(e){return i.storage.GetMessage(e)}},i.remote={lastmessages:function(){c.lastmessages&&c.lastmessages(function(e){i.receive.messages(e)})}},i.close=function(){n()},n(),i}l.id=(l.device||"")+e;return new function(){var t,s=this;s.chats={},s.relay={},s.relayed={},s.clbks={};var c={login:{}},e=!1,n=!1;function a(e){retry(function(){return n},function(){t.send(JSON.stringify(e))},100)}function i(){s.clbks={newchat:{},chat:{},message:{}}}function o(e){(t=new ReconnectingWebSocket(h.app.options.rtcws)).onmessage=function(e){f(e)},t.onopen=function(){n=!0,e&&e()}}s.online=!0,s.onlineCheck=!0,"undefined"!=typeof window&&(s.online=deep(window,"navigator.onLine")||!1);function u(n,t){return s.chats[n]||(s.chats[n]=new m(n,t,{send:function(e){var t=_.clone(e);t.m=encodeURIComponent(t.m),a({type:"message",chatid:n,message:e})},lastmessages:function(e){s.rtchttp.get.chats.messages(n,e)},connect:function(e){a({type:"chat",chatid:n,addresses:t||[]}),s.addclbk("chat",makeid(!0),e)},leave:function(e){a({type:"leave",chatid:n}),s.addclbk("leave",makeid(!0),e),delete s.chats[n]}})),s.chats[n]}var r={leave:function(){},chat:function(t){var n=u(t.chatid,t.addresses);_.each(c.chat||{},function(e){e(t,n)}),t.l?n.remote.lastmessages():s.rtchttp.put.chat.messages(n)},relay:function(e){relays.create(e.device,e.offline)},chat_newdevice:function(t){var n=u(t.chatid,t.addresses);_.each(c.chat||{},function(e){e(t,n)})},chat_newuser:function(e){s.chats[e.chatid]},exit:function(e){},login:function(t){_.each(c.login||{},function(e){e(t)})},message:function(t){var n=s.chats[t.chatid];n&&(n.receive.message(t.message),s.rtchttp.update.chat(t.chatid,1),_.each(s.clbks.message||{},function(e){e(t,n)}))}},d={},f=function(e){var t={};try{t=JSON.parse(e.data)}catch(e){}t.type&&(t.success?r[t.type]&&r[t.type](t):d[t.type]?d[t.type](t):t.error)};return s.initChats=function(e){_.each(e,function(e){u(e.id,e.users)})},s.addclbk=function(n,s,a){c[n]||(c[n]={}),c[n][s]=function(e,t){delete c[n][s],a&&"function"==typeof a&&a(e,t)}},s.api={login:function(e){l&&(a({type:"login",device:l.device,id:l.id,address:l.address,signature:l.signature,publicKey:l.publicKey}),s.addclbk("login",makeid(!0),e))},getChat:function(e,t,n){return u(e,t)}},s.connection=function(){return t},s.close=function(){return!e&&(i(),e=!(n=!1),t.close(),!0)},s.destroy=function(){_.each(s.chats||{},function(e){e.close()}),s.chats={},s.close()},s.psinit=function(e){o(function(){s.api.login(function(){e&&e()})})},s.init=function(e){s.onlineCheck,o(),s.rtchttp=new g,s.api.login(function(){i(),e&&e()})},s.getchats=function(e){_.each(s.chats,function(e){e.remote.lastmessages(),e.connect()}),e&&e()},s}};"undefined"!=typeof module&&(module.exports=platformRTC);
 /*_____*/ 
var PeertubeRequest=function(e=0){function i(e,t,o){var i,a,n,r=new AbortController,s=1e4;return(window.cordova||isInStandaloneMode())&&(s=25e3),i=s,a=function(e,t,o,r){r=r||{},t=t||{};var i=_.extend({Accept:"application/json"},r.headers||{});console.log("RESPHEADERS",i);var a={},i={method:r.method||"GET",headers:i,signal:o};return t&&!_.isEmpty(t)&&"GET"!==i.method&&(i.body=serialize(t)),fetch(e,i).then(e=>(o.dontabortable=!0,(a=e).ok?e.json():Promise.resolve(e.text()))).then(e=>a.ok?Promise.resolve(e||{}):Promise.reject(e)).catch(e=>{e={code:a.status||400,text:e};return Promise.reject(e)})}(e,t,r.signal,o),n=r,new Promise((t,o)=>{const r=setTimeout(()=>{n.signal.dontabortable||n&&n.abort()},i);a.then(e=>{clearTimeout(r),t(e)}).catch(e=>{clearTimeout(r),o(e)})})}return this.fetch=function(e,t,o,r){return i(e+"/"+t,o,r)},this};PeerTubePocketnet=function(r){var u=this,o="peertube://",d="",c=new PeertubeRequest(r),i=null;u.checklink=function(e){return e.includes(o)},u.transcode=async function(e){var t=null;try{t=await a(e)}catch(e){console.log("ER",e)}return t};var a=async function(e){if("undefined"==typeof FFmpeg)return null;var t=makeid(),{createFFmpeg:o,fetchFile:r}=FFmpeg;return(i=null===i?o({log:!0}):i).isLoaded()||await i.load(),i.FS("writeFile",t,await r(e)),await i.run("-i",t,"-acodec","copy","-vcodec","h264","-s","720x1280",t+"output.mp4"),i.FS("readFile",t+"output.mp4")};function h(e){return{code:e,text:r.localization.e("pterror_"+e)}}function n(e,i={},a={}){a.host||(a.host=d);var t,n={headers:{}},s=(t=i,m[e=e]?("function"==typeof(e=_.clone(m[e])).path&&(e.path=e.path(t)),e):null);return s?u.api.proxy.bestIfNeed(!(a.host&&!a.best)).then(e=>{if(e&&(a.host=e),!a.host)return Promise.reject(h("host"))}).then(()=>u.api.pocketnet.signatureIfNeed(s.signature)).then(e=>(i=_.extend(i,e),u.api.user.authIfNeed(s.authorization,a.host,s.renew))).then(e=>{var o;if(s.authorization&&(n.headers.Authorization=`Bearer ${l[a.host].access_token}`),s.headers&&(n.headers=_.extend(n.headers,s.headers)),s.method&&(n.method=s.method),s.formdata&&(o=new FormData,_.each(i,function(e,t){o.append(t,e)}),i=o),s.changedata&&s.changedata(i),s.serialize&&(i=serialize(i)),s.formdata||s.axios){const r=axios.CancelToken;var t={headers:n.headers};return"GET"===n.method&&(i={...i,...t}),s.formdata&&(t.onUploadProgress=e=>{var t=Math.round(100*e.loaded/e.total);a.progress&&a.progress(t,e)},t.cancelToken=new r(e=>{a.cancel&&a.cancel(e)})),axios[(n.method||"post").toLowerCase()]("https://"+a.host+"/"+s.path,i,t).then(e=>e.data||{}).catch(e=>Promise.reject(e))}return console.log("requestoptions",n),c.fetch("https://"+a.host,s.path,i,n)}):Promise.reject(h("meta"))}u.parselink=function(e){return{host:(e=e.replace(o,"").split("/"))[0],id:e[1]}},u.composeLink=function(e,t){return o+e+"/"+t};var l={},m={stats:{path:"api/v1/videos"},video:{path:function({id:e}){return"api/v1/videos/"+e}},oauthClientsLocal:{path:"api/v1/oauth-clients/local"},pocketnetAuth:{path:"plugins/pocketnet-auth/router/code-cb",signature:!0,method:"POST",axios:!0,serialize:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}},getToken:{path:"api/v1/users/token",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}},quotaUsed:{path:"api/v1/users/me/video-quota-used",authorization:!0},me:{path:"api/v1/users/me",authorization:!0},uploadVideo:{path:"api/v1/videos/upload",formdata:!0,renew:!0,method:"POST",authorization:!0},importVideo:{path:"api/v1/videos/imports",formdata:!0,renew:!0,method:"POST",authorization:!0},startLive:{path:"api/v1/videos/live",formdata:!0,renew:!0,method:"POST",authorization:!0},getLiveInfo:{path:({id:e})=>`api/v1/videos/live/${e}`,method:"GET",authorization:!0},getMyAccountVideos:{path:"api/v1/users/me/videos",method:"GET",authorization:!0,axios:!0},removeVideo:{path:function({id:e}){return"api/v1/videos/"+e},method:"DELETE",authorization:!0,renew:!0,changedata:function(e){delete e.id}},updateVideo:{path:function({id:e}){return"api/v1/videos/"+e},method:"PUT",formdata:!0,authorization:!0,renew:!0}};return u.active=function(){return d},u.api={pocketnet:{signatureIfNeed:function(e){return e?this.signature():Promise.resolve({})},signature:function(){return new Promise((t,o)=>{r.user.isState(function(e){return e?t(r.user.signature("peertube",null)):o()})})}},proxy:{bestIfNeed:function(e){return e?this.best():Promise.resolve()},best:function(){return r.api.fetch("peertube/best").then(e=>e.host?Promise.resolve(e.host):Promise.reject(h("host"))).catch(e=>("best"==e.data&&(e.text="Unable to connect to video server"),Promise.reject(e)))},bestChange:function(){return u.api.proxy.best().then(e=>(d=e,Promise.resolve())).catch(e=>Promise.resolve())}},videos:{remove:function(e,t={}){return u.checklink(e)?(e=u.parselink(e),t.host||(t.host=e.host),n("removeVideo",e={id:e.id},t).then(e=>e.video?Promise.resolve():Promise.reject(h("removeerror")))):Promise.reject(h("link"))},update:function(e,t={},o={}){if(!u.checklink(e))return Promise.reject(h("link"));var r=u.parselink(e),e={};return o.host||(o.host=r.host),t.image&&(e.thumbnailfile=e.previewfile=dataURLtoFile(t.image.data)),t.name&&(e.name=t.name),t.description&&(e.description=t.description),_.isEmpty(e)?Promise.reject(h("updateempty")):(e.id=r.id,n("updateVideo",e,o).then(e=>Promise.resolve()))},upload:function(o,r){return o.video?u.api.videos.checkQuota(o.video.size).then(e=>{var t=o.name||`${this.userName}:${(new Date).toISOString()}`,t={privacy:1,"scheduleUpdate[updateAt]":(new Date).toISOString(),channelId:e.channelId,name:t,videofile:o.video};return o.image&&(t.thumbnailfile=t.previewfile=dataURLtoFile(o.image.data,o.image.name)),n("uploadVideo",t,r).then(e=>e.video?Promise.resolve(u.composeLink(r.host,e.video.uuid)):Promise.reject(h("uploaderror"))).catch(e=>(e.cancel=axios.isCancel(e),Promise.reject(e)))}):Promise.reject(h("videonotselected"))},import:(t={},o={})=>u.api.videos.checkQuota(0).then(e=>({...t.data,channelId:e.channelId,privacy:1})).then(e=>n("importVideo",e,o).then(e=>e.video?Promise.resolve(u.composeLink(o.host,e.video.uuid)):Promise.reject(h("uploaderror"))).catch(e=>(e.cancel=axios.isCancel(e),Promise.reject(e)))),live:(r={},t={})=>u.api.user.me().then(e=>{var t=r.name||`Stream:${(new Date).toISOString()}`;const o={privacy:1,channelId:e.channelId,name:t,saveReplay:!0};return r.image&&(o.thumbnailfile=o.previewfile=dataURLtoFile(r.image.data,r.image.name)),o}).then(e=>n("startLive",e,t)).then(e=>e.video?Promise.resolve({...e.video,formattedLink:u.composeLink(t.host,e.video.uuid),host:t.host}):Promise.reject(h("uploaderror"))).catch((e={})=>3!==(e.response?e.response.data:{}).code?(e.cancel=axios.isCancel(e),Promise.reject(e)):u.api.videos.getMyAccountVideos({isLive:!0,filter:"local"}).then((e=[])=>(e=e[0])?Promise.resolve({id:e.id,uuid:e.uuid,host:t.host,formattedLink:u.composeLink(t.host,e.uuid)}):Promise.reject(h("failedStreamGeneration")))),getLiveInfo:(t={},e={})=>n("getLiveInfo",t,e).then(e=>({...e,uuid:t.id})),checkQuota:function(n=0){return u.api.user.me().then(a=>u.api.videos.quota().then(e=>{var t=Number(n)||0,o=Number(a.videoQuotaDaily)||0,r=Number(e.videoQuotaUsedDaily)||0,i=Number(a.videoQuota)||0;return Number(e.videoQuotaUsed),!(t&&o&&i)||t+r<o+104857600||o<0?Promise.resolve(a):Promise.reject(h("dailyquotalimit"))}))},quota:function(){return n("quotaUsed").then(e=>void 0!==e.videoQuotaUsedDaily?Promise.resolve(e):Promise.reject(h("videoQuotaUsedDaily")))},getMyAccountVideos(e={}){return n("getMyAccountVideos",{params:{...e}}).then((e={})=>e.data||[])}},user:{me:function(){return n("me").then(e=>(e={channelId:deep(e,"videoChannels.0.id"),videoQuotaDaily:deep(e,"videoQuotaDaily"),videoQuota:deep(e,"videoQuota"),username:deep(e,"username")}).channelId&&e.videoQuotaDaily?Promise.resolve(e):Promise.reject(h("usersMe")))},authIfNeed:function(e,t,o){return e?this.auth(t,o):Promise.resolve()},auth:function(t,e){var o={};if(console.log("CHECK HOST",l,t,l[t]),t&&l[t]){if(!e)return Promise.resolve(l[t]);if(l[t].date>utcnow().addMinutes(-15))return u.api.user.getToken(l[t],{host:t})}return n("oauthClientsLocal",{},{host:t}).then(({client_id:e,client_secret:t})=>e&&t?(o.client_id=e,o.client_secret=t,Promise.resolve()):Promise.reject(h("oauthClientsLocal"))).then(()=>n("pocketnetAuth",{},{host:t})).then((e={})=>e.externalAuthToken&&e.username?(o.externalAuthToken=e.externalAuthToken,o.username=e.username,Promise.resolve(o)):Promise.reject(h("pocketnetAuth"))).then(e=>u.api.user.getToken(e,{host:t}))},getToken:function(o={},t={}){return o.response_type="code",o.refresh_token?o.grant_type="refresh_token":o.grant_type="password",n("getToken",o,t).then(({access_token:e,refresh_token:t})=>e&&t?(o.access_token=e,o.refresh_token=t,o):Promise.reject(h("getToken"))).then(e=>(e.date=utcnow(),l[t.host]=e,Promise.resolve(e)))}}},u.clear=function(){l={}},u.init=function(){return u.api.proxy.bestChange()},u};
 /*_____*/ 
!function(l){var e,u,f,r,b,y,v,k,o,m,I,t,g,M;function h(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function x(e,n,t){e.addEventListener(n,t,!1)}function E(e,n,t){e.removeEventListener(n,t,!1)}function i(e){return I[e]?I[e].log:f}function F(e,n){a("log",e,n,i(e))}function T(e,n){a("info",e,n,i(e))}function z(e,n){a("warn",e,n,!0)}function a(e,n,t,i){!0===i&&"object"==typeof window.console&&console[e](y+"["+(e="Host page: "+n,e=window.top!==window.self?window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+n:"Nested host page: "+n:e)+"]",t)}function n(n){function i(){e("Height"),e("Width"),H(function(){P(p),R(w),f("onResized",p)},p,"init")}function e(e){var n=Number(I[w]["max"+e]),t=Number(I[w]["min"+e]),i=e.toLowerCase(),e=Number(p[i]);F(w,"Checking "+i+" is in range "+t+"-"+n),e<t&&(e=t,F(w,"Set "+i+" to min value")),n<e&&(e=n,F(w,"Set "+i+" to max value")),p[i]=""+e}function a(e){return h.substr(h.indexOf(":")+b+e)}function s(t,i){var o;M[o=i]||(M[o]=setTimeout(function(){var e,n;M[o]=null,j("Send Page Info","pageInfo:"+(e=document.body.getBoundingClientRect(),n=p.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})),t,i)},32))}function d(e){return e=e.getBoundingClientRect(),O(w),{x:Math.floor(Number(e.left)+Number(k.x)),y:Math.floor(Number(e.top)+Number(k.y))}}function c(e){var n=e?d(p.iframe):{x:0,y:0},t={x:Number(p.width)+n.x,y:Number(p.height)+n.y};F(w,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](t.x,t.y):z(w,"Unable to scroll to requested position, window.parentIFrame not found"):(k=t,l(),F(w,"--"))}function l(){!1!==f("onScroll",k)?R(w):S()}function u(e){var n,t=0===Number(p.width)&&0===Number(p.height)?{x:(n=a(9).split(":"))[1],y:n[0]}:{x:p.width,y:p.height};f(e,{iframe:p.iframe,screenX:Number(t.x),screenY:Number(t.y),type:p.type})}function f(e,n){return N(w,e,n)}var t,o,r,m,g,h=n.data,p={},w=null;"[iFrameResizerChild]Ready"===h?function(){for(var e in I)j("iFrame requested init",A(e),I[e].iframe,e)}():y===(""+h).substr(0,v)&&h.substr(v).split(":")[0]in I?(g=(o=h.substr(v).split(":"))[1]?parseInt(o[1],10):0,r=I[o[0]]&&I[o[0]].iframe,m=getComputedStyle(r),p={iframe:r,id:o[0],height:g+("border-box"!==(g=m).boxSizing?0:(g.paddingTop?parseInt(g.paddingTop,10):0)+(g.paddingBottom?parseInt(g.paddingBottom,10):0))+("border-box"!==m.boxSizing?0:(m.borderTopWidth?parseInt(m.borderTopWidth,10):0)+(m.borderBottomWidth?parseInt(m.borderBottomWidth,10):0)),width:o[2],type:o[3]},w=p.id,I[w]&&(I[w].loaded=!0),(o=p.type in{true:1,false:1,undefined:1})&&F(w,"Ignoring init message from meta parent page"),!o&&(t=!0,I[o=w]||(t=!1,z(p.type+" No settings for "+o+". Message was: "+h)),t)&&(F(w,"Received: "+h),t=!0,null===p.iframe&&(z(w,"IFrame ("+p.id+") not found"),t=!1),t&&function(){var e,t=n.origin,i=I[w]&&I[w].checkOrigin;if(i&&""+t!="null"&&!(i.constructor===Array?function(){var e=0,n=!1;for(F(w,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===t){n=!0;break}return n}():(e=I[w]&&I[w].remoteHost,F(w,"Checking connection is from: "+e),t===e)))throw new Error("Unexpected message received from: "+t+" for "+p.iframe.id+". Message was: "+n.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return 1}()&&function(){switch(I[w]&&I[w].firstRun&&I[w]&&(I[w].firstRun=!1),p.type){case"close":C(p.iframe);break;case"message":n=a(6),F(w,"onMessage passed: {iframe: "+p.iframe.id+", message: "+n+"}"),f("onMessage",{iframe:p.iframe,message:JSON.parse(n)}),F(w,"--");break;case"mouseenter":u("onMouseEnter");break;case"mouseleave":u("onMouseLeave");break;case"autoResize":I[w].autoResize=JSON.parse(a(9));break;case"scrollTo":c(!1);break;case"scrollToOffset":c(!0);break;case"pageInfo":s(I[w]&&I[w].iframe,w),o=w,t("Add ",x),I[o]&&(I[o].stopPageInfo=r);break;case"pageInfoStop":I[w]&&I[w].stopPageInfo&&(I[w].stopPageInfo(),delete I[w].stopPageInfo);break;case"inPageLink":e=a(9).split("#")[1]||"",n=decodeURIComponent(e),(n=document.getElementById(n)||document.getElementsByName(n)[0])?(n=d(n),F(w,"Moving to in page link (#"+e+") at x: "+n.x+" y: "+n.y),k={x:n.x,y:n.y},l(),F(w,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(e):F(w,"In page link #"+e+" not found and window.parentIFrame not found"):F(w,"In page link #"+e+" not found");break;case"reset":W(p);break;case"init":i(),f("onInit",p.iframe);break;default:0===Number(p.width)&&0===Number(p.height)?z("Unsupported message received ("+p.type+"), this is likely due to the iframe containing a later version of iframe-resizer than the parent page"):i()}var e,o,n;function t(n,t){function i(){I[o]?s(I[o].iframe,o):r()}["scroll","resize"].forEach(function(e){F(o,n+e+" listener for sendPageInfo"),t(window,e,i)})}function r(){t("Remove ",E)}}())):T(w,"Ignored: "+h)}function N(e,n,t){var i=null,o=null;if(I[e]){if("function"!=typeof(i=I[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=i(t)}return o}function p(e){e=e.id,delete I[e]}function C(e){var n=e.id;if(!1!==N(n,"onClose",n)){F(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){z(e)}N(n,"onClosed",n),F(n,"--"),p(e)}else F(n,"Close iframe cancelled by onClose event")}function O(e){null===k&&F(e,"Get page position: "+(k={x:window.pageXOffset!==l?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==l?window.pageYOffset:document.documentElement.scrollTop}).x+","+k.y)}function R(e){null!==k&&(window.scrollTo(k.x,k.y),F(e,"Set page position: "+k.x+","+k.y),S())}function S(){k=null}function W(e){F(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),O(e.id),H(function(){P(e),j("reset","reset",e.iframe,e.id)},e,"reset")}function P(i){function t(e){function n(){Object.keys(I).forEach(function(e){function n(e){return"0px"===(I[t]&&I[t].iframe.style[e])}var t;I[t=e]&&null!==I[t].iframe.offsetParent&&(n("height")||n("width"))&&j("Visibility change","resize",I[t].iframe,t)})}var t;r||"0"!==i[e]||(r=!0,F(o,"Hidden iFrame detected, creating visibility listener"),(t=h())&&(e=document.querySelector("body"),new t(function(e){F("window","Mutation observed: "+e[0].target+" "+e[0].type),d(n,16)}).observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})))}function e(e){var n=e;i.id?(i.iframe.style[n]=i[n]+"px",F(i.id,"IFrame ("+o+") "+n+" set to "+i[n]+"px")):F("undefined","messageData id not set"),t(e)}var o=i.iframe.id;I[o]&&(I[o].sizeHeight&&e("height"),I[o].sizeWidth&&e("width"))}function H(e,n,t){t!==n.type&&o&&!window.jasmine?(F(n.id,"Requesting animation frame"),o(e)):e()}function j(e,n,t,i,o){var r,a=!1;i=i||t.id,I[i]&&(t&&"contentWindow"in t&&null!==t.contentWindow?(r=I[i]&&I[i].targetOrigin,F(i,"["+e+"] Sending msg to iframe["+i+"] ("+n+") targetOrigin: "+r),t.contentWindow.postMessage(y+n,r)):z(i,"["+e+"] IFrame("+i+") not found"),o&&I[i]&&I[i].warningTimeout&&(I[i].msgTimeout=setTimeout(function(){!I[i]||I[i].loaded||a||(a=!0,z(i,"IFrame has not responded within "+I[i].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},I[i].warningTimeout)))}function A(e){return e+":"+I[e].bodyMarginV1+":"+I[e].sizeWidth+":"+I[e].log+":"+I[e].interval+":"+I[e].enablePublicMethods+":"+I[e].autoResize+":"+I[e].bodyMargin+":"+I[e].heightCalculationMethod+":"+I[e].bodyBackground+":"+I[e].bodyPadding+":"+I[e].tolerance+":"+I[e].inPageLinks+":"+I[e].resizeFrom+":"+I[e].widthCalculationMethod+":"+I[e].mouseEvents}function s(t,e){var n,i,o,r,a,s=(""===(i=t.id)&&(t.id=(n=e&&e.id||g.id+u++,null!==document.getElementById(n)&&(n+=u++),i=n),f=(e||{}).log,F(i,"Added missing iframe ID: "+i+" ("+t.src+")")),i);function d(e){1/0!==I[s][e]&&0!==I[s][e]&&(t.style[e]=I[s][e]+"px",F(s,"Set "+e+" = "+I[s][e]+"px"))}function c(e){if(I[s]["min"+e]>I[s]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}s in I&&"iFrameResizer"in t?z(s,"Ignored iFrame, already setup."):(r=e||{},I[s]={firstRun:!0,iframe:t,remoteHost:t.src&&t.src.split("/").slice(0,3).join("/")},function(){if("object"!=typeof r)throw new TypeError("Options is not an object")}(),Object.keys(r).forEach(function(e){var n=e.split("Callback");2===n.length&&(this[n="on"+n[0].charAt(0).toUpperCase()+n[0].slice(1)]=this[e],delete this[e],z(s,"Deprecated: '"+e+"' has been renamed '"+n+"'. The old method will be removed in the next major version."))},r),function(e){for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(I[s][n]=(Object.prototype.hasOwnProperty.call(e,n)?e:g)[n])}(r),I[s]&&(I[s].targetOrigin=!0!==I[s].checkOrigin||""===(a=I[s].remoteHost)||null!==a.match(/^(about:blank|javascript:|file:\/\/)/)?"*":a),function(){switch(F(s,"IFrame scrolling "+(I[s]&&I[s].scrolling?"enabled":"disabled")+" for "+s),t.style.overflow=!1===(I[s]&&I[s].scrolling)?"hidden":"auto",I[s]&&I[s].scrolling){case"omit":break;case!0:t.scrolling="yes";break;case!1:t.scrolling="no";break;default:t.scrolling=I[s]?I[s].scrolling:"no"}}(),c("Height"),c("Width"),d("maxHeight"),d("minHeight"),d("maxWidth"),d("minWidth"),"number"!=typeof(I[s]&&I[s].bodyMargin)&&"0"!==(I[s]&&I[s].bodyMargin)||(I[s].bodyMarginV1=I[s].bodyMargin,I[s].bodyMargin=I[s].bodyMargin+"px"),o=A(s),!(a=h())||t.parentNode&&new a(function(e){e.forEach(function(e){Array.prototype.slice.call(e.removedNodes).forEach(function(e){e===t&&C(t)})})}).observe(t.parentNode,{childList:!0}),x(t,"load",function(){var e,n;j("iFrame.onload",o,t,l,!0),e=I[s]&&I[s].firstRun,n=I[s]&&I[s].heightCalculationMethod in m,!e&&n&&W({iframe:t,height:0,width:0,type:"init"})}),j("init",o,t,l,!0),I[s]&&(I[s].iframe.iFrameResizer={close:C.bind(null,I[s].iframe),removeListeners:p.bind(null,I[s].iframe),resize:j.bind(null,"Window resize","resize",I[s].iframe),moveToAnchor:function(e){j("Move to anchor","moveToAnchor:"+e,I[s].iframe,s)},sendMessage:function(e){j("Send Message","message:"+(e=JSON.stringify(e)),I[s].iframe,s)}}))}function d(e,n){null===t&&(t=setTimeout(function(){t=null,e()},n))}function c(){"hidden"!==document.visibilityState&&(F("document","Trigger event: Visiblity change"),d(function(){w("Tab Visable","resize")},16))}function w(n,t){Object.keys(I).forEach(function(e){I[e]&&"parent"===I[e].resizeFrom&&I[e].autoResize&&!I[e].firstRun&&j(n,t,I[e].iframe,e)})}function L(){function t(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),s(n,e),i.push(n))}var i;return function(){for(var e=["moz","webkit","o","ms"],n=0;n<e.length&&!o;n+=1)o=window[e[n]+"RequestAnimationFrame"];o?o=o.bind(window):F("setup","RequestAnimationFrame not supported")}(),x(window,"message",n),x(window,"resize",function(){F("window","Trigger event: resize"),d(function(){w("Window resize","resize")},16)}),x(document,"visibilitychange",c),x(document,"-webkit-visibilitychange",c),function(e,n){switch(i=[],e&&e.enablePublicMethods&&z("enablePublicMethods option has been removed, public methods are now always available in the iFrame"),typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(l,e));break;case"object":t(e,n);break;default:throw new TypeError("Unexpected data type ("+typeof n+")")}return i}}"undefined"!=typeof window&&(u=0,r=f=!1,b="message".length,v=(y="[iFrameSizer]").length,k=null,o=window.requestAnimationFrame,g={autoResize:!(t=null),bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!(I={}),enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!(m={max:1,scroll:1,bodyScroll:1,documentElementScroll:1}),maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,mouseEvents:!0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return!0},onClosed:function(){},onInit:function(){},onMessage:function(){z("onMessage function not defined")},onMouseEnter:function(){},onMouseLeave:function(){},onResized:function(){},onScroll:function(){return!0}},M={},window.jQuery&&((e=window.jQuery).fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(t){return this.filter("iframe").each(function(e,n){s(n,t)}).end()}):T("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],L):"object"==typeof module&&"object"==typeof module.exports&&(module.exports=L()),window.iFrameResize=window.iFrameResize||L())}();var PNWIDGETS=function(){var s=this;return s.renders={iframe:function(e,n,t,i){var o="pocketnet.app";return'<iframe width="100%" src="https://'+(o=window.testpocketnet?"test.pocketnet.app":o)+"/openapi.html?action="+n+"&id="+t+"&embeddingSettigns="+i+'" id="pocketnet_iframe_'+e+'" scrolling="no" style="border: none;" frameborder="0" marginheight="0" marginwidth="0" loading="lazy" allowfullscreen allowautoplay></iframe>'}},s.make=function(e,n,t,i,o){var r=document.getElementById("pocketnet_"+e);if(window.POCKETNETINSTANCE&&o){var a=window.POCKETNETINSTANCE,o={};try{o=JSON.parse(hexDecode(i||"7B7D"))}catch(e){}o.openapi=!0,$(r).addClass("openapipnet"),a.platform.papi[n](t,$(r),null,o)}else r.innerHTML=s.renders.iframe(e,n,t,i),iFrameResize({},"#pocketnet_iframe_"+e)},s.url=function(e){var n=new URL(e),t=n.searchParams.get("s")||n.searchParams.get("v");return{action:e=n.searchParams.get("commentid")?"commment":t?"post":"channel",id:"channel"==e?n.pathname.replace("/",""):t,p:"7B22626C61636B223A66616C73652C22636F6D6D656E7473223A226C617374222C2266756C6C73637265656E766964656F223A66616C73657D"}},s.makefromurl=function(e,n){var t=Math.floor(1e5*Math.random()),i='<div  id="pocketnet_'+t+'">';e.innerHTML=i+="</div>",n=s.url(n),s.make(t,n.action,n.id,n.p)},s};window.PNWIDGETS=PNWIDGETS;
 /*_____*/ 
var terms=function(){function n(e){var t;return{primary:e=deep(e,"history"),getdata:function(e){e({})},destroy:function(){t={}},init:function(e){(t={}).c=e.el.find("#"+a.map.id),a.shell({name:a.app.localization.key,el:t.c,data:{}},function(e){}),e.clbk(null,e)},wnd:{class:"withoutButtons allscreen black a100"}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=terms:(app.modules.terms={},app.modules.terms.module=terms);var about=function(){function n(e){function t(){c.whitepaper()}function n(){c.join()}function a(){var e=$(this).attr("answer");e&&l.send(e,function(){p.survey()})}var o,i,s,e=deep(e,"history"),r=null,l=null,c={videoWidth:function(e){var t=e.width(),n=t/(560/315);e.find("iframe").width(t),e.find("iframe").height(n)},time:function(){today=new Date,today=Math.floor((i-today)/1e3),tsec=today%60,today=Math.floor(today/60),tsec<0?tsec="00":tsec<10&&(tsec="0"+tsec),tmin=today%60,today=Math.floor(today/60),tmin<0?tmin="00":tmin<10&&(tmin="0"+tmin),thour=today%24,today=Math.floor(today/24),thour<0&&(thour="00"),today<0&&(today="00"),o.days.html(today),o.seconds.html(tsec),o.minutes.html(tmin),o.hours.html(thour)},fixed:function(){var e=$(window).scrollTop();o.main.offset().top+o.main.height()<e?o.fixed.addClass("active"):o.fixed.removeClass("active")},explore:function(){var e=o.c.find(".faq");_scrollToTop(e)},validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,t,n,a){a=a||"4",(t={Email:e,Name:t}).Action||(t.Action="ADDTOMAILLIST"),t.TemplateID||(t.TemplateID=a),$.ajax({type:"POST",url:u.app.options.server,data:t,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){u.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){u.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".email"),e=e.el.find(".name"),t=t.val(),e=e.val();if(c.validateEmail(t)&&e)return c.saveEmail(t,e),c.joinSuccess(t,e),!0},clbk:function(e){function t(){var e=a.val(),t=n.val();return c.validateEmail(e)&&t?(o.removeClass("disabled"),!0):(o.addClass("disabled"),!1)}var n=e.find(".name"),a=e.find(".email"),o=e.find(".btn1");o.addClass("disabled"),o.on("click",function(){}),n.focus(),n.on("change",t),n.on("keyup",t),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})},{action:e})},whitepaperSuccess:function(){u.fastTemplate("whitepaperSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})})},whitepaper:function(){u.fastTemplate("whitepaper",function(e){dialog({html:e,wrap:!0,success:function(e){if(e=e.el.find("input").val(),c.validateEmail(e))return c.saveEmail(e,"",null,"5"),c.whitepaperSuccess(),!0},clbk:function(e){function t(){var e=$(this).val();return c.validateEmail(e)?(n.removeClass("disabled"),!0):(n.addClass("disabled"),!1)}var n=e.find(".btn1");n.addClass("disabled"),n.on("click",function(){}),(e=e.find("input")).focus(),e.on("change",t),e.on("keyup",t)},class:"one joinbeta"})})}},d=[{name:"Twitter",icon:'<i class="fab fa-twitter"></i>',href:"https://twitter.com/Pocket_Net"},{name:"Telegram",icon:'<i class="fab fa-telegram"></i>',href:"https://t.me/PocketRep"},{name:"Facebook",icon:'<i class="fab fa-facebook"></i>',href:"https://www.facebook.com/PocketNet"},{name:"Minds",image:"https://cdn-assets.minds.com/front/dist/assets/logos/bulb.svg",href:"https://www.minds.com/PocketNet"},{name:"Linkedin",icon:'<i class="fab fa-linkedin"></i>',href:"https://www.linkedin.com/company/cryptolo-io"},{name:"Mastodon",icon:'<i class="fab fa-mastodon"></i>',href:"https://mastodon.social/@PocketRep"},{name:"Gab",image:"https://gab.com/assets/img/logo-dec.png",href:"https://gab.com/PocketNet"},{name:"Sola",image:"https://web.solacore.net/img/logo_medium-3_mNF.png",href:"https://sola.ai/cryptolo_io"},{name:"Medium",icon:'<i class="fab fa-medium"></i>',href:"https://medium.com/@cryptolo.io"}],p={survey:function(t){u.shell({name:"survey",el:o.survey,data:{survey:l},animation:"fadeIn"},function(e){e.el.find(".sendanswer").on("click",a),e.el.find(".resultpercent").each(function(){var e=$(this);e.animate({width:e.attr("w")+"%"},130)}),t&&t()})},tes:function(){var e=o.c.find(".tes");lazyEach({array:e,sync:!0,action:function(e){var t=$(e.item),n=t.attr("time")||600;t.addClass("show"),setTimeout(function(){e.success()},n)}})},lenta:function(){u.nav.api.load({open:!0,id:"lenta",el:o.lenta,animation:!1,mid:"about",essenseData:{author:"PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd",byauthor:!0,authAction:function(e){c.join(e)},notscrollloading:!0},clbk:function(e,t){r=t}})}};return{primary:e,getdata:function(e){r=null,l=new sQuestion({id:"pocketnetlanding",ajax:u.app.ajax,question:"Are you fed up with traditional social media like Facebook, Twitter and others?",answers:[{t:"Yes, very",v:1},{t:"Yes, somewhat",v:2},{t:"Facebook and Twitter are just great",v:3}]}),e({socials:d,survey:l})},destroy:function(){s&&clearInterval(s),r&&(r.destroy(),r=null),window.removeEventListener("scroll",c.fixed),o={}},init:function(e){(o={}).c=e.el.find("#"+u.map.id),o.lenta=e.el.find(".lenta"),o.main=o.c.find(".main"),o.fixed=o.c.find(".fixedButton"),o.join=o.c.find(".ejoin"),o.whitepaper=o.c.find(".whitepaper"),o.days=e.el.find(".days"),o.seconds=e.el.find(".seconds"),o.minutes=e.el.find(".minutes"),o.hours=e.el.find(".hours"),o.survey=e.el.find(".survey"),i=new Date(2019,0,23,23,59),s=setInterval(c.time,1e3),o.join.on("click",n),o.whitepaper.on("click",t),o.c.find(".exploremore").on("click",c.explore),window.addEventListener("scroll",c.fixed),p.tes(),p.lenta(),l.init(function(){p.survey()}),c.videoWidth(o.c.find(".videoContent")),e.clbk(null,e)}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=about:(app.modules.about={},app.modules.about.module=about);var applications=function(){function n(e){function i(t,e,n){var a;t.hidden||(a=n?t.id:".currentos",l.shell({turi:"registration",name:"os",el:s.c.find(a),data:{os:t,last:!1}},function(e){e.el.find(".downloadOs").on("click",function(){var n;(n=t)&&n.github&&$.get(n.github.url,{},function(e){var t=deep(e,"assets")||[];(e=_.find(t,function(e){return e.name==n.github.name}))&&((t=document.createElement("a")).setAttribute("href",e.browser_download_url),t.setAttribute("download","download"),t.click(),e=e.browser_download_url,s.c.find(a+" .os").addClass("rundownloading"),s.c.find(a+" .skipositem").html('<div><a href="'+e+'"><b>'+l.app.localization.e("e13012")+"</b></a></div>"))})})}))}var s,r,e=deep(e,"history");return{primary:e,getdata:function(e,t){(r=deep(t,"settings.essenseData")||{}).key||(r.key="ui"),e({})},destroy:function(){s={}},init:function(e){var t,n,a,o;(s={}).c=e.el.find("#"+l.map.id),t=os(),n=l.app.platform.applications[r.key],a=Object.keys(n),o=n[t],a=a.filter(function(e){return e!==t}),t&&o&&"undefined"==typeof _Electron&&!window.cordova&&!isInStandaloneMode()&&(i(o),a.forEach(function(e){i(n[e],0,!0)})),e.clbk(null,e)}}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,n,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=applications:(app.modules.applications={},app.modules.applications.module=applications);var registration=function(){function n(t){var s,n,a,e=deep(t,"history"),o={last:!1,end:!1},r=null,i={type:"STRING",name:"keyInput",id:"keyInput",placeholder:g.app.localization.e("confirmkey"),autoSearch:function(e,t,n){var a;0==o.mnemonicKey.indexOf(e)&&" "!=e[e.length-1]&&((e=e.split(" "))[a=e.length-1],n(_.filter(o.mnemonicContent,function(e,t){if(t<=a)return!0}).join(" ")))}};function l(){m.registration()}function c(){m.generate()}function d(){$(this).hasClass("disabled")||m.continue()}function p(){m.repeat()}function u(){m.download(function(e){s.c.find(".osStep").addClass("rundownloading"),s.c.find(".skipositem").html('<div class="downloadstart">'+g.app.localization.e("e13011")+'</div><div><a href="'+e+'"><b>'+g.app.localization.e("e13012")+"</b></a></div>")})}isMobile()&&delete i.autoSearch;var f=new Parameter(i),m={download:function(n){o.os&&o.os.github&&$.get(o.os.github.url,{},function(e){var t=deep(e,"assets")||[];(e=_.find(t,function(e){return e.name==o.os.github.name}))&&((t=document.createElement("a")).setAttribute("href",e.browser_download_url),t.setAttribute("download","download"),t.click(),n&&n(e.browser_download_url))})},validation:function(){var e=trim(f.value);return e!=o.mnemonicKey&&e!=o.mk?(s.c.find(".note").html(g.app.localization.e("keysnotmatch")),s.c.addClass("error"),!1):(s.c.removeClass("error"),s.c.find(".note").html(""),!0)},registration:function(){m.validation()&&(localStorage.stay="1",g.app.user.stay=1,g.user.signin(o.mnemonicKey,function(e){return e?(o.end=!0,void h.confirm(function(){h.success(function(){setTimeout(function(){var e;"_this"==deep(n,"successHref")?g.app.user.validate()?((e=deep(a,"container.close"))&&e(),n.signInClbk&&n.signInClbk()):g.nav.api.loadSameThis("filluser",t):(console.log("essenseData.nav",n.nav),n.nav||(n.nav={}),n.nav.history=!0,n.nav.reload=!1,g.app.reload({href:n.successHref||"filluser",nav:n.nav}))},2e3)})})):(s.c.find.note.html(g.app.localization.e("id98")),void s.c.addClass("error"))}))},generate:function(){s.c.removeClass("begin");var t=bitcoin.bip39.generateMnemonic();m.testqrcodeandkey(t,function(e){e?(o.mnemonicKey=t,o.mnemonicMask=_.shuffle(indexArray(o.mnemonicKey.length)),o.mnemonicContent=o.mnemonicKey.split(" "),e=g.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnet(e.publicKey).address,o.mk=e.privateKey.toString("hex"),h.key()):m.generate()})},repeat:function(){o.last=!1,h.confirm(function(){h.tips(function(){setTimeout(function(){s.c.removeClass("last"),setTimeout(function(){m.generate()},300)},300)})})},continue:function(){var e=s.c.find(".mnemonicKey");s.c.find(".keyStep").removeClass("showedPanel"),h.mnemonicEffect(e,!0,function(){o.last=!0,h.key(function(){setTimeout(function(){h.tips(),s.c.addClass("last"),setTimeout(function(){h.confirm()},300)},300)})})},removeDisabled:function(e){e.find(".continue").removeClass("disabled"),e.find(".preloader").remove(),e.find(".save").addClass("black"),e.find(".copy").addClass("black")},testqrcodeandkey:function(e,t){e=g.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=h.qrcode(s.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg"),grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?t&&t(!1):t&&t(!0)},qrscanner.q.decode(e)})}},h={os:function(t){var e=os();e&&g.app.platform.applications[e]&&"undefined"==typeof _Electron&&!window.cordova?(o.os=g.app.platform.applications[e],h.step("os",function(e){e.el.find(".downloadOs").on("click",u),e.el.find(".skip").on("click",function(){t&&t()})})):t()},step:function(e,t){g.shell({name:e,el:s.c.find("."+e+"Step"),data:o,animation:{id:"slide"}},function(e){t&&t(e)})},success:function(t){h.step("success",function(e){t&&t()})},tips:function(t){h.step("tips",function(e){e.el.find(".generate").on("click",c),t&&t()})},confirm:function(t){f.value="",o.keyInput=f,h.step("confirm",function(e){e.el.find(".repeat").on("click",p),e.el.find(".registrationButton").on("click",l),t?t():(ParametersLive([f],e.el),_scrollTo(e.el,r),initUpload({el:e.el.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:s.c.find(".confirm"),action:function(e,t){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?s.c.find(".note").html(g.app.localization.e("filedamaged")):(f.value=trim(e),f.el.val(f.value),m.registration())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(f.value=trim(e[1]),f.el.val(f.value),m.registration()):s.c.find(".note").html(g.app.localization.e("filedamaged")))}}),setTimeout(function(){e.el.find('input[type="text"]').on("focus",function(){e.el.find(".inputTable").addClass("typeactive")}),e.el.find('input[type="text"]').on("blur",function(){e.el.find(".inputTable").removeClass("typeactive")}),isMobile()||e.el.find(".autosearchInputCnt input").focus()},600))})},qrcode:function(e,t){return new QRCode(e[0],{text:t,width:256,height:256})},key:function(i){h.step("key",function(t){var e=t.el.find(".mnemonicKey"),n=s.c.find(".keyStep");n.removeClass("showedPanel");var a,o=t.el.find(".hiddenMnemonicKey").html();o&&(o=g.app.user.keysFromMnemo(trim(o)).privateKey.toString("hex"),a=h.qrcode(t.el.find(".qrcode"),o)),h.mnemonicEffect(e,!1,function(){n.addClass("showedPanel")}),t.el.find(".continue").on("click",d),setTimeout(function(){m.removeDisabled(t.el)},2e3),g.app.platform.clbks._focus.registration=function(){m.removeDisabled(t.el)},t.el.find(".copy").on("click",function(){copyText(t.el.find(".hiddenMnemonicKey")),sitemessage(g.app.localization.e("successfullycopied")),m.removeDisabled(t.el)}),t.el.find(".save").on("click",function(){var e=t.el.find(".qrcode img").attr("src");saveAs({file:e,format:"png",name:"pocketnetkey"})}),window.cordova&&t.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:"Save key on device",class:"itemmain",action:function(e){var t=b64toBlob(a._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(t,"pkey"+g.app.platform.currentTime()+".png",function(){e()})}}]})}),i?i():_scrollTo(t.el,r)})},mnemonicEffect:function(n,e,t){var a=indexArray(101);e&&a.reverse();var o=n.height();n.css("min-height",o+"px"),lazyEach({array:a,sync:!0,action:function(e){var t=e.item;n.html(h.mnemonic(t)),o=n.height(),n.css("min-height",o+"px"),setTimeout(e.success,rand(1,5))},all:{success:function(){n.css("min-height","0px"),t&&t()}}})},mnemonic:function(e){var n="",a=(o.mnemonicMask.length*e/100).toFixed(0);return _.each(o.mnemonicKey,function(e,t){t=_.indexOf(o.mnemonicMask,t),n+=t<a||" "==e?e:g.app.platform.values.alph[rand(0,g.app.platform.values.alph.length-1)]}),n}};return{primary:e,getdata:function(e,t){g.nav.api.load({open:!0,href:"filluserfast"})},destroy:function(){delete g.app.platform.clbks._focus.registration,s={}},init:function(e){var t;(s={}).c=e.el.find("#"+g.map.id),s.registrationButton=s.c.find(".registrationButton"),s.toAuthorization=s.c.find(".toAuthorization"),s.login=s.c.find(".loginValue"),s.ler=s.c.find(".ler"),s.key=s.c.find(".key"),n=e.essenseData||{},a=e,(r=s.c.closest(".wndcontent")).length||(r=null),h.os(function(){h.tips()}),t=e,s.toAuthorization.on("click",function(){g.nav.api.loadSameThis("authorization",t)}),e.clbk(null,e)},wnd:{class:"withoutButtons allscreen"}}}var g=new nModule,a={};return g.run=function(e){var t=g.addEssense(a,n,e);g.init(t,e)},g.stop=function(){_.each(a,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=registration:(app.modules.registration={},app.modules.registration.module=registration);var anothersite=function(){function n(e){return{primary:e=deep(e,"history"),getdata:function(e,t){e({link:t.settings.essenseData.link})},destroy:function(){},init:function(e){e.el.find("#"+a.map.id),e.clbk(null,e)},wnd:{header:"Another site",class:"transparent small anothersite"}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=anothersite:(app.modules.anothersite={},app.modules.anothersite.module=anothersite);var pkview=function(){function n(e){var t,e=deep(e,"history"),o={},i={qrcode:function(e,t){return new QRCode(e[0],{text:t,width:256,height:256})},mnemonic:function(e){var n,a="";return o.mnemonicMask?(n=(o.mnemonicMask.length*e/100).toFixed(0),_.each(o.mnemonicKey,function(e,t){t=_.indexOf(o.mnemonicMask,t),a+=t<n||" "==e?e:s.app.platform.values.alph[rand(0,s.app.platform.values.alph.length-1)]})):a=o.mnemonicKey,a},mnemonicEffect:function(n,e,t){var a=indexArray(101);e&&a.reverse(),lazyEach({array:a,sync:!0,action:function(e){var t=e.item;n.html(i.mnemonic(t)),h=n.height(),setTimeout(e.success,rand(1,5))},all:{success:function(){t&&t()}}})},key:function(a){s.shell({name:"key",el:t.c.find(".keywrapper"),data:o,animation:{id:"slide"}},function(t){var e=t.el.find(".mnemonicKey");i.mnemonicEffect(e,!1,function(){});var n=i.qrcode(t.el.find(".qrcode"),o.mk);t.el.find(".copy").on("click",function(){copyText(t.el.find(".hiddenMnemonicKey")),sitemessage(s.app.localization.e("successfullycopied"))}),t.el.find(".save").on("click",function(){var e=t.el.find(".qrcode img").attr("src");saveAs({file:e,format:"png",name:"pocketnetkey"})}),window.cordova&&t.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:s.app.localization.e("e13145"),class:"itemmain",action:function(e){var t=b64toBlob(n._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(t,"pkey"+s.app.platform.currentTime()+".png",function(){e()})}}]})}),a&&a(t)})},dontshowagain:function(){t&&t.c&&t.c.find(".dontshowagain").addClass("active")}};return{primary:e,getdata:function(e,t){e({})},destroy:function(){t={}},init:function(e){(t={}).c=e.el.find("#"+s.map.id),t.c.find(".dontshowagain").on("click",function(){s.closeContainer(),s.app.platform.sdk.registrations.donotshowprivate(),isMobile()&&s.app.nav.api.load({open:!0,href:"index",history:!0})}),function(){o={};var e=localStorage.mnemonic;e&&s.app.platform.cryptography.api.aeswc.decryption(e,s.app.options.fingerPrint,{},function(e){var t;e&&(bitcoin.bip39.validateMnemonic(e)?(t=s.app.user.keysFromMnemo(trim(e)),o.mk=t.privateKey.toString("hex")):o.mk=e,o.mnemonicKey=e,o.mnemonicMask=_.shuffle(indexArray(o.mnemonicKey.length)),o.mnemonicContent=o.mnemonicKey.split(" "),i.key(),setTimeout(function(){i.dontshowagain()},2e3))})}(),e.clbk(null,e)},wnd:{class:"allscreen black withoutButtons pkviewwnd"}}}var s=new nModule,a={};return s.run=function(e){var t=s.addEssense(a,n,e);s.init(t,e)},s.stop=function(){_.each(a,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=pkview:(app.modules.pkview={},app.modules.pkview.module=pkview);var token=function(){function n(e){function a(){var e=parameters().token||null;return{type:parameters().type||null,token:e}}return{primary:e=deep(e,"history"),getdata:function(t){var e,n=a();"activate"!=n.type?o.app.platform.ws.addBlock():(delete(e=o.app.platform.ws.messages.CUSTOMER.ACTIVE).clbks.successDialog,e.clbks.success=function(){var e=deep(o,"app.modules.menu.module");e&&e.restart()}),o.app.platform.sdk.tokens.check(n.token,function(e){n.result=e,t(n)})},destroy:function(){o.app.platform.ws.removeBlock()},init:function(e){a(),e.el.find("#"+o.map.id),e.clbk(null,e)}}}var o=new nModule,a={};return o.run=function(e){var t=o.addEssense(a,n,e);o.init(t,e)},o.stop=function(){_.each(a,function(e){e.destroy()})},o}();"undefined"!=typeof module?module.exports=token:(app.modules.token={},app.modules.token.module=token);var page404=function(){function n(e){return{primary:e=deep(e,"history"),getdata:function(e){e({})},destroy:function(){},init:function(e){e.el.find("#"+a.map.id),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=page404:(app.modules.page404={},app.modules.page404.module=page404);var test=function(){function n(e){function t(){f.signout()}function n(){f.save()}function a(){f.cancel()}function o(){var e=y.app.platform.sdk.address.pnet();topPreloader(30),y.app.platform.sdk.node.account.import(e.address,function(){topPreloader(100),sitemessage("Address "+e.address+" was successfully imported")})}var i,s,r,l,c=deep(e,"history"),d=!1,p={language:y.app.localization.key||"en"},u=!1,f={saveemail:function(e,n){var t,a={Email:e,Lang:y.app.localization.key||"en"};a.Action||(a.Action="ADDTOMAILLIST"),a.TemplateID="1005",a.ref="",t=function(e){var t="";e&&(a.ref+=e,t+='<p><a href="https://'+y.app.options.url+"/author?address="+y.app.ref+'">Referrer: '+e+"</a></p>"),(e=deep(document,"referrer"))&&(t+='<p><a href="'+e+'">From: '+e+"</a></p>"),a.body=encodeURIComponent(t),$.ajax({type:"POST",url:"https://"+y.app.options.url+"/Shop/AJAXMain.aspx",data:a,dataType:"json",success:function(){n&&n()}})},y.app.ref?y.sdk.users.get(y.app.ref,function(){var e=deep(y,"sdk.users.storage."+y.app.ref+".name");t(e)}):t(null)},valid:function(e,t){if(!f.equal(e,t)&&trim(e.name)&&e.image)return!0},equal:function(e,t){function n(e){return"name:"+(trim(e.name)||"")+"image:"+(e.image||"")+"about:"+(trim(e.about)||"")+"site:"+(trim(e.site)||"")+"language:"+(e.language||"")+"addresses:"+JSON.stringify(e.addresses||[])}return n(e)==n(t)},cancel:function(){f.userOptions(),f.upanel(),v.icon(),v.options()},ref:function(e){r&&d&&(localStorage[y.app.platform.sdk.address.pnet().address+"subscribeRef"]=r.address)},save:function(e){var o;u||(u=!0,o=function(){i.upanel.removeClass("loading"),i.c.find(".userPanel").removeClass("loading"),topPreloader(100),u=!1,c?y.nav.api.go({href:"index",history:!0,open:!0}):s.success?s.success():e&&e()},y.sdk.users.checkFreeRef(y.app.platform.sdk.address.pnet()?y.app.platform.sdk.address.pnet().address:"",function(n,e){if(i.c.find(".userPanel").hasClass("loading"))u=!1;else{if(f.equal(p,y.app.platform.sdk.user.storage.me))return sitemessage(y.app.localization.e("uchanges")),void(u=!1);if(!f.valid(p,y.app.platform.sdk.user.storage.me))return sitemessage(y.app.localization.e("uchangesvalid")),trim(p.name)?p.image||(t=i.c.find(".fileUploader"),_scrollTo(t)):((t=i.c.find('[parameter="name"] input')).focus(),_scrollTo(t)),void(u=!1);var t,a=new UserInfo;if(a.name.set(trim(p.name)),a.language.set(p.language),a.about.set(trim(p.about)),a.site.set(trim(p.site)),a.image.set(p.image),a.addresses.set(p.addresses),a.ref.set(deep(r,"address")||""),e=a.validation())return i.c.find(".errorname").fadeIn(),"namelength"==e&&i.c.find(".errorname span").html("The name length can be more than 20 symbols"),"pocketnet"==e&&i.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved"),(t=i.c.find('[parameter="name"] input')).focus(),_scrollTo(t),u=!1;topPreloader(30),i.c.find(".userPanel").addClass("loading"),i.upanel.addClass("loading"),y.app.platform.sdk.users.nameExist(a.name.v,function(e){!e||y.app.platform.sdk.address.pnet()&&e==y.app.platform.sdk.address.pnet().address?(topPreloader(50),s.presave(function(){a.keys.set(_.map(y.app.user.cryptoKeys(),function(e){return e.public})),i.c.find(".errorname").fadeOut(),topPreloader(70),a.uploadImage(y.app,function(e){return e?(topPreloader(100),i.upanel.removeClass("loading"),i.c.find(".userPanel").removeClass("loading"),sitemessage("An error occurred while loading images"),void(u=!1)):s.makeuser?(topPreloader(100),i.upanel.removeClass("loading"),i.c.find(".userPanel").removeClass("loading"),s.makeuser(a),void(u=!1)):((e=p.email)&&f.saveemail(e),void y.sdk.node.transactions.create.commonFromUnspent(a,function(e,t){console.log("error",t,e),e?(successCheck(),delete y.sdk.usersl.storage[y.app.platform.sdk.address.pnet().address],delete y.sdk.users.storage[y.app.platform.sdk.address.pnet().address],y.app.platform.sdk.user.storage.me=e,p=_.clone(y.app.platform.sdk.user.storage.me),f.upanel(),f.ref(n),y.closeContainer(),y.app.platform.sdk.users.getone(y.app.platform.sdk.address.pnet().address,function(){y.app.reloadModules(function(){s.presuccess?s.presuccess(o):o()})})):(y.app.platform.errorHandler(t,!0),i.upanel.removeClass("loading"),i.c.find(".userPanel").removeClass("loading"),topPreloader(100))},{relay:!!s.relay&&s.relay()}))})})):(u=!1,i.upanel.removeClass("loading"),i.c.find(".userPanel").removeClass("loading"),topPreloader(100),i.c.find(".errorname").fadeIn(),i.c.find(".errorname span").html("This username is taken in Pocketnet"))})}}))},upload:function(e,a){topPreloader(20);var t=[{original:e.base64,index:0}];y.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:0,images:t,apply:!0,crop:{aspectRatio:1,style:"round apply",autoCropArea:.9},success:function(e,n){resize(t[0].original,100,100,function(e){var t=e.split(",");n(),t[1]?(p.image=e,v.icon(),f.upanel(),a&&a()):topPreloader(100)})}}})},upanel:function(){i.upanel&&(0<_.toArray(y.app.platform.sdk.node.transactions.temp.userInfo||{}).length||y.app.platform.sdk.address.pnet()&&0<deep(y.sdk.relayTransactions.storage,y.app.platform.sdk.address.pnet().address+".userInfo.length")&&!s.failedrelay?(i.upanel.addClass("wait"),i.c.find(".caption").remove()):(i.upanel.removeClass("wait"),f.equal(p,y.app.platform.sdk.user.storage.me)||!f.valid(p,y.app.platform.sdk.user.storage.me)?i.upanel.removeClass("changes"):i.upanel.addClass("changes")))},clear:function(){f.userOptions(),v.caption()},userOptions:function(){p=_.clone(y.app.platform.sdk.user.storage.me),_.each(m,function(t,n){var e=y.app.platform.sdk.user.storage.me[t.id];"addresses"==n&&(e=_.clone(y.app.platform.sdk.user.storage.me[t.id])),t.value=e||t.defaultValue||"",p[t.id]=t.value,t._onChange=function(e){if(p[t.id]="addresses"==n?_.clone(e):trim(e),f.upanel(),"language"!=n||(e=y.app.localization.available[e])&&e.key!=y.app.localization.key&&y.app.localization.lightSet(e.key),"name"==n){if(-1<p[t.id].toLowerCase().replace(/[^a-z]/g,"").indexOf("pocketnet"))return i.c.find(".errorname").fadeIn(),void i.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved");20<p[t.id].length?(i.c.find(".errorname").fadeIn(),i.c.find(".errorname span").html("The name length can be more than 20 symbols")):y.app.platform.sdk.users.nameExist(p[t.id],function(e){!e||y.app.platform.sdk.address.pnet()&&e==y.app.platform.sdk.address.pnet().address?i.c.find(".errorname").fadeOut():(i.c.find(".errorname").fadeIn(),i.c.find(".errorname span").html("This username is taken in Pocketnet"))})}}})},signout:function(){y.app.user.signout(),y.app.reload({href:"authorization"})}},m={name:new Parameter({name:y.app.localization.e("unickname"),id:"name",type:"NICKNAME",require:!0}),email:new Parameter({name:"Email",id:"email",type:"EMAIL",onType:!0}),language:new Parameter({name:y.app.localization.e("ulanguage"),id:"language",type:"VALUES",defaultValue:y.app.localization.key||"en",possibleValues:["en","ru"],possibleValuesLabels:["English","Русский"]}),about:new Parameter({name:y.app.localization.e("uabout"),id:"about",type:"TEXT",onType:!0,placeholder:y.app.localization.e("e133512")}),site:new Parameter({name:y.app.localization.e("uwebsite"),id:"site",type:"STRINGANY",onType:!0,value:""}),addresses:new function(){var n=this;return n.id="addresses",n.name=y.app.localization.e("uaddresesd"),n.value=[],n.defaultValue=[],n.remove=function(e,t){removeEqual(n.value,{currency:e,address:t}),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.add=function(e){n.value.push(e),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.addDialog=function(){function o(e,t){return 0<t.length}b.fastTemplate("addaddress",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".currency").val();if(o(0,e=e.el.find(".address").val()))return n.add({currency:t,address:e}),!0},clbk:function(e){var t=e.find(".currency"),n=e.find(".address"),a=e.find(".btn1"),e=function(){return t.val(),o(0,n.val())?(a.removeClass("disabled"),!0):(a.addClass("disabled"),!1)};n.focus(),n.on("change",e),n.on("keyup",e),t.on("change",e),t.on("keyup",e),e()},class:"one addaddressDialog zindex"})},{})},n.removeEvent=function(){var e=$(this).closest(".addedAddress").attr("currency"),t=$(this).closest(".addedAddress").attr("address");n.remove(e,t)},n.addedAddresses=function(){var t="";_.each(n.value,function(e){e&&e.currency&&(t+='<div class="addedAddressWrapper">',t+='<div class="addedAddress table" currency="'+e.currency+'" address="'+e.address+'">',t+='<div class="currencyWrapper">',t+=e.currency.toUpperCase(),t+="</div>",t+='<div class="addressWrapper">',t+=e.address,t+="</div>",t+='<div class="panelWrapper">',t+='<div class="item remove">',t+='<i class="far fa-times-circle"></i>',t+="</div>",t+="</div>",t+="</div>",t+="</div>")}),n.el.find(".addedAddressesWrapper").html(t),n.el.find(".addedAddressesWrapper .remove").on("click",n.removeEvent)},n.init=function(e){n.defaultValue=[],n.el=e.find(".adressesInput"),n.addedAddresses(),n.el.find(".addaddress").on("click",n.addDialog)},n.input=function(){return'<div class="adressesInput"><div class="addaddressWrapper"><div class="addaddress"><i class="fas fa-plus"></i></div></div><div class="addedAddressesWrapper"></div></div>'},n}},h=null,g=null,v={options:function(t){y.shell({name:"options",el:i.options,data:{tempInfo:p,userOptions:m}},function(e){ParametersLive(_.toArray(m),e.el),m.addresses.init(e.el),t&&t()})},icon:function(t){y.shell({name:"icon",el:i.icon,data:{tempInfo:p,ed:s}},function(e){initUpload({el:e.el.find(".pgroup"),ext:["png","jpeg","jpg","webp","jfif"],dropZone:i.c,multiple:!1,action:function(e,t){f.upload(e,function(){l&&l.destroy(),_scrollTo(i.c.find(".nickname input").focus()),t&&t()})},onError:function(e,t,n){sitemessage(n)}}),s.wizard&&!p.image&&(l=y.app.platform.api.plissing({el:e.el.find(".iconWrapper"),text:"Upload Profile Image"})),t&&t()})},unspent:function(e,t){y.shell({name:"unspent",el:i.unspent,data:{unspent:e}},function(e){t&&t()})},caption:function(e,t){},address:function(){i.c.find(".adr").html(bitcoin.payments[y.app.platform.addressType]({pubkey:y.app.user.key.value}))}};return{primary:c,getdata:function(a,e){r=null,(s=e.settings.essenseData||{}).presave||(s.presave=function(e){e&&e()}),y.app.platform.sdk.user.get(function(){var e,t;_.isEmpty(y.app.platform.sdk.user.storage.me)&&(d=!0,(t=y.app.ref)&&t!=y.app.platform.sdk.address.pnet()&&(r=t)),e=_.map(y.app.platform.nodes,function(e,t){return t.toString()}),t=_.map(y.app.platform.nodes,function(e,t){return e.full}),(h=new Parameter({type:"VALUES",name:"setNode",id:"setNode",possibleValues:e,possibleValuesLabels:t,defaultValue:"1"})).value=y.app.platform.nodeid,h._onChange=function(e){y.app.platform.nodeid=e,y.app.platform.state.save()},(g=new Parameter({type:"VALUES",name:"setAddressType",id:"setAddressType",possibleValues:y.app.platform.addressTypes,possibleValuesLabels:["P2PKH","P2SH"],defaultValue:"p2sh"})).value=y.app.platform.addressType,g._onChange=function(e){y.app.platform.addressType=e,y.app.platform.state.save(),y.user.address.set(y.app.platform.sdk.address.pnet().address),y.app.reload()},f.userOptions();var n={};n.p2pkh=y.app.platform.sdk.address.pnet(),n.setNode=h,n.setAddressType=g,n.userOptions=m,n.tempInfo=p,n.firstTime=d,n.ref=r,n.caption=s.caption,r?y.sdk.users.get(r,function(){var e=r;(r=y.sdk.users.storage[e]||null)&&(r.address=e),n.ref=r,a(n)}):a(n)})},destroy:function(){return u=!(i={}),p={language:y.app.localization.key||"en"},null},init:function(e){(i={}).c=e.el.find("#"+y.map.id),i.transaction=e.el.find(".transactionInfo"),i.unspent=e.el.find(".unspentlist"),i.showhidetestpanel=e.el.find(".showhidetestpanel"),i.import=e.el.find(".import"),i.caption=i.c.find(".bgCaption"),i.icon=i.c.find(".pgroupIconWrapper"),i.usericon=i.c.find(".usericon"),i.options=i.c.find(".optionsParameters"),i.upanel=s.panel||i.c.find(".upanel"),i.signout=i.c.find(".signout"),i.import.on("click",o),i.showhidetestpanel.on("click",function(){$(this).closest(".testPanel").toggleClass("active")}),i.upanel.find(".cancel").on("click",a),i.upanel.find(".save").on("click",n),ParametersLive([h,g],i.c),i.signout.on("click",t),i.c.find(".refRemove").on("click",function(){r=null,delete localStorage.ref,i.c.find(".referalMaketWrapper").remove()}),f.upanel(),v.caption(),v.icon(),v.options(),y.sdk.node.transactions.get.unspent(function(e){v.unspent(e)}),y.app.platform.ws.messages.transaction.clbks.utemp=function(e){e.temp&&"userInfo"==e.temp.type&&f.upanel()},e.clbk(null,e)},wnd:{class:"withoutButtons allscreen testwindow"}}}var y=new nModule,b=y,a={};return y.run=function(e){var t=y.addEssense(a,n,e);y.init(t,e)},y.stop=function(){var t=null;if(_.each(a,function(e){(e=e.destroy())&&(t=e)}),t)return{action:t}},y}();"undefined"!=typeof module?module.exports=test:(app.modules.test={},app.modules.test.module=test);var usersettings=function(){function n(e){var t,a,e=deep(e,"history"),o=!1,i={options:function(){l.shell({name:"options",el:t.options,data:{composed:a.c,themes:l.app.platform.sdk.theme.all,current:l.app.platform.sdk.theme.current}},function(n){ParametersLive(a.o,n.el),n.el.find(".themewrapper").on("click",function(){var e,t=$(this);t.hasClass("active")||(e=t.attr("theme"),n.el.find(".themewrapper").removeClass("active"),t.addClass("active"),l.app.platform.sdk.theme.set(e))});var e=n.el.find(".parameterMaketWrapper[parameter=telegram] input");e.on("change",function(e){var t=l.sdk.usersettings.meta,e=e.target.value;t.tgfrom[e]&&t.tgfrom[e].possibleValues?(t.tgfrom.possibleValues=t.tgfrom[e].possibleValues,t.tgfrom.possibleValuesLabels=t.tgfrom[e].possibleValuesLabels,t.tgfrom.value=t.tgfrom[e].value):(t.tgfrom.possibleValues=[],t.tgfrom.possibleValuesLabels=[],t.tgfrom.value=""),t.tgto[e]&&t.tgto[e].possibleValues?(t.tgto.possibleValues=t.tgto[e].possibleValues,t.tgto.possibleValuesLabels=t.tgto[e].possibleValuesLabels,t.tgto.value=t.tgto[e].value):(t.tgto.possibleValues=[],t.tgto.possibleValuesLabels=[],t.tgto.value=""),a=l.app.platform.sdk.usersettings.compose(s),l.sdk.usersettings.save(),s()}),e=e.val(),l.app.platform.sdk.system.get.telegramGetMe(e,!0,s,r)})},cache:function(){var e=l.app.platform.sdk.node.transactions.temp,n=[];_.each(e,function(e,t){_.each(e,function(e){n.push(e)})}),l.shell({name:"cache",el:t.cache,data:{temp:n,checking:o}},function(e){e.el.find(".check").on("click",function(){$(this).hasClass("disabled")||(o=!0,i.cache(),l.app.platform.sdk.node.transactions.checkTemps(function(){setTimeout(function(){o=!1,i.cache()},100)}))}),e.el.find(".clear").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear temporary application information? You balance can has changed on several minutes.",btn1text:l.app.localization.e("dyes"),btn2text:l.app.localization.e("dno"),success:function(){l.app.platform.sdk.node.transactions.clearTempHard(),i.cache()}})})})}},s=function(){i.options(),i.cache(),l.app.platform.sdk.node.transactions.clbks.settings=i.cache},r=function(e){var t=(e,t)=>{const n=document.createElement("div");n.classList.add("iWrapper");const a=document.createElement("i"),o=document.querySelector("div[parameter='telegram']");o&&(o.setAttribute("style","display: flex"),n.classList="tokenResult "+t,a.classList.add("fa"),a.classList.add(e),n.appendChild(a),o.appendChild(n))};e?t("fa-check-circle","success"):t("fa-times","failed")};return{primary:e,getdata:function(e){a=l.app.platform.sdk.usersettings.compose(s),e({})},destroy:function(){t={},delete l.app.platform.sdk.node.transactions.clbks.settings,l.app.user.features.telegram&&(controller.abort(),controller=new AbortController,l.app.platform.sdk.system.get.telegramUpdates())},init:function(e){(t={}).c=e.el.find("#"+l.map.id),t.options=t.c.find(".options"),t.cache=t.c.find(".cache"),controller=l.app.platform.sdk.system.get.telegramUpdateAbort,controller.abort(),l.app.platform.sdk.system.get.telegramUpdateAbort=new AbortController,s(),e.clbk(null,e)}}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,n,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=usersettings:(app.modules.usersettings={},app.modules.usersettings.module=usersettings);var uploadpeertube=function(){function n(e){var n,a,o,e=deep(e,"history"),i={};return{primary:e,getdata:function(e,t){r=t.settings.essenseData,i=r.actions,e({})},destroy:function(){n={}},init:function(e){(n={}).c=e.el.find("#"+s.map.id),n.videoInput=n.c.find(".upload-video-file"),n.videoWallpaper=n.c.find(".upload-video-wallpaper"),n.videoError=n.c.find(".file-type-error"),n.wallpaperError=n.c.find(".wallpaper-type-error"),n.videoLabel=n.c.find(".upload-video-file-label"),n.wallpaperLabel=n.c.find(".upload-video-wallpaper-label"),n.uploadProgress=n.c.find(".upload-progress-container"),n.importUrl=n.c.find(".import-container"),n.uploadButton=n.c.find(".uploadButton"),n.cancelButton=n.c.find(".cancelButton"),n.header=n.c.find(".upload-header"),n.preloaderElement=n.c.find(".iconwr"),n.videoInput.change(async function(e){var t=e.target.files[0].name;return n.videoError.text(t.slice(0,20)+(20<t.length?"...":"")),n.videoError.removeClass("error-message"),e=n.videoInput.prop("files"),t=a.find(".upload-video-name").val(),a.find(".name-type-error").text(""),e[0]?e[0].type.includes("video")?(r.uploadInProgress=!0,n.header.removeClass("activeOnRolled"),n.uploadButton.prop("disabled",!0),n.uploadProgress.removeClass("hidden"),e={video:e[0]},t&&(e.name=t),t={progress:function(e){"100.00"===(e=(.9*e).toFixed(2))&&n.preloaderElement.hasClass("hidden")&&n.preloaderElement.removeClass("hidden"),n.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),n.uploadProgress.find(".upload-progress-percentage").text(e+"%")},cancel:function(e){r.cancelCloseFunction=()=>{"function"==typeof e&&e(),o.close()},n.cancelButton.on("click",()=>{n.uploadProgress.addClass("hidden"),n.cancelButton.addClass("hidden"),n.importUrl.removeClass("hidden"),r.uploadInProgress=!1,e()}),n.cancelButton.removeClass("hidden")}},n.importUrl.addClass("hidden"),s.app.peertubeHandler.api.videos.upload(e,t).then(e=>{n.uploadButton.prop("disabled",!1),n.header.addClass("activeOnRolled"),n.uploadProgress.addClass("hidden"),n.preloaderElement.addClass("hidden"),r.uploadInProgress=!1,e.error||(e.split("/").pop(),i.added(e,a.find(".upload-video-name").val()),o.close())}).catch(e=>{console.log("ERROR",e),n.videoInput.val(""),n.wallpaperError.text(""),n.uploadButton.prop("disabled",!1),n.header.addClass("activeOnRolled"),n.uploadProgress.addClass("hidden"),e.cancel?sitemessage("Uploading canceled"):(e=e.text||findResponseError(e)||"Uploading error",sitemessage(e))}),void console.log(e,t)):(n.videoError.text("Incorrect video format"),void n.videoError.addClass("error-message")):(n.videoError.text("No video selected"),void n.videoError.addClass("error-message"))}),n.importUrl.click(()=>{inputDialogNew({caption:s.app.localization.e("importHeading"),class:"importVideoDialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:s.app.localization.e("importInputPlaceholder"),label:s.app.localization.e("importInputLabel")}],success:function(e){n.videoInput.prop("disabled",!0),r.uploadInProgress=!0,n.header.removeClass("activeOnRolled"),n.uploadButton.prop("disabled",!0),n.uploadProgress.removeClass("hidden");var t={progress:function(e){"100.00"===(e=(.9*e).toFixed(2))&&n.preloaderElement.hasClass("hidden")&&n.preloaderElement.removeClass("hidden"),n.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),n.uploadProgress.find(".upload-progress-percentage").text(e+"%")},cancel:function(e){r.cancelCloseFunction=()=>{"function"==typeof e&&e(),o.close()},n.cancelButton.on("click",()=>{n.uploadProgress.addClass("hidden"),n.cancelButton.addClass("hidden"),n.importUrl.removeClass("hidden"),n.videoInput.prop("disabled",!1),r.uploadInProgress=!1,e()}),n.cancelButton.removeClass("hidden")}};n.importUrl.addClass("hidden"),s.app.peertubeHandler.api.videos.import({data:{targetUrl:e[0]}},t).then(e=>{e.error||(e.split("/").pop(),i.added(e,a.find(".upload-video-name").val()),r.uploadInProgress=!1,o.close())}).catch(e=>{n.videoInput.val(""),n.wallpaperError.text(""),n.uploadButton.prop("disabled",!1),n.header.addClass("activeOnRolled"),n.uploadProgress.addClass("hidden"),n.importUrl.removeClass("hidden"),n.videoInput.prop("disabled",!1),r.uploadInProgress=!1,e.cancel?sitemessage("Uploading canceled"):(e=e.text||findResponseError(e)||"Uploading error",sitemessage(e))})}})}),e.clbk(null,e)},wnd:{header:"",close:function(){r.closeClbk&&r.closeClbk()},postRender:function(e,t,n){o=t,a=e,n&&n()},offScroll:!0,noInnerScroll:!0,class:"uploadpeertube",allowHide:!0,noCloseButton:!0,noButtons:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var s=new nModule,a={},r={};return s.run=function(e){var t=s.addEssense(a,n,e);s.init(t,e)},s.stop=function(){_.each(a,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=uploadpeertube:(app.modules.uploadpeertube={},app.modules.uploadpeertube.module=uploadpeertube);var accounts=function(){function n(e){function a(n){f.app.platform.sdk.pool.expand(c,function(e){var t=_.indexOf(e.addresses,n);-1<t&&(t=e.private[t],u.dumpkey(n,t))})}function o(){5<=deep(c,"addresses.length")?sitemessage("You have reached a maximum of 5 accounts. No more can be added "):f.app.nav.api.load({open:!0,id:"addaccount",inWnd:!0,essenseData:{success:function(t){console.log("mnemonic",t),f.app.platform.sdk.pool.expand(c,function(e){console.log("IMHERE",t),f.app.platform.sdk.pool.add(e,t,function(e,t){console.log("IMHERE",e),t?dialog({html:f.app.localization.e("aused"),class:"one"}):f.app.platform.sdk.pool.export(e,function(e){console.log("HERE"),f.app.platform.sdk.pool.current.packs[d]=e,f.app.platform.sdk.pool.save(),c=e,f.app.platform.sdk.pool.info(e,function(){u.addresses()})})})})}}})}function i(){l.dumpkey.html(""),l.c.find(".dumpaddress").html(""),l.c.removeClass("privatedump")}function n(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to see your private key?",btn1text:"See Private Key",btn2text:"Cancel",class:"zindex",success:function(){a(e)}})}function s(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to remove this address from this device?",btn1text:"Remove",btn2text:"Cancel",class:"zindex",success:function(){f.app.platform.sdk.pool.remove(c,e),f.app.platform.sdk.pool.save(),u.addresses()}})}function r(){var o=$(this).closest(".addressTable").attr("address");f.app.platform.sdk.pool.expand(c,function(e){var t,n,a=_.indexOf(e.addresses,o);-1<a?(t=e.private[a],n=f.app.user.stay,f.app.user.signout(function(){f.app.user.stay=n,f.user.signin(t,function(e){f.app.reloadLight(function(){var e="userpage?id=accounts&s="+makeid(),t=!1;f.app.user.validate()||(e="filluser",t=!0),f.app.nav.api.load({open:!0,href:e,history:t})})})})):console.log("INDEX",a)})}var l,c,d,p,e=deep(e,"history"),u={qrcode:function(e,t){new QRCode(e[0],{text:t,width:256,height:256})},dumpkeyabout:function(){},dumpkey:function(e,t){var n="";l.c.addClass("privatedump"),l.c.find(".dumpaddress").html(e);try{n=f.app.user.keysPairFromPrivate(t).toWIF().toString("hex")}catch(e){console.log("ER",e)}f.shell({name:"dumpkey",el:l.dumpkey,data:{private:t,address:e,privateWif:n},animation:"fadeIn"},function(e){u.qrcode(e.el.find(".code"),t),e.el.find(".copyvalue").on("click",function(){var e=$(this).closest(".infotable").find(".value");copyText(e),sitemessage("Value was successfully copied")})})},addresses:function(t){f.shell({name:"addresses",el:l.addresses,data:{current:f.app.platform.sdk.address.pnet().address,pack:c},animation:"fadeIn"},function(e){e.el.find(".remove").on("click",s),e.el.find(".dumpkey").on("click",n),e.el.find(".ncurrent .label").on("click",r),t&&t()})}};return{primary:e,getdata:function(e,t){p=deep(t,"settings.essenseData")||{},d=c=null,e({})},destroy:function(){l={}},init:function(e){var t,n;(l={}).c=e.el.find("#"+f.map.id),l.addresses=l.c.find(".addresses"),l.dumpkey=l.c.find(".dumpkey"),l.c.find(".add").on("click",o),l.c.find(".back").on("click",i),t=f.app.platform.sdk.address.pnet().address,(n=f.app.platform.sdk.pool.getPack(t))?(c=n[0],d=n[1],f.app.platform.sdk.pool.info(c,function(){u.addresses(function(){p.dumpkey&&a(t)})})):sitemessage("ERROR"),e.clbk(null,e)}}}var f=new nModule,a={};return f.run=function(e){var t=f.addEssense(a,n,e);f.init(t,e)},f.stop=function(){_.each(a,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=accounts:(app.modules.accounts={},app.modules.accounts.module=accounts);var filluser=function(){function n(e){function r(t){b.app.ref?b.sdk.users.get(b.app.ref,function(){var e=deep(b,"sdk.users.storage."+b.app.ref+".name");t&&t(e)}):t&&t(null)}function l(){var e=b.app.ref||"",t="Overall";return-1<e.indexOf("author")&&(t="Account"),-1<e.indexOf("&s=")||-1<e.indexOf("&v=")?"Post":t}function i(t){return _.findIndex(m,function(e){return e==t})}function t(){var e,t;f&&(e=u[f],t=s.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=s.c.find(".stepsWrapperLine"),t=t.closest(".stepsWrapper").width(),s.c.find(".step").width(t),e.css("margin-left","-"+i(f)*t+"px"),e.width(t*_.toArray(u).length))}var s,o,a,n,e=deep(e,"history"),c=null,d=!1,p=!1,u={captcha:{id:"captcha",render:"captcha",nextindex:"email",prev:function(n){var e=b.sdk.address.pnet().address;b.app.settings.get(e,"request")?v.next():g.check(function(e){e?v.next():b.sdk.captcha.get(function(e,t){t?v.to("network"):e.done?(v.next(),g.request()):(u.captcha.current=e,n())},!0)},!0)},after:function(e,t){var n=e.find(".ucaptchainput"),a=e.find(".redo"),o=e.find(".addCaptcha");function i(e){return/^[a-zA-Z0-9]{4,}$/.test(e)}setTimeout(function(){n.focus()},150),n.on("keyup",function(){i($(this).val())?o.removeClass("disabled"):o.addClass("disabled")}),o.on("click",function(){var e=n.val();i(e)&&b.sdk.captcha.make(e,function(e,t){return"captchashots"==e?(sitemessage(b.app.localization.e("e13118")),void v.redo()):void(e?sitemessage(b.app.localization.e("e13118")):t.done&&(v.next(),g.request()))},!0)}),a.one("click",function(){v.redo()})}},email:{id:"email",nextindex:"money",prev:function(e){h.referral(),localStorage.uei?v.next():e()},render:"email",after:function(e,t,n){function a(e){return/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)}var o=e.find(".uemailinput"),i=e.find(".skip"),s=e.find(".addEmail");o.focus(),o.on("keyup",function(){a($(this).val())?(s.removeClass("disabled"),i.addClass("hidden"),s.html(b.app.localization.e("e13119"))):(s.addClass("disabled"),i.removeClass("hidden"),s.html(b.app.localization.e("e13113")))}),s.on("click",function(){var e=o.val();a(e)&&(v.next(),localStorage.uei=!0,function(e){topPreloader(20);var n={Email:e,Lang:b.app.localization.key||"en"};n.Action||(n.Action="ADDTOMAILLIST"),n.TemplateID="1005",n.ref="",r(function(e){var t="";n.ref+=l(),e&&(n.ref+=", "+e,t+='<p><a href="https://'+b.app.options.url+"/author?address="+b.app.ref+'">Referrer: '+e+"</a></p>"),(e=deep(document,"referrer"))&&(t+='<p><a href="'+e+'">From: '+e+"</a></p>"),n.body=encodeURIComponent(t),$.ajax({type:"POST",url:"https://"+b.app.options.url+"/Shop/AJAXMain.aspx",data:n,dataType:"json",success:function(){topPreloader(100)}})})}(e))}),i.one("click",function(){localStorage.uei=!0,v.next()})}},money:{id:"money",nextindex:"settings",prev:function(t){g.check(function(e){e?v.next():d?v.to("captcha"):p?v.to("moneyfail"):t()})},ret:!1,render:"money",after:function(t,n,e){v.timer(t.find(".time"),e||59,function(){g.check(function(e){!e||"money"!=f&&"captcha"!=f?(t.find(".subcaption").html(b.app.localization.e("wesentmoneydelay")),u.money.after(t,n,30)):v.next()},!0)})}},settings:{id:"settings",nextindex:"welcome",prev:function(e){e()},render:"settings",after:function(e,t){},next:!0},welcome:{id:"welcome",prev:function(e){e()},render:"welcome",after:function(e){setTimeout(function(){b.nav.api.go({href:"index?r=recommended",history:!0,open:!0})},1500),e.find(".welcome").on("click",function(){var e;"_this"==deep(a,"successHref")?((e=deep(n,"container.close"))&&e(),a.signInClbk&&a.signInClbk()):b.nav.api.go({href:"index?r=recommended",history:!0,open:!0})})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){b.app.errors.clbks.filluser=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=f||b.app.platform.loadingWithErrors||v.to("captcha"),delete b.app.errors.clbks.filluser)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(t){function n(){b.app.platform.sdk.node.transactions.get.allBalance(function(e){t.find(".balance").html("Balance: "+b.app.platform.mp.coin(e)+" PKOIN")})}n(),t.find(".check").on("click",function(){topPreloader(20),b.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),0<e&&("moneyfail"==f&&v.to("settings"),delete b.app.platform.sdk.node.transactions.clbks.moneyfail),n()}),b.app.platform.sdk.node.transactions.clbks.moneyfail=function(){b.app.platform.sdk.node.transactions.get.allBalance(function(e){0<e&&("moneyfail"==f&&v.to("settings"),delete b.app.platform.sdk.node.transactions.clbks.moneyfail)})}})}}},f=null,m=_.map(u,function(e,t){return t}),h={referral:function(){r(function(e){l(),deep(document,"referrer")})}},g={request:function(o){b.sdk.users.requestFreeMoney(function(e,t){var n=b.sdk.address.pnet().address,a=b.app.settings.get(n,"request")||"";e||a?(b.app.settings.set(n,"request","true"),g.follow(),o&&o(!0)):("captcha"==t&&(d=!0,"money"!=f&&"captcha"!=f||v.to("captcha")),"error"==t&&(p=!0,"money"!=f&&"captcha"!=f||v.to("captcha")),o&&o(!1,"err"))})},check:function(t,e){b.app.platform.sdk.node.transactions.get.allBalance(function(e){t&&t(0<e)},e)},follow:function(){b.app.platform.sdk.node.transactions.clbks.filluser||(b.app.platform.sdk.node.transactions.clbks.filluser=function(){delete b.app.platform.sdk.node.transactions.clbks.filluser,g.check(function(e){e?"money"==f&&v.next():g.follow()})})}},v={to:function(e,t){f=e,v.makeStep(t)},redo:function(e){v.makeStep(function(){})},next:function(e){(f=f?u[f].nextindex:u.captcha.id)&&v.makeStep(function(){})},makeStep:function(e){var n=u[f];n&&n.prev(function(){s.c&&(s.c.attr("step",n.id),y.panel(n,function(t){y.step(n,function(e){_scrollTop(e,c),t.find(".elpanel").addClass("active"),n.after(e,t)})}))})},timer:function(n,a,e){var o=new CircularProgress({radius:120,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 56px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#5D5D5D",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});function t(e){var t=secInTime(e/1e3).split(":");n.find(".t .min").html(t[0]),n.find(".t .sec").html(t[1]),o.options.text={value:""},o.update(e=(e=100*(1-e/(1e3*a)))<0?0:e)}n.find(".circle").html(o.el),timer=new Timer({ontick:function(){t(timer.getDuration())},onend:function(){e&&e()}}),timer.start(a),t(timer.getDuration())}},y={step:function(e,n){s.c.find(".step").removeClass("active");var t=s.c.find('.step[step="'+e.id+'"] .stepBody'),a=t.closest(".step"),o=s.c.find(".stepsWrapperLine");y[e.render](t,function(e){var t=a.closest(".stepsWrapper").width();s.c.find(".step").width(t),o.width(t*_.toArray(u).length),t="-"+i(f)*t+"px",o.css("margin-left",t),a.closest(".step").addClass("active"),n&&n(e)})},panel:function(e,t){b.shell({name:"panel",el:s.panel,data:{step:e}},function(e){t&&t(e.el)})},captcha:function(e,t){b.shell({name:"captcha",el:e,data:{captcha:u.captcha.current}},function(e){t&&t(e.el)})},email:function(e,t){b.shell({name:"email",el:e,data:{}},function(e){t&&t(e.el)})},welcome:function(e,t){b.shell({name:"welcome",el:e,data:{}},function(e){t&&t(e.el)})},moneyfail:function(e,t){b.shell({name:"moneyfail",el:e,data:{}},function(e){t&&t(e.el)})},network:function(e,t){b.shell({name:"network",el:e,data:{}},function(e){t&&t(e.el)})},money:function(e,t){b.shell({name:"money",el:e,data:{}},function(e){t&&t(e.el)})},settings:function(n,a,e){b.nav.api.load({open:!0,id:"test",el:n,essenseData:{wizard:!0,panel:s.panel,success:function(){v.next()}},clbk:function(e,t){o=t,a&&a(n)}})}};return{primary:e,getdata:function(t,e){p=d=!1,a=e.settings.essenseData||{},f=null;var n={steps:u};b.app.user.validate()?b.app.nav.api.load({open:!0,href:"index",history:!0}):b.app.errors.connection()?b.app.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):b.fastTemplate("panel",function(e){t(n)})},destroy:function(){window.removeEventListener("resize",t),o&&o.destroy(),o=null,s={},$("html").removeClass("fillinguser")},init:function(e){(s={}).c=e.el.find("#"+b.map.id),s.panel=s.c.find(".panelWrapper"),window.addEventListener("resize",t),n=e,v.next(),(c=s.c.closest(".wndcontent")).length||(c=null),$("html").addClass("fillinguser"),e.clbk(null,e)}}}var b=new nModule,a={};return b.run=function(e){var t=b.addEssense(a,n,e);b.init(t,e)},b.stop=function(){_.each(a,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=filluser:(app.modules.filluser={},app.modules.filluser.module=filluser);var filluserfast=function(){function n(e){function i(t){return _.findIndex(d,function(e){return e==t})}function t(){var e,t;l&&(e=c[l],t=s.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=s.c.find(".stepsWrapperLine"),t=t.closest(".stepsWrapper").width(),s.c.find(".step").width(t),e.css("margin-left","-"+i(l)*t+"px"),e.width(t*_.toArray(c).length))}var s,n,a,e=deep(e,"history"),o={},r=null,l=null,c={settings:{id:"settings",nextindex:"captcha",prev:function(e){e()},render:"settings",after:function(e,t){},next:!0},captcha:{id:"captcha",render:"captcha",nextindex:"welcome",prev:function(n){var e=h.sdk.address.pnet().address,e=h.app.settings.get(e,"request")||"";console.log("requested"),e?u.next():p.check(function(e){console.log("result",e),e?u.next():h.sdk.captcha.get(function(e,t){console.log("errorerrorerror",t),t?u.to("network"):e.done?p.request(function(e){e&&u.next()}):(c.captcha.current=e,n())},!0)},!0)},after:function(e,t){var n=e.find(".ucaptchainput"),a=e.find(".redo"),o=e.find(".addCaptcha");function i(e){return/^[a-zA-Z0-9]{4,}$/.test(e)}n.focus(),n.on("keyup",function(){i($(this).val())?o.removeClass("disabled"):o.addClass("disabled")}),o.on("click",function(){var e=n.val();i(e)&&h.sdk.captcha.make(e,function(e,t){return"captchashots"==e?(sitemessage(h.app.localization.e("e13118")),void u.redo()):void(e?sitemessage(h.app.localization.e("e13118")):t.done&&p.request(function(e){e&&u.next()}))},!0)}),a.one("click",function(){u.redo()})}},welcome:{id:"welcome",prev:function(e){n.welcomepart&&n.welcomepart(),e()},render:"welcome",after:function(e){function t(){var e;"_this"==deep(n,"successHref")?((e=deep(a,"container.close"))&&e(),n.signInClbk&&n.signInClbk()):h.nav.api.go({href:"index?r=recommended",history:!0,open:!0}),isMobile()?h.app.platform.ui.showmykey():h.app.platform.ui.showmykeyfast()}setTimeout(function(){t()},1500),e.find(".welcome").on("click",function(){t()})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){h.app.errors.clbks.filluserfast=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=l||h.app.platform.loadingWithErrors||u.to("captcha"),delete h.app.errors.clbks.filluserfast)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(t){function n(){h.app.platform.sdk.node.transactions.get.allBalance(function(e){t.find(".balance").html("Balance: "+h.app.platform.mp.coin(e)+" PKOIN"),0<e&&((e=app.platform.sdk.registrations.storage[a])&&2==e&&h.sdk.registrations.add(a,3),"moneyfail"==l&&setTimeout(function(){u.to("welcome")},100),delete h.app.platform.sdk.node.transactions.clbks.moneyfail)})}var a=h.sdk.address.pnet().address;n(),t.find(".tryagain").on("click",function(){p.request(function(e){e&&u.next()})}),t.find(".check").on("click",function(){console.log("allBalanceCheck"),h.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),console.log("allBalance",e),n()},!0)}),h.app.platform.sdk.node.transactions.clbks.moneyfail=n}}},d=_.map(c,function(e,t){return t}),p={request:function(o){h.sdk.users.requestFreeMoney(function(e,t){var n=h.sdk.address.pnet().address,a=h.app.settings.get(n,"request")||"";e||a?(h.app.settings.set(n,"request","true"),h.sdk.registrations.add(n,3),o&&o(!0)):("captcha"==t&&("money"!=l&&"captcha"!=l||u.to("captcha")),console.log("err",t),"error"!=t&&"iplimit"!=t||"money"!=l&&"captcha"!=l||u.to("moneyfail"),_.isEmpty(t)&&u.to("moneyfail"),o&&o(!1,"err"))})},check:function(t,e){h.app.platform.sdk.node.transactions.get.allBalance(function(e){t&&t(0<e)},e)},follow:function(){h.app.platform.sdk.node.transactions.clbks.filluser||(h.app.platform.sdk.node.transactions.clbks.filluser=function(){delete h.app.platform.sdk.node.transactions.clbks.filluser,p.check(function(e){e?"money"==l&&u.next():p.follow()})})}},u={preloader:function(e){e?s.c.addClass("loading"):s.c.removeClass("loading")},signin:function(t){h.user.signin(o.mnemonicKey,function(e){t&&t()})},to:function(e,t){l=e,u.makeStep(t)},redo:function(e){u.makeStep(function(){})},next:function(e){var t;(l=l?c[l].nextindex:((t=deep(app,"platform.sdk.user.storage.me"))&&t.relay?c.captcha:c.settings).id)&&u.makeStep(function(){})},makeStep:function(e){var n=c[l];n&&(u.preloader(!0),n.prev(function(){s.c&&(s.c.attr("step",n.id),f.panel(n,function(t){f.step(n,function(e){u.preloader(!1),_scrollTop(e,scrollel),t.find(".elpanel").addClass("active"),n.after(e,t)})}))}))},testqrcodeandkey:function(e,t){e=h.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=f.qrcode(s.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg"),grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?t&&t(!1):t&&t(!0)},qrscanner.q.decode(e)})},generate:function(t){var n;o.mnemonicKey?t&&t():(n=bitcoin.bip39.generateMnemonic(),u.testqrcodeandkey(n,function(e){e?(o.mnemonicKey=n,e=h.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnetsimple(e.publicKey).address,o.mk=e.privateKey.toString("hex"),t&&t()):u.generate()}))},waitgeneration:function(e){retry(function(){if(o.mnemonicKey||o.mk)return!0},e,40)}},f={qrcode:function(e,t){return new QRCode(e[0],{text:t,width:256,height:256})},step:function(e,n){s.c.find(".step").removeClass("active");var t=s.c.find('.step[step="'+e.id+'"] .stepBody'),a=t.closest(".step"),o=s.c.find(".stepsWrapperLine");f[e.render](t,function(e){var t=a.closest(".stepsWrapper").width();s.c.find(".step").width(t),o.width(t*_.toArray(c).length),t="-"+i(l)*t+"px",o.css("margin-left",t),a.closest(".step").addClass("active"),n&&n(e)})},panel:function(e,t){h.shell({name:"panel",el:s.panel,turi:"filluser",data:{step:e}},function(e){t&&t(e.el)})},captcha:function(e,t){h.shell({name:"captcha",el:e,turi:"filluser",data:{captcha:c.captcha.current}},function(e){t&&t(e.el)})},email:function(e,t){h.shell({name:"email",turi:"filluser",el:e,data:{}},function(e){t&&t(e.el)})},welcome:function(e,t){h.shell({name:"welcome",turi:"filluser",el:e,data:{}},function(e){t&&t(e.el)})},moneyfail:function(e,t){h.shell({name:"moneyfail",turi:"filluser",el:e,data:{}},function(e){t&&t(e.el)})},network:function(e,t){h.shell({name:"network",el:e,turi:"filluser",data:{}},function(e){t&&t(e.el)})},money:function(e,t){h.shell({name:"money",el:e,data:{}},function(e){t&&t(e.el)})},settings:function(n,a,e){h.nav.api.load({open:!0,id:"test",el:n,essenseData:{wizard:!0,panel:s.panel,presave:function(t){u.waitgeneration(function(){h.app.user.isState(function(e){h.sdk.registrations.add(o.mainAddress,1),e?(h.sdk.registrations.add(o.mainAddress,1),t&&t()):u.signin(function(){t&&t()})})})},relay:function(){return o.mainAddress},success:function(e){o.info=e,h.sdk.registrations.add(o.mainAddress,2),m.save(),console.log("actions.next()",e),u.next()}},clbk:function(e,t){r=t,a&&a(n)}})}},m={save:function(){},load:function(){}};return{primary:e,getdata:function(e,t){!t.state||h.user.validateVay()?(o={},n=deep(t,"settings.essenseData")||{},l=null,e({steps:c,inauth:deep(t,"settings.essenseData.inauth")||!1})):h.app.nav.api.load({open:!0,href:"index",history:!0})},destroy:function(){window.removeEventListener("resize",t),delete h.app.platform.sdk.node.transactions.clbks.moneyfail,delete h.app.errors.clbks.filluserfast,delete h.app.platform.sdk.node.transactions.clbks.filluser,r&&r.destroy(),r=null,o={},s={}},init:function(e){m.load(),(s={}).c=e.el.find("#"+h.map.id),s.panel=s.c.find(".panelWrapper"),a=e,scrollel=s.c.closest(".wndcontent"),scrollel.length||(scrollel=null),window.addEventListener("resize",t),h.app.user.isState(function(e){e?((o={}).mainAddress=h.app.user.address.value,o.mk=h.app.user.private.value.toString("hex"),console.log(o.mainAddress)):setTimeout(function(){u.generate(function(){})},1e3),u.next()}),e.clbk(null,e)}}}var h=new nModule,a={};return h.run=function(e){var t=h.addEssense(a,n,e);h.init(t,e)},h.stop=function(){_.each(a,function(e){e.destroy()})},h}();"undefined"!=typeof module?module.exports=filluserfast:(app.modules.filluserfast={},app.modules.filluserfast.module=filluserfast);var streampeertube=function(){function n(e){function r(){l.copyButton.each((e,t)=>{var n=(t=$(t)).attr("linkType");t.on("click",()=>{var e=l.c.find(`.${n}`);copyText(e),sitemessage("Link was copied to clipboard")})}),l.c.find(".closewindowaction").on("click",function(){a.close()})}var l,c,a,e=deep(e,"history"),d={};return{primary:e,getdata:function(n,e){var t;o=e.settings.essenseData,d=o.actions,p.app.peertubeHandler.checklink(o.currentLink)?(e=(t=p.app.peertubeHandler.parselink(o.currentLink)).id)?p.app.peertubeHandler.api.videos.getLiveInfo({id:e},{host:t.host}).then(e=>{var t;e.error?(t=deep(e,"error.responseJSON.errors")||{},t=(Object.values(t)[0]||{}).msg,sitemessage(t||"Server error")):(u=!0,i={rtmpUrl:e.rtmpUrl,streamKey:e.streamKey}),n({})}):n({}):(i=null,u=!1,n({}))},destroy:function(){l={}},init:function(s){(l={}).c=s.el.find("#"+p.map.id),l.videoInput=l.c.find(".upload-video-file"),l.videoWallpaper=l.c.find(".upload-video-wallpaper"),l.videoError=l.c.find(".file-type-error"),l.wallpaperError=l.c.find(".wallpaper-type-error"),l.uploadProgress=l.c.find(".upload-progress-container"),l.contentSection=l.c.find(".content-section"),l.resultSection=l.c.find(".result-section"),l.dateInput=l.c.find("#dtBox"),l.streamButton=l.c.find(".streamButton"),l.copyButton=l.c.find(".copyStreamInfo"),i?(u=!0,l.contentSection.addClass("hidden"),l.resultSection.removeClass("hidden"),l.resultSection.find(".result-video-rtmp").val(i.rtmpUrl),l.resultSection.find(".result-video-streamKey").val(i.streamKey),l.streamButton.html('<i class="fas fa-check"></i> Stream Created'),l.streamButton.addClass("successButton"),r(),s.clbk(null,s)):function(){if(u)return u=!1,a.close();var e=c.find(".content-section"),i=c.find(".preloader-section");l.streamButton.addClass("disabledButton"),l.streamButton.text("Starting..."),e.addClass("hidden"),i.removeClass("hidden"),l.videoWallpaper.prop("files");var t=c.find(".upload-video-name").val();c.find(".name-type-error"),(e={}).name=t,p.app.peertubeHandler.api.videos.live(e).then(a=>{var o=c.find(".result-section");p.app.peertubeHandler.api.videos.getLiveInfo({id:a.uuid},{host:a.host}).then(e=>{var t,n;i.addClass("hidden"),a.error?(t=deep(a,"error.responseJSON.errors")||{},n=(Object.values(t)[0]||{}).msg,sitemessage(n||"Uploading error")):(u=!0,o.removeClass("hidden"),l.streamButton.html('<i class="fas fa-check"></i> Stream Created'),l.streamButton.removeClass("disabledButton"),l.streamButton.addClass("successButton"),t=o.find(".result-video-rtmp"),n=o.find(".result-video-streamKey"),t.val(e.rtmpUrl),n.val(e.streamKey),d.added(a.formattedLink),r(),s.clbk(null,s))})})}()},wnd:{header:"",close:function(){o.closeClbk&&o.closeClbk()},postRender:function(e,t,n){a=t,c=e,n&&n()},offScroll:!0,noInnerScroll:!0,class:"streampeertube",allowHide:!0,noCloseButton:!0,noButtons:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var p=new nModule,a={},o={},u=!1,i=null;return p.run=function(e){var t=p.addEssense(a,n,e);p.init(t,e)},p.stop=function(){_.each(a,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=streampeertube:(app.modules.streampeertube={},app.modules.streampeertube.module=streampeertube);var taginput=function(){function n(e){var o,i,e=deep(e,"history"),s={initsearch:function(){search(o.tagSearch,{placeholder:i.placeholder||c.app.localization.e("addtagsCategories"),clbk:function(e){},time:0,events:{fastsearch:function(n,a,e){if(e&&(e=String.fromCharCode(e.keyCode||e.which),/[,.!?;:() ]/.test(e)))return r.addTag(n.replace(/#/g,"").replace(/ /g,"")),o.tagSearch.find("input").val("").focus(),void a(null);c.app.platform.sdk.tags.search(n,function(e){var t=_.map(e,function(e){return{tag:e,name:"#"+e}}),e=c.app.platform.sdk.categories.search(n,s.language());i.addonlytags&&(e=[]),t=_.map(e,function(e){return{id:e.id,name:e.name}}).concat(t),l.tagsResults(t,function(e){a(e,function(e,t){e.find(".result").on("click",function(){t.closeResults(),t.clear(),r.add($(this))}),e.find(".empty").on("click",function(){var e=trim(o.tagSearch.find("input").val());e&&(t.closeResults(),t.clear(),r.addTag(e))})})})})},search:function(e,t,n){e=(e=e.replace(/#/g," ")).split(" "),1==(e=_.filter(e,function(e){return e})).length&&(e=e[0]),r.addTag(e),n.clear(),t&&t()}},last:{get:function(){var e=c.app.platform.sdk.categories.get(s.language())||[],t=_.map(c.app.platform.sdk.categories.getaddedtags(s.language()),function(e){return{tag:e,name:"#"+e}}),n=[c.app.localization.e("tnews"),c.app.localization.e("timages"),c.app.localization.e("tvideos"),c.app.localization.e("tmarket"),c.app.localization.e("tsport")],n=_.map(n,function(e){return{tag:e,name:"#"+e}});return(e=i.addonlytags?[]:e).concat(t,n)},tpl:function(e,t){l.tagsResults(e,function(e){t(e,function(e,t){e.find(".result").on("click",function(){t.closeResults(),t.clear(),r.add($(this))})})})}}})},language:function(){return i.language?i.language():null}},r={add:function(e){var t=e.attr("tag");(e=e.attr("category"))?(e=c.app.platform.sdk.categories.getbyid(e,s.language()),r.addTags(e.tags)):r.addTag(t),isMobile()&&setTimeout(function(){o.tagSearch&&o.tagSearch.find("input").focus()},500)},remove:function(){var e=$(this).closest(".wrps").attr("tag"),t=$(this).closest(".wrps").attr("category");t&&(t=c.app.platform.sdk.categories.getbyid(t,s.language()),r.removeTags(t.tags)),e&&r.removeTag(e),$(this).closest(".wrps").remove()},removeTag:function(e){i.removeTag&&i.removeTag(e)},removeTags:function(e){i.removeTags&&i.removeTags(e)},addTag:function(e){i.addTag&&i.addTag(e)},addTags:function(e){i.addTags&&i.addTags(e)}},l={tags:function(t){var e,n;o.tags&&(o.tags.find(".tag").remove(),e=i.tags?i.tags():[],n=c.app.platform.sdk.categories.fromTags(e,s.language()),i.addonlytags&&(n={tags:e,categories:[]}),c.shell({name:"tags",el:o.tags,data:{tags:i.tags?i.tags():[],bycategories:n}},function(e){e.el&&e.el.find(".remove").on("click",r.remove),t&&t()}))},tagsResults:function(e,t){c.shell({name:"tagsResult",data:{results:e}},function(e){t&&t(e.rendered)})}};return{primary:e,getdata:function(e,t){i=t.settings.essenseData||{},e({})},destroy:function(){o={}},init:function(e){(o={}).c=e.el.find("#"+c.map.id),o.tags=o.c.find(".tagsCont"),o.tagSearch=o.c.find(".searchWrapper"),s.initsearch(),l.tags(),e.clbk(null,e)}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=taginput:(app.modules.taginput={},app.modules.taginput.module=taginput);var tagcloud=function(){function n(e){function a(){d.app.platform.sdk.categories.gettags(null,"onlytags").length?s.cleartags.addClass("showed"):s.cleartags.removeClass("showed")}var s,r,e=deep(e,"history"),l=!1,c={showhide:function(){l?s.c.addClass("showedalltags"):s.c.removeClass("showedalltags")},tags:function(n,t){var a=d.app.platform.sdk.categories.gettagsmap(),o=[];_.each(a,function(e,t){-1==_.indexOf(n,t)&&o.push({tag:t,count:0})}),n=n.concat(o),_.each(n,function(e){e.count=Number(e.count||0)});var i=0;_.each(n,function(e){e.count>i&&(i=e.count)}),i++,n=_.sortBy(n,function(e){var t=1,n=e.count+1;return a[e.tag]&&(n=i+(e.count+1),t=100,a[e.tag].fixed&&(t=2)),-n*t}),(n=_.uniq(n,function(e){return e.tag})).length?(s.c.removeClass("hidden"),d.shell({name:"tags",el:s.tags,data:{tags:n,tagsmap:a}},function(e){c.showhide(),e.el.find(".showhidealltags").on("click",function(){l=!l,c.showhide(),r.renderclbk&&r.renderclbk()}),e.el.find(".tagcheckgl").on("click",function(){var e=$(this).closest(".tg");e.hasClass("fixed")||(e=e.attr("tag"),d.app.platform.sdk.categories.tag(e))}),r.renderclbk&&r.renderclbk(),t&&t()})):s.c.addClass("hidden")}},o=function(){d.app.platform.sdk.tags.cloud(function(e,t){e=d.app.platform.sdk.tags.filterEx(e),t&&(d.iclbks.maintag=o),c.tags(e),a()})};return{primary:e,getdata:function(e,t){r=t.settings.essenseData||{},e({})},destroy:function(){delete d.iclbks.maintag,delete d.app.platform.sdk.categories.clbks.tags.tagsmodule,delete d.app.platform.sdk.categories.clbks.selected.tagsmodule,s={}},init:function(e){(s={}).c=e.el.find("#"+d.map.id),s.tags=s.c.find(".tags"),s.cleartags=s.c.find(".cleartags"),d.app.platform.sdk.categories.clbks.selected.tagsmodule=function(e,t,n){o()},d.app.platform.sdk.categories.clbks.tags.tagsmodule=function(e,t,n){e=s.c.find('.tg[tag="'+e+'"]'),a(),t?e.addClass("selected"):e.removeClass("selected")},s.cleartags.on("click",function(){dialog({class:"zindex",html:"Do you really want to clear tags filters?",btn1text:d.app.localization.e("dyes"),btn2text:d.app.localization.e("dno"),success:function(){d.app.platform.sdk.categories.clear(null,!0),o()}})}),o(),e.clbk(null,e)}}}var d=new nModule,a={};return d.run=function(e){var t=d.addEssense(a,n,e);d.init(t,e)},d.stop=function(){_.each(a,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=tagcloud:(app.modules.tagcloud={},app.modules.tagcloud.module=tagcloud);var staking=function(){function n(e){function a(t){b.app.api.fetch("exchanges/history").then(e=>{i=e.prices,t&&t()})}function n(){return[{name:"Coins",color:"#00A3F7",data:h.prices()}]}var o,i,e=deep(e,"history"),s=null,r=1e3,l=null,c="USD",d="bilaxy",p={mercatox:"last_price",bilaxy:"close"},u={},f={USD:{id:"USD",key:"USD",view:function(e){return b.app.platform.mp.dollars(e,{prefix:""})}},USDT:{id:"USDT",key:"USDT",view:function(e){return b.app.platform.mp.dollars(e,{prefix:""})}},BTC:{id:"BTC",key:"BTC",view:function(e){return b.app.platform.mp.acoin(e)}}},t=[{block:0,label:"Now",id:"now"},{block:30.5,label:"1 Month",id:"1m"},{block:182.5,label:"6 Months",id:"6m"},{block:365,label:"1 Year",id:"1y"}],m={currency:new Parameter({name:b.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"USD",possibleValuesLabels:["USD","USDT","BTC"],possibleValues:["USD","USDT","BTC"],format:{right:!0}})},h={netstakeweight:function(){return(deep(s,"netstakeweight")||0xabe8ad706f5a)/1e8},point:function(e){return h.netstakeweight(),r*Math.pow(1+3600/h.netstakeweight(),e)},price:function(e){if(e=e||0,i&&i[d]&&i[d].length>e){var t=i[d][i[d].length-1+e];if(t&&t.prices[c])return Number(t.prices[c].data[p[d]]||"0");if(t&&!t.prices[c])return 0<=(t=(e=Object.keys(p)).indexOf(d))&&e.splice(t,1),(e=e.map(e=>{var t=i[e][i[e].length-1];return Number(t.prices[c].data[p[e]]||"0")})).push(0),Math.max.apply(null,e)}return 0},prevprice:function(){for(var e=-1,t=0,n=this.price();t=this.price(e),e--,0<t&&t-n==0;);return t},prices:function(){var e=[];return i&&i[d]&&i[d].length&&(e=_.filter(i[d],function(e){return e}),e=_.map(e,function(e){if(e.prices[c])return{x:fromutc(new Date(e.date)),y:Number(e.prices[c].data[p[d]])}})),e}},g={prepare:function(e){return(e=new b.app.platform.objects.graph({el:e,shell:b.shell,chart:{caption:"Coins",height:70,width:70,type:"spline",xtype:"datetime",removeLegend:!0,disableYLabels:!0,disableXLabels:!0,yGridLineWidth:0,ypadding:0,disableTooltip:!0}})).series=n(),e},graph:function(e,t){l?(l.chart.update({series:n()}),t&&t(l,e)):(l=g.prepare(e)).render({maxPointsCount:10,prepareOptions:function(e){e.plotOptions.series={states:{inactive:{opacity:1},enableMouseTracking:!1,hover:{halo:{size:0},enabled:!1}}},e.plotOptions.spline={animation:!1,lineWidth:1,marker:{enabled:!1},states:{hover:{lineWidth:1,lineWidthPlus:0,marker:{fillColor:"#000",lineColor:"#000"},halo:{opacity:0}}}}}},function(){t&&t(l,e)})},pricechart:function(){}},v={updateValues:function(){this.updateValue(t[2]),this.updateValue(t[3]),this.updateValue(t[0])},updateValue:function(e){var t=o.c.find('.blv[item="'+e.id+'"]'),n=Number((t.text()||"0").replace(/,/g,""));n<0&&(n=0),e=h.point(e.block),t.animateNumber({number:e-n,numberStep:function(e,t){e=Number(n+e).toFixed(8),$(t.elem).text(b.app.platform.mp.coin(e=e<0?-e:e))}},rand(400,1200),function(){})},lastPrice:function(){l=null;var e="",t=h.price(0),n=h.prevprice(0),a={value:0,percent:0};t&&(e=f[c].view(t)),n&&t&&(a.value=n=t-n,a.percent=n/t),b.shell({inner:html,name:"lastprice",data:{price:e,currency:f[c],change:a},el:o.c.find(".lastpriceCnt")},function(e){v.pricechart()})},pricechart:function(){var e=o.c.find(".chart"),t=$("<div></div>",{class:"chartWrapper"});e.html(t),g.graph(t,function(e){})},updateTotal:function(e,t){v.datasets(e),u[e.id].update(),o.c.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(b.app.platform.mp.coinwithsmall(h.point(e.block))),t&&t()}},y=function(){var n;a(function(){v.lastPrice()}),n=function(e){e&&(b.iclbks.mainstacking=y),v.updateValues()},s?n(s):b.app.platform.sdk.node.get.info(function(e,t){e&&(s=e),n(e)})};return{primary:e,getdata:function(e){e({amount:r,parameters:m})},destroy:function(){delete b.iclbks.mainstacking,l=null,u={},o={}},init:function(e){var t;(o={}).c=e.el.find("#"+b.map.id),o.calculator=o.c.find(".calculator"),o.am=o.c.find(".amredits"),o.am.on("keyup",function(){var e=$(this).val()||"";5e5<(r=(r=Number(e.replace(/,/g,"")))<50?50:r)&&(r=5e5),v.updateValues()}),o.am.on("change",function(){var e=$(this).val()||"";5e5<(r=(r=Number(e.replace(/,/g,"")))<50?50:r)&&(r=5e5),$(this).val(r),v.updateValues()}),ParametersLive(_.toArray(m),o.c),m.currency._onChange=function(e){c=e,a(function(){v.lastPrice()})},o.c.find(".earnlabel").on("click",function(){var e="https://"+b.app.options.url;b.app.platform.sdk.address.pnet()&&(e+="?&ref="+b.app.platform.sdk.address.pnet().address),b.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:e,style:"smallcaption",caption:"The best way to earn Pocketcoin (PKOIN) is to invite people to the platform. You will get 20% of their PKOIN earnings for the first three months. Send the link below to anyone via email, social media, messenger."}})}),0<(t={alias:"numeric",groupSeparator:",",radixPoint:".",digits:0,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(t.placeholder="0"),o.am.inputmask(t),o.am.blur(),y(),e.clbk(null,e)}}}var b=new nModule,a={};return b.run=function(e){var t=b.addEssense(a,n,e);b.init(t,e)},b.stop=function(){_.each(a,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=staking:(app.modules.staking={},app.modules.staking.module=staking);var articles=function(){function n(e){function n(){c.nav.api.load({open:!0,href:"article?aid="+makeid(),inWnd:!0,history:!0,essenseData:{save:function(t){c.app.platform.sdk.articles.storage||(c.app.platform.sdk.articles.storage=[]),_.find(c.app.platform.sdk.articles.storage,function(e){if(t.id==e.id)return!0})||c.app.platform.sdk.articles.storage.unshift(t),c.app.platform.sdk.articles.save()},close:function(){l.articles()},complete:function(){c.closeContainer()},closeContainer:function(){c.closeContainer()}}})}function a(e){c.nav.api.load({open:!0,href:"article?aid="+e.id,inWnd:!0,history:!0,essenseData:{art:e,save:function(e){c.app.platform.sdk.articles.save()},close:function(){l.articles()},complete:function(){c.closeContainer()},closeContainer:function(){c.closeContainer()}}})}function t(){var t=$(this).closest(".art").attr("art");dialog({html:c.app.localization.e("e13018"),btn1text:c.app.localization.e("dyes"),btn2text:c.app.localization.e("dno"),class:"zindex",success:function(){var e=t;removeEqual(c.app.platform.sdk.articles.storage,{id:e}),r.c.find('.art[art="'+e+'"]').remove(),c.app.platform.sdk.articles.save(),l.ini()}})}function o(){n()}function i(){var t=$(this).closest(".art").attr("art");a(_.find(c.app.platform.sdk.articles.storage,function(e){return e.id==t}))}function s(){c.nav.api.load({open:!0,href:"author?address="+c.app.user.address.value.toString("hex"),history:!0}),c.closeContainer()}var r,e=deep(e,"history"),l={ini:function(){c.app.platform.sdk.articles.storage.length?r.c.removeClass("initial"):r.c.addClass("initial")},articles:function(){l.ini(),c.shell({name:"articles",el:r.articles.find(".artwrapper"),data:{articles:c.app.platform.sdk.articles.storage}},function(e){e.el.find(".artcnt").on("click",i),e.el.find(".remove").on("click",t)})}};return{primary:e,auto:function(){var t=parameters(),e=null;t.marticle&&!c.app.nav.wnds.article&&((e=t.aid?_.find(c.app.platform.sdk.articles.storage,function(e){return e.id==t.aid}):e)?a(e):n())},getdata:function(e){e({})},destroy:function(){r={}},init:function(e){(r={}).c=e.el.find("#"+c.map.id),r.articles=r.c.find(".articles"),r.add=r.c.find(".add"),r.add.on("click",o),r.c.find(".top").on("click",s),l.articles(),e.clbk(null,e)},wnd:{class:"allscreen a100 article "}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=articles:(app.modules.articles={},app.modules.articles.module=articles);var system16=function(){function n(e){function n(){i&&(delete i.clbks.changednode.components,delete i.clbks.changed.components,delete i.clbks.tick.components,delete i.system.clbks.tick.components)}function s(e,t){return"function"==typeof k[e]?k[e](t):k[e]}function r(e,t){var o=[],n=e.series;return _.each(n,function(n){var a={color:n.color,data:[],name:n.name,type:n.type||e.meta.type};_.each(t,function(e){var t=deep(e.info,n.path)||0;a.data.push({y:t,x:new Date(e.time)})}),o.push(a)}),o}var l,e=deep(e,"history"),d=null,i=null,c=null,p=[],o=null,u=[],f={},m=["#F0810F","#011A27","#4897D8","#E6DF44","#063852","#486824"],a=null,h={server:{}},g={charts:{nodes:{type:"rating"},server:{type:"responses"},wallets:{type:"distribution"},peertube:{type:"allcount"}}},v={unableProxyConnect:{icon:'<i class="fas fa-wifi"></i>',text:"Unable to Connect to Proxy"},undefinedError:{icon:'<i class="fas fa-exclamation-triangle"></i>',text:"Undefined Error"}},t={firebase:function(){var e=h.server.firebase||o.firebase;inputDialogNew({caption:"Proxy Firebase Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Upload New Firebase Admin SDK",placeholder:"Upload file with .json extension",upload:{ext:["json"]}},{defValue:e.id,validate:"empty",label:"Application Id",placeholder:"Application Id"}],success:function(e){var t={};return t.key=deep(e,"0.base64"),t.id=e[1],t.key||t.id?(h.server.firebase=t,C.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},certificate:function(){h.server.ssl;var t={};inputDialogNew({caption:"Proxy SSL Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Certificate",placeholder:"Upload file with .pem extension",upload:{ext:["pem"]}},{defValue:"",validate:"empty",placeholder:"Upload file with .pem extension",label:"Certificate Key",upload:{ext:["pem"]}},{defValue:"",validate:"empty",label:"Password",placeholder:"Certificate Password"}],success:function(e){return t.cert=deep(e,"0.base64"),t.key=deep(e,"1.base64"),t.passphrase=e[2],t.name=deep(e,"0.file.name"),t.cert&&t.key&&t.passphrase&&t.name?(h.server.ssl=t,C.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},serverenabled:function(e){h.server.enabled=!JSON.parse(e.attr("value")),h.server.enabled==o.server.enabled&&delete h.server.enabled,C.webserveradmin(l.c)},nodeenabled:function(){var e=o.node.enabled?[{text:"Disable Pocketnet Node",action:function(t){return i.system.request("set.node.enabled",{enabled:!1}).then(e=>{t(),y.refresh().then(e=>{y.refreshsystem()})})}}]:[{text:"Enable Pocketnet Node",action:function(t){return i.system.request("set.node.enabled",{enabled:!0}).then(e=>{y.refresh().then(e=>{y.refreshsystem()}),t()})}}];menuDialog({items:e})},binPath:function(){return globalpreloader(!0),i.system.request("set.node.binPath",{}).then(e=>{y.refresh().then(e=>{y.refreshsystem(),globalpreloader(!1)})}).catch(e=>{globalpreloader(!1)})},ndataPath:function(){return globalpreloader(!0),i.system.request("set.node.ndataPath",{}).then(e=>{globalpreloader(!1),y.refresh().then(e=>{y.refreshsystem()})}).catch(e=>{globalpreloader(!1)})}},y={convertTime:function(e){_.each(e,function(e){e.time=fromutc(new Date(e.time))})},updateNode:function(){i.fetchauth("manage",{action:"node.update",data:{all:"all"}}).then(e=>{y.refresh().then(e=>{C.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),y.refresh().then(e=>{C.allsettings()}),topPreloader(100)})},installNode:function(){i.fetchauth("manage",{action:"node.install",data:{}}).then(e=>{y.refresh().then(e=>{C.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),y.refresh().then(e=>{C.allsettings()}),topPreloader(100)})},removeNode:function(e){i.fetchauth("manage",{action:"node.delete",data:{all:e}}).then(e=>{y.refresh().then(e=>{C.allsettings()}),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),y.refresh().then(e=>{C.allsettings()}),topPreloader(100)})},admin:function(){var e=P.app.platform.sdk.address.pnet();return!!e&&(i&&c?i.direct||-1<_.indexOf(c.admins,e.address):void 0)},removeBot:function(t){topPreloader(30),i.fetchauth("manage",{action:"bots.remove",data:{address:t}}).then(e=>{u=_.filter(u,function(e){return e!=t}),C.botscontent(l.c),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),topPreloader(100)})},removeAdmin:function(e){topPreloader(30),i.fetchauth("manage",{action:"set.admins.remove",data:{address:e}}).then(e=>{y.refresh(),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),topPreloader(100)})},dust:function(e,t,n,a){P.app.platform.sdk.wallet.sendmanyoutputs(e,t,n,2,function(e,t){e&&P.app.platform.errorHandler(e,!0),a(e)})},ticksettings:function(e,t,n){n&&(o=e),C.allsettings()},refreshsystem:function(){return i.system.api.get.settings().then(e=>{o=e,l.c&&C.allsettings()})},refresh:function(){return i.get.info().then(e=>(this.tick(e.info),Promise.resolve()))},tick:function(e){c=e,(!(e=p[p.length-1])||new Date(e.time).addSeconds(10)<new Date)&&(p.push({info:c,time:new Date}),p=lastelements(p,1e3),l.c&&(C.nodecontentstate(l.c),C.nodescontenttable(l.c),C.peertubeinstancestable(l.c),C.webadminscontent(l.c),C.webdistributionwallets(l.c),C.webserverstatus(l.c)),setTimeout(function(){z.stats(!0)},200))},addnode:function(i,e){var s=!1,t="create",n=P.app.localization.e("e13044"),a=P.app.localization.e("add");i&&(s=!0,t="update",n=P.app.localization.e("e13062"),a=P.app.localization.e("save")),i=i||{};var r={host:new Parameter({type:"STRING",name:P.app.localization.e("nodehost"),id:"host",defaultValue:i.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:P.app.localization.e("e13063"),id:"port",defaultValue:i.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:P.app.localization.e("e13064"),id:"ws",defaultValue:i.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:P.app.localization.e("e13065"),id:"nodename",defaultValue:(i.nodename||(P.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:P.app.localization.e("e13066"),require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> '+P.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(e,n){var a,o=_.clone(i);i.host=r.host.value,i.port=r.port.value,i.ws=r.ws.value,i.nodename=r.nodename.value,i.rpcuser="",i.rpcpwd="","locally"==r.saveto.value?(i.rpcuser=r.rpcuser.value||"",i.rpcpwd=r.rpcpwd.value||"",i.locally=!0):(delete i.rpcuser,delete i.rpcpwd),i.host&&i.port&&i.ws&&i.nodename?(delete(a=_.clone(i)).addedby,delete a.date,a.locally||delete a.locally,P.app.platform.sdk.node.sys[t+r.saveto.value](a,function(e,t){e?(i=_.clone(o),sitemessage(e)):(s?(l.list.html(""),C.nodes(P.app.platform.nodes)):(P.app.platform.nodes||(P.app.platform.nodes=[]),P.app.platform.nodes.push(t),C.nodes([t])),P.app.platform.nodeid&&P.app.platform.nodeid.host!=a.host?n.close():y.connectnode(a,function(){n.close()}),C.active())})):sitemessage(P.app.localization.e("e13071"))}}};s&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+P.app.localization.e("delete"),fn:function(e,n){dialog({class:"zindex",html:P.app.localization.e("e13072"),success:function(){var e=i.locally?"revokelocally":"revokeproxy";P.app.platform.sdk.node.sys[e]({host:i.host},function(e,t){e?sitemessage(e):(l.list.find('.node[host="'+i.host+'"]').closest(".nodewrapepr").remove(),C.empty(),i.host==P.app.platform.nodeid.host?y.connectnode(null,function(){n.close()}):n.close())})}})}}),P.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:r},wnd:{header:n,buttons:a,noInnerScroll:!0,class:"addnodewnd"}},function(e){ParametersLive(_.toArray(r),e.el)})},settings:function(e){e.find("[sys]").on("click",function(){var e=$(this).attr("sys");!e||(e=deep(t,e))&&e($(this))})},node:{test:function(n){var e=_.map([{name:"Pageload",key:"pageload"},{name:"Limits",key:"limits"}],function(t){return{text:t.name,action:function(e){i.fetchauth("nodes/test",{scenario:t.key,node:n.key}).catch(e=>{sitemessage(e)}),e()}}});menuDialog({items:e})}},proxy:{selectWatch:function(){x.proxieslist(i,"Watch Proxy",function(e){T(e)})},selectUsing:function(){var e=d.get.current();x.proxieslist(e,"Select Proxy that using Interface",function(e){d.set.current(e.id,!0).then(e=>{T(d.get.current())})})},add:function(t){x.addproxy(null,function(e){t&&t()})},edit:function(e,t){x.addproxy(e,function(e){t&&t()})}}},b={nodes:{responsetime:{caption:"Nodes Response Time",series:[{name:"Median Response Time",path:"statistic.time",id:"ct"}]},rate:{caption:"Rate",series:[{name:"Requestes per seconds",path:"statistic.rate",id:"cr"}]},probability:{caption:"Probability",series:[{name:"Probability to select",path:"probability",id:"spr"}]},difference:{caption:"Block Height Difference",series:[{name:"Difference",path:"status.difference",id:"cd"}]},rating:{caption:"Rating",series:[{name:"Rating",path:"rating",id:"cr"}]},wsc:{caption:"Websocket Connections",series:[{name:"Websocket",path:"users",id:"wsc"}]},allcount:{caption:"Count of requestes",series:[{name:"Count of requestes",path:"statistic.allcount",type:"spline",id:"cr"},{name:"Success Count",path:"statistic.success",type:"areaspline",id:"cp"}]}},peertube:{responsetime:{caption:"Instance Median Response Time",series:[{name:"Median Response Time",path:"stats.averageTime",id:"sa"}]},allcount:{caption:"Count of requestes",series:[{name:"Count of requestes",path:"stats.count",type:"spline",id:"sc"},{name:"Success Count",path:"stats.success",type:"areaspline",id:"ss"}]},total:{caption:"Total count of videos",series:[{name:"Videos count",path:"stats.total",type:"spline",id:"sc"}]}},server:{connections:{caption:"Connections",series:[{path:"wss.users",name:"Websocket Connections",id:"wss"},{path:"server.middle.requestsIp",name:"Https requests IP",id:"requests"}]},memory:{caption:"Memory",series:[{path:"memory.rss",name:"RSS",id:"rss"}]},signatures:{caption:"Signed requests",objects:"server.middle.signatures",series:[{path:"length",namePath:"code",name:"Signature",id:"count"}]},responses:{caption:"Responses",objects:"server.middle.responses",series:[{path:"length",namePath:"code",name:"Code",id:"count"}]},rmts:{caption:"RMTS",series:[{path:"remote.size",name:"RMTS",id:"rmts"}]},cache:{caption:"Cache Size",objects:"server.cache.meta",series:[{path:"size",name:"Size",id:"size"}]}},wallets:{distribution:{caption:"Registration Address Distribution",series:[{path:"wallet.addresses.registration.queue",name:"Users Queue Size",id:"queue"},{path:"wallet.addresses.registration.unspents",name:"Unspents Count",id:"unspents"}]},balance:{caption:"Registration Address Balance",series:[{path:"wallet.addresses.registration.balance",name:"Address Balance",id:"balance"}]}}},k={server:function(e){var t=g.charts.server.type,a=b.server[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},i=0,t=[c];return a.objects&&(t=deep(c,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:m[i%m.length],type:e.type},i++})}),{meta:n,series:o}},nodes:function(e){var t=g.charts.nodes.type,n=b.nodes[t],t={type:"spline",xtype:"datetime",caption:n.caption},a={},o=0;return c.nodeManager&&_.each(c.nodeManager.nodes,function(e,t){_.each(n.series,function(e){a[e.id+t]={name:e.name+": "+t,path:"nodeManager.nodes.'"+t+"'."+e.path,color:m[o%m.length],type:e.type},o++})}),{meta:t,series:a}},peertube:function(e){var t=g.charts.peertube.type,n=b.peertube[t],t={type:"spline",xtype:"datetime",caption:n.caption},a={},o=0;return c.peertube&&_.each(c.peertube,function(e,t){_.each(n.series,function(e){a[e.id+t]={name:e.name+": "+t,path:"peertube.'"+t+"'."+e.path,color:m[o%m.length],type:e.type},o++})}),console.log("series",a),{meta:t,series:a}},wallets:function(e){var t=g.charts.wallets.type,a=b.wallets[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},i=0,t=[c];return a.objects&&(t=deep(c,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:m[i%m.length],type:e.type},i++})}),{meta:n,series:o}}},w={prepare:function(e,t,n){var a=s(e,t),e=_.clone(a.meta),t=r(a,t);return(e=new P.app.platform.objects.graph({el:n,shell:P.shell,chart:e})).series=t,e},graph:function(a,e,t,n){var o=w.prepare(a,e,t);s(a,e),o.render({height:250,maxPointsCount:50},function(){g.charts[a].showed&&t.find(".graphWrapper").addClass("showed"),t.find(".showgraphwrapper").on("click",function(){t.find(".graphWrapper").toggleClass("showed"),g.charts[a].showed=t.find(".graphWrapper").hasClass("showed"),o.chart.reflow()}),t.find(".subcaptiongraph").on("click",function(){var n=[];_.each(b[a],function(e,t){n.push({text:e.caption,action:function(e){g.charts[a].type=t,w.make(a,p),e()}})}),menuDialog({items:n})}),n&&n(o,t)})},make:function(t,e,n,a){var o,i;l.c&&(f[t]&&a?(i=r(o=s(t,e),e),i=f[t].rarefied(i,50),P.app.platform.focus&&(console.log("focus"),f[t].chart.update({series:i}))):(o=l.c.find("."+t+"chart"),i=$("<div></div>",{class:"chartWrapper"}),o.html(i),w.graph(t,e,i,function(e){f[t]=e,n&&n()},a)))}},x={addproxy:function(s,r){var l=!1,e=P.app.localization.e("e13054"),t=P.app.localization.e("add");s&&(l=s.id,e=P.app.localization.e("e13055"),t=P.app.localization.e("save")),s=s||{};var c={host:new Parameter({type:"STRING",name:P.app.localization.e("e13056"),id:"host",defaultValue:s.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:s.port||"8899",placeholder:"8899",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"wss",defaultValue:s.wss||"8099",placeholder:"8099",require:!0})},t={close:{class:"close",html:'<i class="fas fa-times"></i> '+P.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+t,fn:function(n,a){var o,t={},i=!0;_.each(c,function(e){t[e.id]=e.value||s[e.id],e.value||(i=!1)}),i?(t.user=!0,o=new Proxy16(t,P.app),P.app.api.get.byid(o.id)?sitemessage(P.app.localization.e("e13058")):(n.find(".addproxy").addClass("loading"),o.api.ping().then(e=>{var t;(t=l?P.app.api.editproxy(l,o.export()):P.app.api.addproxy(o.export()))?(r&&r(t),a.close()):sitemessage("Unable to add Proxy"),n.find(".addproxy").removeClass("loading")}).catch(e=>{n.find(".addproxy").removeClass("loading"),sitemessage("Unable to connect")}))):sitemessage(P.app.localization.e("e13057"))}}};l&&(t.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+P.app.localization.e("delete"),fn:function(e,t){dialog({class:"zindex",html:P.app.localization.e("e13059"),success:function(){var e=l.id==d.get.current().id;P.app.api.removeproxy(s.id),r&&r(null,e),t.close()}})}}),P.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:c},wnd:{header:e,buttons:t,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(c),e.el),e.el.find(".host input").focus()})},proxieslist:function(o,i,s){o=o||{};var e=P.app.api.get.proxies(),t={close:{class:"close",html:'<i class="fas fa-times"></i> '+P.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+P.app.localization.e("e13054"),fn:function(e,t){y.proxy.add(function(e){t.close(),x.proxieslist(o,i,s)})}}},e={destroy:function(){},name:"proxieslist",data:{proxies:e,proxy:o},wnd:{header:i,noInnerScroll:!0,class:"proxieslistwnd",buttons:t},insert:"wnd"};P.fastTemplate("proxieslist",function(e){new wnd({content:e,app:P.app,header:i,noInnerScroll:!0,class:"proxieslistwnd",buttons:t,clbk:function(a){a.el.find(".proxy").length?a.el.find(".proxieslist").removeClass("empty"):a.el.find(".proxieslist").addClass("empty"),a.el.find(".name").on("click",function(){var e=$(this).closest(".proxy").hasClass("active"),t=$(this).closest(".proxy").attr("pid");e||((t=P.app.api.get.byid(t))?s&&(s(t),a.close()):sitemessage("Error"))}),a.el.find(".delete").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=P.app.api.get.byid(e),n=d.get.current().id==e;t&&dialog({class:"zindex",html:P.app.localization.e("e13059"),success:function(){P.app.api.removeproxy(t.id),n&&T(d.get.current()),a.close(),x.proxieslist(o,i,s)}})}),a.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=P.app.api.get.byid(e),n=d.get.current().id==e;t&&y.proxy.edit(t,function(e){n&&T(d.get.current()),a.close(),x.proxieslist(o,i,s)})})}})},e.data)},addbotlist:function(){console.log("addbots");var n=inputDialogNew({caption:"Add Address to Proxy Bot List",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Addresses",label:"Bots addresses",text:!0}],success:function(e){var t=e[0].split(/[ \t\n\r]+/g);if(!(t=_.filter(t,function(e){var t=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){t=!1}return console.log("address",e,t),t})).length)return sitemessage("Addresses is not valid"),!1;topPreloader(30),i.fetchauth("manage",{action:"bots.addlist",data:{addresses:t}}).then(e=>{_.each(t,function(e){u.push(e)}),C.botscontent(l.c),n.destroy(),topPreloader(100)}).catch(e=>{console.log("E",e),sitemessage(P.app.localization.e("e13293")),topPreloader(100)})}})},addbot:function(){console.log("addbots");var a=inputDialogNew({caption:"Add Address to Proxy Bot List",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Address",label:"Bot address"}],success:function(e){var t=e[0];if(t){var n=!0;try{bitcoin.address.fromBase58Check(t)}catch(e){n=!1}}if(!n)return sitemessage("Address is not valid"),!1;topPreloader(30),i.fetchauth("manage",{action:"bots.add",data:{address:t}}).then(e=>{u.push(t),C.botscontent(l.c),a.destroy(),topPreloader(100)}).catch(e=>{console.log("E",e),sitemessage(P.app.localization.e("e13293")),topPreloader(100)})}})},addadmin:function(){var n=inputDialogNew({caption:"Add Admin to Proxy",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Address",label:"Admin address"}],success:function(e){if(e=e[0]){var t=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){t=!1}}if(!t)return sitemessage("Address is not valid"),!1;topPreloader(30),i.fetchauth("manage",{action:"set.admins.add",data:{address:e}}).then(e=>{y.refresh(),n.destroy(),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),topPreloader(100)})}})}},C={allsettings:function(){l.c&&(C.nodecontentmanage(l.c),C.nodecontentstate(l.c))},proxycurrent:function(t){var e=d.get.current();P.shell({inner:html,name:"proxycurrent",data:{proxies:d.get.proxies(),current:i,using:e,admin:y.admin()},el:l.proxycurrent},function(e){e.el.find(".current").on("click",y.proxy.selectWatch),e.el.find(".selectusing").on("click",y.proxy.selectUsing),t&&t()})},error:function(e,t,n){P.shell({inner:html,name:"error",data:{error:v[e]||v.undefinedError},el:t},function(e){e.el.find(".refreshpage").on("click",function(){T(i)}),n&&n()})},proxycontent:function(t){c?P.shell({inner:html,name:"proxycontent",data:{info:c,proxy:i,admin:y.admin()},el:l.proxycontent},function(e){C.servercontent(e.el),C.nodescontent(e.el),C.peertubecontent(l.c),C.nodecontent(e.el),C.bots(e.el),t&&t()}):C.error("unableProxyConnect",l.proxycontent)},bots:function(t,n){y.admin()&&P.shell({inner:html,name:"webbots",data:{admin:y.admin()},el:t.find(".botsWrapper")},function(e){e.el.find(".addbot").on("click",x.addbot),e.el.find(".addbotlist").on("click",x.addbotlist),C.botscontent(t),n&&n()})},botscontent:function(e,t){P.app.platform.sdk.users.get(u||[],function(){P.shell({inner:html,name:"webbotsContent",data:{admin:y.admin(),bots:u},el:e.find(".webbotsContentWrapper")},function(e){e.el.find(".exportlist").on("click",function(){text=u.join("\r\n"),copycleartext(text),sitemessage(P.app.localization.e("successcopied"))}),e.el.find(".removefromlist").on("click",function(){var e=$(this).attr("bot");e&&dialog({class:"zindex",html:"Do you really want to remove selected bot from Proxy server bot list?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){y.removeBot(e)}})}),t&&t()})})},servercontent:function(e,t){c?P.shell({inner:html,name:"servercontent",data:{info:c,proxy:i,admin:y.admin()},el:e.find(".serverWrapper")},function(){C.webservercontent(e),C.webadminscontent(e),C.webdistributioncontent(e),t&&t()}):t&&t()},webserverstatus:function(e,t){c?P.shell({inner:html,name:"webserverstatus",data:{info:c,proxy:i,admin:y.admin()},el:e.find(".webserverstatusWrapper")},function(e){t&&t()}):t&&t()},webservercontent:function(e,t){c?P.shell({inner:html,name:"webservercontent",data:{info:c,proxy:i,admin:y.admin()},el:e.find(".webServerWrapper")},function(e){C.webserverstatus(e.el),C.webserveradmin(e.el),t&&t()}):t&&t()},webserveradmin:function(t,n){y.admin()&&o?P.shell({inner:html,name:"webserveradmin",data:{admin:y.admin(),system:o,proxy:i,changes:h.server},el:t.find(".adminPanelWrapper")},function(e){y.settings(e.el),e.el.find(".todefaultcert").on("click",function(){dialog({class:"zindex",html:"Do you really want to cancel Certificate changes and set Default self-signed Certificate?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){i.fetchauth("manage",{action:"set.server.defaultssl",data:{}}).catch(e=>Promise.resolve()).then(e=>{T(i||d.get.current()),topPreloader(100)})}})}),e.el.find(".save").on("click",function(){function e(){globalpreloader(!0),i.fetchauth("manage",{action:"set.server.settings",data:{settings:h.server}}).catch(e=>(globalpreloader(!1),Promise.resolve())).then(e=>{h.server={},T(i||d.get.current()),globalpreloader(!1),topPreloader(100)})}(h.server.https||h.server.wss)&&(h.server.ports={https:h.server.https,wss:h.server.wss}),void 0!==h.server.enabled||h.server.https||h.server.wss||h.server.ssl?dialog({class:"zindex",html:"Do you really want to change this settings?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){e()}}):e()}),e.el.find(".clearfirebase").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear all firebase settings?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){i.fetchauth("manage",{action:"set.server.firebase.clear",data:{}}).then(e=>{T(i||d.get.current())}).catch(e=>{sitemessage(P.app.localization.e("e13293"))})}})}),e.el.find("[remove]").on("click",function(){var e=$(this).attr("remove");e&&delete h.server[e],C.webserveradmin(t)}),e.el.find(".discard").on("click",function(){h.server={},C.webserveradmin(t)}),e.el.find(".domain").on("change",function(){var e=$(this).val();$(this).val(e),e==o.server.domain?delete h.server.domain:h.server.domain=e,C.webserveradmin(t)}),e.el.find(".httpsport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==o.server.https?delete h.server.https:h.server.https=e,C.webserveradmin(t)}),e.el.find(".wsssport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==o.server.wss?delete h.server.wss:h.server.wss=e,C.webserveradmin(t)}),n&&n()}):n&&n()},webadminscontent:function(e,t){P.app.platform.sdk.users.get(c.admins,function(){P.shell({inner:html,name:"webadminscontent",data:{admins:c.admins,info:c,proxy:i,admin:y.admin()},el:e.find(".webAdminsWrapper")},function(e){e.el.find(".addadmin").on("click",x.addadmin),e.el.find(".remove").on("click",function(){var e,t=$(this).attr("address");t&&(e="Do you really want to remove selected admin from Proxy server admin list?",t==P.app.platform.sdk.address.pnet().address&&(e="Do you really want to remove Your account from Proxy server admin list?"),dialog({class:"zindex",html:e,btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){y.removeAdmin(t)}}))}),t&&t()})})},webdistributionwallets:function(e,t){P.shell({inner:html,name:"webdistributionwallets",data:{wallets:c.wallet,info:c,proxy:i,admin:y.admin()},el:e.find(".webdistributionwalletsWrapper")},function(e){e.el.find(".coins").on("click",function(){var t,e=$(this).closest(".wallet").attr("key");console.log("key",e,c.wallet),!e||(t=deep(c.wallet,"addresses."+e+".address"))&&dialog({class:"zindex",html:"Do you really want to send 1 PKOIN to this coin distribution address?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){topPreloader(30);var e=P.app.user.private.value.toString("hex");y.dust(e,t,2,function(e){y.refresh(),topPreloader(100),e||dialog({class:"one",html:"Pocketcoins sent to address. They will be available in several minutes"})})}})}),e.el.find(".settings").on("click",function(){var t,n=$(this).closest(".wallet").attr("key");n&&(t=inputDialogNew({caption:"Add Private Key To Coins Distribution",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Private Key (WIF Format)",label:"Private Key"}],success:function(e){e=e[0],topPreloader(30),i.fetchauth("manage",{action:"set.wallet.setkey",data:{key:n,privatekey:e}}).then(e=>{y.refresh(),t.destroy(),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),topPreloader(100)})}}))}),e.el.find(".remove").on("click",function(){var e=$(this).closest(".wallet").attr("key");e&&dialog({class:"zindex",html:"Do you really want to remove this private key from coins distribution process?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){topPreloader(30),i.fetchauth("manage",{action:"set.wallet.removeKey",data:{key:e}}).then(e=>{y.refresh(),topPreloader(100)}).catch(e=>{sitemessage(P.app.localization.e("e13293")),topPreloader(100)})}})}),t&&t()})},webdistributioncontent:function(e,t){P.shell({inner:html,name:"webdistributioncontent",data:{wallets:c.wallet,info:c,proxy:i,admin:y.admin()},el:e.find(".webDistributionWrapper")},function(e){C.webdistributionwallets(e.el),t&&t()})},peertubecontent:function(e,t){c?P.shell({inner:html,name:"peertubecontent",data:{info:c,proxy:i,admin:y.admin()},el:e.find(".peertubeWrapper")},function(){C.peertubeinstancestable(e),t&&t()}):t&&t()},peertubeinstancestable:function(e,t){console.log("info",c),P.shell({inner:html,name:"peertubeinstancestable",data:{info:c,proxy:i,admin:y.admin(),fixedinstance:null,currentinstance:null},el:e.find(".peertubeWrapper .instances")},function(e){t&&t()})},nodescontent:function(e,t){c?P.shell({inner:html,name:"nodescontent",data:{info:c,manager:c.nodeManager,proxy:i,admin:y.admin()},el:e.find(".nodesWrapper")},function(){e.find(".addnode").on("click",function(){y.addnode()}),C.nodescontenttable(e),t&&t()}):t&&t()},nodescontenttable:function(a,t){var e=d.get.current(),o=null;e.id==i.id&&i.current&&(o=i.current.key),P.shell({inner:html,name:"nodescontenttable",data:{info:c,manager:c.nodeManager,proxy:i,admin:y.admin(),currentnode:o,fixednode:d.get.fixednode()},el:a.find(".nodesWrapper .nodes")},function(e){e.el.find(".use").on("click",function(){var t,e=$(this).closest(".node").attr("node"),n=(t=$(this).closest(".node").attr("node"),_.find(c.nodeManager.nodes,function(e){return e.node.key==t}));"tmp"!=$(this).closest(".nodeWrapper").attr("key")&&n&&(e==o?d.get.fixednode()==e?(d.set.fixednode(null),C.nodescontenttable(a)):dialog({class:"zindex",html:"Do you really want to fix selected Pocketnet Node?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){d.set.fixednode(e),C.nodescontenttable(a)}}):dialog({class:"zindex",html:"Do you really want reconnect to selected Pocketnet Node?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){d.set.fixednode(null),i.changeNode(n.node),C.nodescontenttable(a)}}))}),e.el.find(".name").on("click",function(){}),t&&t()})},nodecontent:function(e,t){y.admin()?P.shell({inner:html,name:"nodecontent",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,proxy:i,admin:y.admin()},el:e.find(".localnodeWrapper")},function(){C.nodecontentstate(e),t&&t()}):t&&t()},nodecontentmanagestacking:function(e,t){y.admin()&&a&&P.shell({inner:html,name:"nodecontentmanagestacking",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:i,admin:y.admin(),system:o,stacking:a},el:e.find(".stacking")},function(e){e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(P.app.localization.e("successcopied"))}),t&&t()})},nodecontentmanage:function(e,n){var t,a;y.admin()&&(a=!1,(t=deep(c,"nodeControl.state.timestamp"))&&(a=new Date<fromutc(new Date(t).addSeconds(60))),P.shell({inner:html,name:"nodecontentmanage",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:i,admin:y.admin(),system:o,dis:a},el:e.find(".localnodeWrapper .manage")},function(e){function t(){e.el.find(".nodecontentmanage").addClass("lock")}console.log("info.nodeControl.state",c.nodeControl.state,c.nodeControl),z.stacking(),y.settings(e.el),e.el.find(".refreshstacking").on("click",function(){z.stacking(!0)}),e.el.find(".addstacking").on("click",function(){var o=inputDialogNew({caption:"Add Private Key To Address Stacking",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Private Key (WIF Format)",label:"Private Key"}],success:function(e){function t(){n||(clearTimeout(a),n=!0,z.stacking(!0),o.destroy(),topPreloader(100))}var e=e[0],n=!1,a=setTimeout(function(){t(),sitemessage("Stacking address will be added soon")},2e3);return topPreloader(30),i.fetchauth("manage",{action:"set.node.stacking.import",data:{privatekey:e}}).then(e=>{t()}).catch(e=>{n||(clearTimeout(a),sitemessage(deep(e,"message")||P.app.localization.e("e13293")),topPreloader(100))}),!1}})}),e.el.find(".updatenode").on("click",function(){dialog({class:"zindex",html:"Do you really want to Stop Pocketnet Node and Update It?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){t(),y.updateNode()}})}),e.el.find(".removenodeall").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove Pocketnet Node and All Blockchain Data?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){t(),y.removeNode(!0)}})}),e.el.find(".removenode").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove Pocketnet Node Daemon?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){t(),y.removeNode()}})}),e.el.find(".install").on("click",()=>{topPreloader(20),dialog({class:"zindex",html:"Do you really want to install Pocketnet Node?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){t(),y.installNode()}})}),e.el.find(".toDefaultPath").on("click",function(){dialog({class:"zindex",html:"Do you really want to set Pocketnet Node Path to Default path?",btn1text:P.app.localization.e("dyes"),btn2text:P.app.localization.e("dno"),success:function(){globalpreloader(!0),i.fetchauth("manage",{action:"set.node.defaultPaths",data:{}}).then(e=>{y.refresh().then(e=>{y.refreshsystem(),globalpreloader(!1)})}).catch(e=>{globalpreloader(!1),sitemessage(P.app.localization.e("e13293"))})}})}),e.el.find(".refreshother").on("click",function(){globalpreloader(!0),i.fetchauth("manage",{action:"set.node.check",data:{}}).then(e=>{y.refresh().then(e=>{y.refreshsystem(),setTimeout(function(){globalpreloader(!1)},300)})}).catch(e=>{setTimeout(function(){globalpreloader(!1)},300),sitemessage(P.app.localization.e("e13293"))})}),n&&n()}))},nodecontentstate:function(e,t){y.admin()&&P.shell({inner:html,name:"nodecontentstate",data:{info:c,manager:c.nodeManager,nodestate:c.nodeControl.state,nc:c.nodeControl,proxy:i,admin:y.admin()},el:e.find(".localnodeWrapper .state")},function(){t&&t()})}},z={stacking:function(t){y.admin()&&(!a||t)&&deep(c,"nodeControl.enabled")?i.fetchauth("manage",{action:"set.node.stacking.addresses",data:{}}).then(e=>{a=e,C.nodecontentmanagestacking(l.c),topPreloader(100)}).catch(e=>{t&&sitemessage(deep(e,"message")||P.app.localization.e("e13293")),topPreloader(100)}):C.nodecontentmanagestacking(l.c)},panel:function(){C.nodecontentmanage(l.c),C.nodecontentstate(l.c),C.nodescontenttable(l.c),C.peertubeinstancestable(l.c),C.webadminscontent(l.c),C.webdistributionwallets(l.c),C.webserveradmin(l.c)},stats:function(e){p&&(w.make("server",p,null,e),w.make("nodes",p,null,e),w.make("wallets",p,null,e),w.make("peertube",p,null,e))},proxycurrent:function(){C.proxycurrent(function(){z.proxycontent()})},proxycontent:function(){C.proxycontent(function(){})}},T=function(e){n(),i=e,c=null,p=[],u=[],f={};var t=l.c.find(".collapsepart").map(function(){return $(this).hasClass("expanded")});i?(i.clbks.changed.components=()=>{T(d.get.current())},i.clbks.changednode.components=()=>{C.nodescontenttable(l.c)},i.clbks.tick.components=y.tick,i.system.clbks.tick.components=y.ticksettings,i.get.info().then(e=>((c=e.info).server.listening&&c.wss.listening&&(g.charts.server.showed=!0),y.admin()&&(g.charts.nodes.showed=!0),p=[{info:c,time:utcnow()}],z.proxycurrent(),i.get.stats())).then(e=>{if(p=e.stats,p=lastelements(p,1e3),y.convertTime(p),setTimeout(function(){z.stats(),z.panel(),C.webserveradmin(l.c)},500),y.admin())return i.system.request("get.settings").then(e=>(o=e,C.allsettings(),Promise.resolve())).then(e=>i.system.request("bots.get")).then(e=>{u=e.bots||[],C.bots(l.c),l.c.find(".collapsepart").each(function(e){t[e]&&$(this).addClass("expanded")})})}).catch(e=>{z.proxycurrent()})):C.proxycurrent()};return{primary:e,getdata:function(e){d=P.app.api,e({})},destroy:function(){n(),l={}},init:function(e){(l={}).c=e.el.find("#"+P.map.id),l.proxycurrent=l.c.find(".proxycurrentWrapper"),l.proxycontent=l.c.find(".proxycontentWrapper"),l.c.on("click",".collapsepart .subcaption",function(){$(this).closest(".collapsepart").toggleClass("expanded")}),T(d.get.current()),e.clbk(null,e),P.app.errors.clbks.system16=function(){c||P.app.errors.state.proxy||!i||T(i)}}}}var P=new nModule,a={};return P.run=function(e){var t=P.addEssense(a,n,e);P.init(t,e)},P.stop=function(){_.each(a,function(e){e.destroy()})},P}();"undefined"!=typeof module?module.exports=system16:(app.modules.system16={},app.modules.system16.module=system16);var categories=function(){function n(e){function a(){u.app.platform.sdk.categories.gettags().length?s.clearcategories.addClass("showed"):s.clearcategories.removeClass("showed")}function n(e){var n=!!e,a={name:(e=e||{name:"",tags:[],id:makeid(!0)}).name,tags:_.clone(e.tags),id:e.id};u.fastTemplate("addcategory",function(e){var t=dialog({html:e,class:"addcategorydialog",header:u.app.localization.e("addcategory"),btn1text:u.app.localization.e("dcancel"),btn2text:u.app.localization.e("save"),wrap:!0,clbk:function(e,t){d.tagsinput(e,a),e.find(".name").on("keyup",function(){a.name=flb($(this).val().replace(/[^a-zA-Zа-яА-Я0-9_ ]/g,""))}),e.find(".removecat").on("click",function(){dialog({class:"zindex",html:"Do you really want to remove this category?",btn1text:u.app.localization.e("dyes"),btn2text:u.app.localization.e("dno"),success:function(){u.app.platform.sdk.categories.remove(a.id),p(),t.destroy()}})})},success:function(){return!0},fail:function(){var e=u.app.platform.sdk.categories.add(a);return e?("name"==e&&(t.el.find(".name").focus(),sitemessage(u.app.localization.e("emptycategoryname"))),"doublename"==e&&(t.el.find(".name").focus(),sitemessage(u.app.localization.e("doublename"))),"tags"==e&&(t.el.find(".sminput").focus(),sitemessage(u.app.localization.e("emptytags"))),!1):(n||u.app.platform.sdk.categories.select(a.id),p(),!0)}})},{category:a,hasc:n})}function o(e,t){e=e.toLowerCase(),-1<_.indexOf(t.tags,e)||t.tags.push(e)}function i(t,e){e.tags=_.filter(e.tags,function(e){return e!=t})}var s,r,l,e=deep(e,"history"),c=!1,d={tagsinput:function(t,n){u.nav.api.load({open:!0,id:"taginput",el:t.find(".tagswrapper"),eid:"addcategorytags",animation:!1,essenseData:{tags:function(){return n.tags},removeTag:function(e){i(e,n),d.tagsinput(t,n)},removeTags:function(e){_.each(tags,function(e){i(e,n)}),d.tagsinput(t,n)},addTag:function(e){o(e,n),d.tagsinput(t,n)},addTags:function(e){_.each(e,function(e){o(e,n)}),d.tagsinput(t,n)},addonlytags:!0,placeholder:u.app.localization.e("addtags")},clbk:function(e,t){s.c&&(l=t)}})},showhide:function(){c?s.c.addClass("showedallcats"):s.c.removeClass("showedallcats")},categories:function(e,t){s.c&&(e.length?(s.c.removeClass("hidden"),e=_.sortBy(e,function(e){return e.added?-1:e.selected?0:1}),u.shell({name:"categories",el:s.cats,data:{cats:e}},function(e){d.showhide(),e.el.find(".showhideallcats").on("click",function(){c=!c,d.showhide(),r.renderclbk&&r.renderclbk()}),e.el.find(".catcheckgl").on("click",function(){var e=$(this).closest(".tg").attr("category");u.app.platform.sdk.categories.select(e)}),e.el.find(".catedit").on("click",function(){var e=$(this).closest(".tg").attr("category");n(u.app.platform.sdk.categories.getbyid(e))}),r.renderclbk&&r.renderclbk(),t&&t()})):s.c.addClass("hidden"))}},p=function(){var e;cats=u.app.platform.sdk.categories.getwithselected(),e=cats,d.categories(e),a()};return{primary:e,getdata:function(e,t){r=t.settings.essenseData||{},(t={}).video=!!parameters().video,e(t)},destroy:function(){delete u.iclbks.maincat,l&&(l.destroy(),l=null),delete u.app.platform.sdk.categories.clbks.selected.mainmodule,s={}},init:function(e){(s={}).c=e.el.find("#"+u.map.id),s.cats=s.c.find(".cats"),s.addcategory=s.c.find(".addcategory"),s.clearcategories=s.c.find(".clearcategories"),u.app.platform.sdk.categories.clbks.tags.mainmodule=u.app.platform.sdk.categories.clbks.selected.mainmodule=function(e,t,n){e&&(e=s.c.find('.tg[category="'+e+'"]'),t?e.addClass("selected"):e.removeClass("selected"),a())},s.c.find(".addcategory").on("click",function(){n()}),s.c.find(".clearcategories").on("click",function(){dialog({class:"zindex",html:"Do you really want to clear category filters?",btn1text:u.app.localization.e("dyes"),btn2text:u.app.localization.e("dno"),success:function(){u.app.platform.sdk.categories.clear(),p()}})}),p(),e.clbk(null,e)}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=categories:(app.modules.categories={},app.modules.categories.module=categories);var article=function(){function n(e){var i,s,r,t,n,a,o=deep(e,"history"),c=/[,.!?;:()<> \n\r]/g,d={message:m.app.localization.e("emptymessage"),tags:m.app.localization.e("emptytags")},p={newart:function(){return m.app.platform.sdk.articles.empty()},complete:function(){r.save&&r.save(s),u.close(),r.complete&&r.complete(s)},change:function(e){s.content=e,s.time=Math.floor((new Date).getTime()/1e3),r.save&&r.save(s)},changecaption:function(e){s.caption.value=e,s.time=Math.floor((new Date).getTime()/1e3),r.save&&r.save(s)},trx:function(a,o){i.c&&i.c.addClass("loading"),r.share&&(a.aliasid=r.share.aliasid),console.log("share",a),m.sdk.node.transactions.create.commonFromUnspent(a,function(e,t){if(console.log("_alias",e),topPreloader(100),i.c&&i.c.removeClass("loading"),e)try{var n=new pShare;n._import(e,!0),n.temp=!0,n.address=e.address,a.aliasid&&(n.edit="true"),m.app.platform.sdk.node.shares.add(n),s.txid=n.txid,s.ptime=Math.floor((new Date).getTime()/1e3),p.complete()}catch(e){console.log(e)}else o?o(!1,d[t]):(t=m.app.platform.errorHandler(t,!0))&&sitemessage(t)},e)},fromShare:function(e){var t=m.app.platform.sdk.articles.empty();return t.caption.value=e.caption.v,t.content=[{value:e.message.v}],t.tags=_.clone(e.tags.v),t},add:function(){var e=new Share(m.app.localization.key),t=m.app.platform.sdk.articles.echo(s);(new Date).getTime(),e.message.set(t),e.caption.set(s.caption.value),e.images.set(m.app.platform.sdk.articles.getImages(t)),e.tags.set(s.tags||[]),e.settings.v="a",e.settings.videos=m.app.platform.sdk.articles.getVideos(t);var n=e.validation();console.log("ERROR",n),n?d[n]&&sitemessage(d[n]):(n="Do you really want to publish this article?",r.share&&(n="Do you really want to change and publish this article?"),dialog({html:n,btn1text:m.app.localization.e("dyes"),btn2text:m.app.localization.e("dno"),class:"zindex",success:function(){t=filterXSS(t,{stripIgnoreTag:!0,whiteList:{a:["href","title","target"],br:["style"],b:["style"],span:["style"],figure:["style"],figcaption:["style","class"],i:["style"],img:["src","width","height"],div:["class","data-plyr-provider","data-plyr-embed-id"],p:[],ul:[],ol:[],li:[],h2:[],h1:[],h3:[],h4:[],h5:[],em:[],u:[],blockquote:[],strong:[],picture:["img-type"],source:["srcset","type"],strike:[]}}),e.message.set(t),p.trx(e)}}))},tagsFromText:function(e){var e=e.split(c),n=_.filter(e,function(e){if("#"==e[0])return!!e.replace(/#/g,"")});return _.each(n,function(e,t){n[t]=e.replace(/\#/g,"")}),n},_addtag:function(e){return s.tags.length<5&&(removeEqual(s.tags,e),s.tags.push(e),!0)},addTags:function(e){_.find(e,function(e){if(!p._addtag(e))return sitemessage(m.app.localization.e("e13162")),!0}),r.save&&r.save(s)},addTag:function(e){p._addtag(e)?r.save&&r.save(s):sitemessage(m.app.localization.e("e13162"))},_removetag:function(e){removeEqual(s.tags,e)},removeTags:function(e){_.each(e,function(e){p._removetag(e)}),r.save&&r.save(s)},removeTag:function(e){p._removetag(e),r.save&&r.save(s)}},u={authorclose:function(){m.nav.api.load({open:!0,href:"author?address="+m.app.user.address.value.toString("hex"),history:!0}),m.closeContainer(),r.closeContainer&&r.closeContainer()},changecaption:function(){var e=$(this).val();p.changecaption(e)},change:function(){n=slowMade(function(){var e=m.app.platform.sdk.articles.lightVideo(t.serialize());p.change(e)},n,300)},close:function(){r.close&&r.close(),m.closeContainer()},add:function(){p.add()},goto:function(){s.txid&&(m.closeContainer(),r.closeContainer&&r.closeContainer(),m.nav.api.load({open:!0,href:"index?s="+s.txid,history:!0}))}},f={art:function(e,t){i.caption.val(e.caption.value)},tgs:function(n){m.nav.api.load({open:!0,id:"taginput",el:i.tgsWrapperMain,eid:"articletags",animation:!1,essenseData:{tags:function(){return s.tags||[]},removeTag:function(e){p.removeTag(e),f.tgs()},removeTags:function(e){p.removeTags(e),f.tgs()},addTag:function(e){p.addTag(e),f.tgs()},addTags:function(e){p.addTags(e),f.tgs()}},clbk:function(e,t){i.c&&(a=t,n&&n())}})}};return{primary:o,getdata:function(e,t){r=t.settings.essenseData||{},s=r.art||p.newart(parameters().aid),r.share&&(s=p.fromShare(r.share)),console.log("ed",r),s.tags||(s.tags=[]),console.log("art",s),e({art:s,ed:r})},destroy:function(){m.app.nav.api.history.removeParameters(["aid"]),a&&(a.destroy(),a=null),i={}},init:function(e){(i={}).c=e.el.find("#"+m.map.id),i.caption=i.c.find(".caption"),i.content=i.c.find(".content"),i.back=i.c.find(".back"),i.add=i.c.find(".add"),i.goto=i.c.find(".goto"),i.tgsWrapperMain=i.c.find(".tgsWrapperMain"),i.back.on("click",u.close),i.caption.on("keyup",u.changecaption),i.add.on("click",u.add),i.goto.on("click",u.goto),i.c.find(".uic").on("click",u.authorclose),i.c.find(".username").on("click",u.authorclose),f.tgs(),t=new MediumEditor(".edt",{delay:500,targetBlank:!0,toolbar:{buttons:["bold","italic","underline","anchor","quote"],diffLeft:25,diffTop:10},anchor:{placeholderText:"Type a link",customClassOption:"btn",customClassOptionText:"Create Button"},paste:{cleanPastedHTML:!0,cleanAttrs:["style","dir"],cleanTags:["label","meta"]},anchorPreview:{hideDelay:300},placeholder:{text:"Text",hideOnClick:!1}}),$(function(){$(".edt").mediumInsert({editor:t,addons:{images:{label:'<span class="fas fa-camera"></span>',deleteScript:function(e,t){m.sdk.imagesH.delete(e)},fileDeleteOptions:{},preview:!0,captions:!0,captionPlaceholder:m.app.localization.e("e13013"),autoGrid:3,formData:{},upload:function(e,n){resize(e,1080,1080,function(e){var t=e.split(",");t[1]&&m.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:t[1]},success:function(e){var t=deep(e,"data.link");t?(e=deep(e,"data.deletehash"))&&m.sdk.imagesH.add(t,e):t="https://"+m.app.options.url+"/img/imagenotuploaded.jpg",n&&n(t)},fail:function(e){app.ajax.run({type:"POST",up1:!0,data:{file:t[1]},success:function(e){e="https://"+m.app.options.url+":8092/i/"+deep(e,"data.ident"),n&&n(e)},fail:function(e){l="https://"+m.app.options.url+"/img/imagenotuploaded.jpg",n&&n(l)}})}})})},fileUploadOptions:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var t=$.Event("keydown");t.which=8,$(document).trigger(t)}}},messages:{acceptFileTypesError:m.app.localization.e("e13014")+" ",maxFileSizeError:m.app.localization.e("e13015")+" "},uploadCompleted:function(e,t){u.change()},uploadFailed:function(e,t){}},embeds:{label:'<span class="fas fa-play"></span>',placeholder:m.app.localization.e("e13016"),styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var t=$.Event("keydown");t.which=8,$(document).trigger(t)}}}}}}),t.subscribe("editableKeyup",function(){u.change()}),t.subscribe("editablePaste",function(){u.change()}),t.subscribe("editableBlur",function(){u.change()}),f.art(s),Plyr.setup(".js-player",function(e){})}),e.clbk(null,e)},wnd:{class:"allscreen a100 article articlebtn"}}}var m=new nModule,a={};return m.run=function(e){var t=m.addEssense(a,n,e);m.init(t,e)},m.stop=function(){_.each(a,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=article:(app.modules.article={},app.modules.article.module=article);var lastcomments=function(){function n(e){function s(){var e=$(this).attr("id"),t=$(this).attr("pid"),n=$(this).closest(".commentgroup").attr("share");d.app.platform.app.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,history:!0,clbk:function(e,t){app.nav.wnds.post=t},essenseData:{share:n,hr:"index?",reply:{answerid:e,parentid:t||"",noaction:!0}}})}var r,e=deep(e,"history"),l=null,c=function(){d.app.platform.sdk.comments.last(function(t,o){var i=group(t,function(e){return e.txid}),e=_.map(i,function(e,t){return t});d.app.platform.sdk.node.shares.getbyid(e,function(e,n){var a=[];_.each(t,function(e){var t=app.platform.sdk.node.shares.storage.trx[e.txid];t&&e&&(a.push(t.address),a.push(e.address))}),a=_.uniq(a),d.sdk.users.get(a,function(e,t){!function(e){if(r.c){if(o||n||t)return d.iclbks.main=c,r.c.addClass("hidden");r.c.removeClass("hidden"),d.shell({name:"lastcommentslist",el:r.c,data:{comments:e}},function(e){e.el.find(".comment").on("click",s),e.el.find(".image").imagesLoaded({background:!0},function(e){l.renderclbk&&l.renderclbk()}),l.renderclbk&&l.renderclbk()})}}(i)},!0)})})};return{primary:e,getdata:function(e,t){l=t.settings.essenseData||{},e({})},destroy:function(){r={},console.log("DESTROYED"),delete d.app.platform.ws.messages.newblocks.clbks.lastcomments,delete d.app.platform.ws.messages["new block"].clbks.lastcomments,delete d.app.platform.clbks._focus.lastcomments},init:function(e){(r={}).c=e.el.find("#"+d.map.id),d.app.platform.ws.messages.newblocks.clbks.lastcomments=d.app.platform.ws.messages["new block"].clbks.lastcomments=function(e,t){console.log("CLBKS"),c()},d.app.platform.clbks._focus.lastcomments=function(e){120<e&&"undefined"!=typeof _Electron&&(console.log("CLBKS2"),c())},c(),e.clbk(null,e)}}}var d=new nModule,a={};return d.run=function(e){var t=d.addEssense(a,n,e);d.init(t,e)},d.stop=function(){_.each(a,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=lastcomments:(app.modules.lastcomments={},app.modules.lastcomments.module=lastcomments);var video=function(){function n(e){function t(){i.join()}var o,s,e=deep(e,"history"),r=[{key:"gMrKZfHJSxA",width:560,height:315,source:"youtube",loc:{en:{title:"Pocketnet - Decentralized Social Network on the Blockchain",id:"gMrKZfHJSxA",description:"Pocketnet is a fully decentralized publishing and social platform. Based on the blockchain technology, it runs on a set of computers around the world, not controlled by any single entity.No corporation behind it to take fruits of your labor. All advertising revenue is split equally between node operators and those who publish highly rated content. Your subscribers always see your content, unless they decide to unsubscribe. Pocketnet is self-policed by the platform participants with good reputation. Nobody records your keystrokes, viewing habits or searches. Join The New Peer-To-Peer Internet: Go to Pocketnet.app and join for free now"}}}],i={validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,t,n,a){a=a||"4",(t={Email:e,Name:t,Lang:l.app.localization.key||"en"}).Action||(t.Action="ADDTOMAILLIST"),t.TemplateID||(t.TemplateID=a),$.ajax({type:"POST",url:"https://"+l.app.options.url+"/Shop/AJAXMain.aspx",data:t,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){l.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){l.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".email"),e=e.el.find(".name"),t=t.val(),e=e.val();if(i.validateEmail(t)&&e)return i.saveEmail(t,e),i.joinSuccess(t,e),!0},clbk:function(e){function t(){var e=a.val(),t=n.val();return i.validateEmail(e)&&t?(o.removeClass("disabled"),!0):(o.addClass("disabled"),!1)}var n=e.find(".name"),a=e.find(".email"),o=e.find(".btn1");o.addClass("disabled"),o.on("click",function(){}),n.focus(),n.on("change",t),n.on("keyup",t),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})},{action:e})}};return{primary:e,getdata:function(e,t){var n=parameters();function a(){l.nav.api.load({open:!0,href:"page404",history:!0})}n.v||(n.v="gMrKZfHJSxA");var o,i=_.find(r,function(e){return e.key==n.v});i?(l.app.el.menu.addClass("logoview").addClass("landing"),o=s=_.clone(i),(i=deep(o,"loc.en")||null)&&_.extend(o,i),s.id?e(s):a()):a()},destroy:function(){o={},l.app.el.menu.removeClass("logoview").removeClass("landing"),l.app.el.app.removeClass("videoActive")},init:function(a){(o={}).c=a.el.find("#"+l.map.id),o.container=o.c.find(".container"),o.c.click&&o.c.click(),l.app.el.app.addClass("videoActive"),o.c.find(".joinbeta").on("click",t),setTimeout(function(){var e,t,n='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+s.id+'?rel=0&amp;autoplay=1" frameborder="0" allow="autoplay;" allowfullscreen></iframe>';"vimeo"==s.source&&(n='<iframe src="https://player.vimeo.com/video/'+s.id+'?title=0&byline=0&portrait=0" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),"bitchute"==s.source&&(n='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://www.bitchute.com/embed/'+s.id+'/"></iframe>'),"peertube"==s.source&&(n='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://pocketnetpeertube1.nohost.me/videos/embed/'+s.id+'/"></iframe>'),o.c.find(".container").html(n),s.description&&o.c.find(".description").html(s.description),e=s,e=(n=(t=o.container).width())/(e.width/e.height),t.find("iframe").width(n),t.find("iframe").height(e),o.container.find("iframe").fadeIn(200),o.c.find(".description").fadeIn(200),a.clbk(null,a)},100)},animation:!1}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,n,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=video:(app.modules.video={},app.modules.video.module=video);var proxylogs=function(){function n(e){function o(e){e.find(".expandall").on("click",function(){$(this).closest(".report").toggleClass("active")})}var i,e=deep(e,"history"),r={requests:{ws:{path:"ws",name:"Websocket connections",color:"#006CFF"},requests:{path:"requestsIp",name:"Https requests ip",color:"#FF004E"}},blacklists:{black:{path:"iplimiter.black",name:"Black list ip count",color:"#20C02B"},tblack:{path:"iplimiter.black",name:"Temp Black list ip count",color:"#00C0FF"}}},s={prepare:function(e,t,n){var o,i,a=(s={type:"spline",xtype:"datetime"},"requests"==(a=e)&&(s.caption="Connections"),"blacklists"==a&&(s.caption="Black list"),s),s=(o=t,i=[],_.each(r[e],function(n){var a={color:n.color,data:[],name:n.name};_.each(o,function(e){var t=deep(e,n.path)||0;a.data.push({y:t,x:new Date(e.time)})}),i.push(a)}),i);return console.log(e,s,t),(a=new c.app.platform.objects.graph({el:n,shell:c.shell,chart:a})).series=s,a},make:function(e,t,n,a){var o=s.prepare(e,t,n);o.render({maxPointsCount:100},function(){a&&a(o)})}},l={users:function(e){var t=[],n=e.find(".loadaddress");n.each(function(){var e=$(this).attr("address");e&&t.push(e)}),t.length&&c.shell({name:"user",data:{}},function(e){console.log(e),c.app.platform.sdk.users.get(t,function(e,t){n.each(function(){var e=$(this).attr("address");e&&($(this).removeAttr("address"),c.shell({name:"user",data:{address:e},el:$(this)},function(e){}))})})})},logs:function(a,t){c.shell({name:"logs",data:{logs:a},el:i.logs},function(e){o(e.el),e.el.find(".expand").on("click",function(){var e=$(this).closest(".log"),t=e.attr("ip"),n=_.find(a,function(e){return e.ip==t});e.hasClass("active")?e.toggleClass("active"):l.wslogs(e.find(".wslogswrp"),deep(n,"ws"),function(){e.toggleClass("active")},!0)}),t&&t()})},ws:function(t,n){c.shell({name:"ws",data:{ws:t},el:i.ws},function(e){o(e.el),l.wslogs(e.el.find(".wslogswrp"),t),n&&n()})},block:function(e,t){c.shell({name:"block",data:{block:e},el:i.block},function(e){o(e.el),t&&t()})},wslogs:function(e,t,n,a){c.shell({name:"wslogs",data:{ws:t,users:a},el:e},function(e){a&&l.users(e.el),e.el.find(".clickload").on("click",function(){l.users($(this).closest(".address"))}),n&&n()})},error:function(t){c.shell({name:"error",data:{},el:i.error},function(e){t&&t()})},stats:function(t,n){c.shell({name:"stats",data:{stats:t},el:i.stats},function(e){l.statsChart("requests",t,e.el.find(".chartswrapper")),l.statsChart("blacklists",t,e.el.find(".chartswrapper")),n&&n()})},statsChart:function(e,t,n,a){var o=$("<div></div>",{class:"chartWrapperbs"});n.append(o),s.make(e,t,o,a)}};return{primary:e,getdata:function(e){e({})},destroy:function(){i={}},init:function(e){var n;(i={}).c=e.el.find("#"+c.map.id),i.logs=e.el.find(".logsWrapper"),i.ws=e.el.find(".wsWrapper"),i.block=e.el.find(".blockWrapper"),i.stats=e.el.find(".statsWrapper"),i.error=e.el.find(".errorWrapper"),n=function(t){var n;t&&l.stats(t),n=function(e){e&&(l.logs(e.logs),l.ws(e.ws),l.block(e.blocks)),t||e||l.error()},c.app.platform.sdk.system.get.info(function(e,s){var r,t;console.log(e),s?(r=[],t={},e=group(s.logs,function(e){return e.ip}),_.each(e,function(e,n){var t=_.filter(s.ws,function(e){if(e.ip==n)return e.using=!0}),t=_.sortBy(t,function(e){return-(e.ws_clients+e.ws_nodes)}),a=_.find(s.iplimiter,function(e,t){if(t==n)return e.using=!0}),o={},i=group(e,function(e){return e.s});_.each(i,function(e,t){o[t]=group(e,function(e){return deep(e,"p.method")||deep(e,"pn")||"others"})}),r.push({ws:t,requests:o,ip:n,block:a,count:e.length})}),r=_.sortBy(r,function(e){return-(e.count+10*e.ws.length)}),t.logs=r,t.ws=_.filter(s.ws,function(e){return!e.using}),t.ws=_.sortBy(t.ws,function(e){return-(e.ws_clients+e.ws_nodes)}),t.blocks=_.filter(s.iplimiter,function(e,t){return e.ip=t,!e.using}),n(t)):n(null)})},c.app.platform.sdk.system.get.stats(function(e,t){n(e?null:t)}),e.clbk(null,e)}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=proxylogs:(app.modules.proxylogs={},app.modules.proxylogs.module=proxylogs);var help=function(){function n(e){var n,t,a,e=deep(e,"history"),o={};function i(e){a&&(a.destroy(),a=null),n.menuitem.removeClass("active"),n.c.find('.tipitem[page="'+e+'"]').addClass("active"),t=e,l.save(),r[e]?r[e](e):r.page(e)}function s(){i($(this).attr("page"))}o.roadmap=[{d:"February 2019",n:"Social Network Beta Test Starts",r:!0},{d:"March 2019",n:"Windows Desktop App",r:!0},{d:"March 2019",n:"Search users, posts",r:!0},{d:"July 2019",n:"Linux Desktop App",r:!0},{d:"July 2019",n:"Android App",r:!0},{d:"August 2019",n:"Search by tags, recommended users, poll transactions",r:!0},{d:"August 2019",n:"Personal link "+c.app.options.url+"/username plus history of personal posts and ability to search users’ posts (decentralized free blog hosting on Pocketnet blockchain)",r:!0},{d:"June 2020",n:"Running a node from the desktop app",r:!0},{d:"August 2020",n:"Pocketcoin listed on two exchanges: BTCPOP and Mercatox",r:!0},{d:"January 2021",n:"Full decentralization: all apps can speak directly to the nodes, desktop app can work without the website "+c.app.options.url,r:!0},{d:"May 2021",n:"Integration of PeerTube into Pocketnet, upload of videos and live streams",r:!1},{d:"June 2021",n:"Rewrite of the backend to move to sqlite from Reindexer to make the node light on RAM use",r:!1},{d:"June 2021",n:"Boost posts for Pocketcoin",r:!1},{d:"June 2021",n:"Peer-to-peer encrypted chat, including group chat",r:!1},{d:"July 2021",n:"Livestream Pocketcoin dondations",r:!1},{d:"July 2021",n:"Pocketnet NFT 3.0",r:!1},{d:"October 2021",n:"Decentralized reputation platform and crypto store",r:!1},{d:"December 2021",n:"Decentralized alternative to adwords advertising through smart contracts",r:!1},{d:"2022",n:"Ability to fork Pocketcoin to create a diverse set of Dapps for users using Pocketnet platform i.e. Pocketnet as an alternative Appstore",r:!1}],o.pkoin={loading:!0,emission:{api:"emission",result:null},blockhash:{api:"blockhash/12000.json",result:{}},emission2:{api:"emission/1000000.json",result:{}},topaddresses:{api:"topaddresses/10.json",result:[]}},o.topaddresses=[];var r={applications:function(e){this.page(e,function(e){c.nav.api.load({open:!0,id:"applications",el:e.find(".applicationsWrapper"),clbk:function(e,t){a=t}})})},faq:function(e){this.page(e,function(e){c.nav.api.load({open:!0,id:"faq",el:e.find(".faqWrapper"),clbk:function(e,t){a=t}})})},node:function(e){this.page(e,function(e){c.app.platform.papi.post("d85a0e1146e89ad6303cc8a081f1fb04da01ab21af913fa9e762de0d7972eaa6",e.find(".lenta"),function(e,t){a=t})})},videos:function(e){this.page(e,function(e){c.nav.api.load({open:!0,id:"lenta",el:e.find(".lenta"),animation:!1,mid:"videos",essenseData:{byauthor:!0,notscrollloading:!0,nocomments:!0,txids:["9f73a1efbfb4b0feb88c134740afa0ab293f8072a80ecbe9fe65ed85591910e6","ad9067c72a7be97c1752a00566940f372e5b526291278cf9bc203b99f81bbaf0","df4064b9e2c8b311fd097804f36802ceb68337dca396bfdea732c0f94c977a3a"]},clbk:function(e,t){a=t}})})},page:function(e,t){c.shell({name:e,el:n.page,data:{c:o}},function(e){t&&t(e.el)})},pkoin:function(e){this.page(e,function(t){o.pkoin.loading=!0,console.log("this.page",t);var n="https://explorer."+c.app.options.url+"/rest/",e=[o.pkoin.blockhash.api,o.pkoin.emission.api,o.pkoin.emission2.api,o.pkoin.topaddresses.api].map(function(e){return fetch(n+e)});Promise.all(e).then(function(e){return Promise.all(e.map(function(e,t){return 0===t?e.text():e.json()}))}).then(function(e){o.pkoin.blockhash.result=JSON.parse(e[0]),o.pkoin.emission.result=e[1],o.pkoin.emission2.result=e[2],o.pkoin.topaddresses.result=e[3],o.pkoin.loading=!1,r.page("pkoin"),t.find(".copyaddress").on("click",function(){copyText($(this).find(".adr")),sitemessage(c.app.localization.e("waddresswascop"))})})})}},l={save:function(){c.app.nav.api.history.addParameters({page:t})},load:function(){t=parameters().page||"faq"}};return{primary:e,getdata:function(e){l.load();var t=null;e({version:t="undefined"!=typeof _Electron?require("electron").remote.app.getVersion():t})},destroy:function(){a&&(a.destroy(),a=null),n={}},init:function(e){l.load(),(n={}).c=e.el.find("#"+c.map.id),n.page=n.c.find(".page"),n.menuitem=n.c.find(".tipitem"),n.caption=n.c.find(".bgCaption"),n.menuitem.on("click",s),n.caption.find(".checkversion").on("click",function(){var e;"undefined"!=typeof _Electron&&(n.caption.find(".checking").addClass("active"),e=require("electron"),setTimeout(function(){e.ipcRenderer.send("electron-checkForUpdates"),e.ipcRenderer.on("updater-message",function(e,t){("update-downloaded"==t.msg||"update-not-available"==t.msg||(t.linux||t.macos)&&"update-available"==t.msg)&&n.caption.find(".checking").removeClass("active")})},100))}),i(t),e.clbk(null,e)}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=help:(app.modules.help={},app.modules.help.module=help);var connection=function(){function n(e){function d(e,n){var t=u.app.platform.apiproxy;u.app.platform.apiproxy=e,u.app.platform.sdk.proxy.info(function(e,t){!t?n&&n(!0):(dialog({html:u.app.localization.e("e13052"),class:"one zindex"}),n&&n(!1))}),u.app.platform.nodeid=t}function t(){u.app.platform.dontuseapiproxy?c.using(!u.app.platform.dontuseapiproxy):dialog({html:u.app.localization.e("e13073"),class:"zindex",success:function(){c.using(!u.app.platform.dontuseapiproxy)}})}function n(){c.proxieslist()}function a(){c.addnode()}function o(){var t=$(this).closest(".node").attr("host"),n="true"==$(this).closest(".node").attr("locally"),e=_.find(u.app.platform.nodes,function(e){return e.host==t&&e.locally==n});e&&c.addnode(e)}function i(){var t,n,e=$(this).closest(".node");e.hasClass("active")||(t=e.attr("host"),n="true"==e.attr("locally"),e=_.find(u.app.platform.nodes,function(e){return e.host==t&&e.locally==n}),c.connectnode(e))}var l,e=deep(e,"history"),c={preloader:function(e){e?l.c.addClass("loading"):l.c.removeClass("loading")},addproxy:function(i,s){var r=!1,l="create",e=u.app.localization.e("e13054"),t=u.app.localization.e("add");i&&(r=!0,l="update",e=u.app.localization.e("e13055"),t=u.app.localization.e("save")),i=i||{};var c={host:new Parameter({type:"STRING",name:u.app.localization.e("e13056"),id:"host",defaultValue:i.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:i.port||"8888",placeholder:"8888",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"ws",defaultValue:i.ws||"8088",placeholder:"8088",require:!0})},t={close:{class:"close",html:'<i class="fas fa-times"></i> '+u.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+t,fn:function(t,n){var e,a={},o=!0;_.each(c,function(e){a[e.id]=e.value||i[e.id],e.value||(o=!1)}),o?(a.user=!0,a.id=u.app.platform.sdk.proxy.makeid(a),e=u.app.platform.sdk.proxy.all(),_.find(e,function(e){return e.id==a.id})?sitemessage(u.app.localization.e("e13058")):(t.find(".addproxy").addClass("loading"),d(a,function(e){t.find(".addproxy").removeClass("loading"),e&&(e=u.app.platform.sdk.proxy[l](a,i.id),r||(u.app.platform.apiproxy=a,e=!0),s&&s(a,e),n.close())}))):sitemessage(u.app.localization.e("e13057"))}}};r&&(t.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+u.app.localization.e("delete"),fn:function(e,t){dialog({class:"zindex",html:u.app.localization.e("e13059"),success:function(){var e=u.app.platform.sdk.proxy.remove(i.id);s&&s(null,e),t.close()}})}}),u.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:c},wnd:{header:e,buttons:t,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(c),e.el),e.el.find(".host input").focus()})},proxieslist:function(e,o){function i(e){e.close(),c.connectproxy()}var t=u.app.platform.sdk.proxy.all(),n={close:{class:"close",html:'<i class="fas fa-times"></i> '+u.app.localization.e("close"),fn:function(e,t){console.log("close"),t.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+u.app.localization.e("e13054"),fn:function(n,a){c.addproxy(null,function(e,t){t?i(a):p.proxieslist(n,a)})}}},s={destroy:function(){},name:"proxieslist",data:{proxies:t,proxy:u.app.platform.apiproxy,ele:c.ele()},wnd:{header:u.app.localization.e("e13060"),noInnerScroll:!0,class:"proxieslistwnd",buttons:n}};e?s.el=e:s.insert="wnd",u.shell(s,function(a){a.el.find(".proxy").length?a.el.find(".proxieslist").removeClass("empty"):a.el.find(".proxieslist").addClass("empty"),a.el.find(".name").on("click",function(){var t,e=$(this).closest(".proxy").hasClass("active"),n=$(this).closest(".proxy").attr("pid");e||("none"==n?dialog({html:u.app.localization.e("e13061"),class:"zindex",success:function(){c.using(!0),p.active(),(a.container||o).close()}}):(t=u.app.platform.sdk.proxy.find(n),a.el.find(".proxieslist").addClass("loading"),d(t,function(e){a.el.find(".proxieslist").removeClass("loading"),e&&u.app.platform.sdk.proxy.changeWithDialog(t,function(){(a.container||o).close(),p.proxy(),p.active()})})))}),a.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid");(e=u.app.platform.sdk.proxy.find(e))&&c.addproxy(e,function(e,t){t?i(a.container||o):c.proxieslist(s.el)})})})},addnode:function(i,e){var s=!1,t="create",n=u.app.localization.e("e13044"),a=u.app.localization.e("add");i&&(s=!0,t="update",n=u.app.localization.e("e13062"),a=u.app.localization.e("save")),i=i||{};var r={saveto:new Parameter({type:"VALUES",name:u.app.localization.e("save"),id:"saveto",defaultValue:"proxy",possibleValues:["proxy","locally"],possibleValuesLabels:[u.app.localization.e("onproxy"),u.app.localization.e("locally")],require:!0}),host:new Parameter({type:"STRING",name:u.app.localization.e("nodehost"),id:"host",defaultValue:i.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:u.app.localization.e("e13063"),id:"port",defaultValue:i.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:u.app.localization.e("e13064"),id:"ws",defaultValue:i.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:u.app.localization.e("e13065"),id:"nodename",defaultValue:(i.nodename||(u.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:u.app.localization.e("e13066"),require:!0}),rpcuser:new Parameter({type:"STRING",name:u.app.localization.e("e13067"),id:"rpcuser",placeholder:u.app.localization.e("e13068"),defaultValue:i.rpcuser||"",require:!0}),rpcpwd:new Parameter({type:"STRING",name:u.app.localization.e("e13069"),id:"rpcpwd",defaultValue:i.rpcpwd||"",placeholder:u.app.localization.e("e13070"),require:!0})};!u.app.platform.dontuseapiproxy&&u.app.platform.apiproxy||(r.saveto=new Parameter({type:"VALUES",name:u.app.localization.e("save"),id:"saveto",defaultValue:"locally",possibleValues:["locally"],possibleValuesLabels:[u.app.localization.e("locally")],require:!0})),console.log("ap",r),a={close:{class:"close",html:'<i class="fas fa-times"></i> '+u.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(e,n){var a,o=_.clone(i);i.host=r.host.value,i.port=r.port.value,i.ws=r.ws.value,i.nodename=r.nodename.value,i.rpcuser="",i.rpcpwd="","locally"==r.saveto.value?(i.rpcuser=r.rpcuser.value||"",i.rpcpwd=r.rpcpwd.value||"",i.locally=!0):(delete i.rpcuser,delete i.rpcpwd),i.host&&i.port&&i.ws&&i.nodename?(delete(a=_.clone(i)).addedby,delete a.date,a.locally||delete a.locally,u.app.platform.sdk.node.sys[t+r.saveto.value](a,function(e,t){e?(i=_.clone(o),sitemessage(e)):(s?(l.list.html(""),p.nodes(u.app.platform.nodes)):(u.app.platform.nodes||(u.app.platform.nodes=[]),u.app.platform.nodes.push(t),p.nodes([t])),u.app.platform.nodeid&&u.app.platform.nodeid.host!=a.host?n.close():c.connectnode(a,function(){n.close()}),p.active())})):sitemessage(u.app.localization.e("e13071"))}}},s&&(r.host.disabled=!0,r.saveto.hidden=!0,i.locally?r.saveto.value="locally":r.saveto.value="proxy",a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+u.app.localization.e("delete"),fn:function(e,n){dialog({class:"zindex",html:u.app.localization.e("e13072"),success:function(){var e=i.locally?"revokelocally":"revokeproxy";u.app.platform.sdk.node.sys[e]({host:i.host},function(e,t){e?sitemessage(e):(l.list.find('.node[host="'+i.host+'"]').closest(".nodewrapepr").remove(),p.empty(),i.host==u.app.platform.nodeid.host?c.connectnode(null,function(){n.close()}):n.close())})}})}}),u.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:r},wnd:{header:n,buttons:a,noInnerScroll:!0,class:"addnodewnd"}},function(e){function t(){e.el.find(".addnode").attr("saveto",r.saveto.value)}ParametersLive(_.toArray(r),e.el),t(),r.saveto._onChange=function(){t()}})},connectproxy:function(e){u.app.platform.nodeid=null,u.app.platform.nodes=null,u.app.errors.clear(),u.app.platform.state.save(),u.app.platform.restart(function(){app.reload(function(){}),e&&e()})},connectnode:function(t,n){var a,o,e;c.preloader(!0),a=function(e){e?(u.app.platform.nodeid=t,u.app.platform.state.save(),p.active(),u.app.errors.clear(),u.app.platform.restart(function(){c.preloader(!1),app.reload(function(){}),n&&n()})):c.preloader(!1)},o=function(e){e?a(!0):(dialog({html:u.app.localization.e("e13053"),class:"one zindex"}),a(!1))},e=u.app.platform.nodeid,u.app.platform.nodeid=t,u.app.platform.sdk.node.get.time(function(e,t){o(!t)}),u.app.platform.nodeid=e},ele:function(){return"undefined"!=typeof _Electron},using:function(e){u.app.platform.dontuseapiproxy=e,u.app.platform.sdk.proxy.save(),p.proxy(),c.connectproxy()}},p={nodes:function(e,t){u.shell({inner:append,name:"nodes",data:{nodes:e},el:l.list},function(){p.empty(),p.active(),t&&t()})},empty:function(){l.list.find(".node").length?l.nodes.removeClass("empty"):l.nodes.addClass("empty")},active:function(){l.list.find(".node").removeClass("active"),u.app.platform.nodeid&&l.list.find('.node[host="'+u.app.platform.nodeid.host+'"][locally="'+(u.app.platform.nodeid.locally||"false")+'"]').addClass("active")},proxy:function(){u.app.platform.dontuseapiproxy?(l.cc.removeClass("useproxy"),l.cc.addClass("shownodes"),l.currentproxy.html(u.app.localization.e("e13051"))):(l.cc.addClass("useproxy"),u.app.platform.apiproxy?(l.cc.addClass("shownodes"),l.currentproxy.html("https://"+app.platform.apiproxy.host+":"+app.platform.apiproxy.port+"; wss:"+app.platform.apiproxy.ws)):(l.cc.removeClass("shownodes"),l.currentproxy.html(u.app.localization.e("notselected"))))}};return{primary:e,getdata:function(e){var t={ele:c.ele()};window.cordova,e(t)},destroy:function(){l={}},init:function(e){(l={}).c=e.el.find("#"+u.map.id),l.list=l.c.find(".list"),l.add=l.c.find(".addnewNode"),l.nodes=l.c.find(".nodespart"),l.cc=l.c.find(".connection"),l.currentproxy=l.c.find(".current"),l.add.on("click",a),l.c.on("click",".edit",o),l.c.on("click",".connectnode",i),l.c.find(".openproxielist").on("click",n),l.c.find(".usingproxy").on("click",t),p.proxy(),l.nodes.addClass("loading"),u.app.platform.sdk.system.get.nodes(!0,function(){l.nodes.removeClass("loading"),p.nodes(u.app.platform.nodes)}),e.clbk(null,e)}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=connection:(app.modules.connection={},app.modules.connection.module=connection);var donations=function(){function n(e){function t(){l.donate()}var s,e=deep(e,"history"),n=["PHdW4pwWbFdoofVhSEfPSHgradmrvZdbE5","PTziv8ym7eJRUfyfAFBejJgEYemTdUgFzH","PBE1MLbsFoY3o1YW6t3Goi6spS1y9GY1vj","PRV1eoYkhA5PGkASm2tyD12xwdQnigbpkp","PRCeHituQ5WN2EXRZz4t9qTYyCBqTc4g4M","P9V67HjuApdEhj4DZxNnibxEqSnmCPbxvB","PA57U1QmmowNzSaz6ThG2EPs34QCsLyksL","PL7RNWypccYBPsDAygW3H4aKfzGBwMeWyt","PDUGAwFmRRSnSVTtcAuyVrTLAREm6HN2BC","PPvPW1sUAA1KPxcwbVKVk2EEp3uWkAKn2U","PWkUgSod6FEyVq8Ve1dWChWMC8HcXJcLro"],a={amount:new Parameter({name:p.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:p.app.localization.e("wsamountof"),format:{Precision:6}})},o=[{id:"btc",name:"Bitcoin",action:function(e){l.ways.ltcbtc(e)},qrname:"bitcoin"},{id:"ltc",name:"Litecoin",qrname:"litecoin",action:function(e){l.ways.ltcbtc(e)}}],i={},r=null,l={checkFunds:function(e,t,n){l.status(e,t,function(e,t){n&&n(t)})},waitfunds:function(t,n,a,o){i[t]=n,d.save(),c.address(t,n,o,a,function(e){r=setInterval(function(){l.checkFunds(t,n,function(e){"AWAITINGFUNDS"!=e.Status&&"AWAITINGDONATION"!=e.Status&&(clearInterval(r),r=null),"AWAITINGFUNDS"==e.Status||"AWAITINGDONATION"==e.Status||"EXPIREDAWAITINGFUNDS"==e.Status?c.address(t,n,o,e):c.thankyou(o,!1,a)})},6e4)})},ways:{ltcbtc:function(n){var a=n.id;i[a]?l.status(a,i[a],function(e,t){"AWAITINGFUNDS"==t.Status||"AWAITINGDONATION"==t.Status?l.waitfunds(a,i[a],t,n):"EXPIREDAWAITINGFUNDS"==t.Status?l.address(a,function(e,t){l.waitfunds(a,e,t,n)}):(delete i[a],d.save(),c.thankyou(n,!0,t))}):l.address(a,function(e,t){l.waitfunds(a,e,t,n)})},xmr:function(e){c.xmraddress(e,function(e){})},paypal:function(e){window.open("https://www.paypal.me/pocketnet","_blank").focus(),c.thankyou(e)}},donate:function(){l.hidepage(function(){c.ways()})},hidepage:function(e){s.c.find(".hideprocess").fadeOut(200,e)},showpage:function(e){s.c.find(".hideprocess").fadeIn(200,e)},status:function(e,t,n){p.app.platform.sdk.exchanges.status(e,t,n)},address:function(e,n){p.app.ajax.run({data:{Action:"GETADDRESSFORDONATION",Currency:e.toUpperCase()},success:function(e){var t=deep(e,"Address.Address");t?n&&n(t,e.Address):sitemessage(p.app.localization.e("e13094"))},fail:function(){sitemessage(p.app.localization.e("e13094"))}})}},c={thankyou:function(t,n,e){_scrollTop(0),a.amount.value=deep(e,"Amount")||0,p.shell({name:"thankyou",inner:html,el:s.process.find(".step"),data:{second:n,curobj:t,info:e,parameters:a}},function(e){ParametersLive(_.toArray(a),e.el),e.el.find(".send").on("click",function(){0<a.amount.value?$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:{Action:"ADDTOMAILLIST",Lang:p.app.localization.key||"en",TemplateID:100,Email:p.app.platform.sdk.address.pnet().address,Name:(t.name||"NAN0")+", "+(a.amount.value||0)},dataType:"json",success:function(){e.el.html(""),setTimeout(function(){l.showpage()},100),dialog({html:p.app.localization.e("e13095"),class:"one"})}}):sitemessage(p.app.localization.e("e13096"))}),e.el.find(".back").on("click",function(){n?(e.el.html(""),setTimeout(function(){t.action(t)},100)):(e.el.html(""),setTimeout(function(){l.showpage()},100))})})},xmraddress:function(t,n){_scrollTop(0),p.shell({name:"xmraddress",inner:html,el:s.process.find(".step"),data:{curobj:t}},function(e){e.el.find(".back").on("click",function(){e.el.html(""),setTimeout(function(){c.ways()},100)}),e.el.find(".next").on("click",function(){c.thankyou(t,!0)}),e.el.on("click",".copyaddress",function(){copyText(e.el.find(".aw")),sitemessage(p.app.localization.e("waddresswascop"))}),n&&n(e.el)})},address:function(n,a,o,i,t){p.shell({name:"address",inner:html,el:s.process.find(".step"),data:{curobj:o,address:a,currency:n,info:i}},function(e){e.el.find(".back").on("click",function(){e.el.html(""),setTimeout(function(){c.ways()},100),r&&(clearInterval(r),r=null)}),e.el.on("click",".copyaddress",function(){copyText(e.el.find(".aw")),sitemessage(p.app.localization.e("waddresswascop"))}),e.el.find(".reactivate").on("click",function(){p.app.platform.sdk.exchanges.reactivate({address:a,currency:n},function(e,t){e?sitemessage(p.app.localization.e("e13097")):l.waitfunds(n,a,i,o)})}),e.el.find(".next").on("click",function(){c.thankyou(o,!0),r&&(clearInterval(r),r=null)}),t&&t(e.el)})},ways:function(t){_scrollTop(0),p.shell({name:"ways",inner:html,el:s.process.find(".step"),data:{ways:o}},function(e){e.el.find(".back").on("click",function(){e.el.html(""),setTimeout(function(){l.showpage()},100)}),e.el.find(".way").on("click",function(){var t=$(this).attr("way"),e=_.find(o,function(e){return e.id==t});e&&e.action(e)}),t&&t()})}},d={save:function(){p.app.settings.set(p.map.uri,"storage",JSON.stringify(i))},load:function(){i=JSON.parse(p.app.settings.get(p.map.uri,"storage")||"{}")}};return{primary:e,getdata:function(e){d.load(),p.sdk.users.get(n,function(){e({donated:n})},!0)},destroy:function(){r&&(clearInterval(r),r=null),s={}},init:function(e){(s={}).c=e.el.find("#"+p.map.id),s.process=s.c.find(".process"),s.donate=s.c.find(".donate"),s.donate.on("click",t),e.clbk(null,e)}}}var p=new nModule,a={};return p.run=function(e){var t=p.addEssense(a,n,e);p.init(t,e)},p.stop=function(){_.each(a,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=donations:(app.modules.donations={},app.modules.donations.module=donations);var userpage=function(){function n(e){function o(){var e=$(this).closest("[levelid]").attr("levelid");a.closeGroup(e)}function i(){var e=$(this).attr("rid");isMobile()&&h.contents(null,e),a.openReport(e,!0)}var s,r,l,e=deep(e,"history"),c=null,d=null,p=!1,u=null,f=[],m={eachReport:function(i,e,t){var s=function(e,a,o){a=a||0,o=o||"",_.each(e,function(e,t){var n=o;n&&(n+="_"),n+=e.id,e.reports?i.group(e,a,n,function(){s(e.reports,a+1,n)},t):i.report(e,a,n)})};s(e=e||f,0,t)},findReport:function(e){var a=function(e,t){var n=t.split("_");return n.length?(t=n[0],(e=_.find(e||[],function(e){return e.id==t}))?(n.splice(0,1),(t=n.join("_"))&&e.reports?a(e.reports,t):e):null):null};return a(f,e)},mobileReports:function(){var o=[];return m.eachReport({group:function(e,t,n,a){e.mobile&&o.push(e),a()},report:function(e){e.mobile&&o.push(e)}}),o.push({name:g.app.localization.e("signout"),id:"signout"}),o},selector:function(){var e=m.mobileReports(),t=_.map(e,function(e){return e.id}),e=_.map(e,function(e){return e.text||e.name});return(e=new Parameter({type:"VALUES",name:g.app.localization.e("e13187"),id:"contents",possibleValues:t,possibleValuesLabels:e,defaultValue:t[0]})).value=parameters().id||t[0],e._onChange=function(e){var t;"signout"==e?a.signout():(t=m.findReport(e),(e=parameters()).report=t.report,e.id=t.id,e="userpage"+collectParameters(e),g.nav.api.load({open:!0,href:e,history:!0}))},e}},a={closeGroup:function(e){var t=m.findReport(e);t&&(t.active=!t.active,e=s.c.find('[levelid="'+e+'"]'),t.active?e.addClass("active"):e.removeClass("active"))},openTree:function(i){m.eachReport({group:function(e,t,n,a){var o=s.c.find('[levelid="'+n+'"]');0==i.indexOf(n)?(e.active=!0,o.addClass("active"),a()):(e.active=!1,o.find(".openReport").removeClass("active"))},report:function(e,t,n){var a=s.c.find('[id="'+n+'"]');i==n?(e.active=!0,a.addClass("active")):(e.active=!1,a.removeClass("active"))}})},closeReport:function(){s.report.html("")},openReport:function(e,t){s.c.find(".openReport").removeClass("active"),s.c.find('[rid="'+e+'"]').addClass("active"),a.openTree(e),h.report(e);var n=m.findReport(e);n&&n.rh||t&&(g.nav.api.history.addParameters({id:e},{removefromback:!1}),g.app.nav.clbks.history.navigation&&g.app.nav.clbks.history.navigation())},signout:function(){function e(){g.app.user.signout(),g.app.reload({href:"authorization"})}g.app.platform.sdk.address.pnet()&&g.app.platform.sdk.registrations.showprivate()?g.app.platform.ui.showmykey({text:g.app.localization.e("e13188"),faillabel:g.app.localization.e("e13189"),fail:function(){e()}}):e()}},h={bgcaption:function(e){m.selector(),s&&s.bgcaption&&(g.app.user.validate()?g.shell({name:"bgcaption",el:s.bgcaption,data:{}},function(e){console.log(e.el),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(g.app.localization.e("successcopied"))})}):s.bgcaption.html('<div class="bgCaptionSpacer"></div>'))},contents:function(t,e){var n,a;s.contents&&(n=m.selector(),a=function(){g.shell({name:"contents",el:s.contents,data:{reports:f,each:m.eachReport,selector:n}},function(e){e.el.find(".groupNamePanelWrapper").on("click",o),e.el.find(".openReport").on("click",i),ParametersLive([n],e.el),_scrollTop(0),p&&s.contents.hcSticky("refresh"),t&&t()})},e&&isMobile()?(s.contents.html(""),t&&t()):g.app.user.isState(function(e){isMobile()&&e?g.app.platform.sdk.node.transactions.get.allBalance(function(e){var t=g.app.platform.sdk.node.transactions.tempBalance();l=e+t,a()}):a()}))},userslist:function(e,t,n,a,o){g.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:t,empty:n,caption:a},clbk:function(e,t){o&&o(e,t)}})},followers:function(e,t){var n,a,o,i=deep(g,"app.user.address.value");i&&(n=deep(g,"sdk.users.storage."+i),o=_.map(deep(n,"subscribers")||[],function(e){return e}),a=deep(n,"blocking")||[],o=_.filter(o,function(e){return-1==_.indexOf(a,e)}),i=g.app.localization.e("anofollowers"),g.user.isItMe(n.address)&&(i=g.app.localization.e("aynofollowers")),h.userslist(e,o,i,g.app.localization.e("followers"),t))},following:function(e,t){var n,a,o,i=deep(g,"app.user.address.value");i&&(n=deep(g,"sdk.users.storage."+i),o=_.map(deep(n,"subscribes")||[],function(e){return e.adddress}),a=deep(n,"blocking")||[],o=_.filter(o,function(e){return-1==_.indexOf(a,e)}),i=g.app.localization.e("anofollowing"),g.user.isItMe(n.address)&&(i=g.app.localization.e("aynofollowing")),h.userslist(e,o,i,g.app.localization.e("following"),t))},fillUser:function(e,t){g.shell({name:"fillUser",el:e,data:{}},function(e){t&&t()})},authorization:function(e,t){g.nav.api.go({href:"authorization",history:!0,open:!0})},registration:function(e,t){g.nav.api.go({href:"registration",history:!0,open:!0})},report:function(e,n){function a(e,t){_scrollTop(0),c=t,d&&d.apply(),n&&n()}c&&c.destroy();var t=m.findReport(e);t.rh?h[t.report]():g.shell({name:"report",el:s.report,data:{}},function(e){h[t.report]?(h[t.report](e.el.find(".reportCnt"),a),p&&s.contents.hcSticky("refresh")):g.nav.api.load({open:!0,id:t.report,el:e.el.find(".reportCnt"),animation:!1,primary:!0,essenseData:{sub:t.sub,dumpkey:r.dumpkey},clbk:function(e,t){a(0,t),p&&s.contents.hcSticky("refresh")}})})}};function t(e){var t=parameters().id;isMobile()||(t=t||(g.app.user.validate()?"ustate":"test")),h.contents(function(){t?a.openReport(t):a.closeReport(),e&&e()},t)}g.authclbk=function(){h.bgcaption()};var n=function(e){h.bgcaption(),t(e),g.app.user.validate()||(s.c.addClass("validate"),g.app.errors.connectionRs()&&(g.iclbks.mn=function(){delete g.iclbks.mn,n()})),isMobile()||(s.contents.hcSticky({stickTo:"#userpagestick",top:77,bottom:177}),p=!0)};return{primary:e,parametersHandler:function(){t()},getdata:function(t,e){var n;r=deep(e,"settings.essenseData")||{},f=[],g.app.user.getstate()?g.app.user.validate()||(n=g.app.localization.e("e13184"),g.app.errors.connection()&&(n=g.app.localization.e("e13185")),f.push({name:n,id:"test",report:"fillUser",mobile:!0})):(f.push({name:g.app.localization.e("signin"),id:"authorization",report:"authorization",mobile:!0,rh:!0}),f.push({name:g.app.localization.e("createnew"),id:"registration",report:"registration",mobile:!0,rh:!0})),f.push({name:g.app.localization.e("notifications"),id:"notifications",report:"notifications",mobile:!0}),f.push({name:g.app.localization.e("rstate"),id:"ustate",report:"ustate",mobile:!0,add:function(){if(isMobile()&&deep(u,"reputation"))return u.reputation.toFixed(1)}}),f.push({name:g.app.localization.e("rwallet"),id:"wallet",report:"wallet",mobile:!0,add:function(){if(isMobile()&&l)return g.app.platform.mp.coin(l)}}),f.push({name:g.app.localization.e("followers"),id:"followers",report:"followers",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e&&(e=deep(g,"sdk.users.storage."+e+".subscribers.length"),isMobile()&&e))return e}}),f.push({name:g.app.localization.e("following"),id:"following",report:"following",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e&&(e=deep(g,"sdk.users.storage."+e+".subscribes.length"),isMobile()&&e))return e}}),g.app.user.validate()&&f.push({name:g.app.localization.e("e13186"),id:"test",report:"test",mobile:!0}),f.push({name:g.app.localization.e("rsettings"),id:"usersettings",report:"usersettings",mobile:!0}),f.push({name:g.app.localization.e("raccounts"),id:"accounts",report:"accounts",mobile:!0}),f.push({name:g.app.localization.e("rsystem"),id:"system16",report:"system16",mobile:!1}),f.push({name:"Pocketcoin",id:"staking",report:"staking",mobile:!0,if:function(){return isMobile()}});var a={},e=parameters();a.p2pkh=g.app.platform.sdk.address.pnet(),g.app.platform.sdk.ustate.me(function(e){u=e,t(a)})},destroy:function(){delete g.iclbks.mn,p=!1,c&&c.destroy(),c=null,d&&d.destroy(),d=null,$("#menu").removeClass("abs"),s={}},init:function(e){(s={}).c=e.el.find("#"+g.map.id),s.contents=s.c.find(".contents"),s.report=s.c.find(".report"),s.bgcaption=s.c.find(".bgCaptionWrapper"),$("#menu").addClass("abs"),new Caption({container:s.c,caption:s.c.find(".captionfwrapper"),offset:[0,0]}).init(),s.c.on("click",".signout",function(){a.signout()}),n(function(){e.clbk(null,e)})}}}var g=new nModule,a={};return g.run=function(e){var t=g.addEssense(a,n,e);g.init(t,e)},g.stop=function(){_.each(a,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=userpage:(app.modules.userpage={},app.modules.userpage.module=userpage);var faq=function(){function n(e){var n,e=deep(e,"history"),t=[{name:"Technical",id:"technical",group:[{id:"downloadclient",q:"Where do I download the client?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.gui/releases/latest">https://github.com/pocketnetteam/pocketnet.gui/releases/latest</a></div><div>Click on PocketnetSetup.exe</div>'},{id:"downloadclient",q:"Where do I download the node?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.core/releases/latest">https://github.com/pocketnetteam/pocketnet.core/releases/latest</a></div><div>With any questions email core@pocketnet.app</div>'}]},{name:"Pocketnet",id:"roadmap",group:[{id:"walletaddresses",q:"I see a PN address and a wallet address... are both these addresses on the PN blockchain?",a:"<div>PN address is the one used for posting content and using social network in general. It also keeps coins that you win for your highly rated posts.</div><div>Wallet addresses are to keep the rest of coins.</div>"},{id:"linktoprofile",q:'Can I link to my profile? or my "page"? So that i can post it into my community to bring members over.',a:"<div>In the browser, go to your profile by clicking on avatar in the upper right and just copy the browser address, everyone who will sign up from that link will follow you automatically and you will actually get rewards.</div>\t\t\t\t\t\t\t<div>On the desktop,  from a desktop application go to your profile,  once there, there will be three icons to the right of your avatar first there will be a wallet with number of coins, then a bell with notifications and a third is a green cross icon click on that green cross  and click copy,  send that link around everyone who subscribes will follow you and you will get rewards.</div>"},{id:"starsystem",q:"The star system. Is there a limit on how many stars a person has to give people?",a:"<div>There are some limits. But as your reputation grows you can upvote more and more. This is done, so bots don&rsquo;t break down our blockchain. Initially you get 100 ratings every 24 hours. As your reputation grows (that happens by posting and getting rated), then you do 200 ratings a day.</div>"},{id:"updateprofiletime",q:"How long until I am able to update my profile? ",a:"<div>You are able to update your profile once every hour.</div>"},{id:"savevideo",q:"Where do you save the video content?",a:"<div>Pocketnet uses open source platform called PeerTube. PeerTube is fully integrated with Pocketnet authorization, each video server is registered on the blockchain. Details of the algorithm are coming.</div>"},{id:"mobileapp",q:"Is there a mobile app?",a:"<div>There is an Android app, you can download it here: https://play.google.com/store/apps/details?id=pocketnet.app  iPhone app is not available, because Apple required us to remove any content on 24 hour notice. We refused, so you can use the mobile web app.</div>"},{id:"postinglimit",q:"Can you tell me what is the limit for posting each day or hour?",a:"<div>We do have some limitations, but after testing it we have increased our limits. At the outset you can make 15 posts and issue 100 ratings every 24 hours. Once your reputation grows above 50, you will be able to make up to 30 posts and 200 ratings every 24 hours.</div>"},{id:"reputation",q:"What is reputation and how is it calculated?",a:"<div>Your reputation is the sum of your ratings calculated in the following way. Note, that users with reputation below 50 do not affect anyone's reputation or coin winnings. They can rate the content, but it does not affect reputation.</div>\t\t\t\t\t\t<div>5=2<br>4=1<br>3=0<br>2=-1<br>1=-2</div><div>So, if you have two 5 start ratings and one 1 star rating, the total will be 2+2-2=2</div>"},{id:"deletepostoruser",q:"Is there a way to delete or edit a post?",a:"<div>Not at this point, as it is baked into blockchain. However, we are working on a feature to create an overwrite transaction as well &#10075;hide&#10076; transaction, which would effectively translate to edit or delete.</div>"},{id:"usersearch",q:"Is there a way to search for a user?",a:"<div>Click the search magnifying glass on the top and search by username or by keywords.</div>"},{id:"follow",q:"How do you follow someone?",a:"<div>Next to post author (on top of post) there is a Follow link, you can find his posts in Top posts (red flame on top of the page). You will also soon see Subscriptions feed, which is going to be different from the main feed. The main feed will be everything that anyone posts chronologically, but Subscriptions feed will only contain posts from people you follow. So, you will go into general feed in search of good content, though you may not like everything. Then select those you want to keep. Kind of like fishing :)</div>"},{id:"otherbrowsers",q:"Can it be used on Brave or Duck Duck go browsers?",a:"<div>Pocketnet should work on those browsers. It is fully functional on Chrome and Firefox. But we strongly encourage everyone to download the desktop app (grab PocketnetSetup.exe here: https://github.com/pocketnetteam/pocketnet.gui/releases/tag/v0.0.33-beta). It cannot be blocked ever (even if pocketnet.app is down or blocked for some reason). This is a serious consideration in totalitarian and quasi-totalitarian countries which, if you think about it, is beginning to include more and more of the globe.</div>"},{id:"replypost",q:"Can we reply to our own/and other&rsquo;s posts?",a:"<div>Yes, commenting is live below each post..</div>"},{id:"addtags",q:"How to add a tag to a post?",a:"<div>Just type in the field tag and press enter. No need to specify #, it will be added automatically.</div>"},{id:"usepublicaddress",q:"How can I use the public address?",a:"<div>Your public address is what Pocketnet uses to verify your identity. Essentially, your private key is a really large number (that can be represented with a 12 word sequence or a QR code). This number gets multiplied by another that everyone knows (called a base point) and we get a public key. When you enter your private key, we can multiply it by the base point to get your public key and we can match it against public address. If they match, we know it is you. It is impossible to go back i.e. to divide public key by the base point to get your private key. The way multiplication in cryptography works is it is only one way and cannot be reversed, so your key is safe. Pocketnet uses the same exact cryptography as Bitcoin.</div>"},{id:"desktopmac",q:"Will there be a downloadable executable for Mac?",a:"<div>Yes - we are working of Mac platform. Target is for mid-April.</div>"},{id:"dark-mode",q:"How do I change the theme to Dark Mode?",a:"<div>If you're on browser click your profile picture > Manage > Settings. If you're on mobile click the three lines on the bottom right > Settings </div>"},{id:"banning",q:"Can people be banned?",a:"<div>If a someone is posting unorthodox content then people will rate their content low causing their reputation to fall, if their reputation is less than -50 then they will be shadow banned. This means they can still post but no one can see their content unless directly on their page.</div>"},{id:"app-store",q:"What can be expected to purchase with PKOIN?",a:"<div>Soon there will be a way to boost posts in the feed and to Top Posts. Also, there will be special emojis and color of page, and badges.</div>"},{id:"Apple App",q:"When will PocketNet be added to Apple?",a:"<div>2-3 months</div>"},{id:"Missing PKCOIN",q:"Help! I am missing my PKOIN!",a:'<div>If for some reason it seems like your PKOIN has gone missing, please first check the blockexplorer via<a href="https://'+r.app.options.url+'/blockexplorer/">BlockExplorer.</a> to that your coins are still there. Just search your wallet address in the search bar and it will show you the balance of your account. </div>'}]},{name:"Pocketcoin",id:"pocketcoin",group:[{id:"pocketcoin",q:"What can I do with Pocketcoin?",a:"<div>Currently you can win it or send as a gift. However, when Pocketnet takes off, Pocketcoin will be the main method of buying advertising on the platform. Advertisers will be able to easily find content authors with the right audience and then offer them advertising opportunities. This will be a trustless endeavor (i.e. neither side can cheat), because of something called multi-signature contracts. Multisig contract requires a digital signature of both parties to be valid. When advertiser offers an ad to the content creator, he creates the first of two required signatures. He signs the actual ad and the amount bid. Content creator reviews this partially signed multisig and if it is accepted, then he appends the second signature. When a blockchain sees both signatures, content creator is automatically paid and an ad is automatically shown on creator’s channel. These transactions will only be done through Pocketcoin. Thus, if Pocketcoin becomes big, it will be an immensely valuable token.</div>"},{id:"pocketcoinstock",q:"Is Pocketcoin like a share of stock in Pocketnet?",a:"<div>Definitely no. Pocketnet is not even a corporation and does not have any ownership. It is an open source code that anyone can copy and run. Pocketcoin is a token that facilitates value exchange, specifically advertising transactions. In addition, Pocketnet will include a marketplace where goods and services will be sold directly for Pocketcoin</div>"},{id:"pocketcoinbuy",q:"Can I buy additional Pocketcoin?",a:"<div>Yes, currently you can buy Pocketcoin on the following exchanges: Bilaxy, Mercatox, BTCPOP.</div>"},{id:"pocketcoinbuyfiat",q:"Can I buy Pocketcoin for US Dollars or other fiat currency?",a:"<div>Some exchanges allow that.</div>"}]},{name:"Privacy",id:"privacy",group:[{id:"anonymous",q:"Are people who do not enter their real names anonymous?",a:"<div>Yes - no names, phones, email is NOT connected to your account in any way, it is just optionally entered to receive newsletter updates.</div>"},{id:"viewoutside",q:"Can someone view a profile (someone&rsquo;s posts) outside the garden? Is it a walled garden?",a:"<div>Since the whole blockchain and all the posts are in opensource anyone can have access to your posts and profile. They just know that it is linked to your public address. In practice, you can have multiple accounts. You can use some with your real name and others anonymously. Anonymity is a great tool to protect free speech from abuse of power.</div>"},{id:"walletid",q:"Is my public key like a wallet ID that I enter on my profile and people can send points to?",a:"<div>Exactly. And it is safe to reveal. But not a secret phrase - keep it safe!</div>"},{id:"runnode",q:"Can I run a node on my headless server?",a:"<div>We will put the node&rsquo;s sources into GitHub. Instructions for running a node will be made available in early April.</div>"},{id:"signback",q:"How can I sign back in?",a:"<div>You can use your private 12-word key or a QR code to sign in.</div>"}]},{name:"Curation of content",id:"curation",group:[{id:"content",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>This is a very important question and we will be releasing many videos and articles about it, as well as looking for your input. To begin with, not all types of content are allowed. However, and this is crucial, the enforcement is transparent and up to the community in the way we will explain below. Enforcement is done by the community and is in the open with no hidden shadow bans or selective banning practiced by the Silicon Valley.</div>"},{id:"specific",q:"Specifics of curation on Pocketnet.",a:"<div>When your reputation gets to 100 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. When someone has more than 2 posts that are voted off the platform in 24 hours, they cannot post for another 48 hours after the second post. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div> "},{id:"racism",q:"Important Note on Racism.",a:"<div>Free thought and free speech is under attack on mainstream social platforms and in the media. We need to speak the truth and this platform is non-corporate and decentralized for that very reason. But we ask everyone make your point without attacking people&rsquo;s nationality or race. You can make your point based on evidence. We cannot afford to turn Pocketnet into a marginal platform. Speak the truth, but please avoid racism and attacks against specific nationalities on the whole. We know that Silicon Valley and MSM has turned the issue of racism into their playing card and they constantly cry wolf. Even more the reason for us to be measured and evidence based and not let them smear us with that. If we are not, we are not allowing most of the population to weigh the evidence of MSM corruption presented on Pocketnet. Please keep that in mind, so that free speech can thrive and we can beat the facebokks of the world.</div><div>Ultimately, it is the community that will determine the direction of the platform. Having a bunch of snowflakes that complain about stuff that offends them is equally as bad as when people want to voice direct violent threats. However, the first indication is that early users of the platform are generally intelligent and evidence based, so the future looks incredibly bright. Pocketnet team has noticed after a few days of the beta test, that we stopped reading even alternative news, because there was so much interesting content on Pocketnet. Keep it up!</div><div>Please get involved in the discussion on these topics. This is a community platform. We are always eager to improve transparency of the platform and you should let us know how we can improve our content curation and policing. Use group chat or email support(at)pocketnet*dot*app or make full posts on this topic.</div>"}]},{name:"Specifics of curation on Pocketnet.",id:"specificscuration",group:[{id:"trolls",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>Sometimes we can have a user who comes in with a specific purpose to attack Pocketnet by posting a series of vile images. To protect against that we have a following mechanism. If someone’s reputation reaches -50 (negative 50), their account is automatically blocked. Getting a reputation of -50 is equivalent to having 25 one star ratings and no four or five star ratings. This is nearly impossible to achieve without having lots of bad posts.</div>"},{id:"flagging",q:"Flagging a specific post",a:"<div>When your reputation gets to 50 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div>"}]},{name:"How is Pocketnet different from...",id:"differents",group:[{id:"differents1",q:"Twitter, Facebook, Reddit & other centralized platforms?",a:"<div>There is no central authority or corporation. Platform is run by equal nodes on a blockchain. All revenue is split between node operators and content creators. Node operators stake Pocketcoin in order to mint blocks with rewards and transactions fees. Half of rewards in each block go to content creators based on ratings their content gathers from users.</div>"},{id:"differents2",q:"Decentralized platforms like Minds.com and Sola?",a:"<div>Both of those platforms, while great, are not self-contained. Both are highly dependent on the Ethereum platform, because their tokens are based on ERC-20 Ethereum standard. That means that operations with tokens carry Ether gas fees. Also, those entities have corporations behind them and a corporation will always be a point of centralization due to its economic logic of growing profits. In addition, corporations are exceedingly easy to censor.</div>"},{id:"differents3",q:"From Steemit?",a:"<div>Steemit has its own blockchain, but is a corporate entity with all of the centralization that comes from that.</div>"},{id:"differents4",q:"Decentralized platforms like Mastodon and others?",a:"<div>While Mastodon is a fully decentralized platform, it requires a great deal of technical knowledge to use. This presents a great hindrance to potential widespread acceptance. Pocketnet features a web and desktop applications and users can log in from any device, pull in their personal settings from the blockchain and start using the platform immediately without any technial knowledge.</div>"}]},{name:"Pocketnet ecosystem",id:"ecosystem",group:[{id:"ecosystem1",q:"How is Pocketnet development funded?",a:"<div>Pocketnet is open sourced and is currently run by the group of volunteers with some serious programming and math skills. After launch Pocketnet will attract top programming talent based on its promise of creating a decentralized fair social network. Programmers and marketers working on Pocketcoin receive 5% of emission. The awards to developers and marketers will be assigned by nodes voting in a transparent manner.</div>"},{id:"ecosystem2",q:"What is Pocketcoin?",a:"<div>Pocketcoin is a network token. It is used exclusively to buy advertising from Pocketnet contributors and to pay transaction fees for such payments. Pocketcoin emission depends on the number of users of Pocketnet and has inherent algorithmic factors tying its long term value to Annual Revenue Per User (ARPU). ARPU is a term in digital advertising which signifies the total amount of revenue platform receives for one active user per year. In Pocketent all of the revenue is split between content creators and nodes.</div>"},{id:"ecosystem3",q:"How are content creators and node operators rewarded?",a:"<div>Pocketnet features unique Direct Marketplace where content creators can sell advertising to ad buyers. Content creators set their price and can accept mass-produced ads or can offer highly valued custom placements (creators pitching the product in their own way). Direct Marketplace is essentially an exchange for advertising that allows ad buyers target specific audiences without any intermediaries. All ad buys and ads themselves are linked on the blockchain, therefore ad buying is completely trustless.</div>"},{id:"ecosystem4",q:"What if users post illegal content, pornography and SPAM?",a:"<div>Pocketnet is not a darknet platform or some sort of pornhub. While it is decentralized and censorship resistant, it is policed by the users. Any illegal content is flagged and removed from the platform using the Wikipedia model. This means that users with highest reputation can police the platform. However, there are safeguards in place (within the open source code) from same or very similar group(s) of people repeatedly voting content off the platform. Also, users are explicitly encouraged to flag illegal content OR content that threatens mass adoption of Pocketnet, not simply the content they find offensive. To make sure that Pocketnet is a free speech platform, we encourage you to start participate, grow your reputation and police the platform properly without the censorship currently prevalent in centralized social media.</div>"},{id:"ecosystem5",q:"Who runs the Pocketnet?",a:"<div>There is no corporate entity or single individual who owns or controls the Pocketnet.</div></div>"}]}];function a(){var e=$(window).height()/4,t=inView(n.c.find(".faqcnt .group"),{offsetTop:e,offsetBottom:e,mode:"line"});0<t.length&&(e=$(t[0]).attr("group"),n.contens.removeClass("active"),n.c.find('.contens .item[group="'+e+'"]').addClass("active"))}function o(){var e=$(this).attr("group");_scrollToTop(n.c.find('.faqcnt .group[group="'+e+'"]'),null,null,-110)}function i(){!function(e){var t=s[e],n="https://"+r.app.options.url+"/help?page=faq&id="+e;r.app.platform.sdk.address.pnet()&&(n+="&ref="+r.app.platform.sdk.address.pnet().address);var a=t.q,e=filterXSS(t.a,{whiteList:[],stripIgnoreTag:!0});r.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:n,sharing:{image:"",images:[],title:a,html:{body:t.a,preview:trimHtml(t.a,160)},text:{body:e,preview:trimHtml(e,160)}},caption:"Share FAQ answer in social networks"}})}($(this).closest(".question").attr("question"))}window.cordova||t[0].group.splice(1,0,{id:"downloadandroid",q:r.app.localization.e("e14109"),a:`<div><a href="https://play.google.com/store/apps/details?id=pocketnet.app">https://play.google.com/store/apps/details?id=pocketnet.app</a></div><div>${r.app.localization.e("e14110")}</div>`});var s={};return{primary:e,getdata:function(e){s={},_.each(t,function(e){_.each(e.group,function(e){s[e.id]=e})}),e({groups:t})},destroy:function(){window.removeEventListener("scroll",a),n={}},init:function(e){(n={}).c=e.el.find("#"+r.map.id),n.contens=n.c.find(".contens .item"),n.contens.on("click",o),n.c.find(".share").on("click",i),n.c.find(".question .questionName").on("click",function(){$(this).closest(".question").toggleClass("opened")}),window.addEventListener("scroll",a),n.c.find(".contens").hcSticky({stickTo:"#faq",top:65});var t=parameters().id;t&&_scrollToTop(n.c.find('.faqcnt .question[question="'+t+'"]'),null,null,-110),e.clbk(null,e)}}}var r=new nModule,a={};return r.run=function(e){var t=r.addEssense(a,n,e);r.init(t,e)},r.stop=function(){_.each(a,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=faq:(app.modules.faq={},app.modules.faq.module=faq);var wallet=function(){function n(e){function n(e,l){lazyEach({array:_.toArray(p),sync:!0,action:function(s){var r=s.item,e=r.addresses();k.app.platform.sdk.node.transactions.get.balance(function(i){k.app.platform.sdk.node.transactions.get.canSpend(e,function(e,t){var n="#414244",a=100,o=k.app.platform.sdk.node.transactions.tempBalance();t&&(a=100*e/(t="pnetwallet"==r.id||"total"==r.id?o+t:t),n="#0F8623"),n={positive:{summary:a,color:n}},e<t&&(n.neutral={summary:100-a,color:"#414244"}),"pnetwallet"!=r.id&&"total"!=r.id||(i=o+i),y.total({label:r.label,id:r.id,balance:i,move:n,update:l},s.success)})},e)},all:{success:function(){e&&e()}}})}function s(e){var t=[y.send,y.deposit,y.addresses];console.log("essenseData",d),d.api&&d.action&&(t=[y[d.action]]),l.c.addClass("loading"),console.log("actions",t),lazyActions(t,function(){e()})}function r(){v.addaddress()}function o(){$(this).closest(".actionbody").html("")}var l,e=deep(e,"history"),c={},d={},p={pnetwallet:{label:k.app.localization.e("tacaddress"),alabel:k.app.localization.e("tacaddress"),id:"pnetwallet",addresses:function(){return[k.app.platform.sdk.address.pnet().address]}},wallet:{label:k.app.localization.e("twallet"),id:"wallet",addresses:function(){return k.app.platform.sdk.addresses.storage.addresses||[]},caption:k.app.localization.e("twalletaddresses")},total:{label:k.app.localization.e("tTotal"),id:"total",addresses:function(){return[k.app.platform.sdk.address.pnet().address].concat(k.app.platform.sdk.addresses.storage.addresses||[])}}},u={parameters:{source:new Parameter({name:k.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[k.app.localization.e("twallet"),k.app.localization.e("tacaddress"),k.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:k.app.localization.e("wsselect")}),reciever:new Parameter({name:k.app.localization.e("wsreciever"),type:"VALUESCUSTOM",id:"reciever",possibleValuesLabels:[],possibleValues:[],placeholder:k.app.localization.e("wsenter"),onType:!0,labelToInput:function(e){return _.isObject(e)?e.name:e},defaultValueTemplate:function(e,t,n,a){if(_.isObject(e)){var o="";return o+='<div class="table walletuservalue" firstdef="'+a+'">',o+='<div class="iconcell">',o+='<img src="'+e.image+'">',o+="</div>",(o+='<div class="namecell">')+e.name+"</div></div>"}return'<div class="walletdfvalue"><span>'+e+"</span></div>"}}),amount:new Parameter({name:k.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:k.app.localization.e("wsamountof"),format:{Precision:6}}),message:new Parameter({name:k.app.localization.e("message"),id:"message",type:"stringany",placeholder:k.app.localization.e("yourmessage"),format:{Length:80}}),fees:new Parameter({name:k.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[k.app.localization.e("wsrecieverpay"),k.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},f={parameters:{source:new Parameter({name:k.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[k.app.localization.e("twallet"),k.app.localization.e("tacaddress"),k.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:k.app.localization.e("wsselect")}),amount:new Parameter({name:k.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:k.app.localization.e("wsamountof"),format:{Precision:6}}),fees:new Parameter({name:k.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[k.app.localization.e("wsrecieverpay"),k.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},t={wallet:k.app.localization.e("twallet"),pnetwallet:k.app.localization.e("tacaddress")},a={active:!1,parameters:{deposit:new Parameter({name:k.app.localization.e("wrecieveon"),type:"VALUES",id:"deposit",defaultValue:"wallet",possibleValuesLabels:[k.app.localization.e("twallet"),k.app.localization.e("tacaddress")],possibleValues:["wallet","pnetwallet"],placeholder:k.app.localization.e("wdselectfrom")}),depositamount:new Parameter({name:k.app.localization.e("wdamount"),id:"depositamount",type:"NUMBER",placeholder:k.app.localization.e("wdenteramount"),onType:!0,format:{Precision:6}}),message:new Parameter({name:k.app.localization.e("wdmessage"),id:"message",type:"TEXT",placeholder:k.app.localization.e("wdmessageplaceholder"),onType:!0}),label:new Parameter({name:k.app.localization.e("wdlabel"),id:"label",type:"STRING",onType:!0})}},i={active:!1,parameters:{reciever:new Parameter({name:k.app.localization.e("wrecieveon"),type:"VALUES",id:"reciever",defaultValue:"pnetwallet",possibleValuesLabels:[k.app.localization.e("tacaddress")],possibleValues:["pnetwallet"],placeholder:k.app.localization.e("wdselectfrom")}),amount:new Parameter({name:k.app.localization.e("e13214"),id:"amount",type:"NUMBER",placeholder:k.app.localization.e("wsamountof"),format:{Precision:6}}),currency:new Parameter({name:k.app.localization.e("currency"),id:"currency",type:"VALUES",defaultValue:"btc",possibleValuesLabels:["BTC","LTC"],possibleValues:["btc","ltc"],placeholder:k.app.localization.e("e13215")}),currencyAmount:new Parameter({name:k.app.localization.e("e13216"),id:"currencyAmount",type:"NUMBER",placeholder:k.app.localization.e("wsamountof"),format:{Precision:6}})},segments:[{id:"AWAITINGFUNDS",time:180,exclude:"all",label:function(e,t,n){if(e==this.id)return'<div class="todeal">'+n.currency.toUpperCase()+": "+t.Address+' <i class="fas fa-chevron-circle-right"></i> </div>'},currentLabel:function(e){return"Awaitng Funds. Address will be valid for <b>"+e.MinutesLeft+" minutes</b>"}},{id:"EXPIREDAWAITINGFUNDS",class:"bad",finish:!0,exclude:"all",label:function(e,t){return k.app.localization.e("e13217")},currentLabel:function(e){return k.app.localization.e("e13217")+' <div class="reactivate">'+k.app.localization.e("reactivate")+"</div>"}},{id:"CONFIRMATIONS0",time:10,currentLabel:function(e){return k.app.localization.e("e13218")+" (0/4)"}},{id:"CONFIRMATIONS1",time:10,currentLabel:function(e){return k.app.localization.e("e13218")+" (1/4)"}},{id:"CONFIRMATIONS2",time:10,currentLabel:function(e){return k.app.localization.e("e13218")+" (2/4)"}},{id:"CONFIRMATIONS3",time:10,currentLabel:function(e){return k.app.localization.e("e13218")+" (3/4)"}},{id:"POCSENT",time:4,currentLabel:function(e){return k.app.localization.e("e13219")}},{id:"POCDELEVERED",finish:!0,currentLabel:function(e){return k.app.localization.e("e13220")}}]},m=[],h=[],g=0,v={showCrInStep:function(t,e,n,a){y.step(function(e){y.crowdfunding(function(e){t&&v[t](e,a),y.stepC(e,n)},e)},e,{class:"crowdfunding",view:t})},olddeal:function(e,t){y.crDeal(t,k.app.platform.sdk.exchanges.info[t.info.address],e.find(".actionbody"))},newdeal:function(a){var e={currency:i.parameters.currency.value,address:i.parameters.reciever.value,amount:i.parameters.amount.value,currencyAmount:i.parameters.currencyAmount.value};v.pocAddress(e,function(e,t,n){e?sitemessage(k.app.localization.e("errorreload")+" (error: 0003)"):y.crDeal(t,n,a.find(".actionbody"))})},showListcount:function(n){k.app.platform.sdk.exchanges.statuses(function(e,t){e?sitemessage(k.app.localization.e("errorreload")+" (error: 0004)"):y.showListcount(t,n.find(".actionbody"))})},status:function(){},pocAddress:function(e,a){(e=e||{}).reciever&&"pnetwallet"!=e.reciever||(e.address=k.app.platform.sdk.address.pnet().address),"wallet"==e.reciever&&(e.address=k.app.platform.sdk.addresses.storage.addresses[0]),e.currency&&e.address?k.app.platform.sdk.exchanges.address(e,function(e,t,n){e?a&&a("fail",null):a&&a(null,t,n)}):a&&a("no data",null)},sendAddresses:function(){var e=u.parameters.source.value;return p[e].addresses()},canChangeSend:function(){if(u.parameters.reciever.value){var n=null;if(_.find(t,function(e,t){return n=t,u.parameters.reciever.value==e||u.parameters.reciever.value==t}))return n}return null},htlsParameters:function(){f.parameters.source.value;var e=v.sendAddresses();k.app.platform.sdk.node.transactions.get.balance(function(e){f.parameters.amount.value>e&&(f.parameters.amount.value=e)},e,null,!0)},sendParameters:function(){var n=u.parameters.source.value;u.parameters.reciever.possibleValues=[],u.parameters.reciever.possibleValuesLabels=[],_.each(t,function(e,t){t!=n&&"total"!=n&&(u.parameters.reciever.possibleValues.push(t),u.parameters.reciever.possibleValuesLabels.push(e))}),"total"==n&&_.find(t,function(e,t){return u.parameters.reciever.value==e||u.parameters.reciever.value==t})&&(u.parameters.reciever.value=""),_.each(k.sdk.activity.latest,function(t,e){_.each(t,function(e){7<t||"user"==e.type&&e.id!=k.app.platform.sdk.address.pnet().address&&(t++,u.parameters.reciever.possibleValues.push(e.id),u.parameters.reciever.possibleValuesLabels.push(e.data))})}),u.parameters.reciever.value!=n&&u.parameters.reciever.value!=t[n]||(u.parameters.reciever.value=u.parameters.reciever.possibleValuesLabels[0]),u.parameters.reciever.possibleValues.length?u.parameters.reciever.placeholder=k.app.localization.e("wrenteraddressselect"):u.parameters.reciever.placeholder=k.app.localization.e("wrenteraddress");var e=v.sendAddresses();k.app.platform.sdk.node.transactions.get.balance(function(e){u.parameters.amount.value>e&&(u.parameters.amount.value=e)},e,null,!0)},addaddress:function(){var e=k.app.platform.sdk.addresses.storage.addresses.length;k.app.platform.sdk.addresses.addWalletAddress(e),k.app.platform.sdk.addresses.save(),topPreloader(0),b(function(){topPreloader(100)})},linkValidation:function(){return 0<a.parameters.depositamount.value&&trim(a.parameters.message.value)&&trim(a.parameters.label.value)},linkValidationQr:function(){return 0<a.parameters.depositamount.value},showDepositInStep:function(t,e,n){y.step(function(e){y.deposit(function(e){v[t](e),y.stepB(e,n)},e)},e,{class:"deposit"})},showQrResult:function(e){a.address&&v.linkValidationQr()&&y.qrResultForDeposit(a.address,e.find(".actionbody"))},showLinkResult:function(e){a.address&&v.linkValidation()&&y.linkResultForDeposit(a.address,e.find(".actionbody"))},showLinkMaker:function(e){a.address&&y.linkMakerForDeposit(a.address,e.find(".actionbody"))},showQrMaker:function(e){a.address&&y.qrMakerForDeposit(a.address,e.find(".actionbody"))},showDeposit:function(t){a.address="";var e=a.parameters.deposit.value,n="";if(a.active=!0,"pnetwallet"==e)return n=k.app.platform.sdk.address.pnet().address,a.address=n,void y.addressForDeposit(n,t.find(".actionbody"));"wallet"==e&&k.app.platform.sdk.addresses.addNewWalletAddress(function(e){k.app.platform.sdk.addresses.save(),n=e,a.address=n,y.addresses(),y.addressForDeposit(n,t.find(".actionbody"))})},showSendInStep:function(t,e,n,a){y.step(function(e){y.send(function(e){v[t](e),y.stepB(e,n),a&&a()},e)},e,{class:"send"})},showHtlsInStep:function(t,e,n,a){var o=l.c.find(".htlsnoredraw");o.length?(g=e,console.log("ACTION",t),v[t](o),y.stepB(o,n),a&&a()):y.step(function(e){y.htls(function(e){v[t](e),y.stepB(e,n),a&&a()},e)},e,{class:"htls"})},calculateFee:function(t){k.app.platform.sdk.node.fee.estimate(function(e){y.sendFees(t.find(".actionbody"),e)})},calculateFeeHtls:function(t){console.log("calculateFeeHtls"),k.app.platform.sdk.node.fee.estimate(function(e){console.log(t,e),y.htlsFees(t.find(".actionbody"),e)})},validHtls:function(){var e=f.parameters.amount.value;return console.log("htls.parameters.amount.value",f.parameters.amount.value),0<e},validSend:function(){var e=u.parameters.amount.value,t=u.parameters.reciever.value;return!!(0<e&&t)},prepareTransactionCommon:function(t,e,n,s,a,r){function o(a,o,i){k.app.platform.sdk.wallet.txbase(a,_.clone(o),0,i,function(e,t,n){e?sitemessage(e):(n=k.app.platform.sdk.node.transactions.create.wallet(t,n),n=Math.min(n.virtualSize()*s,.0999),r&&r(a,o,n,i))})}var i=v.sendAddresses(),l=[];if("pnetwallet"==e||e==k.app.localization.e("tacaddress"))return l.push({address:k.app.platform.sdk.address.pnet().address,amount:t}),void o(i,l,n);"wallet"!=e&&e!=k.app.localization.e("twallet")?(l.push({address:e,amount:t}),k.sdk.wallet.embed(l,a),o(i,l,n)):k.app.platform.sdk.addresses.getFirstRandomAddress(function(e){l.push({address:e,amount:t}),k.app.platform.sdk.addresses.save(),o(i,l,n)})},prepareTransaction:function(e,t){var n=u.parameters.amount.value,a=u.parameters.fees.value,o=u.parameters.message.value,i=u.parameters.reciever.value;v.prepareTransactionCommon(n,i,a,e,o,t)},prepareTransactionHlts:function(o,e,i){var n=f.parameters.amount.value,s=f.parameters.fees.value,r=v.sendAddresses(),l=[];k.app.platform.sdk.address.pnet().address,l.push({amount:n,key:"htlc"}),k.app.platform.sdk.wallet.txbase(r,_.clone(l),e,s,function(e,a,t){e?sitemessage(e):k.sdk.node.transactions.htls.plcreate(d.htls,n,a,t,function(e,t){var n=e.build(),e=Math.min(n.virtualSize()*o,.0999);i&&i(r,l,a,e,s,t,n)})})}},y={clearMain:function(e){k.shell({animation:{id:"fadeInByElement",selector:".fadeInByElement",timeouts:150},clear:!0,el:l.c.find(".animationWrapper")},e)},clearStep:function(e){k.shell({animation:{id:"fadeInByElement",selector:".fadeInByElementStep",timeouts:150},clear:!0,el:l.step},e)},mainWithClear:function(e){m=[],h=[],y.clearStep(function(){y.main(function(){b()})})},main:function(e){k.shell({name:"main",el:l.main,data:{},animation:"fadeIn"},function(){l.total=l.c.find(".total .tttl"),l.totaler=l.c.find(".total .tttlforerror"),l.addresses=l.c.find(".addresses"),l.send=l.c.find(".send"),l.deposit=l.c.find(".deposit"),l.crowdfunding=l.c.find(".crowdfunding"),l.htls=l.c.find(".htls"),console.log("el.htls",l.htls),k.iclbks.main=function(){k.app.errors.connection()?l.totaler.addClass("active"):l.totaler.removeClass("active")},e&&e()})},stepC:function(e,t){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+k.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(t||"")},stepB:function(e,t){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+k.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(t||"")},step:function(t,e,n){n=n||{},g==e?t&&t(l.c.find(".step")):(m[g=e]=t,h[e]=n,y.clearMain(function(){_scrollToTop(l.step,0,200,-70),setTimeout(function(){k.shell({name:"step",el:l.step,data:{},animation:"fadeIn"},function(e){e=e.el.find(".step"),n.class&&e.addClass(n.class),n.view?e.attr("view",n.view):e.removeAttr("view"),t&&t(e)})},200)}))},showListcount:function(e,t){var n=k.app.platform.sdk.exchanges.get();k.shell({name:"listcr",el:t,data:{list:n,c:i}},function(a){function o(e,t){k.app.platform.sdk.exchanges.remove(e.currency,e.info.address),t.remove(),(n=k.app.platform.sdk.exchanges.get()).length||y.step(m[g-1],g-1,h[g-1])}a.el.find(".removecr").on("click",function(){var n=$(this).closest(".item"),e=n.attr("item"),a=k.app.platform.sdk.exchanges.find(e);k.app.platform.sdk.exchanges.status(a.currency,a.info.address,function(e,t){e?sitemessage(k.app.localization.e("errorreload")+" (error: 0006)"):"AWAITINGFUNDS"==t.Status||"EXPIREDAWAITINGFUNDS"==t.Status?o(a,n):dialog({html:k.app.localization.e("e13221"),success:function(){o(a,n)}})})}),a.el.find(".updatecr").on("click",function(){var n=$(this).closest(".item"),e=n.attr("item"),a=k.app.platform.sdk.exchanges.find(e);a?k.app.platform.sdk.exchanges.status({address:a.info.address,currency:a.currency},function(e,t){e?sitemessage(k.app.localization.e("errorreload")+" (error: 0002)"):y.crStatus(a,t,n.find(".status"))}):sitemessage(k.app.localization.e("errorreload")+" (error: 0001)")}),a.el.on("click",".todeal",function(){var e=$(this).closest(".item").attr("item"),e=k.app.platform.sdk.exchanges.find(e);v.showCrInStep("olddeal",g+1,"Deal",e)}),lazyEach({array:n,action:function(e){var t=e.item,n=a.el.find('[item="'+t.info.address+'"] .status'),e=k.app.platform.sdk.exchanges.info[t.info.address];y.crStatus(t,e,n)}})})},listcount:function(e){var t=k.app.platform.sdk.exchanges.get(),n=e.find(".listcountWrapper");0<t.length?(t="("+t.length+")",e.find(".listcount").html(t),n.fadeIn()):n.fadeOut()},crdealstatusstep:function(e,t,n){k.shell({name:"crdealstatusstep",el:n,data:{addressobject:e,info:t}},function(e){})},crDeal:function(a,o,e){k.shell({name:"crdeal",el:e,data:{addressobject:a}},function(n){y.crStatus(a,o,n.el.find(".status")),y.crdealstatusstep(a,o,n.el.find(".crdealstatusstep")),n.el.on("click",".copyaddress1",function(){copyText(n.el.find(".forcopyaddress1")),sitemessage(k.app.localization.e("waddresswascop"))}),n.el.on("click",".copyaddress2",function(){copyText(n.el.find(".forcopyaddress2")),sitemessage(k.app.localization.e("waddresswascop"))}),n.el.on("click",".reactivate",function(){k.app.platform.sdk.exchanges.reactivate({address:a.info.address,currency:a.currency},function(e,t){e?sitemessage(k.app.localization.e("errorreload")+" (error: 0002)"):(o=t,y.crStatus(a,o,n.el.find(".status")),y.crdealstatusstep(a,o,n.el.find(".crdealstatusstep")))})})})},applyStatus:function(a,o){_.find(i.segments,function(e){var t=o.find('.segment[segment="'+e.id+'"]');if(e.id==a.Status){var n=100*Math.min((Number(e.time)-Number(a.MinutesLeft))/Number(e.time),.99);return t.find(".line").css("width",n+"%"),t.addClass("active"),e.class&&t.addClass(e.class),e.finish&&(t.addClass("ended"),t.find(".line").css("width","100%")),!e.finish&&"all"!=e.exclude||o.find(".current").html(e.currentLabel(a)),!0}t.addClass("ended"),t.find(".line").css("width","100%")})},crStatus:function(e,t,n,a){k.shell({name:"pocstatus",el:n,data:{addressobject:e,info:t,segments:i.segments}},function(e){y.applyStatus(t,n),a&&a()})},crowdRate:function(e,t,n){e.find(".rate .value").html("<b>1 PKOIN = "+t[n].toFixed(6)+" "+n.toUpperCase()+"</b>")},crowdCurrencyLabel:function(e,t){e.find(".currencyAmountLabel").html(t.toUpperCase()+" "+k.app.localization.e("amount")+"</b>")},crowdfunding:function(e,t){2==g&&(m[1]=function(e){v.showCrInStep("",1,"")},h[1]={class:"crowdfunding"}),i.parameters.currency||(i.parameters.currency.value="btc"),k.app.platform.sdk.exchanges.rates(function(a){k.app.platform.sdk.node.transactions.get.balance(function(n){n=Math.min(n/3,1e3),k.shell({name:"crowdfunding",el:t||l.crowdfunding,data:{d:i,amount:n}},function(t){ParametersLive(_.toArray(i.parameters),t.el),t.el.on("click",".closeAdditional",o),y.crowdRate(t.el,a,i.parameters.currency.value),y.crowdCurrencyLabel(t.el,i.parameters.currency.value),y.listcount(t.el),i.parameters.amount._onChange=function(e){i.parameters.amount.value<0&&(i.parameters.amount.value=0),i.parameters.amount.value>n&&(i.parameters.amount.value=n),i.parameters.currencyAmount.value=i.parameters.amount.value*a[i.parameters.currency.value],i.parameters.amount.el.closest(".inputWrapper").html(i.parameters.amount.input()),i.parameters.currencyAmount.el.closest(".inputWrapper").html(i.parameters.currencyAmount.input()),ParametersLive([i.parameters.amount,i.parameters.currencyAmount],t.el)},i.parameters.currency._onChange=function(e){k.app.platform.sdk.exchanges.rates(function(e){a=e,y.crowdRate(t.el,a,i.parameters.currency.value),y.crowdCurrencyLabel(t.el,i.parameters.currency.value)})},i.parameters.currencyAmount._onChange=function(e){i.parameters.currencyAmount.value<0&&(i.parameters.currencyAmount.value=0),i.parameters.currencyAmount.value/a[i.parameters.currency.value]>n&&(i.parameters.currencyAmount.value=Number((n*a[i.parameters.currency.value]).toFixed(6))),i.parameters.amount.value=i.parameters.currencyAmount.value/a[i.parameters.currency.value],i.parameters.amount.el.closest(".inputWrapper").html(i.parameters.amount.input()),i.parameters.currencyAmount.el.closest(".inputWrapper").html(i.parameters.currencyAmount.input()),ParametersLive([i.parameters.amount,i.parameters.currencyAmount],t.el)},t.el.find(".listcountWrapper").on("click",function(){v.showCrInStep("showListcount",2,"List of deals")}),t.el.find(".newdeal").on("click",function(){0<i.parameters.amount.value?(v.showCrInStep("newdeal",2,"Deal"),t.el.find(".required").addClass("hidden")):t.el.find(".required").removeClass("hidden")}),e&&e(t.el)})},"PFF7PevK753eYTwWBScdEAbWQrgu36AdUA",!0,!0)})},qrResultForDeposit:function(e,t,n){k.shell({name:"depositqrresult",el:t,data:{address:e,d:a}},function(e){})},linkResultForDeposit:function(e,t,n){k.shell({name:"depositlinkresult",el:t,data:{address:e,d:a}},function(e){e.el.find(".copylink").on("click",function(){copyText(e.el.find(".linkInTextArea")),sitemessage(k.app.localization.e("waddresswascop"))})})},linkMakerForDeposit:function(e,t,n){k.shell({name:"depositlinkmaker",el:t,data:{address:e,d:a}},function(e){var t=e.el.find(".getlink"),n=[a.parameters.depositamount,a.parameters.message,a.parameters.label];ParametersLive(n,e.el),_.each(n,function(e){e._onChange=function(){v.linkValidation()?t.removeClass("disabled"):t.addClass("disabled")}}),v.linkValidation()&&t.removeClass("disabled"),t.on("click",function(){v.linkValidation()&&v.showDepositInStep("showLinkResult",3,k.app.localization.e("linkCreated"))})})},qrMakerForDeposit:function(e,t,n){k.shell({name:"depositqrmaker",el:t,data:{address:e,d:a}},function(e){var t=e.el.find(".getlink"),n=[a.parameters.depositamount,a.parameters.message,a.parameters.label];ParametersLive(n,e.el),_.each(n,function(e){e._onChange=function(){v.linkValidationQr()?t.removeClass("disabled"):t.addClass("disabled")}}),v.linkValidationQr()&&t.removeClass("disabled"),t.on("click",function(){v.linkValidationQr()&&v.showDepositInStep("showQrResult",3,k.app.localization.e("wqrcodecreated"))})})},addressForDeposit:function(e,t,n){k.shell({name:"depositaddress",el:t,data:{address:e,d:a}},function(e){e.el.find(".getlink").on("click",function(){v.showDepositInStep("showLinkMaker",2,k.app.localization.e("wlinkcreating"))}),e.el.find(".qrcode").on("click",function(){v.showDepositInStep("showQrMaker",2,k.app.localization.e("wqrcodecreating"))}),e.el.find(".copyaddress").on("click",function(){copyText(e.el.find(".adr")),sitemessage(k.app.localization.e("waddresswascop"))})})},deposit:function(e,t){k.shell({name:"deposit",el:t||l.deposit,data:{d:a}},function(t){ParametersLive([a.parameters.deposit],t.el),a.parameters.deposit._onChange=function(e){k.app.settings.set(k.map.uri,"deposit",e),e=a.parameters.deposit.labelByValue(e),t.el.find(".type").html(e),v.showDepositInStep("showDeposit",1,k.app.localization.e("wdoptions"))},t.el.find(".recieveaddress").on("click",function(){v.showDepositInStep("showDeposit",1,k.app.localization.e("wdoptions"))}),t.el.on("click",".closeAdditional",o),e&&e(t.el)})},embeddingcode:function(e){var t={comments:"no",footer:"no"},t=hexEncode(JSON.stringify(t)),n=rand(1e4,99999);return'<div id="pocketnet_'+n+'"></div><script src="https://'+k.app.options.url+'/js/widgets.js"><\/script><script type="text/javascript">(new window.PNWIDGETS()).make('+n+', "lenta", "'+e+'", "'+t+'")<\/script>'},htlsFees:function(s,e,t){var l;console.log("el, fees",s,e),v.validHtls()&&(l=e.feerate||1e-6,console.log("htlsFees",l),v.prepareTransactionHlts(l,0,function(e,t,n,a,o,i){console.log("prepareTransactionHlts",a),k.shell({name:"htlsFees",el:s,data:{fees:a,d:f,meta:i}},function(t){function r(e){e?t.el.find(".sendtransaction").addClass("loading"):t.el.find(".sendtransaction").removeClass("loading")}ParametersLive([f.parameters.fees],t.el),f.parameters.fees._onChange=function(e){k.app.settings.set(k.map.uri,"feesModehtls",e)},t.el.find(".sendtransaction").on("click",function(){$(this).hasClass("loading")||(r(!0),v.prepareTransactionHlts(l,a,function(e,n,a,t,o,i,s){console.log("TX",s),_.each(a,function(e){e.cantspend=!0}),k.app.platform.sdk.node.transactions.send(s,function(e,t){console.log("err",t),t?(k.app.platform.sdk.node.transactions.releaseCS(a),r(!1),k.app.platform.errorHandler(t,!0)):(t=_.map(a,function(e){return e.txid}),k.app.platform.sdk.node.transactions.clearUnspents(t),g=0,y.mainWithClear(),k.app.platform.sdk.wallet.saveTempInfoWallet(e,a,n),r(!1),sitemessage(k.app.localization.e("wssuccessfully")))})}))})})}))},htls:function(e,t){console.log("el.htls",l.htls),v.htlsParameters(),k.shell({name:"htls",el:t||l.htls,data:{d:f,ed:d}},function(n){ParametersLive(_.toArray(f.parameters),n.el),f.parameters.amount._onChange=function(e){var t=v.sendAddresses();k.app.platform.sdk.node.transactions.get.balance(function(e){f.parameters.amount.value<0&&(f.parameters.amount.value=0),f.parameters.amount.value>e&&(f.parameters.amount.value=e),f.parameters.amount.el.closest(".inputWrapper").html(f.parameters.amount.input()),ParametersLive([f.parameters.amount],n.el),console.log("MODE",g),1==g&&v.showHtlsInStep("calculateFeeHtls",1,"htls")},t,null,!0)},n.el.find(".calculateFee").on("click",function(){v.validHtls()?(v.showHtlsInStep("calculateFeeHtls",1,"htls"),n.el.find(".required").addClass("hidden")):n.el.find(".required").removeClass("hidden")}),d.htls&&n.el.find(".htlsWrapper").html(y.embeddingcode(d.htls)),e&&e(n.el)})},sendFees:function(o,e,t){var i;v.validSend()&&(i=e.feerate||1e-6,v.prepareTransaction(i,function(e,t,n,a){k.shell({name:"sendfees",el:o,data:{fees:n,d:u}},function(t){function o(e){e?t.el.find(".sendtransaction").addClass("loading"):t.el.find(".sendtransaction").removeClass("loading")}ParametersLive([u.parameters.fees],t.el),u.parameters.fees._onChange=function(e){k.app.settings.set(k.map.uri,"feesMode",e)},t.el.find(".sendtransaction").on("click",function(){$(this).hasClass("loading")||(o(!0),v.prepareTransaction(i,function(e,t,n,a){k.app.platform.sdk.wallet.txbase(e,_.clone(t),n,a,function(e,n,a){return e?(o(!1),void sitemessage(e.text||e)):(e=k.app.platform.sdk.node.transactions.create.wallet(n,a),_.each(n,function(e){e.cantspend=!0}),void k.app.platform.sdk.node.transactions.send(e,function(e,t){console.log("err",t),t?(k.app.platform.sdk.node.transactions.releaseCS(n),o(!1),sitemessage(t.text||t)):(t=_.map(n,function(e){return e.txid}),k.app.platform.sdk.node.transactions.clearUnspents(t),g=0,y.mainWithClear(),k.app.platform.sdk.wallet.saveTempInfoWallet(e,n,a),o(!1),sitemessage(k.app.localization.e("wssuccessfully")),k.app.platform.matrixchat.transaction(e,d.roomid),d.sendclbk&&d.sendclbk({txid:e}))}))})}))})})}))},send:function(t,e){v.sendParameters(),k.shell({name:"send",el:e||l.send,data:{d:u}},function(n){function a(){v.canChangeSend()?e.removeClass("hidden"):e.addClass("hidden")}ParametersLive(_.toArray(u.parameters),n.el);var e=n.el.find(".change");u.parameters.amount._onChange=function(e){var t=v.sendAddresses();k.app.platform.sdk.node.transactions.get.balance(function(e){u.parameters.amount.value<0&&(u.parameters.amount.value=0),u.parameters.amount.value>e&&(u.parameters.amount.value=e),u.parameters.amount.el.closest(".inputWrapper").html(u.parameters.amount.input()),ParametersLive([u.parameters.amount],n.el),1==g&&v.showSendInStep("calculateFee",1,k.app.localization.e("wscalculatefees"))},t,null,!0)},u.parameters.source._onChange=function(e){v.sendParameters(),u.parameters.reciever.el.closest(".inputWrapper").html(u.parameters.reciever.input()),u.parameters.amount.el.closest(".inputWrapper").html(u.parameters.amount.input()),ParametersLive([u.parameters.reciever,u.parameters.amount],n.el),a(),1==g&&v.showSendInStep("calculateFee",1,k.app.localization.e("wscalculatefees"))},u.parameters.reciever._onChange=function(e){if(a(),!v.canChangeSend()&&e){var t=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){t=!1}t?(n.el.find(".notvalidaddress").html(""),e[0]):n.el.find(".notvalidaddress").html(k.app.localization.e("wsaddressnotv"))}else n.el.find(".notvalidaddress").html("")},e.on("click",function(){var e=v.canChangeSend();e&&(u.parameters.source.value=e,u.parameters.source._onChange(),u.parameters.source.el.closest(".inputWrapper").html(u.parameters.source.input()),ParametersLive([u.parameters.source],n.el))}),n.el.find(".calculateFee").on("click",function(){v.validSend()?(v.showSendInStep("calculateFee",1,k.app.localization.e("wscalculatefees")),n.el.find(".required").addClass("hidden")):n.el.find(".required").removeClass("hidden")}),a(),t&&t(n.el)})},addresses:function(a){var o=p.total.addresses(),i={};k.app.platform.sdk.node.transactions.get.unspents(function(n){k.app.platform.sdk.node.transactions.get.balance(function(e){_.each(n,function(e,t){i[t]=_.reduce(e,function(e,t){return e+Number(t.amount)},0)});var t=[p.pnetwallet,p.wallet],t=_.map(t,function(e){var t=_.map(e.addresses(),function(e){return{balance:i[e],address:e}});return{caption:e.caption,details:t,label:e.alabel}},o);k.shell({name:"addresses",el:l.addresses,data:{addressesGroup:t,total:e}},function(e){e.el.find(".addaddress").on("click",r),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(k.app.localization.e("successcopied"))}),a&&a()})},o)},o)},updateTotal:function(e,t){y.datasets(e,c[e.id].data.datasets),c[e.id].update(),l.total&&l.total.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(k.app.platform.mp.coinwithsmall(e.balance)),t&&t()},datasets:function(e,t){var n=[],a=_.map(e.move,function(e){return n.push(e.color),Number(e.summary||0)}),o=[],i=[],s=[],r=[],l="#F1F1F1";$("html").hasClass("stblack")&&(l="#112035"),_.each(e.move,function(e){_.each(e.items,function(e){o.push(Number(e.value)),i.push(e.color),s.push(l),r.push(8)})});var c=[{data:a,backgroundColor:n,borderColor:[l,l],borderWidth:[8,8]},{data:o,backgroundColor:i,borderColor:s,borderWidth:r}];return _.each(t,function(e,t){e.data=c[t].data}),c},total:function(t,n){t.update?y.updateTotal(t,n):k.shell({name:"total",el:l.total,inner:append,data:{item:t}},function(e){e=e.el.find("#chart"+t.id)[0].getContext("2d"),c[t.id]=new Chart(e,{type:"doughnut",data:{datasets:y.datasets(t)},options:{rotation:.5*Math.PI,cutoutPercentage:85}}),n&&n()})}},b=function(t){l.total.html(""),n(function(){var e=[y.send,y.deposit,y.addresses];lazyActions(e,t),k.app.platform.sdk.node.transactions.clbks.circles=function(){n(null,!0)},k.app.platform.sdk.node.transactions.clbks.walletaddresses=function(){y.addresses()}}),k.app.platform.sdk.node.transactions.get.allBalance(null,!0)};return{primary:e,getdata:function(e,t){var n={};n.p2pkh=k.app.platform.sdk.address.pnet(),d=t.settings.essenseData||{},a.parameters.deposit.value=k.app.settings.get(k.map.uri,"deposit")||a.parameters.deposit.defaultValue,u.parameters.source.value=k.app.settings.get(k.map.uri,"source")||u.parameters.source.defaultValue,u.parameters.reciever.value="",u.parameters.fees.value=k.app.settings.get(k.map.uri,"feesMode")||u.parameters.fees.defaultValue,f.parameters.fees.value=k.app.settings.get(k.map.uri,"feesModehtls")||f.parameters.fees.defaultValue,a.active=!1,g=0,m=[],h=[],e(n)},destroy:function(){delete k.app.platform.sdk.node.transactions.clbks.circles,delete k.app.platform.sdk.node.transactions.clbks.walletaddresses,delete k.iclbks.main,l={}},init:function(e){var n,a,t,o=_.extend(parameters(),d);c={},(l={}).c=e.el.find("#"+k.map.id),l.step=l.c.find(".actionstep"),l.main=l.c.find(".mainstep"),l.c.on("click","._stepclose",function(){g=0,y.mainWithClear()}),l.c.on("click","._stepback",function(){1<g?y.step(m[g-1],g-1,h[g-1]):(g=0,y.mainWithClear())}),isMobile()&&(n=l.c.find(".circularprogress"),(a=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),l.c.find(".circularprogressWrapper").html(a.el),t=$(window),d.api||new SwipeParallaxNew({el:l.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/80;console.log("PX",e),0<=e?(a.options.text={value:""},n.fadeIn(1),a.update(100*t),n.height(220*t+"px")):(a.renew(),n.fadeOut(1))},constraints:function(){if(t.scrollTop()<=0)return!0},restrict:!0,trueshold:80,clbk:function(){a.update(0),n.fadeOut(1),k.app.platform.sdk.notifications.getNotifications(),k.app.platform.sdk.node.transactions.get.allBalanceUpdate(function(){b()})}}}}).init()),d.class&&l.c.addClass(d.class);var i=b;o.api&&(i=s),y.main(function(){i(function(){console.log("_p",o),o.action&&("send"==o.action&&(u.parameters.amount.value=Number((o.amount||"0").replace(/,/g,"")),u.parameters.reciever.value=o.address||"",u.parameters.message.value=o.message||"",u.parameters.amount._onChange(),v.showSendInStep("calculateFee",1,k.app.localization.e("wscalculatefees"),function(){l.c.removeClass("loading")})),"htls"==o.action&&(console.log("actions.showSendInStep"),v.showHtlsInStep("calculateFeeHtls",1,"HTLS",function(){l.c.removeClass("loading")})),"recieve"==o.action&&v.showDepositInStep("showDeposit",1,k.app.localization.e("wdoptions"))),e.clbk(null,e)})})},wnd:{class:"withoutButtons walletwindow"}}}var k=new nModule,a={};return k.run=function(e){var t=k.addEssense(a,n,e);k.init(t,e)},k.stop=function(){_.each(a,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=wallet:(app.modules.wallet={},app.modules.wallet.module=wallet);var share=function(){function n(e){var s,i,a,o=/[,.!?;:() \n\r]/g,t=deep(e,"history"),r=null,l=!1,c=null,d={},n=v.app.localization.e("e13160"),p={resizeImage:function(e,t={}){var o=[{original:e,index:0}];return new Promise((n,a)=>{v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:0,images:o,apply:!0,crop:{aspectRatio:t.aspectRatio||16/9,style:"apply",autoCropArea:.95},success:function(e,t){resize(o[0].original,1920,1080,function(e){e.split(",")[1]?(t(),n(e)):a("error")})}}})})},uploadVideoWallpaper:function(t){var n=(r.url||{}).v||"",a={thumbnailfile:t},o={};return v.app.platform.sdk.videos.info([n]).then(()=>(v.app.platform.sdk.videos.storage[n]||{}).data).then((e={})=>(o.aspectRatio=e.aspectRatio,toDataURL(t))).then(e=>p.resizeImage(e,o)).then(e=>{var t=v.app.peertubeHandler.parselink(n).host||null;return a.image={data:e},v.app.peertubeHandler.api.videos.update(n,a,{host:t})}).catch(e=>{e=e.text||findResponseError(e)||"Updating error",sitemessage(e)})},language:function(a){var e=[];_.each(v.app.localization.available,function(n){e.push({text:n.name,action:function(e){var t=app.localization.findByName(n.name);t&&t.key!=r.language.v&&r.language.set(t.key),e(),m.postline(),a&&a()}})}),menuDialog({items:e})},toggleTimesDisplay:function(){var e=r.message.v||r.caption.v||r.repost.v||r.url.v||r.images.v.length||r.tags.v.length;s.times&&(e&&s.times.removeClass("hide"),e||s.times.addClass("hide"))},tooltips:function(){p.tooltip},tooltip:function(){},unfocus:function(){s.c&&s.c.addClass("unfocus").removeClass("focus")},waitActions:function(){v.app.platform.sdk.user.waitActions(function(e){s.c&&(e&&"inf"!=e?s.c.addClass("waitActions"):s.c.removeClass("waitActions"))})},autoFilled:function(){p.filled("i",0!=r.images.v.length),p.filled("u",r.url.v),p.filled("t",0!=r.tags.v.length),p.filled("cm",r.message.v||r.caption.v),p.filled("p",r.poll.v.list)},filled:function(e,t){e=s.c.find('.draggablepart[part="'+e+'"]'),t?e.addClass("filled"):e.removeClass("filled")},checkUrlForImage:function(t){if(t=t.split("?")[0].toLowerCase(),_.find(["jpg","gif","png","jpeg","webp","jfif"],function(e){if(-1<t.indexOf(e))return!0}))return!0},embeding20:function(e){var t=r.export(!0);v.nav.api.load({open:!0,id:"embeding20",inWnd:!0,essenseData:{storage:t,value:e,on:{added:function(e){"url"==type&&e&&p.checkUrlForImage(e)&&(type="images"),r[type].set(e),m[type]&&m[type]()}}}})},embeding:function(a,e){var t=r.export(!0);"addVideo"!==a&&"addStream"!==a||m.streamPage({value:e,storage:t,type:a}),"article"!=a?"times"!=a?"url"!=a&&"images"!=a||(l=!0,v.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:a,storage:t,value:e,on:{added:function(e){var n=!0;"url"==a&&e&&p.checkUrlForImage(e)&&(a="images"),_.isArray(e)||(e=[e]),_.each(e,function(e,t){n=r[a].set(e),i.share||h.save()}),!n&&u[a]&&sitemessage(u[a]),"url"==a?m.all():m[a]&&m[a]()}}},clbk:function(e,t){c=t}})):dialog({html:v.app.localization.e("e14002"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),class:"zindex",success:function(){var e=r.url.v;v.app.peertubeHandler.checklink(e)&&p.removevideo(e),r.clear(),r.language.set(v.app.localization.key),g()},fail:function(){}}):v.nav.api.load({open:!0,id:"articles",inWnd:!0,history:!0,essenseData:{storage:t,value:e,on:{added:function(e){}}},clbk:function(e){c=e}})},addTags:function(e){_.find(e,function(e){return r.tags.set(e)?(s.error.html(""),void(i.share||h.save())):(s.error.html(v.app.localization.e("e13162")),!0)})},addTag:function(e){r.tags.set(e)?(s.error.html(""),i.share||h.save()):s.error.html(v.app.localization.e("e13162"))},removeTags:function(e){var t=s.eMessage[0].emojioneArea.getText();_.each(e,function(e){r.tags.remove(e),t=t.split("#"+e).join(e)}),s.eMessage[0].emojioneArea.setText(t),i.share||h.save()},removeTag:function(e){r.tags.remove(e);var t=(t=s.eMessage[0].emojioneArea.getText()).split("#"+e).join(e);s.eMessage[0].emojioneArea.setText(t),i.share||h.save()},editImage:function(e){var t=_.map(r.images.v,function(e,t){return{original:e,index:t}}),a=_.filter(t,function(e){if(-1<e.original.indexOf("data:image"))return!0});l=!0,v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:a,close:function(){setTimeout(function(){l=!1},200)},success:function(e,t){_.each(r.images.v,function(e,t){var n=_.find(a,function(e){if(e.index==t)return!0});n&&(r.images.v[t]=n.original)}),i.share||h.save(),m.images(t)}}})},removeImage:function(n){var e=r.images.v.splice(n,1)[0];s.c.find(".imageContainer").each(function(){var e=$(this),t=e.attr("value");n<t&&e.attr("value",t-1),t==n&&e.remove()}),s.c.find(".imagesEmbWr").isotope();var t=(t=s.eMessage[0].emojioneArea.getText()).split(e).join("");s.eMessage[0].emojioneArea.setText(t),i.share||h.save()},removePoll:function(){r.poll.set(),i.share||h.save()},removevideo:function(t){r.settings.a=r.default.a,v.app.peertubeHandler.api.videos.remove(t).then(e=>{v.app.platform.sdk.videos.clearstorage(t)})},removelink:function(){var e=r.url.v;r.url.set();var t=(t=s.eMessage[0].emojioneArea.getText()).split(e).join("");s.eMessage[0].emojioneArea.setText(t),v.app.peertubeHandler.checklink(e)&&(p.removevideo(e),g()),i.share||h.save()},applyText:function(e){r.message.set(e)},caption:function(e){r.caption.set(e)},linksFromText:function(e){r.url.v||(e=e.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%|_\+.~#/?&//=]*)?/gi))&&0<e.length&&_.each(e,function(e){p.checkUrlForImage(e)?-1==r.images.v.indexOf(e)&&(r.images.set(e),m.images()):r.url.v||(r.url.set(e),m.url(),m.postline())})},tagsFromText:function(e){e=e.split(o),(e=_.filter(e,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))&&!r.tags.have(e)})).length&&(_.each(e,function(e){e=e.replace(/\#/g,""),r.tags.set(e)}),m.tgs())},post:function(a,t){if(s.postWrapper.removeClass("showError"),i.hash==r.shash())return s.postWrapper.addClass("showError"),void s.error.html(v.app.localization.e("e13163"));function e(){r.language.set(v.app.localization.key),r.uploadImages(v.app,function(){if(r.checkloaded()){var e=v.app.platform.errorHandler("imageerror",!0);return topPreloader(100),s.c.removeClass("loading"),void(e&&sitemessage(e))}v.sdk.node.transactions.create.commonFromUnspent(r,function(e,t){if(topPreloader(100),s.c.removeClass("loading"),e){try{var n=new pShare;n._import(e,!0),n.temp=!0,n.address=e.address,r.aliasid&&(n.edit="true"),r.time&&(n.time=r.time),v.app.platform.sdk.node.shares.add(n),i.notClear||(r.clear(),v.app.nav.api.history.removeParameters(["repost"]),v.closeContainer(),i.share||h.save(),g())}catch(e){console.log(e)}v.app.platform.sdk.user.get(function(e){e.postcnt++}),i.post?i.post():isMobile()?v.app.nav.api.load({open:!0,href:"index",history:!0}):_scrollTop(0),a&&a(!0),p.unfocus(),successCheck()}else a?a(!1,u[t]):(s.postWrapper.addClass("showError"),(t=v.app.platform.errorHandler(t,!0))&&s.error.html(t))},t)})}if(s.c.addClass("loading"),topPreloader(50),r.itisvideo()){const o={};r.message.v&&(o.description=`Watch more exciting videos at https://pocketnet.app/! \n ${r.message.v}`),r.caption.v&&(o.name=r.caption.v);var n=v.app.peertubeHandler.parselink(r.url.v);return o.host=n.host,v.app.peertubeHandler.api.videos.update(r.url.v,o).then(e).catch(e=>{e=e.text||findResponseError(e)||"Updating error",sitemessage(e),s.c.removeClass("loading"),topPreloader(100)})}e()},error:function(e){var t=r.validation();return p.toggleTimesDisplay(),t&&!e?(s.postWrapper&&s.postWrapper.addClass("showError"),s.error.html(u[t]),"message"==t&&s.c.find(".emojionearea-editor").focus(),"tags"==t&&s.c.find(".tgs input").focus(),"videocaption"==t&&s.caption.focus(),!0):(s.postWrapper&&s.postWrapper.removeClass("showError"),s.error&&s.error.html(""),!1)},eTextChange:function(e){e=e.getText(),p.tagsFromText(e),p.applyText(e),p.linksFromText(e),m.caption(),i.share||h.save()}},u={message:v.app.localization.e("emptymessage"),tags:v.app.localization.e("emptytags"),images:v.app.localization.e("maximages"),url:v.app.localization.e("e13164"),error_video:v.app.localization.e("e13165"),videocaption:v.app.localization.e("entervideocaption")},f={unfocus:function(e){s.c.hasClass("focus")&&!l&&0===s.c.has(e.target).length&&p.unfocus()},selectTime:function(){var e={day:null,hour:(e=(e=new Date).addMinutes(10)).getHours(),minutes:e.getMinutes()};i.time&&(e.day=i.time.yyyymmdd(),e.hour=i.time.getHours(),e.minutes=i.time.getMinutes()),v.fastTemplate("sharedate",function(e){dialog({html:e,btn1text:v.app.localization.e("daccept"),class:"one sharedate",clbk:function(e){},wrap:!0,success:function(e){var t=e.el.find(".day").val(),n=e.el.find(".hours").val(),e=e.el.find(".minutes").val(),t=(t=(t=strToDateSmall(t)).addHours(n)).addMinutes(e);return new Date<t?(i.time=t,s.selectTime.find(".selectedTime").html(convertDate(dateToStr(t))),i.selectTime&&i.selectTime(t),!0):(sitemessage(v.app.localization.e("pastdate")),!1)}})},{date:e})},changePostTime:function(){var e=$(this),t=$(this).val();"p"!=t?("t"==t&&(p.error()?e.val("w"):i.time&&i.time<new Date&&(i.time=null,s.selectTime.find(".selectedTime").html(v.app.localization.e("timenotselected")),i.selectTime&&i.selectTime(null))),t=$(this).val(),i.type&&i.type(t)):dialog({html:v.app.localization.e("sharenow"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),success:function(){i.type&&i.type(t)},fail:function(){e.val("w")}})},changeAddress:function(){var e=$(this).val(),t=s.c.find(".usericon"),n=deep(app,"platform.sdk.users.storage."+e+".image")||"";n?(t.html(""),t.attr("image",n),bgImages(s.c.find(".icon"))):(t.html('<svg width="30" height="30" data-jdenticon-value="'+e+'"></svg>'),t.attr("image",""),t.css("background","#F9F6F6"),t.css("background-image",""),t.css("background-size",""),t.css("background-position",""),t.css("background-repeat",""),s.c.find("[data-jdenticon-value]").each(function(){var e=$(this),t=e.data("jdenticon-value");e.html(jdenticon.toSvg(t,e.width()))})),i.address&&i.address(e)},change:function(){p.error(!0),p.autoFilled()},post:function(){var e=p.error();d.uploadInProgress?dialog({html:"Video is still uploading. Do you want to cancel it?",btn1text:"Wait",btn2text:"Cancel uploading",class:"videoCaution",success:()=>{},fail:()=>{d.cancelCloseFunction&&d.cancelCloseFunction()}}):e||p.post()},embeding:function(){var e=$(this).attr("embeding");"language"!=e?"poll"!=e?"embeding20"==e?p.embeding20():p.embeding(e):dialog({header:"Create new poll",class:"one joinbeta",poll:!0,btn1text:"Create",success:function(){var e=(t=$(".dialog .poll")).find(".title .input").val(),t=t.find(".poll-item .input").map(function(e,t){return $(t).val()}).filter(function(e,t){return t}),t=Array.from(t);r.poll.set({title:e,list:t}),m.poll()}}):p.language()},caption:function(){var e=$(this).val();p.caption(e)},eTextChange:function(e,t){p.eTextChange(this)},textChange:function(){var e=$(this).val();p.tagsFromText(e),p.applyText(e),p.linksFromText(e),m.caption()},eText:function(e,t){var n=String.fromCharCode(t.keyCode||t.which),t=this.getText();o.test(n)&&(p.tagsFromText(t),p.linksFromText(t)),p.applyText(t),m.caption(),i.share||h.save()},text:function(e){var t=String.fromCharCode(e.keyCode||e.which),e=$(this).val();o.test(t)&&(p.tagsFromText(e),p.linksFromText(e)),p.applyText(e),m.caption()},removelink:function(){p.removelink(),m.all()},removePoll:function(){p.removePoll(),m.poll()}},m={postline:function(t){v.app.platform.sdk.ustate.me(function(e){v.shell({name:"postline",el:s.postline,data:{share:r,essenseData:i,lkey:v.app.localization.key,u:e}},function(e){s.panel=s.c.find(".panel .item"),s.postWrapper=s.c.find(".postWrapper"),s.changePostTime=s.c.find(".postTime"),s.selectTime=s.c.find(".selectedTimeWrapper"),s.post=s.c.find(".post"),s.times=s.c.find(".panel .times"),s.changePostTime.on("change",f.changePostTime),s.selectTime.on("click",f.selectTime),s.panel.on("click",f.embeding),s.post.on("click",f.post),s.peertube=s.c.find(".peertube"),s.peertubeLiveStream=s.c.find(".peertubeLiveStream"),e.el.find(".cancelediting").on("click",function(){v.closeContainer(),d.cancelCloseFunction&&d.cancelCloseFunction(),i.close&&i.close()}),p.toggleTimesDisplay(),t&&t()})})},tgs:function(n){r.repost.value?n&&n():v.nav.api.load({open:!0,id:"taginput",el:s.tgsWrapperMain,eid:"sharetags",animation:!1,essenseData:{tags:function(){return r.tags.get()},removeTag:function(e){p.removeTag(e),m.tgs()},removeTags:function(e){p.removeTags(e),m.tgs()},addTag:function(e){p.addTag(e),m.tgs()},addTags:function(e){p.addTags(e),m.tgs()},language:function(){return r.language.get()}},clbk:function(e,t){s.c&&(a=t,n&&n())}})},all:function(){m.body(function(){s.eMessage[0].emojioneArea.setText(r.message.v),s.cpt.find("input").val(r.caption.v||""),s.cpt.val(),m.tgs(),m.url(),m.caption(),m.images(),m.poll(),m.repost(),m.postline()})},caption:function(){r.caption.v||r.itisvideo()?s.cpt.hasClass("active")||s.cpt.addClass("active"):s.cpt.removeClass("active")},streamPage(t={}){var e,n={addVideo:"uploadpeertube",addStream:"streampeertube"}[t.type];c&&c.id==n?c.container.show():(c&&c.container.close(),globalpreloader(!0),e=r.url?v.app.peertubeHandler.parselink(r.url.v).host:null,v.app.peertubeHandler.api.user.auth(e||v.app.peertubeHandler.active(),!0).then(e=>{globalpreloader(!1),v.nav.api.load({open:!0,id:n,inWnd:!0,history:!1,essenseData:{storage:t.storage,value:t.value,currentLink:r.url?r.url.v:"",actions:{added:function(e,t){e=r.url.set(e),r.settings.a=["i","u","cm","p"],r.caption.set(t),r.images.set(),r.repost.set(),i.share||h.save(),!e&&u.url&&sitemessage(u.url),g()}},closeClbk:function(){v.app.peertubeHandler.checklink(r.url.v)||s.peertube&&s.peertubeLiveStream,c=null,"streampeertube"!=n&&g()}},clbk:function(e,t){d=(c=t).essenseData,console.log("external",t)}})}).catch(e=>(console.log("E",e),globalpreloader(!1),sitemessage(e.text||"Undefined Error"))))},url:function(e){var t=r.url.v,o=v.app.platform.parseUrl(t),i=v.app.platform.sdk.remote.storage[t],n=()=>v.shell({name:"url",inner:html,el:s.urlWrapper,data:{url:r.url.v,og:i,remove:!0,share:r}},function(n){var a;r.url.v&&!i?"youtube"==o.type||"vimeo"==o.type||"bitchute"==o.type||"peertube"==o.type?(Plyr.setup("#"+v.map.id+" .js-player",function(e){e.muted=!1},{denyPeertubeAutoPlay:!0}),n.el.find(".removepeertube").on("click",function(){dialog({html:v.app.localization.e("removeVideoDialog"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),class:"zindex",success:function(){f.removelink()},fail:function(){}})}),n.el.find(".streaminfo").on("click",()=>{var e=r.export(!0);m.streamPage({storage:e,type:"addStream"})}),initUpload({el:s.urlWrapper.find(".uploadpeertubewp"),ext:["png","jpeg","jpg","webp","jfif"],dropZone:s.urlWrapper,multiple:!1,action:function(e,t){p.uploadVideoWallpaper(e.file).then(e=>{v.app.platform.sdk.videos.clearstorage(r.url.v),m.url()})},onError:function(e,t,n){sitemessage(n)}})):v.app.platform.sdk.remote.get(o.url,function(e){e&&m.url()}):i&&(a=n.el.find("img"),n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(a[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(a[t]).closest(".image").css("display","none")})}),n.el.find(".removeImage").on("click",function(){l=!0,r.settings.image="r",m.url(),h.save(),setTimeout(function(){l=!1},200)})),n.el.find(".removelink").on("click",f.removelink),e&&e()});"peertube"==o.type?v.app.platform.sdk.videos.info([t]).then(()=>n()).catch(()=>n()):n()},images:function(n){v.shell({name:"images",turi:"embeding",inner:html,el:s.images,data:{images:_.map(r.images.v||[],function(e,t){return{src:e,id:t}})}},function(e){e.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");p.removeImage(e)}),e.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");p.editImage(e)}),e.el.find(".image").on("click",function(){var e,t=$(this).attr("i");t&&(e=_.map(r.images,function(e){return{src:e}}),v.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:t,idName:"src",images:e}}))}),e.el.find(".image").imagesLoaded({background:!0},function(e){var t;isMobile()?(n&&n(),s.images.addClass("active")):((t=s.images.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:20},initLayout:!1}),t.on("arrangeComplete",function(){n&&n(),s.images.addClass("active")}),t.isotope())})})},repost:function(t){var n=r.repost.v;v.app.platform.sdk.node.shares.getbyid([n],function(){var e=v.app.platform.sdk.node.shares.storage.trx[n];v.shell({name:"repost",inner:html,el:s.repostWrapper,data:{repost:e,share:r,level:0}},function(e){n&&(v.app.platform.papi.post(n,e.el.find(".repostShare"),function(){},{repost:!0,eid:"share"}),e.el.find(".repostCaption").on("click",function(){r.repost.set(),h.save(),v.app.nav.api.history.removeParameters(["repost"]),m.repost(function(){m.tgs(),m.postline()})})),t&&t()})})},poll:function(e){var t,n=r.poll.get(),a=s.c.find(".pollWrapper"),o="",i=n.title;i&&(o+=`<div class="title"><b>${i}</b></div>`),n.list&&n.list.length&&(t='<div class="list">',n.list.forEach(function(e){t+=`<div class="list-item">${e}</div>`}),o+=t+="</div>"),a.html(o=o?'<div class="poll">'+o+'<div class="removeWrapper"><div class="removelink"><i class="fas fa-times"></i></div></div></div>':""),s.c.find(".pollWrapper").on("click",function(){f.removePoll()})},body:function(n){v.shell({name:"body",el:s.body,data:{share:r}},function(e){var t,a;s.c&&(s.message=s.c.find(".message"),s.eMessage=s.c.find("#emjcontainer"),s.urlWrapper=s.c.find(".urlWrapper"),s.caption=s.c.find(".captionshare"),s.cpt=s.c.find(".cpt"),s.images=s.c.find(".imagesWrapper"),s.poll=s.c.find(".pollWrapper"),s.updateWallpaperInput=s.c.find(".wallpaperShareInput"),s.wallpaperStatusIcon=s.c.find(".wallpaperStatusIcon"),s.eMessage.emojioneArea({pickerPosition:"bottom",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{change:f.eTextChange,click:f.eTextChange,keyup:f.eText,onLoad:function(e,t){parameters().newshare&&s.c.find(".emojionearea-editor").focus(),s.c.find(".emojionearea-editor").pastableContenteditable(),s.c.find(".emojionearea-editor").on("pasteImage",function(e,t){topPreloader(100),resize(t.dataURL,1920,1080,function(e){e.split(",")[1]?r.images.set(e)?m.images&&m.images():sitemessage(u.images):sitemessage("Image upload error")})}).on("pasteImageStart",function(){topPreloader(30)}).on("pasteImageError",function(e,t){topPreloader(100)}).on("pasteText",function(e,t){p.eTextChange(s.eMessage[0].emojioneArea)}),(isMobile()||isTablet())&&s.c.find(".emojionearea-button").hide()}}}),s.caption.on("keyup",f.caption),t={animation:150,swapThreshold:.5,draggable:".draggablepart",onUpdate:function(e){var t=[],n=$(a).find(".draggablepart");$.each(n,function(){t.push($(this).attr("part"))}),r.settings.a=t,i.changeArrange&&i.changeArrange(),i.share||h.save()},forceFallback:!0,handle:".marker"},(a=document.getElementById("sortableBody"))&&!isMobile()&&Sortable.create(a,t),p.autoFilled(),n&&n())})}},h={save:function(){var e;r?r.aliasid||((e=r.export(!0)).message==n&&(e.message=""),v.app.settings.set(v.map.id,"currentShare_v1",e)):v.app.settings.set(v.map.id,"currentShare_v1","")},load:function(){var e=v.app.settings.get(v.map.id,"currentShare_v1");return e&&r.import(e),e}},g=function(){m.all()};return{primary:t,post:p.post,make:function(){h.load(),g()},auto:function(){parameters().marticles&&!v.app.nav.wnds.articles&&p.embeding("article",null)},getdata:function(t,e){c=null,r=deep(e,"settings.essenseData.share")||new Share(v.app.localization.key),i=deep(e,"settings.essenseData")||{},v.app.platform.sdk.user.get(function(e){i.share||(h.load(),0===e.postcnt&&!r.message.v&&i.hello&&(r.message.v=n),r.language.set(v.app.localization.key)),(i.repost||parameters().repost)&&r.repost.set(i.repost||parameters().repost),e={essenseData:i,share:r,postcnt:e.postcnt},t(e)})},destroy:function(){c&&c.module.closeContainer(),a&&(a.destroy(),a=null),c=null,$("html").off("click",f.unfocus),delete v.app.platform.ws.messages.transaction.clbks.share,s.c&&s.c.find(".emojionearea-editor").off("pasteImage"),s={},Sortable&&Sortable.destroy&&Sortable.destroy()},init:function(e){(s={}).c=e.el.find("#"+v.map.id),s.tgsWrapperMain=s.c.find(".tgsWrapperMain"),s.error=s.c.find(".error"),s.changeAddress=s.c.find(".changeAddress"),s.repostWrapper=s.c.find(".repostWrapper"),s.postline=s.c.find(".postlineWrapper"),s.body=s.c.find(".bodywrapper"),s.changeAddress.on("change",f.changeAddress),isMobile()||s.c.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),r.on.change.edit=f.change,v.app.platform.ws.messages.transaction.clbks.share=p.waitActions,s.c.on("click",function(){s.c&&s.c.addClass("focus").removeClass("unfocus")}),$("html").on("click",f.unfocus),p.toggleTimesDisplay(),g(),e.clbk(null,e),p.waitActions()},wnd:{close:function(){d.cancelCloseFunction&&d.cancelCloseFunction(),i.close&&i.close()},class:"smallWnd withoutButtons wndsharepost"},id:e._id}}var v=new nModule,a={};return v.run=function(e){var t=v.addEssense(a,n,e);v.init(t,e)},v.stop=function(){_.each(a,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=share:(app.modules.share={},app.modules.share.module=share);var embeding=function(){function n(e){function n(){var e=$(this).attr("action")||r;d.add[e]()}function a(){var e=$(this).closest(".imageContainer").attr("value");d.removeImage(e)}var o,i,s,e=deep(e,"history"),r=null,l={url:new Parameter({type:"URL",id:"url",placeholder:u.app.localization.e("e13102"),onType:!0}),images:{isValid:function(){return!0},value:[]}},c={url:u.app.localization.e("e13103"),imagesLength:u.app.localization.e("e13104")},d={check:function(e){if(l[e].isValid(l[e].value))return o.error.html(""),!0;o.error.html(c[e])},removeImage:function(e){removeEqual(l.images.value,{id:e}),p.images(),o.error.html("")},add:{url:function(){d.check("url")&&(i.added(l.url.value),u.closeContainer())},images:function(){var t;d.check("images")&&(t=[],_.each(l.images.value,function(e){e.base64&&t.push(e.base64)}),i.added(t),u.closeContainer())}},slowUploadGif:function(e,t){e.id=makeid(),e.slow=!0,e.base64=e.base64,l.images.value.push(e),t&&t()},slowUpload:function(t,n){resize(t.base64,1080,1080,function(e){e.split(",")[1]&&(t.id=makeid(),t.slow=!0,t.base64=e,l.images.value.push(t)),n&&n()})},upload:function(t,n){resize(t.base64,1080,1080,function(e){(e=e.split(","))[1]&&(5<l.images.value.length?o.error.html(c.imagesLength):(o.error.html(""),t.id=makeid(),t.loading=!0,l.images.value.push(t),p.images(),u.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:e[1]},success:function(e){t.loading=!1,t.src=deep(e,"data.link")||"https://"+u.app.options.url+"/img/imagenotuploaded.jpg",p.images(),n&&n()},fail:function(){t.src="https://"+u.app.options.url+"/img/imagenotuploaded.jpg",p.images(),n&&n()}})))})}},p={images:function(e,t){(e=e||l.images.value).length&&u.shell({name:"images",el:o.images,data:{images:e}},function(e){e.el.find(".remove").on("click",a),e.el.find(".image").each(function(){$(this)}),t&&t()})}};return{primary:e,getdata:function(e,n){r=n.settings.essenseData.type,i=n.settings.essenseData.on,s=n.settings.essenseData,n.settings.essenseData.subtype,n.settings.essenseData.storage&&_.each(l,function(e,t){e.value=n.settings.essenseData.storage[t],"images"==t&&(e.value=[])}),e({type:r,options:l})},destroy:function(){o={}},init:function(e){var t;(o={}).c=e.el.find("#"+u.map.id),o.error=o.c.find(".error"),o.action=o.c.find(".action"),o.upload=o.c.find(".upload"),o.images=o.c.find(".imagesMi"),o.c.find("input").focus().on("change",n),o.action.on("click",n),"images"==r?(p.images(),s.value&&(t={base64:s.value},d.slowUpload(t)),initUpload({el:o.upload,ext:["png","jpeg","jpg","gif"],dropZone:o.c.closest(".wnd"),multiple:!0,action:function(e,t){"gif"==e.ext?d.slowUploadGif(e,t):d.slowUpload(e,t)},onSuccess:function(){d.add.images()}})):ParametersLive([l[r]],o.c),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-check"></i> '+u.app.localization.e("finish"),fn:function(e,t){d.add[r]()}}},close:function(){s.on.close&&s.on.close()},success:function(e,t){wndObj=t,wnd=e},offScroll:!0,noInnerScroll:!0,class:"embeding",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=embeding:(app.modules.embeding={},app.modules.embeding.module=embeding),"undefined"==typeof _OpenApi&&(_OpenApi=!1);var comments=function(){function n(e){function s(o,n,a){var e=n.el.find(".leaveComment"),i=n.el.find(".postbody");z.process(o.id||"0"),e.emojioneArea({pickerPosition:"top",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{"emojibtn.click":T.emessage,change:T.emessage,click:T.emessage,keydown:function(e,t){if(t.ctrlKey&&13==t.keyCode)return i.hasClass("sending")?void 0:(i.addClass("sending"),z.post(o.id||"0",o.pid,o.aid,o.editid),t.preventDefault(),!1);z.scrollToComment(n.el)},keyup:function(e,t){var n=String.fromCharCode(t.keyCode||t.which),a=this.getText();C.test(n)&&z.links(a),t.ctrlKey&&13==t.keyCode||(z.message(o.id||"0",a),P.limits(i,a))},focus:function(){z.scrollToComment(n.el)},onLoad:function(e,t){(d.init||o.init)&&(n.el.find(".emojionearea-editor").focus(),n.el.addClass("active"),d.init=!1),o.value&&this.setText(o.value),o.images&&o.editid&&o.images.length&&(m[o.editid].images.v=_.clone(o.images),P.images(o.editid,o)),(isMobile()||isTablet())&&n.el.find(".emojionearea-button").hide(),a&&a(this,n.el.find(".emojionearea-editor"))}}}),n.el.find(".emojionearea-editor").on("focus",function(){z.process(o.id||"0"),n.el.addClass("active")}),n.el.find(".emojionearea-editor").on("blur",function(){setTimeout(function(){n.el.removeClass("active")},150)}),n.el.find(".postaction").on("click",function(){i.hasClass("sending")||(i.addClass("sending"),z.post(o.id||"0",o.pid,o.aid,o.editid))}),o.id&&n.el.find(".closeEdit").on("click",function(){z.closeEdit(o.id)}),n.el.find(".closeAnswer").on("click",function(){z.removeForm(o.id||"0")})}function a(e,t,n,a,o){var i,s;console.log("CLBK"),t&&t.txid==c&&(s=(i=l.c.find("#"+t.id)).find(">div.commentPaddingWrapper>div.commentWrapper>div.commentBody>div.cbodyWrapper"),a==I.app.platform.sdk.address.pnet().address&&(n?(i.addClass("rated"),0<n&&s.find(".scoreUp").addClass("ratedScore"),n<0&&s.find(".scoreDown").addClass("ratedScore")):40!=e&&(i.removeClass("rated"),s.find(".scoreUp").removeClass("ratedScore"),s.find(".scoreDown").removeClass("ratedScore"))),n={scoreUp:(t.scoreUp||0)+(o&&0<n?1:0),scoreDown:(t.scoreDown||0)+(o&&n<0?1:0)},s.find(".scoreUp .commentScore").html(t.scoreUp?compressedNumber(n.scoreUp,1):""),s.find(".scoreDown .commentScore").html(n.scoreDown?compressedNumber(n.scoreDown,1):""))}function o(e,t,n,a,o,i,s,r){n==c&&(l.c.find(".sending").removeClass("sending"),e||(A.save(),l.c.find(".emojionearea-editor").blur(),l.c.find(".att").html(""),n={comments:[t]},g&&(d.lastComment=I.app.platform.sdk.comments.toLastComment(t)),delete m[s],"0"==s&&(n.class="firstcomment"),"0"==s?(w[s]&&w[s].setText(""),l.c.find(".post .newcommentimages").html("")):(e=l.c.find("#"+s),i?(e.find(".edit").html(""),t.timeUpd=t.timeUpd.addMinutes(1),t.parentid||(n.class="firstcomment"),delete w[s],delete k[s],e.removeClass("editing"),n.inner=replaceWith,n.el=e):(e.find(".answer").html(""),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),n.el=l.c.find("#"+s+" .answers"),delete w[s])),n.newcomments="newcomments",P.list(n,function(){r&&z.tocomment(t.id)}),!i&&d.send&&d.send(t,I.app.platform.sdk.comments.toLastComment(t)),i||(d.comments&&d.comments++,z.showhideLabel())))}var l,c,d,r,i,p,u,f,e=deep(e,"history"),m={},h=!1,g=!1,v=!1,y=!1,b={content:I.app.localization.e("e13029"),messagelength:I.app.localization.e("e13030"),images:I.app.localization.e("maximages")},k={},w={},n=null,x={},C=/[,.!?;:() \n\r]/g,z={myscores:function(){_.each(k,function(e,t){(t=deep(I.app.platform.sdk,"comments.storage.all."+t))&&a(null,t,Number(t.myScore),I.app.platform.sdk.address.pnet().address)})},stateAction:function(t){if(_OpenApi){var e="https://"+I.app.options.url+"/post?openapi=true&s="+c;return I.app.ref&&(e+="&ref="+I.app.ref),void window.open(e,"_blank")}I.app.user.isState(function(e){e?t():I.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:I.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!y},function(){t&&t()})}}})})},sharesocial:function(e){var t=d.hr+"&commentid="+e.id;e.parentid&&"0"!=e.parentid&&(t=t+"&parentid="+e.parentid),I.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:t,caption:"Share comment",sharing:e.social(I.app),embedding:{type:"comment",commentid:e.id,parentid:e.parentid,id:c}}})},editImage:function(n,e,a){var o=m[n],i=_.map(o.images.v,function(e,t){return{original:e,index:t}});focusfixed=!0,I.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:i,close:function(){},success:function(e,t){_.each(o.images.v,function(e,t){var n=_.find(i,function(e){if(e.index==t)return!0});n&&(o.images.v[t]=n.original)}),P.images(n,a,t)}}})},removeImage:function(e,n,t){m[e].images.v.splice(n,1)[0],t.el.find(".imageContainer").each(function(){var e=$(this),t=e.attr("value");n<t&&e.attr("value",t-1),t==n&&e.remove()}),t.el.find(".imagesEmbWr").isotope()},embedimages:function(a,t){a=a||"0",z.process(a),w[a]&&(w[a].___inited=!0);var e=m[a].export(!0);I.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:"images",storage:e,on:{added:function(e){var n=!0;_.isArray(e)||(e=[e]),_.each(e,function(e,t){n=m[a].images.set(e)}),!n&&b[type]&&sitemessage(b[type]),P.images(a,t)}}},clbk:function(e,t){n=t}})},removeForm:function(e){console.log("ID",e),delete w[e],l.c.find("#"+e+" .answer").html(""),l.c.find("#"+e+" .edit").html("")},post:function(e,t,n,a){var o,i=m[e=e||"0"];i?(o=i.validation())?(l.c.find(".sending").removeClass("sending"),sitemessage(b[o])):i.loading||(i.loading=!0,i.uploadImages(I.app,function(){z.send(i,function(e,t){i.loading=!1,e||successCheck()},t,n,a,e)})):(l.c.find(".sending").removeClass("sending"),sitemessage(b.content))},send:function(e,n,t,a,o,i){I.app.platform.sdk.comments.send(c,e,t,a,function(e,t){l.c&&l.c.find(".sending").removeClass("sending"),e?(I.app.platform.errorHandler(e,!0),n&&n(e,null)):n&&n(null,t)},o,i)},links:function(e,t){var n=m[e=e||"0"];n&&(n.url.v||(e=null,(e=(t=t.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi))&&0<t.length?t[0]:e)&&n.url.set(e)))},process:function(e){m[e=e||"0"]||(m[e]=new Comment(c))},message:function(e,t){m[e=e||"0"]&&m[e].message.set(t),A.save()},emessage:function(e,t){t=t.getText(),z.links(e,t),z.message(e,t),w[e]&&(w[e].___inited=!0)},fastreply:function(t){t&&z.replies(t.parentid||t.answerid,!0,function(){var e;t.noaction?(z.tocomment(t.answerid),(e=l.c.find("#"+t.answerid)).addClass("newcommentsn"),setTimeout(function(){e.removeClass("newcommentsn")},2500)):z.reply(t.parentid||t.answerid,t.answerid)})},reply:function(i,s){z.stateAction(function(){var e=l.c.find("#"+i).find(".answer");P.post(function(e,t){var n="0",a=I.app.platform.sdk.comments.address(c,s,n=s!=i?i:n)||deep(d,"lastComment.address"),o=deep(I.app,"platform.sdk.usersl.storage."+a+".name")||a,n="@"+o+",  ";a!=I.app.platform.sdk.address.pnet().address&&o||(n=""),e.setText(n),w[i]=e,t.focus(),t.closest(".answer").addClass("active"),n.length&&ecaretPosition(t,0,n.length)},{placeholder:"Send Reply",el:e,answer:"answer",pid:i,aid:s,id:i})})},hideallReplies:function(){_.each(deep(I,"app.platform.sdk.comments.storage."+c+".0"),function(e,t){z.replies(t,!1)}),d.lastComment&&z.replies(d.lastComment.id,!1)},replies:function(t,e,n,a){var o,i;a=a||{},"0"!=t?((o={}).in=a.in,o.el=l.c.find("#"+t+" .answers"),i=l.c.find("#"+t),void 0===e&&(i.hasClass("showedreplies")?e=!1:(e=!0,i.find(".repliesloaderWrapper").removeClass("hidden"))),e?S.level(t,function(e){i.find(".repliesloaderWrapper").addClass("hidden"),o.comments=I.app.platform.sdk.comments.storage[c][t],i.addClass("showedreplies"),P.list(o,function(){r||P.caption(),n&&n()},t)}):(delete x.levels[t],I.app.platform.sdk.comments.storage[c]&&_.each(I.app.platform.sdk.comments.storage[c][t],function(e){delete k[e.id]}),i.removeClass("showedreplies"),z.removeForm(t),o.el.html(""))):n&&n()},getid:function(e){return e.attr("answer")?((t=e.closest(".comment")).attr("id"),e.closest(".firstcomment").attr("id")):e.attr("edit")?((t=e.closest(".comment")).attr("aid"),t.attr("pid"),t.attr("id")):"0";var t},tocomment:function(e){_scrollTo(l.c.find("#"+e),i)},closeEdit:function(e){var t=l.c.find("#"+e);t.removeClass("editing"),t.find(".commentBody").removeClass("editing"),z.removeForm(e)},delete:function(e,n){e=e.delete(),I.app.platform.sdk.comments.delete(c,e,function(e,t){e?(I.app.platform.errorHandler(e,!0),n&&n(e,null)):n&&n(null,t)})},update:function(e){var t={},n=null,n=e?l.c.find("#"+e+" .answers"):(t.class="firstcomment",l.c.find(".list"));S.level(e,function(e){n.html(""),t.comments=e,P.list(t)})},hiddenCounts:function(e){0<e?l.showall.find(".ccounts").html("("+e+")"):l.showall.find(".ccounts").html()},showall:function(){v=!0,l.c.addClass("showedall"),z.showhideLabel(),d.showall=!0,g?(l.c.removeClass("listpreview"),l.c.find(".loaderWrapper").removeClass("hidden"),S.level(null,function(e,t){return t?(I.app.platform.errorHandler(t,!0),l.c.addClass("listpreview"),l.c.find(".loaderWrapper").addClass("hidden"),v=!1,l.c.removeClass("showedall"),void z.showhideLabel()):(g=!1,P.caption(),k={},(t={}).comments=I.app.platform.sdk.comments.storage[c][0],t.class="firstcomment",t.inner=html,void P.list(t,function(){l.c.find(".loaderWrapper").addClass("hidden")}))})):P.caption()},showhideLabel:function(){var e,t;l.showall&&(v?l.showall.addClass("hidden"):(e=deep(I.app.platform,"sdk.node.shares.storage.trx."+c+".comments")||0,t=deep(I.app.platform,"sdk.node.shares.storage.trx."+c+".lastComment.children")||0,g?1<e-t?(l.showall.removeClass("hidden"),z.hiddenCounts(e-t-1)):l.showall.addClass("hidden"):5<e?(l.showall.removeClass("hidden"),z.hiddenCounts(e-5)):l.showall.addClass("hidden")))},openGallery:function(e,t,n){var a=_.map(e.images,function(e){return{src:e}}),o=findIndex(a,function(e){if(e.src==t)return!0});console.log("comment",e,t,a),I.app.nav.api.load({open:!0,href:"imagegallery?s="+c+"&num="+(o||0)+"&com="+e.id,inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:a,gid:c+e.id},clbk:function(){n&&n()}})},upvoteComment:function(t,n){z.stateAction(function(){var e=deep(I.app.platform.sdk,"comments.storage.all."+n);e&&e.address!=I.app.platform.sdk.address.pnet().address&&(e=e.upvote(t),I.app.platform.sdk.comments.upvote(e,function(e,t){e&&I.app.platform.errorHandler(e,!0)}))})},scrollToComment:function(e){var t;e&&0<e.length&&e[0].scrollIntoView&&isMobile()&&$(window).width()<=768&&(e[0].scrollIntoView(!0),t=$("html").hasClass("showmain")?$(".lentacell"):$("html"),0<(e=120-e[0].getBoundingClientRect().top)&&t.animate({scrollTop:"-="+e+"px"},0))}},T={upvoteComment:function(){var e,t,n;$(this).closest(".comment").hasClass("rated")||(e="scoreUp"==$(this).attr("score")?1:-1,t=$(this).closest(".comment").attr("id"),n=$(this).closest(".comment").attr("pid"),z.upvoteComment(e,t,n))},openGallery:function(){var e=$(this),t=(n=e.closest(".comment")).attr("id"),n=n.attr("pid"),n=I.app.platform.sdk.comments.find(c,t,n);g&&d.lastComment&&(n=I.app.platform.sdk.comments.ini([d.lastComment])[0],console.log("ed.lastComment",d.lastComment)),z.openGallery(n,e.attr("i"))},replyandreplies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e,!0,function(){z.scrollToComment(l.list.find(".answer.active"))});var t=$(this).closest(".comment"),e=$(this).closest(".firstcomment").attr("id"),t=t.attr("id");z.reply(e,t)},replies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e)},emessage:function(e,t){var n=this.getText(),a=z.getid(e.closest(".postbody"));z.emessage(a,this),P.limits(e.closest(".postbody"),n)},message:function(){var e=$(this).val(),t=z.getid(editor.closest(".postbody"));z.links(t,e),z.message(t,e)},reply:function(){var e=$(this).closest(".comment"),t=$(this).closest(".firstcomment").attr("id"),e=e.attr("id");z.reply(t,e)},tocomment:function(){var e=$(this).attr("comment");z.tocomment(e)},metmenu:function(){var n=$(this),a=n.closest(".comment"),o=n.closest(".commentBody"),e=a.attr("id"),t=a.attr("pid"),i=I.app.platform.sdk.comments.find(c,e,t),s={address:I.app.user.address.value,caddress:I.app.platform.sdk.comments.address(c,e,t),txid:e};g&&d.lastComment&&!t&&(i=I.app.platform.sdk.comments.ini([d.lastComment])[0],s.caddress=i.address),I.fastTemplate("metmenu",function(e,t){I.app.platform.api.tooltip(n,function(){return t(s)},function(e){e.find(".edit").on("click",function(){P.edit(o,i),n.tooltipster("hide")}),e.find(".block").on("click",function(){I.app.platform.api.actions.blocking(s.caddress,function(e,t){console.log(e,t),e?a.remove():I.app.platform.errorHandler(t,!0),n.tooltipster("hide")})}),e.find(".remove").on("click",function(){dialog({html:I.app.localization.e("e13032"),success:function(){z.delete(i,function(e){e||((e=l.c.find("#"+i.id)).addClass("deleted"),l.c.find("#"+i.id+" >div.commentPaddingWrapper .commentmessage div").html("<div>"+I.app.localization.e("e13033")+"</div>"),e.find(".panel").remove(),e.find(".commentimages").remove(),e.find(".reply").remove())})},btn1text:I.app.localization.e("e13034"),btn2text:I.app.localization.e("e13035")}),n.tooltipster("hide")}),e.find(".socialshare").on("click",function(){z.sharesocial(i),n.tooltipster("hide")})},{theme:"zindex lighttooltip"})},s)}},P={images:function(t,a,o){var i=m[t];I.shell({name:"images",turi:"embeding",inner:html,el:a.el.find(".newcommentimages"),data:{images:_.map(i.images.v||[],function(e,t){return{src:e,id:t}})}},function(n){n.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.removeImage(t,e,a)}),n.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.editImage(t,e,a)}),n.el.find(".image").on("click",function(){var e,t=$(this).attr("i");t&&(e=_.map(i.images,function(e){return{src:e}}),I.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:t,idName:"src",images:e}}))}),n.el.find(".image").imagesLoaded({background:!0},function(e){var t;isMobile()?(o&&o(),a.el.find(".newcommentimages").addClass("active")):((t=n.el.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:10},initLayout:!1}),t.on("arrangeComplete",function(){o&&o(),a.el.find(".newcommentimages").addClass("active")}),t.isotope())})})},limits:function(e,t){t=1e3-t.length,e.find(".limits").removeClass("bad"),t<500?0<t?e.find(".limits").addClass("active").html(t+" "+pluralform(t,["Character","Characters"])+" Available"):e.find(".limits").addClass("active").addClass("bad").html("You are "+-t+" characters over"):e.find(".limits").removeClass("active")},cpreview:function(e){e=e||d.caption,l.caption&&(l.caption.find(".captionPreview").html(e),bgImages(l.caption.find(".captionPreview")))},caption:function(t){d.caption&&I.shell({name:"caption",el:l.caption,data:{ed:d}},function(e){P.cpreview(),r=new Caption({container:l.c,caption:l.c.find(".captionfwrapper"),offset:[p,-100],removeSpacer:!0,iniHeight:!0,_in:i}).init(),e.el.find(".close .cact").on("click",function(){d.close&&d.close()}),e.el.find(".top .cact").on("click",function(){_scrollToTop(l.c.find(".list"),i,void 0,-150)}),e.el.find(".bottom .cact").on("click",function(){_scrollToBottom(l.c.find(".list"),i,void 0,-150)}),t&&t()})},edit:function(e,t){e.addClass("editing"),t={value:t.message,images:t.images,init:!0,edit:"edit",el:e.find(">div.edit"),pid:t.parentid,aid:t.answerid,id:t.id,editid:t.id},P.post(function(e,t){},t)},post:function(o,i){d.openapi?o&&o():I.app.user.isState(function(a){(i=i||{}).el||(i.el=l.post);var e=h&&!i.answer&&!i.editid;I.shell({name:"post",el:i.el,data:{placeholder:i.placeholder||"",answer:i.answer||"",edit:i.edit||"",preview:e,mestate:f}},function(t){function n(n){h&&(h=!1,i.init=!0,l.c.removeClass("preview"),s(i,t,function(e,t){o(e,t),n&&n(e,t)}))}return t.el.find(".embedimages").off("click").on("click",function(){var e=z.getid(t.el.find(".postbody"));a?(z.embedimages(e,i),i.answer||i.editid||n()):z.stateAction(function(){})}),e?(t.el.find("textarea").on("click",function(){$(this).blur(),I.app.user.isState(function(e){e?n():z.stateAction(function(){})})}),void t.el.find(".embedEmojiPrivew").on("click",function(){a?n(function(e,t){e.showPicker()}):z.stateAction(function(){})})):void s(i,t,o)})})},commentimages:function(e,t){var n,s,r;l.c&&(e=l.c.find("#"+e.id),n=e.find(".commentimages .image"),!(s=e.find(".commentimages")).hasClass("active")&&n.length&&s.length?(e.height(),n.imagesLoaded({background:!0},function(i){_.each(i.images,function(e,t){var n=e.img,a=$(i.elements[t]).closest(".imagesWrapper"),o="",e=a.width();a.height(),n.width>n.height&&!isMobile()&&(o="w2",(t=e*(n.width/n.height))>s.width()&&(t=s.width(),r=t*(n.height/n.width),a.height(r)),a.width(t)),(n.height>n.width||isMobile())&&(o="h2",a.height(e*(n.height/n.width))),o&&a.addClass(o)}),s.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:10},initLayout:!1}),s.on("arrangeComplete",function(){s.addClass("active"),n.addClass("active"),d.renderClbk&&d.renderClbk(),t&&t()}),s.isotope()})):t&&t())},list:function(t,n,e){(t=t||{}).comments=_.filter(t.comments||[],function(e){if(!k[e.id])return k[e.id]=!0}),d.commentPs&&(t.comments=_.filter(t.comments||[],function(e){if(e.id==d.commentPs.commentid||e.id==d.commentPs.parentid)return!0}));var a=append;d.fromtop&&!t.el?(t.comments=_.sortBy(t.comments,function(e){return-e.time}),a=prepend):t.comments=_.sortBy(t.comments,function(e){return e.time}),e&&(x.levels[e]=e),t.in&&(a=t.in),t.el||(t.el=l.list),I.shell({name:"list",el:t.el||l.list,inner:t.inner||a,data:{comments:t.comments||[],_class:t.class||"",newcomments:t.newcomments||"",replaceName:function(e,t){return'<span class="tocomment" comment="'+t.comment+'">'+e+"</span>"},replaceNameNoComment:function(e,t){return'<span class="tocommentno">'+e+"</span>"},mestate:f},additionalActions:function(){d&&d.additionalActions&&d.additionalActions()}},function(e){l.list&&(l.list.find(".reply").off("click").on("click",T.replyandreplies),l.list.find(".replies").off("click").on("click",T.replies),l.list.find(".panel").off("click").on("click",T.metmenu),l.list.find(".tocomment").off("click").on("click",T.tocomment),l.list.find(".imageCommentOpen").off("click").on("click",T.openGallery),setTimeout(function(){l.list&&l.list.find(".newcomments").removeClass("newcomments")},600),bgImages(l.list),lazyEach({array:t.comments,action:function(e){P.commentimages(e.item,e.success)}})),d.renderClbk&&d.renderClbk(),n&&n()})}},S={preview:function(e){var t=[];d.lastComment&&(t=I.app.platform.sdk.comments.ini([d.lastComment])),I.sdk.comments.users(t,function(){e&&e(t)})},level:function(e,n){I.app.platform.sdk.comments.get(c,e||"",function(e,t){n&&n(e,t)})}},A={save:function(){},load:function(){var e=I.app.settings.get(I.map.id,c);e&&m[0].import(e)}};return{primary:e,getdata:function(t,e){var n;u=e.settings.eid,k={},m={},x={reply:null,levels:{}},d=e.settings.essenseData||{},h=d.preview||!1,g=h,v=!1,c=d.txid||null,m[0]=new Comment(c),c&&((n={}).ed=d,I.app.platform.sdk.ustate.me(function(e){f=e,t(n)}))},authclbk:function(){l&&l.c&&(y=!0,I.app.platform.sdk.ustate.me(function(e){function t(){var e=_.map(x.levels,function(e){return e});e.length?lazyEach({array:e,action:function(t){var e=t.item;S.level(e,function(e){t.success()})},all:{success:function(){n()}}}):n()}var n;f=e,n=function(){z.myscores(),y=!1},h&&!v?t():S.level(null,function(){t()}),P.post(function(e){w[0]=e})}))},destroy:function(){delete I.app.platform.sdk.comments.sendclbks[u],delete I.app.platform.ws.messages.comment.clbks[u],delete I.app.platform.sdk.comments.upvoteClbks[u],delete I.app.platform.ws.messages.cScore.clbks[u],y=!1,n&&n.destroy(),r&&r.destroy(),l={}},init:function(e){var t,n;(l={}).c=e.el.find("#"+I.map.id),l.post=l.c.find(".post"),l.list=l.c.find(".list"),l.caption=l.c.find(".captionCnt"),l.showall=l.c.find(".showall"),i=l.c.closest(".wndcontent"),p=i.length?0:(i=null,65),h?(l.c.find(".loaderWrapper").addClass("hidden"),l.c.addClass("preview"),l.c.addClass("listpreview"),n={},P.post(function(e){w[0]=e}),S.preview(function(e){n.comments=e,n.class="firstcomment",z.showhideLabel(),l.list.html(""),P.list(n,function(){})})):(t={},S.level(null,function(e){t.comments=I.app.platform.sdk.comments.storage[c][0],t.class="firstcomment",z.showhideLabel(),l.list&&l.list.html(""),P.list(t,function(){l.c.find(".loaderWrapper").addClass("hidden"),P.post(function(e){var t;w[0]=e,d.reply?z.fastreply(d.reply):(t={},(e=d.commentPs||parameters()).commentid&&(t.answerid=e.commentid,t.parentid=e.parentid||"",t.noaction=!0,z.fastreply(t)))})})}),d.showall&&z.showall()),l.c.find(".showall").on("click",function(){z.showall()}),I.app.platform.sdk.comments.sendclbks[u]=o,I.app.platform.sdk.comments.upvoteClbks[u]=a,I.app.platform.ws.messages.comment.clbks[u]=function(e){if(e.posttxid==c){var t={};if(t.comments=[e.comment],e.parentid){if(e=l.c.find("#"+e.parentid),t.el=e.find(".answers"),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),!e.hasClass("showedreplies"))return}else t.el=l.c.find(".list"),t.class="firstcomment";P.list(t)}},I.app.platform.ws.messages.cScore.clbks[u]=function(e){e.comment.txid==c&&a(null,e.comment,e.upvoteVal||e.value,e.addrFrom)},l.c.on("click",".upvoteComment",T.upvoteComment),e.clbk(null,e)},freeze:function(){r&&r.destroy()},hideall:function(e){v=!1,(g=void 0!==e?e||!1:g)?(l.c.addClass("listpreview"),r&&r.destroy(),r=null):l.c.removeClass("listpreview"),l.c.removeClass("showedall"),z.hideallReplies(),z.showhideLabel()},changein:function(e,t){e?(i=e,p=t,r&&(r.addscroll=!0,r.setOffset([p,0]),r.setIn(i))):(i=l.c.closest(".wndcontent"),p=i.length?0:(i=null,65),r&&(r.addscroll=!!i,r.setOffset([p,0]),r.setIn(i)))}}}var I=new nModule,a={};return I.run=function(e){var t=I.addEssense(a,n,e);I.init(t,e)},I.authclbk=function(){_.each(a,function(e){e.authclbk()})},I.stop=function(){_.each(a,function(e){e.destroy()})},I}();"undefined"!=typeof module?module.exports=comments:(app.modules.comments={},app.modules.comments.module=comments);var oldchat=function(){function n(e){var c,e=deep(e,"history"),t=makeid(),d={},p=null,u=null,n=null,f=null,a=null,m=null,h={},g={},v={preloader:function(e){e?c.c.addClass("loading"):c.c.removeClass("loading")},close:function(){b.removeEssense(o,t),d.closeClbk&&d.closeClbk()},sendClbk:function(e,t,n){var a=c.messages.find("#"+e.EncryptedMessageID);t?(e.EncryptedMessageID=t,e.result="success",e.Message=n.note||"",e.Attachment=n.attachment||"",e.AttachmentName=n.attachmentName||"",e.AttachmentPreview=n.attachmentPreview||"",a.attr("id",e.EncryptedMessageID)):e.result="fail",a.removeClass("sending"),a.addClass(e.result)},mobileBuildHeight:function(){var e,t,n;"buildin"==d.view&&isMobile()&&(e=c.c.find(".chatwindow").height(),t=$(window).height(),n=c.c.find(".chatmessages").height(),e<=t-175&&n<e?c.c.find(".chatwindow").height(t-175):c.c.find(".chatwindow").css("height","auto"))},spacer:function(){var e;v.mobileBuildHeight(),!isTablet()||(e=0)<c.messages.find(".chatmessage").length&&(c.c.find(".spacer").height(0),e=c.c.find(".chatwindow").height()-c.c.find(".chatmessages").height()-10,c.spacer.height((e=e<0?0:e)+"px"))},send:function(e){e&&f.rtc.send(e)},sendAttachment:function(e,n){b.app.platform.sdk.chats.send({attachment:e.attachment,attachmentName:e.attachmentName,attachmentPreview:e.attachmentPreview,temp:n},f.ThreadID,function(e,t){v.sendClbk(n,e,t)})},addTempMessage:function(e){var t=new Date;return b.app.platform.timeDifference&&(t=t.addSeconds(b.app.platform.timeDifference/1e3)),e={Created:dateToStrUtcS(t),ThreadID:f.ThreadID,EncryptedMessageID:makeid(!0),temp:!0,UserID:b.app.user.data.id,decrypted:{Message:e.note,AttachmentName:e.attachmentName,AttachmentPreview:e.attachmentPreview}},f.messages.push(e),r.messages(null,[e],!0),e},clearTempMessages:function(){c.messages.find(".temp").remove()},scrollToPx:function(e,t){if(!v.checkState())return!1;var n,a,o,i;null!==t&&(i=n=null,a="position","buildin"==d.view?(n=$(window),i=$("html"),a="offset"):(n=c.c.find(".chatwindow"),i=c.c.find(".chatmessages")),"toLast"==e||"toLast"==t?(o=c.messages.find(".chatmessage:nth-last-child(1)"))[a]()&&(e=70,isMobile()&&(e=115),t=o[a]().top+o.height()+e-n.height(),n.scrollTop(t,200)):(i=i.height(),n.scrollTop(i-t,200)))},scrollPx:function(e){if(c.c){var t,n=null,a=null,o=null,a="buildin"==d.view?(n=$(window),$("html")):(n=c.c.find(".chatwindow"),c.c.find(".chatmessages"));return"toLast"==e?o="toLast":(t=c.messages.find(".chatmessage:nth-last-child(1)"),e="position","buildin"==d.view&&(e="offset"),inView(t,{inel:n,offset:-20,mode:"partall"}),t&&t[e]()&&(e=a.height(),a=n.scrollTop(),o=e-t.height()-150,o=a+n.height()>o?"toLast":null)),o}},saveAttachment:function(e){topPreloader(30);var t=s.findEl(e);t&&t.addClass("saveAttachment"),b.app.platform.sdk.chats.getAttachment(e,function(e){topPreloader(100),t&&t.removeClass("saveAttachment"),e?e.ChatMessageAttach&&saveAs({download:e.decrypted.AttachmentName,file:e.ChatMessageAttach,noA:!0}):console.log("ERROR")})},openGallery:function(e){e={idName:"EncryptedMessageID",initialValue:e.EncryptedMessageID,getImages:function(){return _.filter(f.messages,function(e){if((e=deep(e,"decrypted.AttachmentName"))&&(-1<e.indexOf(".jpg")||-1<e.indexOf(".png")||-1<e.indexOf(".jpeg")))return!0})},getImage:function(e,t){e.ChatMessageAttach?t&&t({src:e.ChatMessageAttach,name:e.decrypted.AttachmentName}):b.app.platform.sdk.chats.getAttachment(e,function(e){e={src:e.ChatMessageAttach,name:e.decrypted.AttachmentName},t&&t(e)})}},r.gallery(e)},getPreview:function(e){b.app.platform.sdk.chats.getPreview(e,function(e){_.each(e,function(e){var t=s.findEl(e);r.messages(null,[e],!0,t)})})},read:function(){},countUnread:function(){c.countUnread&&c.countUnread.html("")},checkState:function(){if(c.c&&!c.c.hasClass("minimized"))return!0}},y={minimize:function(){c.c.addClass("minimized"),d.minimizeClbk&&d.minimizeClbk(),p.clear(),u.clear(),c.type.blur()},expand:function(){c.c.removeClass("minimized"),d.expandClbk&&d.expandClbk(),isTablet()||c.type.focus(),v.spacer(),setTimeout(function(){v.scrollToPx("toLast","toLast")},100)},out:function(){b.app.modules.chats.module.api.add(f.ThreadID)},close:function(){v.close()},type:function(e,t){var n=this.getText();if(13==t.which||13==t.keyCode)return n&&(this.setText(""),v.send(n),$(this).val("")),!1},resizeWindow:function(){p&&p.setOffset([65,0]),u&&u.setOffset([0,100])},getAttachment:function(){var e=$(this).closest(".chatmessage"),t=e.attr("id");e.hasClass("sending")||(e=s.findMessage(t)).decrypted&&e.decrypted.AttachmentName&&(-1<(t=e.decrypted.AttachmentName.toLowerCase()).indexOf(".jpg")||-1<t.indexOf(".png")||-1<t.indexOf(".jpeg")?v.openGallery(e):v.saveAttachment(e))},messagesInView:function(){n=slowMade(function(){if(!v.checkState())return!1;var e=c.messages.find(".chatmessage"),t=c.messages.find(".chatmessage:nth-last-child(1)");"buildin"==d.view&&(n=$(window)),"fixedin"==d.view&&(n=c.c.find(".chatwindow"));var e=inView(e,{inel:n}),n=inView(t,{inel:n});0<e.length&&_.map(e,function(e){return e=$(e).attr("id"),s.findMessage(e)}),0<n.length&&v.read()},n,100)}},s={findMessage:function(t){return _.find(f.messages,function(e){return e.EncryptedMessageID==t})},findEl:function(e){return c.c.find("#"+(e.tm+e.f))}},r={gallery:function(e){b.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e=e||{}})},safemessages:function(e,t){var o=_.map(g,function(e,t){return{m:e,t:t}}),o=_.sortBy(o,function(e){return Number(e.t)}),i=[];_.each(o,function(t,n){var a={newmessages:[],oldmessage:t};_.each(e,function(e){(Number(e.tm)<Number(t.t)||n==o.length-1)&&(!n||Number(o[n-1].t)>Number(e.tm))&&a.newmessages.push(e)}),a.newmessages.length&&(a.newmessages.push(a.oldmessage.m),a.newmessages=_.sortBy(a.newmessages,function(e){return Number(t.t)}),i.push(a))}),i.length?lazyEach({array:i,action:function(e){var t=e.item,n=s.findEl(t.oldmessage);r.messages(e.success,t.newmessages,null,n)},all:{success:t}}):r.messages(t,e)},messages:function(t,a,n,e){var o,i,s,r,l;c.c&&(a=_.filter(a,function(e,t){var n=e.tm;if(17==e.tm.length&&(e.tm=n+"0"),!(m&&m.tm>e.tm))return!(a.length-50>t)}),o=a?"fixed":"toLast",i=v.scrollPx(o),a=a||[],console.log("BEFORE",a),a=_.filter(a,function(e){var t=e.tm+e.f;return!!e.tm&&(h[t]?void 0:(h[t]=!0,g[e.tm]=e,!0))}),s=_.sortBy(a,function(e){var t=e.tm;return 17==e.tm.length&&(e.tm=t+"0"),Number(e.tm)}),n||v.clearTempMessages(),r=append,l=c.messages,e&&(r=replaceWith,l=e),a.length?(m=s[s.length-1],console.log("messages : sorted\t",s),b.shell({name:"messages",el:l,data:{chat:f,messages:s},inner:r},function(e){d.messagesClbk&&d.messagesClbk(),c.messages.find(".attachment").off("click"),c.messages.find(".attachment").on("click",y.getAttachment),y.messagesInView(),0<c.messages.find(".chatmessage").length?c.c.find(".other").fadeOut(1):c.c.find(".other").fadeIn(1),n&&(i="toLast"),v.spacer(),setTimeout(function(){v.scrollToPx(o,i)},20),p&&p.action(),u&&u.action(),v.countUnread(),t&&t()})):t&&t())}};return{primary:e,getdata:function(t,e){var n,a={},o=deep(e,"settings.essenseData.chat");o||(n=parameters().chatid,o=b.app.platform.sdk.discussions.fromChatId(n)),o||(b.app.platform.sdk.chats.add(n,"share"),o=b.app.platform.sdk.discussions.fromChatId(n)),deep(e,"settings.essenseData"),console.log("_chat",o),o&&(f=o.chat,b.app.platform.sdk.chats.info([o.chat],function(e){a.chat=o,b.app.platform.sdk.tempmessenger.getChat(o.chat),a.canEnc=!0,b.app.platform.sdk.ustate.me(function(e){a.mestate=e,t(a)})}))},destroy:function(){c.type&&c.type.blur(),$("html").off("mousemove",y.messagesInView),window.removeEventListener("scroll",y.messagesInView),window.removeEventListener("resize",y.resizeWindow),b.app.platform.ws,$(window).off("focus",v.read),$(window).off("mousemove",v.read),delete f.rtc.clbks.receive.message.messenger,delete f.rtc.clbks.receive.messages.messenger,delete f.rtc.clbks.send.message.messenger,n&&clearTimeout(n),c={},p&&p.destroy(),u&&u.destroy(),p=u=null,f&&(f.rtc.leave(),f=null),clearInterval(a),$("#tawkchat-container").fadeIn(),d.destroyClbk&&d.destroyClbk()},init:function(e){var t,n;h={},g={},m=null,(d=e.essenseData||{}).view||(d.view="buildin"),(c={}).c=e.el.find("#"+b.map.id),c.messages=c.c.find(".chatmessages"),c.type=c.c.find(".type"),c.attachement=c.c.find(".attachement"),c.countUnread=c.c.find(".countUnread"),c.spacer=c.c.find(".spacer"),c.c.addClass(d.view),"buildin"==d.view&&(isMobile()||(p=new Caption({container:c.c.find(".chatWrapper"),caption:c.c.find(".captionfwrapper"),offset:[65,0]}).init()),t=0,isMobile()&&(t=50),u=new Caption({container:c.c.find(".chatWrapper"),caption:c.c.find(".bcaptionfwrapper"),offset:[t,2*t],pos:"bottom"}).init(),c.c.find(".out").on("click",y.out),window.addEventListener("scroll",y.messagesInView),window.addEventListener("resize",y.resizeWindow),$("html").on("mousemove",y.messagesInView)),"fixedin"==d.view&&(c.c.find(".close").on("click",y.close),c.c.find(".chatwindow").on("scroll",y.messagesInView),$("html").on("mousemove",y.messagesInView)),c.c.find(".minimize").on("click",y.minimize),c.c.find(".expand").on("click",y.expand),c.countUnread.on("click",function(){y.expand()}),c.type.emojioneArea({pickerPosition:"top",search:!1,tones:!1,attributes:{spellcheck:!0,autocomplete:"on"},events:{keyup:y.type,onLoad:function(e,t){}}}),initUpload({el:c.attachement,ext:["png","jpeg","jpg","pdf"],multiple:!0,maxFileSize:5,dropZone:c.c.find(".chatWrapper"),beforeUpload:function(e){var t,a=deep(e,"file.name");"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?resize(e.base64,200,200,function(t){var n=v.addTempMessage({attachmentName:a,attachmentPreview:t});resize(e.base64,1600,1600,function(e){v.sendAttachment({attachment:e,attachmentName:a,attachmentPreview:t},n)})}):(t=v.addTempMessage({attachmentName:a}),v.sendAttachment({attachment:e.base64,attachmentName:a},t))}}),f.rtc.clbks.receive.message.messenger=function(e){!b.app.platform.focus&&b.app.platform.titleManager&&b.app.platform.titleManager.add("You have new messages"),m=e,b.app.platform.sdk.messenger.load.messages(e,function(){r.messages(null,[e])})},f.rtc.clbks.receive.messages.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){r.messages(null,e,!0)})},f.rtc.clbks.send.message.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){m=e,r.messages(null,[e],!0)})},f&&(n=_.toArray(f.rtc.storage._db||{}),b.app.platform.sdk.messenger.load.messages(n,function(){r.messages(null,n,!0)}),f.rtc.connect(function(){})),b.app.platform.ws,$(window).on("focus",v.read),$(window).on("mousemove",v.read),v.countUnread(),e.clbk(null,e)},id:t,api:y}}var b=new nModule,o={};return b.run=function(e){var t=b.addEssense(o,n,e);b.init(t,e)},b.stop=function(){_.each(o,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=oldchat:(app.modules.oldchat={},app.modules.oldchat.module=oldchat),"undefined"==typeof _OpenApi&&(_OpenApi=!1);var lenta=function(){function n(e){var d,t,p,u,o,n,a,r,i=deep(e,"history"),e=e.mid,s=!1,l=!1,c=[],f={},m=!1,g=!1,v=!1,y=0,b={},k={},w=!1,x=!1,C={},z=[],T=!1,P=0,S=0,A=null,I=0,M={},E={},D=0,W=null,V=!1,N=0,L=null,q=!1,R=!1,F={newmaterials:function(e){if(!(s||p.author||p.txids)){if(e=e||{},"sub"!=u)return e.sharesLang?B(deep(e,"sharesLang."+G.app.localization.key)):B(g?deep(e,"contentsLang.video."+G.app.localization.key):(deep(e,"contentsLang.video."+G.app.localization.key)||0)+(deep(e,"contentsLang.share."+G.app.localization.key)||0));B(e.sharesSubscr)}},scrollmode:function(e){e?$("html").addClass("scrollmodedown"):$("html").removeClass("scrollmodedown")},authclbk:function(){R=!0;var e=_.map(b,function(e,t){return t});G.app.platform.sdk.node.shares.getbyid(e,function(e){_.each(e,function(e){delete e.myVal}),O.mystars(e,function(){R=!1}),F.subscribeLabels()})},subscribeLabels:function(){_.each(b,function(e,t){(t=G.app.platform.sdk.node.shares.storage.trx[t])&&F.subscribeLabel(t)})},subscribeLabel:function(e){var t=G.app.user,n=!1;t.address.value&&e.address==t.address.value||!t.address.value||(t=deep(G.app,"platform.sdk.users.storage."+t.address.value))&&t.relation(e.address,"subscribes")&&(n=!0),d.c&&(e=d.c.find("#"+e.txid+" .shareTable"),n?e.addClass("subscribed"):e.removeClass("subscribed"))},repost:function(e){F.stateAction("_this",function(){G.app.platform.ui.share({repost:e})},e)},cleardelay:function(){W&&(clearTimeout(W),W=null),d.c&&d.c.removeClass("rebuilding")},rebuilddelay:function(){d.c&&d.c.addClass("rebuilding"),W=slowMade(function(){_scrollToTop(d.shares,null,10,-80),F.loadprev()},W,600)},loadprev:function(e){d.c.find(".shares").html('<div class="bspacer"></div>'),d.c.removeClass("showprev"),d.c.removeClass("loading"),d.c.removeClass("sharesEnded"),d.c.removeClass("sharesZero"),d.shares&&v&&d.shares.isotope("destroy"),v=!1,K(),F.clear(),p.renderclbk&&p.renderclbk(),H(e)},clear:function(){_.each(b,function(e,t){delete G.app.platform.sdk.node.shares.storage.trx[t]}),_.each(C,function(e){e.p&&e.p.destroy()}),_.each(f,function(e){e&&e.destroy()}),_.each(E,function(e){e&&e.destroy()}),E={},P=N=0,R=!(c=[]),b={},k={},M={},V=!(f={}),$("html").removeClass("fullvideoshowed"),$("html").removeClass("fullvideoshowedanimblock"),x=w=!1,C={},T=!(z=[]),r&&(clearTimeout(r),r=null),n&&(clearTimeout(n),n=null),a&&(clearTimeout(a),a=null),L=A=null,loaded=x=q=!1,s=!1,D=I=S=0},next:function(t,n){var e=nextElH(z,function(e){if(e.txid==t)return!0});e?n&&n(e.txid):x?n&&n(null):F.loadmore(function(e){n&&n(deep(e,"0.txid")||null)})},loadmore:function(n){U.shares(function(e,t){return t?(s=!1,G.app.errors.connection()&&d.c.addClass("networkError"),void(G.app.errors.connectionRs()&&(G.iclbks.lenta=F.loadmore))):(d.c.removeClass("networkError"),e&&O.shares(e,function(){O.sharesInview(e,function(){p.renderclbk&&p.renderclbk()})},{index:z.length}),void(n&&n(e)))})},removeAdditionalByScroll:function(){var e;A&&(e=d.w.scrollTop(),150<Math.abs(e-S)&&F.additional(A,!1))},additional:function(e,t){t?(e.addClass("showAdditional"),e.find(".subscribeWrapper").fadeIn(),S=e.w.scrollTop(),(A=e).w.on("scroll",F.removeAdditionalByScroll)):(e.removeClass("showAdditional"),e.find(".subscribeWrapper").fadeOut(),e.w.on("scroll",F.removeAdditionalByScroll))},applyheight:function(e,t,n){},applyheightEl:function(e,t,n){},stateAction:function(t,n,a){G.app.user.isState(function(e){if(e)n();else{if(_OpenApi)return e="https://"+G.app.options.url+"/post?openapi=true&s="+a,G.app.ref&&(e+="&ref="+G.app.ref),void window.open(e,"_blank");G.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:G.app.localization.e("llogin"),successHref:t,signInClbk:function(){retry(function(){return!R},function(){n&&n()})}}})}})},destroyVideo:function(e){C[e.txid]&&(C[e.txid].p&&C[e.txid].p.destroy(),delete C[e.txid],O.urlContent(e))},initVideo:function(e,t,n,a){if(t&&t.txid){var o=e.find(".js-player"),i=e.find(".videoWrapper");if(a&&!C[t.txid])return C[t.txid]={shadow:!0,el:i,txid:t.txid},void(n&&n(!0));!C[t.txid]||C[t.txid].error||C[t.txid].shadow?!G.app.platform.sdk.usersettings.meta.embedvideo||G.app.platform.sdk.usersettings.meta.embedvideo.value?o.length&&o[0].getAttribute&&(a={muted:!0,resetOnEnd:!0,controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],speed:{selected:1,options:[1]},volumeChange:function(e){y=e,G.sdk.videos.volume=y,G.sdk.videos.save()}},"a"==t.settings.v&&(a.muted=!1,a.autoplay=!1),isMobile()&&(a.controls=["play","progress","current-time","fullscreen"]),PlyrEx(o[0],a,e=>{e?(C[t.txid]||(C[t.txid]={}),C[t.txid].p=e,C[t.txid].initing=!0,C[t.txid].el=i,C[t.txid].id=i.attr("pid"),C[t.txid].shadow=!1,F.setVolume(C[t.txid]),g&&(C[t.txid].preview=!0),p.enterFullScreenVideo&&(p.enterFullScreenVideo=!1,F.fullScreenVideo(t.txid))):C[t.txid]={error:!0}},e=>{C[t.txid]&&(o.find("iframe").attr("disable-x-frame-options","disable-x-frame-options"),C[t.txid].inited=!0),n&&n(!0)})):n&&n(!1):n&&n(!0)}},openPost:function(n,a){var e;isMobile()?(e=G.app.platform.sdk.node.shares.storage.trx[n],delete f[n],O.share(e,null,!0)):G.app.user.isState(function(e){var t={share:n,hr:p.hr,like:function(e){O.stars(e)},next:F.next,close:function(){p.renderclbk&&p.renderclbk()}};G.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,history:!0,clbk:function(){p.renderclbk&&p.renderclbk(),a&&a()},essenseData:t})})},sharesocial:function(e,t){var n,a=G.app.platform.sdk.node.shares.storage.trx[e];a&&(n="https://"+G.app.options.url+"/"+(p.hr||"index?")+"s="+e+"&mpost=true",parameters().address&&(n+="&address="+(parameters().address||"")),(g||p.videomobile||a.itisvideo())&&(n="https://"+G.app.options.url+"/index?v="+e+"&mpost=true&video=1"),e="Post","a"==a.settings.v&&(e="Article"),G.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:n,caption:G.app.localization.e("e13133")+" "+e,sharing:a.social(G.app),embedding:{type:"post",id:a.txid,fullscreenvideoShowed:V}}}))},unblock:function(e,t){(e=G.app.platform.sdk.node.shares.storage.trx[e])&&G.app.platform.api.actions.unblocking(e.address,function(e,t){e||G.app.platform.errorHandler(t,!0)})},htls:function(e){G.app.platform.ui.wallet.send({htls:e},function(){})},donate:function(e,t){var n,a,o=G.app.platform.sdk.node.shares.storage.trx[e];o&&(n=deep(app,"platform.sdk.usersl.storage."+o.address)||{address:o.address,addresses:[]},e=o.caption||o.message,a="send?address="+o.address+"&amount=1&message="+hexEncode(G.app.localization.e("postlabel")+" - "+e.substr(0,20)+(e.length<=20?"":"..."))+"&label="+(n.name||n.address)+"&setammount=true",G.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:G.app.localization.e("dcancel"),clbk:function(e,t){e.find(".pnetdnt").on("click",function(){G.nav.api.load({open:!0,href:a,history:!0}),t.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(G.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:n}))},videoPosition:function(e){var t,n,a;p.openapi||(t=e.find(".work"),e.hasClass("fullScreenVideo")?(n=$(window).height(),a=0,isMobile()||(a=100),0<(a=(n-(e.find(".videoWrapper").height()+a))/2)?t.css("margin-top",a+"px"):t.css("margin-top","0px")):t.css("margin-top","0px"))},fullScreenVideoMobile:function(e){C[e]&&(C[e].p.fullscreen.enter(),C[e].p.playing||C[e].p.play(),F.setVolume(C[e],y||.5))},opensvi:function(e){p.opensvi&&p.opensvi(e,deep(G,"app.platform.sdk.node.shares.storage.trx."+e))},fullScreenVideo:function(t,n){var e,a=d.c.find("#"+t),o=G.app.platform.sdk.node.shares.storage.trx[t];o||(e=_.find(G.sdk.node.transactions.temp.share,function(e){return e.txid==t}),(o=new pShare)._import(e),o.temp=!0,o.address=G.app.platform.sdk.address.pnet().address),F.initVideo(a,o,function(e){e?C[t]&&(a.addClass("fullScreenVideo"),$("html").addClass("fullvideoshowed"),$("html").addClass("fullvideoshowedanimblock"),F.videoPosition(a),G.app.nav.api.history.addParameters({v:t}),(e=C[t]).p.playing||e.p.play(),F.setVolume(C[t],y||.5),P=d.w.scrollTop(),l=!G.app.actions.offScroll(),p.comments||retry(function(){return f[t]||!d.c},function(){d.c&&(f[t]&&(f[t].destroy(),f[t]=null),O.comments(t,!1,!0))}),V=!0,n&&n()):sitemessage("")})},exitFullScreenVideo:function(e){var t;$("html").removeClass("fullvideoshowed"),setTimeout(function(){$("html").removeClass("fullvideoshowedanimblock")},300),d.c&&((t=d.c.find("#"+e)).scrollTop(0),t.removeClass("fullScreenVideo"),F.videoPosition(t)),C[e],F.setVolume(C[e],y),G.app.nav.api.history.removeParameters(["v"]),G.app.actions.onScroll(),d.w.scrollTop(P||0),V=!1,p.comments||(f[e]&&(f[e].destroy(),f[e]=null),O.comments(e,!1,!1,!0)),g&&(e=G.app.platform.sdk.node.shares.storage.trx[e],F.destroyVideo(e))},postscores:function(e,t){G.app.nav.api.load({open:!0,href:"postscores?p="+e,inWnd:!0,history:!0,essenseData:{share:e,like:function(e){O.stars(e)}},clbk:function(){t&&t()}})},like:function(n,e,a){var o=n.upvote(e);if(!o)return G.app.platform.errorHandler("4",!0),void(a&&a(!1));G.sdk.node.transactions.create.commonFromUnspent(o,function(e,t){topPreloader(100),e?a&&a(!0):(o.myVal=null,n.myVal=0,G.app.platform.errorHandler(t,!0),a&&a(!1))})},block:function(e,t){},complain:function(e){G.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:G.app.platform.sdk.node.shares.storage.trx[e],success:function(){}},clbk:function(){}})},openGalleryRec:function(n,a,o){var i=[],s=function(e,t){_.each(e.images,function(e){i.push(e)}),e.repost?G.app.platform.sdk.node.shares.getbyid(e.repost,function(e){(e=e[0])?s(e,t):t&&t()}):t&&t()};s(n,function(){var e=_.map(i,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==a)return!0});(1<=e.length||n.url&&e.length&&parseVideo(n.url).type||!isMobile())&&G.app.nav.api.load({open:!0,href:"imagegallery?i="+n.txid+"&num="+(t||0),inWnd:!0,history:!0,essenseData:{initialValue:a,idName:"src",images:e,gid:n.txid},clbk:function(){o&&o()}})})},openGallery:function(e,t,n){var a=_.map(e.images,function(e){return{src:e}}),o=findIndex(a,function(e){if(e.src==t)return!0});(1<a.length||e.url&&a.length&&parseVideo(e.url).type||!isMobile())&&G.app.nav.api.load({open:!0,href:"imagegallery?i="+e.txid+"&num="+(o||0),inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:a,gid:e.txid},clbk:function(){n&&n()}})},scrollToPost:function(e){_scrollTo($("#"+e))},videosInview:function(e,o,i){var s;V||(s=_.filter(e,function(e){if(e.inited&&!e.playing&&!e.stopped&&e.el&&!e.preview&&!e.error)return!0})).length&&(n=slowMade(function(){window.requestAnimationFrame(function(){s=_.filter(s,function(e){return e.el}),_.map(s,function(e){return e.el[0]});var e=inView(d.c.find(".videoWrapper"),{offset:d.w.height()/10,mode:"all"}),t=null;if(0<e.length){var n=$(e[0]),t=n.attr("pid"),a=_.find(s,function(e){return e.id==t});if(!t||!a)return;a&&setTimeout(function(){inView(n,{offset:-100,mode:"all"}).length&&o(a,n)},520)}(e=_.filter(s,function(e){return e.id!=t})).length&&i(e)})},n,60))},sharesInview:function(o,i,s){t.scrollTop(),o.length&&!T&&(r=slowMade(function(){window.requestAnimationFrame(function(){var n,e=d.c.find(".share"),t=d.w,a=d.w.height()/4;0<(t=inView(e,{inel:t,offsetTop:a,offsetBottom:a})).length&&(n={},a=_.map(t,function(e){var t=e.getAttribute("id");return n[t]=!0,_.find(o,function(e){return e.txid==t})}),a=_.filter(a,function(e){if(e&&!e.temp)return!0}),i(a,t,function(){var e;s&&(e=_.filter(o,function(e){if(!n[e.txid])return!0}),s(e))}))})},r,60))},videoShare:function(e){if(!e.url||!e.itisvideo())return sitemessage("Unable to parse a video in the post");var t=G.app.platform.parseUrl(e.url),n="https://"+G.app.options.url+`/embedVideo.php?host=${t.host_name}&id=${t.id}&embed=true&s=${e.txid}`;return"peertube"===t.type?copycleartext(n):copycleartext(e.url),sitemessage(G.app.localization.e("videoCopied"))},setVolume:function(e,t){void 0===t&&(t=y),e.p&&(t&&e.p.setVolume?e.p.setVolume(t):e.p.muted=!0)}},j={sharesPreInitVideo:function(){var t={};_.each(C,function(e){e.shadow&&e.txid&&(t[e.txid]=!0)});var e=_.filter(z,function(e){return t[e.txid]});e.length&&(a=slowMade(function(){window.requestAnimationFrame(function(){var n;d.c&&(n=d.w.scrollTop(),_.each(e,function(e){var t=d.share[e.txid];t.length&&n+3500>t.offset().top&&F.initVideo(t,e)}))})},a,60))},sharesInview:function(e){F.sharesInview(z,function(e,t,n){var a=_.filter(e,function(e){return!b[e.txid]});p.contents&&0<a.length&&(p.beginmaterial=e[0].txid,U.shares(function(e){O.sharesInview(e,function(){})})),_.each(e,function(e){d.share[e.txid].addClass("vstars")}),n&&n()},function(e){_.each(e,function(e){d.share[e.txid].removeClass("vstars")})})},videosInview:function(e){F.videosInview(C,function(e,t,n){var a;G.app.platform.sdk.usersettings.meta.videoautoplay&&!G.app.platform.sdk.usersettings.meta.videoautoplay.value||(a=t.closest(".share"),t.closest(".share").hasClass("showAdditional")||F.initVideo(a,G.app.platform.sdk.node.shares.storage.trx[a.attr("id")],function(){e.p.getState&&"ended"==e.p.getState()||e.p.playing||(e.p.play(),F.setVolume(e))}))},function(e){_.each(e,function(e){e.error||(e.p.muted=!0,e.p.playing&&(e.p.stop(),isMobile()&&e.p.rebuild&&setTimeout(function(){},1e3)))})})},repost:function(){var e=$(this).closest(".share").attr("id");F.repost(e)},showmorebyauthor:function(){$(this).closest(".authorgroup").find(".share").removeClass("hidden"),$(this).remove(),O.sharesInview(z,function(e){j.sharesPreInitVideo(),j.videosInview()},function(){})},metmenu:function(){var e=$(this),t=$(this).closest(".share").attr("id");G.app.platform.api.metmenu(e,t,F)},resize:function(){var e=d.c.find(".fullScreenVideo");0<e.length&&F.videoPosition(e)},loadmorescroll:function(){p.horizontal?!w&&!x&&"recommended"!=u&&d.w.scrollLeft()+d.w.width()>d.c.find(".shares").width()-2e3&&F.loadmore():!w&&!x&&("recommended"!=u||isMobile())&&d.w.scrollTop()+d.w.height()>d.c.height()-2e3&&F.loadmore()},commentLike:function(){var e=$(this).closest(".comment").attr("id"),t=$(this).closest(".share").attr("id");F.like(G.app.platform.sdk.node.shares.storage.trx[t].findComment(e)),$(this).addClass("active")},toComments:function(){var e=$(this).closest(".share").attr("id");O.comments(e,!0)},getTransaction:function(){var e=$(this).closest(".share").attr("id");G.app.platform.sdk.node.transactions.get.tx(e)},postscores:function(){var e=$(this).closest(".share").attr("id");F.postscores(e)},like:function(){var n,e,a=$(this).closest(".stars");a.attr("value")||(e=$(this).closest(".share").attr("id"),n=$(this).attr("value"),e=e||$(this).closest(".truerepost").attr("stxid"),F.stateAction("_this",function(){G.app.platform.sdk.node.shares.getbyid(e,function(){var t=G.app.platform.sdk.node.shares.storage.trx[e];G.app.platform.sdk.address.pnet()&&t.address==G.app.platform.sdk.address.pnet().address||(a.attr("value",n),a.addClass("liked"),F.like(t,n,function(e){e?(t.scnt||(t.scnt=0),t.score||(t.score=0),t.scnt++,t.score=Number(t.score||0)+Number(n),e=Number(t.score)/Number(t.scnt),a.find(".tstarsov").css("width",e/5*100+"%"),a.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),O.stars(t)):(a.removeAttr("value"),a.removeClass("liked"))}))})},e))},complain:function(){var e=$(this).closest(".share").attr("id");F.complain(e)},additional:function(){var e=$(this).closest(".share");F.additional(e,!e.hasClass("showAdditional"))},openGallery:function(){var e,t=$(this).closest(".shareinlenta").attr("id"),n=$(this).attr("i"),a=G.app.platform.sdk.node.shares.storage.trx[t];a||(e=_.find(G.sdk.node.transactions.temp.share,function(e){return e.txid==t}),(a=new pShare)._import(e),a.temp=!0,a.address=G.app.platform.sdk.address.pnet().address),F.openGalleryRec(a,n)},subscribePrivate:function(){var e=(t=$(this)).hasClass("turnon"),t=t.closest(".shareTable").attr("address");G.app.platform.api.actions[e?"notificationsTurnOff":"notificationsTurnOn"](t,function(e,t){e||G.app.platform.errorHandler(t,!0)})},asubscribe:function(){var e=$(this).closest(".shareTable").attr("address"),t=$(this).closest(".shareTable").attr("stxid");$(this).closest(".share"),F.stateAction("_this",function(){G.app.platform.api.actions.subscribeWithDialog(e,function(e,t){e||G.app.platform.errorHandler(t,!0)})},t)},aunsubscribe:function(){var e=$(this).closest(".shareTable").attr("address"),n=$(this).closest(".share");dialog({html:G.app.localization.e("e13022"),btn1text:G.app.localization.e("unsub"),btn2text:G.app.localization.e("ucancel"),class:"zindex",success:function(){G.app.platform.api.actions.unsubscribe(e,function(e,t){e?n.find(".shareTable").removeClass("subscribed"):G.app.platform.errorHandler(t,!0)})}})},exitFullScreenVideo:function(){var e=$(this).closest(".share").attr("id");F.exitFullScreenVideo(e)},fullScreenVideo:function(){var e=$(this).closest(".share").attr("id");F.fullScreenVideo(e)},opensvi:function(){var e=$(this).closest(".share").attr("id");F.opensvi(e)},fullScreenVideoMobile:function(){var e=$(this).closest(".share").attr("id");F.fullScreenVideoMobile(e)},openPost:function(e){deep(e,"target.href")||(e=$(this).closest(".shareinlenta").attr("id"),F.openPost(e))},sharesocial:function(){var e=$(this).closest(".shareinlenta").attr("id");F.sharesocial(e)},unblock:function(){var e=$(this).closest(".share").attr("id");F.unblock(e)},donate:function(){var e=$(this).closest(".share").attr("id");F.donate(e)},htls:function(){var e=$(this).closest(".share").attr("id");F.htls(e)},discussion:function(){var e=$(this).closest(".share").attr("id"),t=G.app.platform.sdk.node.shares.getWithTemp(e);isMobile()?G.nav.api.load({open:!0,id:"discussions",history:!0,clbk:function(){G.app.platform.sdk.chats.add(e+"_"+t.address,"share")}}):G.app.platform.sdk.chats.add(e+"_"+t.address,"share")},loadmore:function(){F.loadmore()},loadprev:function(){F.loadprev()}},O={debugusers:function(e){e.find(".testusersprofiles").each(function(){var e=$(this),t=(e.attr("ids")||"").split(","),n=_.map((e.attr("ids")||"").split(","),function(e){return e.split("_")[0]});t.length?G.app.platform.sdk.users.get(n,function(){G.shell({inner:html,name:"testusers",data:{ids:t},el:e},function(e){})}):e.text("Empty")})},comments:function(a,o,i,s){var r,l;"no"!=p.comments&&(g||f[a]||d.c&&(r=d.c.find("#"+a+" .commentsWrapper"),l=deep(G.app.platform,"sdk.node.shares.storage.trx."+a),G.fastTemplate("commentspreview",function(e){var t,n;d.c&&(t=d.c.find("#"+a),n="",G.app.platform.sdk.address.pnet()&&(n="&ref="+G.app.platform.sdk.address.pnet().address),n="https://"+G.app.options.url+"/"+(p.hr||"index?")+"s="+a+"&mpost=true"+n,parameters().address&&(n+="&address="+(parameters().address||"")),G.nav.api.load({open:!0,id:"comments",el:r,eid:a+"lenta",essenseData:{close:function(){f[a]&&f[a].hideall(!0),_scrollToTop(r,0,0,-65)},totop:d.c.find("#"+a),send:function(e,t){var n=d.c.find("#"+a+" .commentsAction .count span");n.html(Number(n.html()||"0")+1),l.lastComment=t},txid:a,showall:"all"==p.comments||i,fromtop:"all"==p.comments||t.hasClass("fullScreenVideo")||!1,preview:"all"!=p.comments&&s,lastComment:"all"!=p.comments?l.lastComment:null,count:l.comments,init:"all"!=p.comments&&o,hr:n,renderClbk:function(){p.renderclbk&&p.renderclbk()}},clbk:function(e,t){d.c&&(d.c.find("#"+a),t&&(f[a]=t),p.renderclbk&&p.renderclbk())}}))},{share:l})))},roomsinfo:function(e){_.each(e,function(e){var t=deep(G.app.platform,"rtc.storage.info."+e+".d.users_count"),e=e.split("_")[0];void 0!==t&&d.c&&d.c.find("#"+e+" .discussion .count").html(t?"<b>"+t+"</b>":"")})},shareSpacers:function(e){_.each(e,function(e){O.shareSpacer(e)})},shareSpacer:function(e){var t,n;b[e.txid]&&!k[e.txid]&&(n=(t=d.shares.find("#"+e.txid)).find(".work").outerHeight(),C[e.txid]&&C[e.txid].inited&&(C[e.txid].p.destroy(),C[e.txid].el=null,C[e.txid].inited=!1),b[e.txid]=!1,d.shares.css("height",d.shares.outerHeight()),t.html('<div class="shareSpacer added"></div>'),t.find(".shareSpacer").outerHeight(n),M[e.txid]=F.applyheightEl(M[e.txid],t,"space"))},share:function(t,n,e){var a;t&&(a=d.share[t.txid],M[t.txid]=0,a.find(".added"),k[t.txid]=!0,G.shell({name:g?"sharevideolight":"share",el:a,data:{share:t,ed:p,mestate:o,all:e||!1,tplvideo:g}},function(e){a.find(".work"),b[t.txid]=!0,M[t.txid]=F.applyheightEl(M[t.txid],a,"share"),O.stars(t),t.temp||O.comments(t.txid,!1,!1,!0),O.repost(e.el,t.repost,t.txid,t.isEmpty()),O.url(e.el.find(".url"),t.url,t,function(){O.urlContent(t,function(){p.searchValue&&e.el.find(".canmark").mark(p.searchValue),g||F.initVideo(e.el,t,null,!p.openapi),v&&d.shares.isotope(),k[t.txid]=!1,n&&n()})}),O.images(t,function(){})}))},mystars:function(e,t){var n=_.filter(e,function(e){if(void 0===e.myVal)return!0}),n=_.map(n,function(e){return e.txid});G.app.platform.sdk.likes.get(n,function(){_.each(e,function(e){O.stars(e),O.wholike(e)}),t&&t()})},wholike:function(e,t){var n,a;!d.shares||(n=d.shares.find("#"+e.txid)).length&&(a=e.who,G.shell({name:"wholike",el:n.find(".wholikes"),data:{scores:Number(e.scnt),wholikes:a||[]},bgImages:{}},function(e){t&&t()}))},stars:function(e,t){var n;!d.shares||(n=d.shares.find("#"+e.txid)).length&&G.shell({name:"stars",el:n.find(".forstars"),data:{share:e}},function(e){fastars(e.el.find(".stars")),t&&t()})},sharesInview:function(e,t){e=_.filter(e,function(e){return!$("#"+e.txid).hasClass("hidden")});var n=_.sortBy(e,function(e){return-e.time});lazyEach({array:n,action:function(e){var t=e.item;b[t.txid]?e.success():(b[t.txid]=!0,O.share(t,e.success))},sync:isMobile(),all:{success:function(){O.mystars(e),t()}}})},shareall:function(e){_.each(e,function(e){O.share(e)})},txidall:function(e){_.each(e,function(e){e=deep(G.app.platform,"sdk.node.shares.storage.trx."+e),O.share(e)})},shares:function(t,n,e){(e=e||{}).inner||(e.inner=function(e,t){if(!v)return append(e,t);t=$(t),e.append(t).isotope("appended",t)});var a="groupshares";(p.author||u||p.horizontal||p.txids||p.search)&&(a="shares"),"recommended"==u&&(t=_.sortBy(t,function(e){return-e.time})),e.ignoresw||(t=_.filter(t,function(t){return!_.find(z,function(e){return e.txid==t.txid})})),G.shell({name:a,inner:e.inner,el:e.el||d.shares,data:{shares:t||[],index:e.index||0,video:g||p.videomobile},animation:!1,delayRender:v},function(e){e.inner==append?z=z.concat(t):e.inner!=replaceWith&&(z=t.concat(z)),z=_.uniq(z,function(e){return e.txid}),_.each(t,function(e){d.share[e.txid]=d.c.find("#"+e.txid)}),p.renderclbk&&p.renderclbk(),g&&!isMobile()&&(v||p.horizontal||(d.shares.isotope({layoutMode:"packery",itemSelector:".authorgroup",packery:{gutter:0},initLayout:!1}),d.shares.on("arrangeComplete",function(){}),v=!0)),n&&n()})},videoPreview:function(e,t){var n,a=d.share[e.txid];"a"==e.settings.v?(a=a.find("[data-plyr-provider][data-plyr-embed-id]"),n=[],$.each(a,function(){var e={type:(e=$(this)).attr("provider"),id:e.attr("eid")};n.push(videoImage(e))})):t&&t()},images:function(n,a){var o,s,r,l=n;d.c&&(o=d.share[n.txid],s=o.find(".image"),!(r=o.find(".images")).hasClass("active")&&s.length&&r.length?window.requestAnimationFrame(function(){s.imagesLoaded({background:!0},function(i){function e(){r.addClass("active"),s.addClass("active"),M[l.txid]=F.applyheightEl(M[l.txid],o),p.renderclbk&&p.renderclbk(),a&&a()}var t;"a"!=n.settings.v&&_.each(i.images,function(e,t){var n=e.img,a=$(i.elements[t]).closest(".imagesWrapper"),o="",e=a.width();a.height(),n.width>n.height&&!isMobile()&&768<window.innerWidth&&(o="w2",(t=e*(n.width/n.height))>r.width()&&(t=r.width(),h=t*(n.height/n.width),a.height(h)),a.width(t)),(n.height>n.width||isMobile()||window.innerWidth<=768)&&(o="h2",a.height(e*(n.height/n.width))),o&&a.addClass(o)}),M[l.txid]=F.applyheightEl(M[l.txid],o),"a"!=n.settings.v&&1<i.images.length?(t=5,isMobile()&&(t=0),r.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:t},initLayout:!1}),r.on("arrangeComplete",function(){e()}),r.isotope()):e()})}):a&&a())},repost:function(e,t,n,a,o){t&&G.shell({name:"repost",el:e.find(".repostWrapper"),data:{repost:t,share:deep(G.app.platform,"sdk.node.shares.storage.trx."+n),level:1}},function(e){e.el&&e.el.length&&G.app.platform.papi.post(t,e.el.find(".repostShare"),function(e){E[n]=e},{repost:!0,eid:n+"lenta",level:1,fromempty:a})})},url:function(t,o,i,s){var n,r,e,a,l;p.nourlload?s&&s():(n=G.app.platform.sdk.remote.storage[o],r=t.closest(".share"),e=G.app.platform.parseUrl(o),a=function(n){var e=deep(G,"app.platform.sdk.videos.storage."+o+".data.aspectRatio")||0,t=G.app.platform.sdk.videos.storage[o];(e=t&&t.data?t.data.aspectRatio||0:e)&&((t=n.el.find(".jsPlayerLoading")).css("padding-top",`${e=100/(2*e)}%`),t.css("padding-bottom",`${e}%`)),G.app.nav.api.links(null,n.el,function(e){e.stopPropagation()}),M[i.txid]=F.applyheightEl(M[i.txid],r,"url");var a=n.el.find("img");p.renderclbk&&p.renderclbk(),n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(a[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(a[t]).closest(".image").css("display","none")}),M[i.txid]=F.applyheightEl(M[i.txid],r,"url"),p.renderclbk&&p.renderclbk()}),s&&s()},l=function(e){G.shell({turi:"share",name:"url",el:t,data:{url:o,og:n,share:i,video:g,preview:!!g},notdisplay:!!g,bgImages:{clbk:!!g}},a)},"peertube"===e.type?G.app.platform.sdk.videos.info([o]).then(e=>{l()}):l())},urlContent:function(t,n){var a,o,e,i;d.c&&((a=t.url)?(o=d.share[t.txid].find(".url"),e=G.app.platform.parseUrl(a),i=G.app.platform.sdk.remote.storage[a],!a||i||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?n&&n():G.app.platform.sdk.remote.get(a,function(e){e?O.url(o,a,t,n):n&&n()})):n&&n())},urlsContent:function(e){_.each(e,function(e){O.urlContent(e)})},urls:function(e,t){lazyEach({array:e,sync:!0,action:function(e){O.url(e.item.el,e.item.url,e.item.share,e.success)},all:{success:function(){t&&t()}}})},spacers:function(e,t){e=_.map(e,function(e){return{txid:e,author:p.author}}),this.shares(e,t,{noview:!0})}},U={recomended:function(t,n){d.loader.fadeIn(),d.c.addClass("loading"),c=[],p.author||L?t&&t(c):G.app.platform.sdk.node.shares.recomended({},function(e){c=_.filter(e,function(t){if(!_.find(n,function(e){if(e.txid==t)return!0}))return!0}),G.app.platform.sdk.node.shares.users(e,function(){t&&t(c)})})},txids:function(e,t){q?t([]):G.app.platform.sdk.node.shares.getbyid(e,function(e){q=!0,t(e)})},begin:function(t){!L||q||u&&"sub"!=u?(q=!0,t([])):G.app.platform.sdk.node.shares.getbyid(L,function(e){q=!0,t(e)})},videosinfo:function(e,t){},sstuff:function(a,o,i,s,r){r=r||[];var l=[].concat(a,r),c=p.author;G.app.platform.sdk.node.shares.loadvideoinfoifneed(l,g,function(){G.app.platform.sdk.node.shares.users(l,function(e,t){var n;N+=l.length,w=!1,d.c&&(o||t||(a&&a.length&&!(a.length<i.count)&&"recommended"!=u||(L||N?!p.txids&&(a.length<i.count||"recommended"==u)&&(u||c||p.search||p.tags)&&setTimeout(function(){d.c&&d.c.addClass("sharesEnded")},1e3):d.c.addClass("sharesZero"),(!a.length||a.length<i.count)&&(u||c||p.search)&&(x=!p.ended||p.ended(a))),(a=_.filter(a,function(t){return!_.find(r,function(e){return e.txid==t.txid})})).concat(r),a=[].concat(r,a),p.filter&&(a=_.filter(a,p.filter)),!p.author&&G.user.address&&G.user.address.value&&(n=deep(G.app,"platform.sdk.users.storage."+G.user.address.value.toString("hex")),a=_.filter(a,function(e){return!n.relation(e.address,"blocking")})),a.length&&p.hasshares&&p.hasshares(a)),p.afterload&&p.afterload(p,a,o||t),d.loader.fadeOut(),s&&s(a,o||t))})})},shares:function(r,l){w||x&&(!p.contents||p.txids.length==_.toArray(b).length)||(d.loader.fadeIn(),d.c.addClass("loading"),w=!0,p.loader?p.loader(function(e,t,n){U.sstuff(e,t,n,r)}):G.app.user.isState(function(s){U.begin(function(a){var e=p.author,t="common",n="";if(e?n=L:t="hierarchical",u)if("recommended"==u)t="recommended";else if("hot"!=u)if("b"==u)t="getbyidsp",n=p.beginmaterial;else if(t="common",e="1",!s)return void U.sstuff([],null,{count:0},r);p.txids&&"b"!=u&&(t="txids"),p.loaderkey&&(t=p.loaderkey),p.from&&(n=p.from);var o=G.app.platform.sdk.categories.gettags();p.tags&&(o=p.tags);var i=p.page||parameters().page||0;G.app.platform.sdk.node.shares[t]({author:e,begin:n||"",txids:p.txids,height:D,tagsfilter:o,video:g||p.videomobile,count:g?20:10,page:i,period:p.period},function(e,t,n){n.blocknumber&&(D=n.blocknumber),p.shuffle&&(e=_.shuffle(e)),U.sstuff(e,t,n,r,a),"b"==u&&(L="")},l)})}))}},B=function(e){var t,n;"recommended"==u||p.author||p.search||(n=0,(t=_.toArray(G.sdk.node.transactions.temp.share||{})).length&&!u&&(n-=t.length),0<(e||0)+n&&(I=I+(e||0)+n,d.c.addClass("showprev"),d.c.find(".countnew").html("("+I+")"),p.renderclbk&&p.renderclbk()))},H=function(a,o){s=!0,F.cleardelay();var e="clear",n=!0;p.goback&&(e="cache"),p.contents&&(d.c.find(".shares").html(""),O.spacers(p.txids,function(){F.scrollToPost(p.beginmaterial)}),n=!1);var t=parameters();p.second||g&&t.v&&F.opensvi(t.v),U.shares(function(e,t){return t?(s=!1,G.app.errors.connection()&&d.c.addClass("networkError"),void(G.iclbks.lenta=function(){H(null,o)})):(d.c.removeClass("networkError"),void(e?(n&&d.c.find(".shares").html(""),O.shares(e,function(){O.sharesInview(e,function(){s=!1,j.sharesInview(),j.sharesPreInitVideo(),j.videosInview();var e,t,n=parameters();p.second||(n.s&&!n.msh&&(isMobile()||F.openPost(n.s,function(){F.scrollToPost(n.p)})),n.i&&(t=null,(e=deep(G.app.platform,"sdk.node.shares.storage.trx."+n.i))&&(n.num&&(t=deep(e,"images."+n.num)),F.openGalleryRec(e,t))),n.v&&(g||isMobile()||F.fullScreenVideo(n.v,function(){})),n.p&&F.postscores(n.p,function(){F.scrollToPost(n.p)})),a&&a(),p.goback&&o.clbk&&(p.goback=!1,o.clbk(null,o)),p.notscrollloading&&p.txids&&O.txidall(p.txids)})})):s=!1))},e)},K=function(){var e;p.goback||p.second||p.author||L||(e="sub"==u?"sub":g?"video":"common","recommended"!=u&&G.app.platform.sdk.newmaterials.see(e))};return{id:e,primary:i,getdata:function(n,e){l=!1,I=0,f={},p=e.settings.essenseData||{},F.clear(),e=parameters(),y=G.sdk.videos.volume,L=e.s||e.i||e.v||e.p||null,u=e.r||!1,void 0!==p.r&&null!=p.r&&(u=p.r),p.second&&(L=null),p.txids&&"b"!=u&&(u=!1),m=!p.txids||!1,g=p.video||!1,G.app.platform.sdk.ustate.me(function(e){o=e||{};var t={beginmaterial:L,author:p.author,recommended:u,filters:p.search||p.tags};G.loadTemplate({name:"share"},function(){G.loadTemplate({name:"sharevideo"},function(){G.loadTemplate({turi:"share",name:"url"},function(){G.loadTemplate({name:"stars"},function(){n(t)})})})})})},hasplayingvideos:function(){var e=_.filter(C,function(e){if(e.p&&e.el&&e.inited&&e.p.playing)return!0});return console.log("players",e),e.length},destroy:function(){d.shares&&v&&d.shares.isotope("destroy"),F.cleardelay(),F.scrollmode(!1),v=!1,_.each(b,function(e,t){delete G.app.platform.sdk.node.shares.storage.trx[t]}),_.each(C,function(e){e.p&&e.p.destroy()}),C={},l&&G.app.actions.onScroll(),_.each(f,function(e){e.destroy()}),f={},delete G.iclbks.lenta,p.openapi||p.second||p.txids||(delete G.app.platform.sdk.categories.clbks.tags.lenta,delete G.app.platform.sdk.categories.clbks.selected.lenta,delete G.app.platform.ws.messages.comment.clbks.lenta,delete G.app.platform.sdk.node.shares.clbks.added.lenta,delete G.app.platform.ws.messages.transaction.clbks.temp,delete G.app.platform.ws.messages.event.clbks.lenta,delete G.app.platform.ws.messages["new block"].clbks.newsharesLenta,delete G.app.platform.clbks.api.actions.subscribe.lenta,delete G.app.platform.clbks.api.actions.unsubscribe.lenta,delete G.app.platform.clbks.api.actions.subscribePrivate.lenta,delete G.app.platform.clbks.api.actions.blocking.lenta,delete G.app.platform.clbks.api.actions.unblocking.lenta,delete G.app.platform.clbks._focus.lenta),G.app.platform.sdk.chats.removeTemp(),g=!1,d.w&&(d.w.off("scroll",j.sharesPreInitVideo),d.w.off("scroll",j.videosInview),d.w.off("scroll",j.sharesInview),d.w.off("scroll",j.loadmorescroll),d.w.off("resize",j.resize)),d={}},authclbk:function(){void 0!==d&&d.c&&F.authclbk()},update:function(){d.shares&&v&&d.shares.isotope("layout")},init:function(e){var n,a,o;t=$(window),(d={}).c=e.el.find("#"+G.map.id),d.shares=d.c.find(".shares"),d.loader=d.c.find(".loader"),d.lentacnt=d.c.find(".lentacell .cnt"),d.w=p.window||$(window),d.share={},p.horizontal&&d.c.addClass("horizontal"),p.compact&&d.c.addClass("compact"),isMobile()&&m&&!p.openapi&&(n=d.c.find(".circularprogress"),(a=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),d.c.find(".circularprogressWrapper").html(a.el),o=d.c.find(".loadprev"),p.second||new SwipeParallaxNew({el:d.c.find(".shares"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/80;0<=e?(a.options.text={value:""},a.update(100*t),n.fadeIn(1),n.height(220*t+"px"),o.css("opacity",1-4*t)):(a.renew(),n.fadeOut(1))},constraints:function(){if(d.w.scrollTop()<=0&&!V)return!0},restrict:!0,dontstop:!0,trueshold:80,clbk:function(){a.update(0),n.fadeOut(1),G.app.platform.sdk.notifications.getNotifications(),F.loadprev(function(){})}}}}).init()),p.openapi||(d.w.on("resize",j.resize),p.horizontal||(d.w.on("scroll",j.videosInview),d.w.on("scroll",j.sharesPreInitVideo)),p.notscrollloading||(d.w.on("scroll",j.sharesInview),d.w.on("scroll",j.loadmorescroll))),d.c.on("click",".wholikesTable",j.postscores),d.c.on("click",".stars i",j.like),d.c.on("click",".complain",j.complain),d.c.on("click",".imageOpen",j.openGallery),d.c.on("click",".txid",j.getTransaction),isMobile(),d.c.on("click",".debuginfo .icon",function(){$(this).closest(".debuginfo").addClass("showed"),O.debugusers($(this).closest(".debuginfo"))}),d.c.on("click",".showMore",j.openPost),d.c.on("click",".forrepost",j.repost),d.c.on("click",".unblockbutton",j.unblock),d.c.on("click",".videoTips",j.fullScreenVideo),d.c.on("click",".videoOpen",j.fullScreenVideo),d.c.on("click",".opensviurl",j.opensvi),d.c.on("click",".exitFull",j.exitFullScreenVideo),d.c.on("click",".additional",j.additional),d.c.on("click",".asubscribe",j.asubscribe),d.c.on("click",".aunsubscribe",j.aunsubscribe),d.c.on("click",".notificationturn",j.subscribePrivate),d.c.on("click",".donate",j.donate),d.c.on("click",".sharesocial",j.sharesocial),d.c.on("click",".discussion",j.discussion),d.c.on("click",".metmenu",j.metmenu),d.c.find(".loadmore button").on("click",j.loadmore),d.c.find(".loadprev button").on("click",j.loadprev),d.c.on("click",".showmorebyauthor",j.showmorebyauthor),d.c.on("click",".commentsAction",j.toComments),p.openapi||p.second||(p.txids||(G.app.platform.sdk.node.shares.clbks.added.lenta=function(e){var t;e.txidEdit?(delete f[e.txidEdit],delete b[e.txidEdit],delete k[e.txidEdit],t=replaceEqual(z,{txid:e.txidEdit},e),F.destroyVideo(e),t&&O.shares([e],function(){O.sharesInview([e],function(){})},{inner:replaceWith,el:d.shares.find("#"+e.txidEdit),ignoresw:!0})):(F.destroyVideo(e),O.shares([e],function(){O.sharesInview([e],function(){})},{inner:prepend}))},G.app.platform.ws.messages.transaction.clbks.temp=function(t){var e;p.author||p.txids||!t.temp||(e=_.find(z,function(e){if(e.txid==t.temp.txid)return!0}))&&(e.temp=!1,e.scnt="0",e.score="0",e.myVal=0,e.time=new Date,b[e.txid]=!1,O.sharesInview([e],function(){}))},G.app.platform.ws.messages.event.clbks.lenta=function(t){var e;"upvoteShare"!=t.mesType||!t.share||(e=_.find(z,function(e){if(e.txid==t.share.txid)return!0}))&&O.stars(e,function(){})}),G.app.platform.clbks._focus.lenta=function(e){!window.cordova&&!isInStandaloneMode()||V||p.txids||s||!(120<e)||p.second||(F.loadprev(),_scrollTop(0))},p.txids||(G.app.platform.ws.messages.newblocks.clbks.newsharesLenta=G.app.platform.ws.messages["new block"].clbks.newsharesLenta=F.newmaterials,G.app.platform.sdk.categories.clbks.tags.lenta=G.app.platform.sdk.categories.clbks.selected.lenta=function(e){var t,n;"hierarchical"!=(t="common",n=p.author,p.loaderkey||(n||(t="hierarchical"),u&&(t="recommended"==u?"recommended":"b"==u?"getbyidsp":"common"),p.txids&&"b"!=u?"txids":t))||p.second||F.rebuilddelay()}),G.app.platform.ws.messages.comment.clbks.lenta=function(e){b[e.posttxid]&&(e=d.c.find("#"+e.posttxid+" .commentsAction .count span")).html(Number(e.html()||"0")+1)},G.app.platform.clbks.api.actions.subscribe.lenta=function(e){(e=d.c.find('.shareTable[address="'+e+'"]')).addClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},G.app.platform.clbks.api.actions.subscribePrivate.lenta=function(e){var t=d.c.find('.shareTable[address="'+e+'"]'),n=deep(G.app,"platform.sdk.users.storage."+G.user.address.value.toString("hex"));n&&(!(e=n.relation(e,"subscribes"))||"true"!=e.private&&!0!==e.private?t.find(".notificationturn").removeClass("turnon"):t.find(".notificationturn").addClass("turnon")),t.addClass("subscribed")},G.app.platform.clbks.api.actions.unsubscribe.lenta=function(e){(e=d.c.find('.shareTable[address="'+e+'"]')).removeClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},G.app.platform.clbks.api.actions.blocking.lenta=function(e){d.c.find('.shareTable[address="'+e+'"]').closest(".share").addClass("blocking")},G.app.platform.clbks.api.actions.unblocking.lenta=function(e){d.c.find('.shareTable[address="'+e+'"]').closest(".share").removeClass("blocking")}),K(),H(null,e),g&&d.c.addClass("mainvideo"),p.goback||e.clbk(null,e)}}}var G=new nModule,a={};return G.update=function(){_.each(a,function(e){e.update()})},G.authclbk=function(){_.each(a,function(e){e.authclbk()})},G.run=function(e){var t=G.addEssense(a,n,e);G.init(t,e)},G.stop=function(){_.each(a,function(e){e.destroy()})},G}();"undefined"!=typeof module?module.exports=lenta:(app.modules.lenta={},app.modules.lenta.module=lenta);var tube=function(){function n(e){var t,n,a;return{primary:e=deep(e,"history"),getdata:function(e,t){n=t.settings.essenseData||{},_.each(a,function(e,t){delete o.app.platform.sdk.node.shares.storage.trx[t]}),loaded=!1,a={},(t=parameters()).s||t.i||t.v||t.p,e({})},destroy:function(){t={}},init:function(e){(t={}).c=e.el.find("#"+o.map.id),t.shares=t.c.find(".shares"),t.loader=t.c.find(".loader"),t.lentacnt=t.c.find(".lentacell .cnt"),n.goback,n.goback||e.clbk(null,e)}}}var o=new nModule,a={};return o.run=function(e){var t=o.addEssense(a,n,e);o.init(t,e)},o.stop=function(){_.each(a,function(e){e.destroy()})},o}();"undefined"!=typeof module?module.exports=tube:(app.modules.tube={},app.modules.tube.module=tube);var send=function(){function n(e){var n,a,e=deep(e,"history"),o={stateAction:function(t,n){i.app.user.isState(function(e){e?n():i.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{loginText:i.app.localization.e("llogin"),successHref:t,signInClbk:function(){n&&n()}}})})},send:function(){o.stateAction("_this",function(){i.nav.api.load({open:!0,history:!0,href:"userpage?id=wallet&action=send&address="+a.address+"&amount="+a.amount+"&message="+a.message})})}};return{primary:e,getdata:function(e){var t=parameters();a={},t.address&&bitcoin.address.fromBase58Check(t.address)&&(a.address=t.address),t.amount&&(a.amount=Number(t.amount)),t.label&&(a.label=clearScripts(donottrustLink(findAndReplaceLink(t.label,!0)))),t.message&&(a.message=clearScripts(donottrustLink(findAndReplaceLink(hexDecode(t.message,!0))))),a.amount&&a.address&&a.message?e(a):i.nav.api.load({open:!0,href:"page404",history:!0})},destroy:function(){n={}},init:function(e){var t;(n={}).c=e.el.find("#"+i.map.id),n.am=n.c.find(".amredit"),n.c.find(".send").on("click",o.send),n.am.on("change",function(){var e=$(this).val();a.amount=e}),0<(t={alias:"numeric",groupSeparator:",",radixPoint:".",digits:6,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(t.placeholder="0.000000"),n.am.inputmask(t),parameters().setammount||n.am.blur(),e.clbk(null,e)}}}var i=new nModule,a={};return i.run=function(e){var t=i.addEssense(a,n,e);i.init(t,e)},i.stop=function(){_.each(a,function(e){e.destroy()})},i}();"undefined"!=typeof module?module.exports=send:(app.modules.send={},app.modules.send.module=send);var imagegallery=function(){function n(e){function t(){if(!i){var e=$(this).attr("action");return c[e](),!1}}function n(e){}var o,a,i,e=deep(e,"history"),s=null,r=0,l={current:{z:1}},c={swipe:function(e,t,n){},back:function(){1<a.images.length&&(c.prepareImages(),--r<0&&(r=a.images.length-1),p())},next:function(){1<a.images.length&&(c.prepareImages(),++r>=a.images.length&&(r=0),p())},initialValue:function(){c.prepareImages(),a.initialValue&&(r=findIndex(a.images,function(e){var t="name";if(e[t=a.idName||t]==a.initialValue)return!0}))},prepareImages:function(){a.getImages&&(a.images=a.getImages())},prepareImage:function(e,t){a.getImage?a.getImage(e,function(e){t&&t(e)}):t&&t(e)}},d={resize:function(){d.bestFit(o.imagesWrapper.find(".image"),s)},bestFit:function(e,t){var n=e.closest(".imagesAbsWrapper"),a=e.find(".imgWrapper"),o=t.naturalWidth||t.width,i=t.naturalHeight||t.height,s=i/o;e.css("padding-top","0px");var r=e.width(),l=e.height(),e=n.width();(l=(n=n.height())<l?n:l)<=(i=(r=e<r?e:r)<o?(o=r)*s:i)&&(o=(i=l)/s),t.width=o,t.height=i,$(t).attr("data-camanwidth",o),$(t).attr("data-camanheight",i),$(t).animate({opacity:1}),a.width(o),a.height(i)},nFormat:function(e){return e<10?"0"+e:e},getRelativePosition:function(e,t,n,a){var o=d.getCoords(e),e=t.x-o.x,o=t.y-o.y;return{x:e/(n.width*a/2)-1,y:o/(n.height*a/2)-1}},getCoords:function(e){var e=(t=e.getBoundingClientRect()).top,t=t.left;return{x:Math.round(t),y:Math.round(e)}},scaleFrom:function(e,t,n){var a=d.getCoordinateShiftDueToScale(l.originalSize,t),o=d.getCoordinateShiftDueToScale(l.originalSize,n),i=a.x-o.x,o=a.y-o.y;return{x:e.x*i,y:e.y*o,z:n-t}},getCoordinateShiftDueToScale:function(e,t){var n=t*e.width,t=t*e.height;return{x:(n-e.width)/2,y:(t-e.height)/2}},updateZoomedImage:function(e=!0){var t;l.current.height=l.originalSize.height*l.current.z,l.current.width=l.originalSize.width*l.current.z,e&&(t=l.imageContainerParent.height()<l.current.height?Math.abs((l.current.height-l.imageContainerParent.height())/2):0,e=l.imageContainerParent.width()<l.current.width?Math.abs((l.current.width-l.imageContainerParent.width())/2):0,l.current.y>t?l.current.y=l.last.y=t:l.current.y<-t&&(l.current.y=l.last.y=-t),l.current.x>e?l.current.x=l.last.x=e:l.current.x<-e&&(l.current.x=l.last.x=-e)),l.imageContainer.style.transform="translate3d("+l.current.x+"px, "+l.current.y+"px, 0) scale("+l.current.z+")"}},p=function(){o.c.addClass("loading"),i=!0;var e=a.images[r]||a.images[0];console.log(e,a.images,r),u.app.nav.api.history.addParameters({num:r.toString()}),c.prepareImage(e,function(e){e={image:e},o.imageNavigation.find(".number").html(d.nFormat(r+1)),$(window).off("resize",d.resize),e=e||{},u.shell({name:"image",el:o.images,inner:html,display:"table",data:{data:a,image:e.image}},function(a){a.el.find("img").imagesLoaded(function(e){o.c.removeClass("loading"),i=!1,(s=deep(e,"images.0.img"))&&(d.resize(),$(window).on("resize",d.resize));var t=a.el.find(".imgWrapper")[0],e=a.el.find("img")[0];l={fullContainer:$(t).closest(".imageContainer")[0],imageContainerParent:$(t).parent(),imageContainer:t,imageElement:e,minZoomAllowed:1,maxZoomAllowed:5,current:{x:0,y:0,z:1,zooming:!1,width:e.width,height:e.height},fixHammerjsDeltaIssue:void 0,pinchStart:{x:void 0,y:void 0},last:{x:0,y:0,z:1},lastEvent:void 0,originalSize:{width:e.width,height:e.height,containerWidth:$(t).width(),containerHeight:$(t).height()},pinchZoomOrigin:void 0};var n=new Hammer(l.imageContainer);n.get("pan").set({threshold:0}),n.get("pinch").set({enable:!0}),n.get("tap").set({taps:2}),n.get("swipe").set({direction:Hammer.DIRECTION_ALL}),n.on("pan",function(e){l.imageContainer.style.transition="none","pan"!==l.lastEvent&&(l.fixHammerjsDeltaIssue={x:e.deltaX,y:e.deltaY}),l.current.x=l.last.x+e.deltaX-l.fixHammerjsDeltaIssue.x,l.current.y=l.last.y+e.deltaY-l.fixHammerjsDeltaIssue.y,l.lastEvent="pan",d.updateZoomedImage(!1)}),n.on("panend",function(e){l.imageContainer.style.transition=l.current.z<=1?"0.3s":"none",l.last.x=l.current.x,l.last.y=l.current.y,l.lastEvent="panend",d.updateZoomedImage()}),n.on("doubletap",function(e){var t=1<l.current.z?1-l.current.z:2;l.imageContainer.style.transition="0.3s",e=d.getRelativePosition(l.imageElement,{x:e.center.x,y:e.center.y},l.originalSize,l.current.z),t=d.scaleFrom(e,l.current.z,l.current.z+t),l.current.x+=t.x,l.current.y+=t.y,l.current.z+=t.z,l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,d.updateZoomedImage()}),n.on("swipeleft swiperight",function(e){l.imageContainerParent.width()<l.current.width||(e.deltaX<0?c.next():c.back())}),n.on("swipeup swipedown",function(e){l.imageContainerParent.height()<l.current.height||u.closeContainer()}),n.on("pinchstart",function(e){l.pinchStart.x=e.center.x,l.pinchStart.y=e.center.y,l.pinchZoomOrigin=d.getRelativePosition(l.imageContainer,{x:l.pinchStart.x,y:l.pinchStart.y},l.originalSize,l.current.z),l.lastEvent="pinchstart"}),n.on("pinch",function(e){(e=d.scaleFrom(l.pinchZoomOrigin,l.last.z,l.last.z*e.scale)).z+l.last.z<=l.maxZoomAllowed&&e.z+l.last.z>=l.minZoomAllowed&&(l.current.x=e.x+l.last.x,l.current.y=e.y+l.last.y,l.current.z=e.z+l.last.z),l.lastEvent="pinch",d.updateZoomedImage()}),n.on("pinchend",function(e){l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,l.lastEvent="pinchend",n.get("pan").set({enable:!1}),setTimeout(()=>{n.get("pan").set({enable:!0})},200)}),l.imageElement.addEventListener("wheel",e=>{var t=0<e.deltaY?-1:1;t<0&&l.current.z+t<l.minZoomAllowed||0<t&&l.current.z+t>l.maxZoomAllowed||(l.imageContainer.style.transition="0.3s",e=d.getRelativePosition(l.imageElement,{x:e.x,y:e.y},l.originalSize,l.current.z),t=d.scaleFrom(e,l.current.z,l.current.z+t),l.current.x+=t.x,l.current.y+=t.y,l.current.z+=t.z,l.last.x=l.current.x,l.last.y=l.current.y,l.last.z=l.current.z,d.updateZoomedImage())},!1),(t=new Hammer(l.fullContainer)).get("swipe").set({direction:Hammer.DIRECTION_ALL}),t.on("swipeleft swiperight",function(e){1.2*l.imageContainerParent.width()<l.current.width||(e.deltaX<0?c.next():c.back())}),t.on("swipeup swipedown",function(e){1.2*l.imageContainerParent.height()<l.current.height||u.closeContainer()})})})})};return{primary:e,parametersHandler:function(){var e=parameters().num;void 0!==e&&(r=Number(e),c.prepareImages(),p())},getdata:function(e){e({})},destroy:function(){s=null,$(window).off("resize",d.resize),i=!1,o={}},clearparameters:["i","num","s","com"],init:function(e){s=null,i=!1,a=e.essenseData||{},c.initialValue(),(o={}).c=e.el.find("#"+u.map.id),o.imagesWrapper=e.el.find(".imagesWrapper"),o.images=e.el.find(".images"),o.imageNavigation=e.el.find(".imageNavigation"),o.arrows=o.imageNavigation.find(".arrow"),p(),o.arrows.on("click",t),isMobile()||isTablet()||o.c.on("click",n),o.c.find(".imagesTableWrapper").closest(".wnd"),a.images&&1<a.images.length&&o.c.find(".imagesTableWrapper").swipe({allowPageScroll:"auto",swipeStatus:function(e,t,n,a){return c.swipe(t,n,a),!0}}),e.clbk(null,e)},wnd:{class:"allscreen black withoutButtons imageGallery"}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=imagegallery:(app.modules.imagegallery={},app.modules.imagegallery.module=imagegallery);var s=function(){function n(e){function t(){var e=$(this).attr("arrow");p.clickArrow(e)}function n(){p.clickNext()}var a,o,r,i,s,e=deep(e,"history"),l=0,c=10,d="list",p={clickNext:function(){f("users",l+=c,30),p.displayArrows()},clickArrow:function(e){"left"==e&&(l-=c)<0&&(l=0),"right"==e&&((l+=c)>=r.users.count&&(l=r.users.count-1),f("users",l,c)),p.slideCarousel()},displayArrows:function(){0<l?p.displayArrow("left",!0):p.displayArrow("left",!1),l+c<r.users.count?(p.displayArrow("right",!0),p.displayNext(!0)):(p.displayArrow("right",!1),p.displayNext(!1))},displayNext:function(e){e?a.unext.addClass("active"):a.unext.removeClass("active")},displayArrow:function(e,t){var n=a.ea;e&&(n=a["u"+e]),t?n.addClass("active"):n.removeClass("active")},slideCarousel:function(){var e=a.c.find(".user").width(),e=l*e;a.userslist.css("margin-left","-"+e+"px"),p.displayArrows()},applyCarousel:function(){var e,t;"list"==d?(e=a.c.find(".user").width(),t=a.c.find(".userslistwrapper").width(),c=Math.min(Number((t/e).toFixed(0)),10),a.c.find(".user").width((t/c).toFixed(0)+"px"),a.userslist.width((r.users.data.length*(t/c)).toFixed(0)+1),p.slideCarousel()):(a.userslist.css("margin-left","0px"),a.userslist.css("width","auto"),a.c.find(".user").css("width","auto"))},changeUsersView:function(){"list"==d?d="full":(d="list",l=0),a.users.attr("view",d),p.applyCarousel()}},u={users:function(e,t){h.shell({name:"userslist",el:a.users.find(".userslist"),data:{users:e},inner:append,bgImages:{clbk:function(e){$(e.elements[0]).addClass("active")}}},function(e){"list"==d&&p.applyCarousel(),t&&t(e)})},posts:function(){var e=!1;h.nav.api.load({open:!0,id:"lenta",el:a.lenta,animation:!1,mid:"search",essenseData:{search:!0,hr:"index?",searchValue:o,loader:function(t){function n(e){e=h.app.platform.sdk.node.shares.transform(e),t&&t(e,null,{count:10})}e?f("posts",r.posts.data.length,10,function(e){n(e)}):(e=!0,n(r.posts.data))}},clbk:function(e,t){s=t}})}},f=function(t,e,n,a){var o,i=r[t].data.length,s=r[t].count;e+n<=i||(e<i&&(o=i-e,e=i,n-=o),(n=s<e+n?s-e:n)<=0||m[t](function(e){a?a(e):u[t](e)},e,n))},m={users:function(t,e,n){h.app.platform.sdk.search.get(o,"users",e,n,i,function(e){t(e.data)})},posts:function(t,e,n){h.app.platform.sdk.search.get(o,"posts",e,n,i,function(e){t(e.data)})}};return{primary:e,getdata:function(n){var a={};s=null,o=(parameters().ss||"").replace("tag:","#");var e=deep(h,"app.modules.menu.module.showsearch");e&&e(o),h.app.platform.sdk.search.clear(),h.app.platform.sdk.search.get(o,"all",0,10,null,function(e,t){i=t,r=e,a.result=e,a.value=o,n(a)})},destroy:function(e){e==h.app.nav.current.href||(e=deep(h,"app.modules.menu.module.closesearch"))&&e(),s&&s.destroy(),s=null,a={}},init:function(e){l=0,c=10,(a={}).c=e.el.find("#"+h.map.id),a.users=a.c.find(".users"),a.userslist=a.c.find(".userslist"),a.posts=a.c.find(".posts"),a.uleft=a.c.find(".uleft"),a.uright=a.c.find(".uright"),a.ua=a.c.find(".arrow"),a.showmore=a.c.find(".showmore"),a.unext=a.c.find(".nextpage"),a.lenta=a.c.find(".lentasearch"),a.ua.on("click",t),a.showmore.on("click",p.changeUsersView),a.userslist.swipe({swipe:function(e,t,n,a,o,i){}}),a.unext.on("click",n),deep(r,"users.data.length")&&u.users(r.users.data),deep(r,"posts.data.length")&&u.posts(),e.clbk(null,e)}}}var h=new nModule,a={};return h.run=function(e){var t=h.addEssense(a,n,e);h.init(t,e)},h.stop=function(t){_.each(a,function(e){e.destroy(t)})},h}();"undefined"!=typeof module?module.exports=s:(app.modules.s={},app.modules.s.module=s);var menu=function(){function n(){function a(){var e=f.app.platform.sdk.newmaterials.storage;s.c&&_.each(e,function(e,t){(t=s.c.find('.lentaunseen[key="'+t+'"]')).html(e=99<e?"99":e),e?t.addClass("hasunseen"):t.removeClass("hasunseen")})}function e(){c&&c.placeholder(f.app.localization.e("e13139")),l=null}var s,n=null,t=null,l=null,c=null,o=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),format:{right:!0},_onChange:function(e){(e=app.localization.findByName(e))&&e.key!=app.localization.key&&app.localization.set(e.key)}}),i={},r={elswidth:function(){s.c.find(".autowidth.active").each(function(){r.setWidth($(this))})},setWidth:function(e){},ahnotifyclear:function(){i={},r.ahnotify(null)},ahnotify:function(e,t,n){t=t||0,n&&(i[n]=t),n=_.reduce(i,function(e,t){return e+(t||0)},0),t=null,"undefined"!=typeof cordova&&(t=deep(cordova,"plugins.notification.badge")),e&&r.ah(e,n),t&&t.set(n),f.app.platform.api.electron.notifications(n,"notifications")},ah:function(e,t){0<t?e.addClass("amountHave"):e.removeClass("amountHave"),e.find(".amount").html(t)},sitenameToNav:function(){d.navinit.el&&(t=slowMade(function(){var e,t;c&&c.active||parameters().ss||(("index"==(e=f.app.nav.current.href)||"author"==e)&&45<$(window).scrollTop()?(s.nav.addClass("active"),s.c.addClass("menupanelactive"),s.nav.find(".pcenterLabel").removeClass("active"),s.postssearch.find("input").blur(),c&&c.blur(),t=parameters(f.app.nav.current.completeHref,!0).r||"empty",parameters(f.app.nav.current.completeHref,!0).video&&(t="video"),"index"==e&&s.nav.find('.pcenterLabel[r="'+t+'"]').addClass("active")):(s.c.removeClass("menupanelactive"),s.nav.removeClass("active")),r.elswidth())},t,10))}},d={navinit:{init:function(e){isTablet()||($(window).on("scroll",r.sitenameToNav),f.app.nav.clbks.history.menu=function(e){r.sitenameToNav()})},destroy:function(){$(window).off("scroll",r.sitenameToNav),delete f.app.nav.clbks.history.menu}},chats:{click:function(){var e=deep(f,"app.platform.matrixchat.core.apptochat");e&&e()},init:function(t){f.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu=function(e){r.ahnotify(t,e,"chat")}}},sitename:{click:function(){f.app.user.isState(function(e){var t=localStorage.lentakey||"index";"index"!=(t=parameters().r==t?"index":t)&&(t="video"==t?"index?video=1":"index?r="+t),e||(t="index"),f.app.curation()&&(t="userpage"),f.nav.api.go({href:t,history:!0,open:!0,handler:!0})})}},activate:{click:function(){dialog({header:f.app.localization.e("id167"),html:f.app.localization.e("id168"),class:"one",btn1text:f.app.localization.e("id169"),success:function(){f.app.platform.sdk.user.activateWithDialogs(function(e){})}})}},keyexport:{click:function(){f.app.platform.ui.showmykey()},init:function(t){f.app.platform.sdk.registrations.clbks.menu=function(){if(f.sdk.address.pnet()){var e=f.sdk.address.pnet().address;if((e=f.app.platform.sdk.registrations.storage[e])&&e<=4)return}t.closest(".keyexportWrapper").remove(),delete f.app.platform.sdk.registrations.clbks.menu}}},notifications:{init:function(e){function t(){return _.filter(f.app.platform.sdk.notifications.storage.notifications,function(e){if(e.seen)return!1;var t=null;return e.mesType&&(t=f.app.platform.ws.messages[e.mesType]),!!(t=e.msg&&!t?f.app.platform.ws.messages[e.msg]:t)&&!!t.fastMessage(e)})}f.app.platform.sdk.notifications.init(function(){r.ahnotify(e,t().length,"notifications")}),isMobile()||f.nav.api.load({eid:"menu",open:!0,id:"notifications",el:e,inTooltip:!0}),f.app.platform.sdk.notifications.clbks.added.menu=f.app.platform.sdk.notifications.clbks.seen.menu=function(){r.ahnotify(e,t().length,"notifications")}},click:function(e){isMobile()&&f.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0})}},messenger:{init:function(e){function t(){var n=0;return _.each(a.storage.chat,function(e,t){n+=e.messages.unreaded}),n}var a=f.app.platform.clientrtc.rtchttp;f.app.platform.clientrtc.rtchttp.info.allchats(function(){r.ahnotify(e,t(),"chat")}),f.app.platform.sdk.messenger.clbks.menu=function(){r.ahnotify(e,t(),"chat")}},click:function(e){isMobile()?f.nav.api.load({href:"messenger",history:!0,open:!0}):f.nav.api.go({href:"userpage?id=messenger&report=messenger",history:!0,open:!0})}},savecross:{init:function(t){var e=deep(f.app,"platform.sdk.user.storage.me.rc")||0;r.ah(t,e),f.app.platform.ws.messages.event.clbks.menusave=function(e){"userInfo"==e.mesType&&(e=deep(f.app,"platform.sdk.user.storage.me.rc")||0,r.ah(t,e))}},click:function(){f.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{rescue:!0}})}},search:{click:function(){s.c.addClass("searchactive"),searchBackAction=null,s.postssearch.find("input").focus(),s.postssearch.addClass("active"),n&&(clearTimeout(n),n=null)}},searchinit:{init:function(t){function o(e){"index"!=f.app.nav.current.href||e?(t.find("input").val(""),u(),i()):searchBackAction&&(searchBackAction(),searchBackAction=null)}function r(e,t,n,a){p.results(e,t,function(e){n(e,function(e,n){bgImages(e),f.app.nav.api.links(null,e,function(){n.closeResults(),i()}),e.find(".user").on("click",function(){var e=$(this).attr("address"),t=$(this).attr("name");f.nav.api.go({href:t?t.toLowerCase():"author?address="+e,history:!0,open:!0}),n.closeResults(),o(),i()})})},a)}var i=function(){n&&(clearTimeout(n),n=null)};c=new search(s.postssearch,{placeholder:f.app.localization.e("e13139"),right:!0,clbk:function(e){e.find("input").on("blur",function(){n=slowMade(function(){o()},n,200)})},last:{get:function(){var n=[],a={};return _.each(f.sdk.activity.latest,function(e,t){_.each(e,function(e){a[e.type]||(a[e.type]=0),7<=a[e.type]||(a[e.type]++,n.push(e))})}),n=_.uniq(n,function(e){return e.type+e.index}),n=_.sortBy(n,function(e){return-Number(e.date)})},tpl:function(e,t){r(e,"",t)}},events:{fastsearch:function(a,o){var i={},s={};f.app.platform.sdk.search.get(a,"users",null,null,null,function(e){var t,n=e.data;e=e.count,i.user=_.map(n,function(e){var t={type:"user",data:e};return t.id=e.address,t.index=e.name,t}),s.user=e,r((t=[],_.each(["user","tag"],function(e){t=t.concat(i[e]||[])}),t),a,o,{counts:s})})},search:function(e,t,n,a){e={href:-1<e.indexOf("#")?"index?sst="+_.uniq(_.filter(e.replace(/#/g,"").split(/[,.!?;:() \n\r]/g),function(e){return e})).join(" "):"index?ss="+e,history:!0,open:!0},l&&(e.handler=!0),f.nav.api.go(e),a.closeResults(),i(),t&&t(!0)},clear:function(e){e||(t.find("input").blur(),setTimeout(function(){o(!0),i()},100),(parameters().sst||parameters().ss)&&f.nav.api.go({href:"index",history:!0,open:!0}))},blank:function(){d.search.click()}}})}},newaccount:{click:function(){f.nav.api.go({href:"registration",history:!0,open:!0})}},state:{init:function(e){function t(){_.isEmpty(f.app.errors.state)?e.addClass("hidden"):e.removeClass("hidden")}t(),f.app.errors.clbks.menu=function(){t()},e.tooltipster({theme:"tooltipster-light",maxWidth:300,zIndex:200})}},wallets:{click:function(){f.nav.api.go({open:!0,href:"userpage?id=wallet",history:!0})},init:function(a){function e(){f.app.platform.sdk.node.transactions.get.allBalance(function(e){var n,t=(e+=f.app.platform.sdk.node.transactions.tempBalance())-s;i&&(t=0,s=e),i=!1,n=s,a.removeClass("hidden"),0==t?(o.text(f.app.platform.mp.coin(n)),r.elswidth()):o.animateNumber({number:t,numberStep:function(e,t){e=Number(n+e).toFixed(8),$(t.elem).text(f.app.platform.mp.coin(e))}},rand(400,1200),function(){a.removeClass("good"),r.elswidth()}),s=e,f.app.platform.sdk.wallet.drawSpendLine(a.find(".numberWrp"))})}var o=a.find(".number"),i=!0,s=0;f.app.platform.sdk.node.transactions.clbks.menu=e,e()}},signout:{click:function(){f.app.user.signout(),f.app.reload({href:"authorization"})}},signin:{init:function(e){},click:function(){f.nav.api.go({href:"authorization",history:!0,open:!0})}},signup:{init:function(e){},click:function(){f.nav.api.go({href:"registration",history:!0,open:!0})}}},p={results:function(e,t,n,a){f.shell({name:"results",data:{results:e,value:t,counts:(a=a||{}).counts||{}}},function(e){n&&n(e.rendered)})}},u=function(){s.c&&s.c.removeClass("searchactive"),s.postssearch&&s.postssearch.find(".search").removeClass("fastSearchShow")};return{getdata:function(e,t){var n={};o.value=app.localization.current().name,n.loc=o,n._SEO=_SEO,n.lkey=app.localization.current();var a=deep(app,"platform.sdk.user.storage.me");n.haschat=f.app.platform.matrixchat.core&&a&&!(a.temp||a.relay||a.fromstorage),t.state?(t=f.sdk.address.pnet().address,f.app.platform.sdk.registrations.showprivate()&&(n.key=!0),f.app.platform.sdk.users.getone(t,function(){e(n)})):e(n)},destroy:function(){e(),r.ahnotifyclear(),c=null,$(window).off("resize",r.elswidth),delete f.app.platform.sdk.newmaterials.clbks.update.menu,delete f.app.platform.sdk.node.transactions.clbks.menu,delete f.app.platform.ws.messages.event.clbks.menusave,delete f.app.platform.sdk.notifications.clbks.seen.menu,delete f.app.platform.sdk.notifications.clbks.added.menu,delete f.app.platform.sdk.messenger.clbks.menu,delete f.app.errors.clbks.menu,delete f.app.platform.sdk.registrations.clbks.menu,delete f.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu,delete f.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu2,_.each(d,function(e){delete e.el,e.destroy&&e.destroy()}),s={}},closesearch:function(){u()},showsearch:function(e,t){console.log("showsearch",e,t),e?(s.c.addClass("searchactive"),s.postssearch.find(".search").addClass("searchFilled")):s.postssearch.find(".search").removeClass("searchFilled"),s.postssearch.find("input").val(e.replace("tag:","#")),searchBackAction=t||null,r.elswidth(),setTimeout(function(){r.elswidth()},2)},initauthorsearch:function(e){e.data&&(c&&c.placeholder(f.app.localization.e("e13140")+" "+e.data.name.toUpperCase()),l=e)},destroyauthorsearch:function(){e()},init:function(e){var t,n;(s={}).c=e.el.find("#"+f.map.id),s.a=e.el.find(".additionalbar"),s.cart=s.c.find(".cart"),s.likes=s.c.find(".favorites"),s.messagesCount=s.c.find(".dialogs .count"),s.notificationsCount=s.c.find(".notifications .count"),s.walletsAmount=s.c.find(".wallets .amount"),s.notactive=s.c.find(".notactive"),s.currency=s.c.find(".currencyWrapper"),s.postssearch=s.c.find(".postssearch"),s.nav=s.c.find(".menutoppanel"),r.ahnotifyclear(),f.app.platform.matrixchat.clbks.ALL_NOTIFICATIONS_COUNT.menu2=function(e){r.ahnotify(null,e,"chat")},s.c.find(".localization").on("click",function(){var e=[];_.each(f.app.localization.available,function(n){e.push({text:n.name,action:function(e){var t=app.localization.findByName(n.name);t&&t.key!=f.app.localization.key&&f.app.localization.set(t.key),e()}})}),menuDialog({items:e})}),f.app.platform.sdk.newmaterials.clbks&&(f.app.platform.sdk.newmaterials.clbks.update.menu=a),s.c.find("[events]").each(function(){var n=$(this),e=n.attr("events");d[e]&&(d[e].el=n,_.each(d[e],function(e,t){"init"==t?e(n):n.on(t,e)}))}),$(window).on("resize",r.elswidth),ParametersLive([o],s.c),"undefined"!=typeof _Electron&&(t=require("electron").remote,n=function(){t.getCurrentWindow().isFullScreen()?s.c.addClass("fullscreen"):s.c.removeClass("fullscreen")},s.c.find(".closeApp").on("click",function(){t.getCurrentWindow().close()}),s.c.find(".miniizeApp").on("click",function(){t.getCurrentWindow().minimize()}),s.c.find(".toggleMinMax").on("click",function(){var e=t.getCurrentWindow();e.setFullScreen(!e.isFullScreen()),n()}),n()),f.app.user.isState(function(e){!parameters().ss&&!parameters().sst||!isMobile()&&"s"!=f.app.nav.get.pathname()||(s.c.addClass("searchactive"),s.c.find(".postssearch").addClass("active"),r.elswidth(),s.postssearch.find("input").val(parameters().ss.replace("tag:","#")))}),e.clbk(null,e)}}}var f=new nModule,a={};return f.run=function(e){var t=f.addEssense(a,n,e);f.init(t,e)},f.stop=function(){_.each(a,function(e){e.destroy()})},f.initauthorsearch=function(t){_.each(a,function(e){e.initauthorsearch(t)})},f.destroyauthorsearch=function(){_.each(a,function(e){e.destroyauthorsearch()})},f.closesearch=function(){_.each(a,function(e){e.closesearch()})},f.showsearch=function(t){_.each(a,function(e){e.showsearch(t)})},f}();"undefined"!=typeof module?module.exports=menu:(app.modules.menu={},app.modules.menu.module=menu);var toppanel=function(){function n(e){function t(t){var n=function(){var e={index:"index",sub:"index?r=sub",recommended:"index?r=recommended"};s.app.platform.videoenabled&&(e.video="index?video=1");var t=_.toArray(e),n=parameters(s.app.nav.current.completeHref,!0).r||"index",a=parameters(s.app.nav.current.completeHref,!0).video||!1,o=e[n],i=[s.app.localization.e("e13136"),s.app.localization.e("e13137"),s.app.localization.e("e13138")];return s.app.platform.videoenabled&&(o=e[a?"video":n],i.push(s.app.localization.e("video"))),(i=new Parameter({type:"VALUES",name:"Contents",id:"contents",possibleValues:t,possibleValuesLabels:i,defaultValue:o})).value=o,i._onChange=function(e){s.nav.api.load({open:!0,href:e,history:!0})},i}();s.app.user.isState(function(e){e&&isMobile()&&"index"!=t?(o.c.addClass("hidden"),$("html").removeClass("toppanelshowed")):(o.c.removeClass("hidden"),$("html").addClass("toppanelshowed"),s.shell({name:"menu",el:o.menu,data:{pathname:t,state:e,mobile:isMobile(),selector:n}},function(e){a(),ParametersLive([n],e.el)}))})}function a(){var e=s.app.platform.sdk.newmaterials.storage;o.c&&_.each(e,function(e,t){(t=o.c.find('.lentaunseen[key="'+t+'"]')).html(e=99<e?"99":e),e?t.addClass("hasunseen"):t.removeClass("hasunseen")})}var o;return{primary:e=deep(e,"history"),getdata:function(e){e({})},destroy:function(){delete s.app.platform.sdk.newmaterials.clbks.update.toppanel,delete s.app.nav.clbks.history.toppanel,o={}},init:function(e){(o={}).c=e.el.find("#"+s.map.id),o.menu=o.c.find(".panelitems"),s.app.nav.clbks.history.toppanel=function(e){t(app.nav.current.href)},s.app.platform.sdk.newmaterials.clbks&&(s.app.platform.sdk.newmaterials.clbks.update.toppanel=a),t(s.app.nav.current.href),e.clbk(null,e)}}}var s=new nModule,a={};return s.run=function(e){var t=s.addEssense(a,n,e);s.init(t,e)},s.stop=function(){_.each(a,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=toppanel:(app.modules.toppanel={},app.modules.toppanel.module=toppanel);var navigation=function(){function n(e){function t(e){250<=e?r.c.addClass("scrolled"):r.c.removeClass("scrolled")}function n(){250<=l.scrollTop()?r.c.addClass("scrolled"):r.c.removeClass("scrolled")}function i(){var e=deep(c,"app.modules.main.module.scrolltopall");e&&e(),_scrollTop(0,null,0)}function a(e){var t=c.app.nav.api.backChainIndex(),n=localStorage.lentakey||t+"?b=true";-1==(n=n==t?t+"?b=true":n).indexOf("?")&&(n="video"==n?t+"?video=1":t+"?r="+n);var a=parameters().video,o=c.app.nav.api.backChainGet();c.shell({name:"menu",inner:html,el:r.menu,data:{back:o,href:e,lentakey:n,indexkey:t,shw:a,haschat:c.app.platform.matrixchat.core}},function(e){e.el.find(".toup").on("click",i),e.el.find(".matrixchat").on("click",function(){var e=deep(c,"app.platform.matrixchat.core.apptochat");e&&e()})})}function o(){r.c&&r.c.closest("#navigationWrapper").addClass("hidden")}function s(){r.c&&r.c.closest("#navigationWrapper").removeClass("hidden")}var r,l;return{primary:e=deep(e,"history"),getdata:function(e,t){console.log("P",t),l=$(window),e({})},destroy:function(){c.app.scrolling&&delete c.app.scrolling.clbks.navigation,window.removeEventListener("scroll",n),window.cordova&&(window.removeEventListener("keyboardWillShow",o),window.removeEventListener("keyboardWillHide",s)),delete c.app.nav.clbks.history.navigation,r&&(r.c&&r.c.remove(),r={})},init:function(e){(r={}).c=e.el.find("#"+c.map.id),r.menu=r.c.find(".nmenu"),c.app.nav.clbks.history.navigation=function(e){r.c.removeClass("scrolled"),a(c.app.nav.get.pathname())},r.c.find(".fakem").on("click",function(){$("html").removeClass("scrollmodedown")}),window.addEventListener("scroll",n),n(),window.cordova&&(window.addEventListener("keyboardWillShow",o),window.addEventListener("keyboardWillHide",s)),c.app.scrolling&&(c.app.scrolling.clbks.navigation=t),e.clbk(null,e),a(c.app.nav.get.pathname())}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=navigation:(app.modules.navigation={},app.modules.navigation.module=navigation);var notifications=function(){function n(o){function l(){var e=c.c.find(".notification:not(.seen)");e.length&&(t=slowMade(function(){u.app.platform.sdk.notifications.seenall(),0<e.length&&e.addClass("seen")},t,50))}function i(){u.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0}),u.closeContainer()}function s(){l()}var c,t,r,e=deep(o,"history"),d="",p={notifications:function(t,e){var o,n,a,i,s=(t=t||{}).notifications||u.app.platform.sdk.notifications.storage.notifications,r=!1;t.el=c.new,t.el&&(u.app.platform.currentTime(),t.seenFilter,o=-s.length+(t.notifications||u.app.platform.sdk.notifications.storage.notifications).length,s=_.sortBy(s,function(e){return Number(-e.nblock)}),n=new Date,s=_.filter(s,function(e){var t=null;return e.mesType&&(t=u.app.platform.ws.messages[e.mesType]),!(!(t=e.msg&&!t?u.app.platform.ws.messages[e.msg]:t)||!t.fastMessage(e)&&(console.log("empty",e),1))}),a=group(s,function(e){return t.now?"ntnow":(e=new Date(1e3*e.time)).addMinutes(60)>n?"ntlasthour":dateToStrSmall(e)==dateToStrSmall(n)?"nttoday":e.getFullYear().toString()+(e.getMonth()+1).toString()==n.getFullYear().toString()+(n.getMonth()+1).toString()?"ntmounth":"ntearlier"}),t.now&&((i=t.el.find('.group[index="ntnow"]')).length&&(t.el=i.find(".groupContent")),r=!0),u.shell({name:"notifications",el:t.el,data:{notifications:s,ws:u.app.platform.ws,now:t.now,grou:a,rnow:r},inner:prepend},function(n){p.loadingAndEmpty(),o&&c.c.find(".more").html("("+o+")");var a=u.app.platform.ws;_.each(s,function(e){var t=null;e.mesType&&(t=a.messages[e.mesType]),(t=e.msg&&!t?a.messages[e.msg]:t)&&t.fastMessageEvents&&t.fastMessageEvents(e,{el:n.el.find('.notification[notification="'+e.txid+'"]')})}),u.app.nav.api.links(null,c.c,function(){u.closeContainer()}),l()}))},loadingAndEmpty:function(){if(u.app.errors.connection())return c.loader.addClass("hidden"),c.empty.addClass("hidden"),void c.error.removeClass("hidden");c.error.addClass("hidden"),u.app.platform.sdk.notifications.loading?c.loader.removeClass("hidden"):(c.loader.addClass("hidden"),c.c.find(".notification").length?c.empty.addClass("hidden"):(c.empty.removeClass("hidden"),c.loader.addClass("hidden")))}};return{primary:e,getdata:function(e){var t={};o.notifications||u.app.platform.sdk.notifications.storage.notifications?e(t):u.app.platform.sdk.notifications.init(function(){e(t)})},destroy:function(){c={},d="",t&&clearTimeout(t),t=null,r.removeEventListener("scroll",s),delete u.app.platform.sdk.notifications.clbks.added["notifications"+d],delete u.iclbks.lenta},init:function(e){var n,a,t;(c={}).c=e.el.find("#"+u.map.id),c.new=c.c.find(".newWrapper"),c.loader=c.c.find(".loader"),c.empty=c.c.find(".empty"),c.error=c.c.find(".error"),"tooltip"==e.insert?(r=c.c.find(".nabsContentWrapper")[0],d="tt"):(d="",r=window),jinel=$(r),p.loadingAndEmpty(),c.c.find(".showAll").on("click",i),r.addEventListener("scroll",s),c.c.find(".closecontainer").on("click",function(){u.closeContainer()}),u.iclbks.lenta=function(){p.loadingAndEmpty()},isMobile()&&(n=c.c.find(".circularprogress"),(a=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),c.c.find(".circularprogressWrapper").html(a.el),t=$(window),new SwipeParallaxNew({el:c.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/90;0<=e&&(a.options.text={value:""},a.update(100*t),n.height(220*t+"px"))},constraints:function(){if(0==t.scrollTop())return!0},restrict:!0,trueshold:90,clbk:function(){u.app.platform.sdk.notifications.getNotifications(function(){})}}}}).init()),e.insert,p.notifications({seenFilter:o.inTooltip}),u.app.platform.sdk.notifications.clbks.added["notifications"+d]=function(e,t){p.notifications({notifications:e,now:t})},e.clbk(null,e)},tooltip:{options:{theme:"lighttooltip notificationTolltip",position:"left",zIndex:50,distance:-47,functionPosition:function(e,t,n){return n.coord.top=0,n.coord.left=0,n},arrow:!1,trigger:"custom",triggerOpen:{click:!0},triggerClose:{}}}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=notifications:(app.modules.notifications={},app.modules.notifications.module=notifications);var imageGalleryEdit=function(){function n(e){function n(){var e=$(this).attr("action");m[e]()}function a(){var e=$(this).attr("action"),t=$(this);m[e]()?t.addClass("active"):t.removeClass("active")}var o,i,e=deep(e,"history"),s=null,r=0,l=!1,d=null,c=null,p=null,u={normal:{name:"Normal"},vintage:{name:"Vintage"},oldBoot:{name:"Old Boot"},clarity:{name:"Clarity"},sunrise:{name:"Sunrise"},crossProcess:{name:"Cross Process"},orangePeel:{name:"Orange Peel"},love:{name:"Love"},jarques:{name:"Jarques"},pinhole:{name:"Pinhole"}},f={},m={back:function(){--r<0&&(r=i.images.length-1),v()},next:function(){++r>=i.images.length&&(r=0),v()},initialValue:function(){i.initialValue&&(r=i.initialValue)},filters:function(){return(l=!l)?(o.c.addClass("filters"),g.filters()):o.c.removeClass("filters"),h.resize(),l},caman:function(e,t){var n=t||"#galleryImage";c&&!t?e&&e(c):Caman(n,function(){t||(c=this),e&&e(this)})},crop:function(){return d?(d.destroy(),d=null,!1):(m.caman(function(){var e=o.imagesWrapper.find("#galleryImage"),t=e.parent();s=c,i.crop||(i.crop={}),d=new Cropper(e[0],{aspectRatio:i.crop.aspectRatio||null,autoCropArea:i.crop.autoCropArea||.9,checkOrientation:!1,crop:function(e){var t=c.width,n=c.height,n={x:e.detail.x/t,y:e.detail.y/n,w:e.detail.width/t,h:e.detail.height/n};f.crop=n},ready:function(){t.find(".cropper-container").addClass(i.crop.style||""),t.find(".cropper-crop-box").append('<div class="applyCrop center" action="apply">\t\t\t\t\t\t\t\t\t<span class="fa fa-check" aria-hidden="true"></span>\t\t\t\t\t\t\t\t</div>'),t.find(".applyCrop").on("click",function(){m.apply("crop"),g.savePanel()})}})}),!0)},camanFilter:function(e,t,n){e.revert(!1),"normal"!=t&&e.newLayer(function(){this.opacity(50),this.copyParent(),this.filter[t]()}),e.render(n)},previewFilter:function(e,t){var n=e.attr("filter"),a=e.attr("imageId");Caman("#"+a,function(){m.camanFilter(this,n,function(){e.animate({opacity:1})})}),e.on("click",function(){m.caman(function(){m.camanFilter(c,n,function(){s=c,f.filter=n,g.savePanel(),h.resize()})})})},applyFilters:function(o,e,i,s){"crop"!=e?"filter"==e&&m.caman(function(e){m.camanFilter(e,o,function(){s&&s()})},i):m.caman(function(e){var t=e.canvas.width,n=e.canvas.height,a={x:o.x*t,y:o.y*n,width:o.w*t,height:o.h*n};e.crop(a.width,a.height,a.x,a.y),e.resize({width:a.width,height:a.height}),e.render(function(){e.resetOriginalPixelData(),e.cropped=!1,e.cropCoordinates={x:0,y:0},e.originalHeight=a.height,e.originalWidth=a.width,e.preScaledHeight=a.height,e.preScaledWidth=a.width,e.resized=!1,i||h.resize(),s&&s()})},i)},apply:function(e,t){e&&f[e]&&(m.applyFilters(f[e],e,t),m[e](),o.c.find('[action="'+e+'"]').removeClass("active"))},close:function(){i.success?(topPreloader(20),i.success(i.images,function(){topPreloader(100),y.closeContainer()})):y.closeContainer()},exit:function(){i.apply&&(m.apply("crop"),m.save(!0)),m.close()},cancel:function(){f={},g.savePanel(),g.image({image:p})},save:function(e){m.checkUpdates()&&(p.original=c.toBase64(),f={},e||(g.savePanel(),g.image({image:p})))},checkUpdates:function(){return!!(f.filter&&"normal"!=f.filter||f.crop)}},h={resize:function(){h.bestFit(o.imagesWrapper.find(".image"),s)},bestFit:function(e,t){var n=e.closest(".imagesAbsWrapper"),a=e.find(".imgWrapper"),o=t.naturalWidth||t.width,i=t.naturalHeight||t.height,s=i/o;e.css("padding-top","0px");var r=e.width(),l=e.height(),c=n.width();(l=(n=n.height())<l?n:l)<=(i=(r=c<r?c:r)<o?(o=r)*s:i)&&(o=(i=l)/s),e.css("padding-top",(l-i)/2+"px"),t.canvas?(t.resize({width:o,height:i}),t.render()):(t.width=o,t.height=i,$(t).attr("data-camanwidth",o),$(t).attr("data-camanheight",i),$(t).css("opacity","1")),a.width(o),a.height(i),d&&d.resize({width:o,height:i})},nFormat:function(e){return e<10?"0"+e:e}},g={savePanel:function(){(f.filter&&"normal"!=f.filter||f.crop)&&!i.apply?o.exitPanel.fadeOut(200,function(){o.savePanel.fadeIn(200)}):o.savePanel.fadeOut(200,function(){o.exitPanel.fadeIn(200)})},image:function(t){c=s=null,f={},g.savePanel(),d&&(d.destroy(),d=null,o.editPanel.find('.eitem[action="crop"]').removeClass("active")),o.imageNavigation.find(".number").html(h.nFormat(Number(r)+1)),$(window).off("resize",h.resize),t=t||{},y.shell({name:"image",el:o.images,inner:html,display:"table",animation:!1,data:{data:i,image:t.image}},function(e){e.el.find("img").imagesLoaded(function(e){s=deep(e,"images.0.img"),p=t.image,h.resize(),$(window).on("resize",h.resize),l&&(l=!l,m.filters()),t.clbk&&t.clbk()})})},filters:function(t){(t=t||{}).image||(t.image=i.images[r]),o.filters.html(""),resizeFit(t.image.original,80,80,function(e){y.shell({name:"filters",el:o.filters,data:{data:i,image:e,filters:u}},function(e){e.el.find(".preview").each(function(){m.previewFilter($(this),t.image)});var i=e.el.find(".filtersSwipe");swipedetect(i[0],function(e,t,n,a){var o=Number(i.css("margin-left").replace("px",""))+Number(1.7*t),t=-i.find(".filtersList").width()+i.closest(".filtersWrapperOvf").width();i.css("margin-left",(o=(o=0<o?0:o)<t?t:o)+"px")})})})}},v=function(){g.image({image:i.images[r],clbk:function(){i.apply&&(m.filters(),m.crop())}})};return{primary:e,getdata:function(e){e({})},destroy:function(){$(window).off("resize",h.resize),o={}},init:function(e){var t;p=s=c=null,l=!1,f={},i=e.essenseData||{},m.initialValue(),(o={}).c=e.el.find("#"+y.map.id),o.imagesWrapper=e.el.find(".imagesWrapper"),o.images=e.el.find(".images"),o.imageNavigation=e.el.find(".imageNavigation"),o.arrows=o.imageNavigation.find(".arrow"),o.editPanel=o.c.find(".editPanel"),o.savePanel=o.c.find(".panel .savePanel"),o.exitPanel=o.c.find(".panel .exitPanel"),o.filters=o.c.find(".filters"),t=function(){v(),o.arrows.on("click",n),o.editPanel.find(".eitem").on("click",a),o.savePanel.find(".sitem").on("click",a),o.exitPanel.find(".sitem").on("click",a),e.clbk(null,e)},i.edit?y.nav.api.loadRelations({relations:[{src:"js/vendor/caman.full.min.js",f:"js",require:function(){Caman=require("../../js/vendor/caman.full.min.js").Caman}},{src:"js/vendor/cropper.js",f:"js",require:function(){Cropper=require("../../js/vendor/cropper.js")}},{src:"css/cropper.min.css",f:"css"}]},t):t()},wnd:{close:function(){i.close&&i.close()},class:"allscreen black withoutButtons imageGalleryEdit"}}}var y=new nModule,a={};return y.run=function(e){var t=y.addEssense(a,n,e);y.init(t,e)},y.stop=function(){_.each(a,function(e){e.destroy()})},y}();"undefined"!=typeof module?module.exports=imageGalleryEdit:(app.modules.imageGalleryEdit={},app.modules.imageGalleryEdit.module=imageGalleryEdit);var panel=function(){function n(e){var c,e=deep(e,"history"),t=null,n=null,a=null,o=null,i=null,s={tags:function(){r.nav.api.load({open:!0,id:"tagcloud",el:c.tags,animation:!1,clbk:function(e,t){n=t}})},stacking:function(){r.nav.api.load({open:!0,id:"staking",el:c.stacking,animation:!1,clbk:function(e,t){o=t}})},recommendationslist:function(e,t){e.length&&c.c&&r.shell({name:"recommendationslist",el:c.r.find(".userslist"),data:{users:e},bgImages:{clbk:function(e){$(e.elements[0]).addClass("active")}}},function(e){t&&t()})},lastcomments:function(e){r.nav.api.load({open:!0,id:"lastcomments",el:c.comments,animation:!1,clbk:function(e,t){a=t},essenseData:{renderclbk:function(){i.renderclbk&&i.renderclbk()}}})},recommendations:function(l,e){l.length&&c.c?r.shell({name:"recommendations",el:c.r,data:{users:l}},function(r){s.recommendationslist(l,function(){var t=0,n=4,a=r.el.find(".userslist"),o=r.el.find(".arrow"),i={uleft:r.el.find(".uleft"),uright:r.el.find(".uright")},s={clickArrow:function(e){"left"==e&&(t-=n)<0&&(t=0),"right"==e&&(t+=n)>=l.count&&(t=l.count-1),s.slideCarousel()},displayArrows:function(){0<t?s.displayArrow("left",!0):s.displayArrow("left",!1),t+n<l.length?s.displayArrow("right",!0):s.displayArrow("right",!1)},displayArrow:function(e,t){e=e?i["u"+e]:o,t?e.addClass("active"):e.removeClass("active")},slideCarousel:function(){var e=c.c.find(".user").width(),e=t*e;a.css("margin-left","-"+e+"px"),s.displayArrows()},applyCarousel:function(){var e=r.el.find(".user").width(),t=r.el.find(".userslistwrapper").width();n=Math.min(Number((t/e).toFixed(0)),4),c.c.find(".user").width((t/n).toFixed(0)+"px"),a.width((l.length*(t/n)).toFixed(0)+1),s.slideCarousel()}};s.applyCarousel(),r.el.find(".arrow").on("click",function(){var e=$(this).attr("arrow");s.clickArrow(e)})})}):c.r.html("")},discussions:function(t){r.shell({name:"discussiondummy",el:c.cnt,data:{}},function(e){t&&t()})},_discussions:function(){r.user.isState(function(e){e&&((e=r.app.platform.sdk.users.storage[r.app.platform.sdk.address.pnet().address]).relay||e.temp||s.discussions())})}};return{primary:e,getdata:function(e,t){i=t.settings.essenseData||{},e({})},destroy:function(){delete r.app.platform.clbks.api.actions.subscribe.panelrec,delete r.app.platform.ws.messages.event.clbks.panel,t&&(t.destroy(),t=null),n&&(n.destroy(),n=null),a&&(a.destroy(),a=null),o&&(o.destroy(),o=null),c={}},authclbk:function(){},init:function(e){(c={}).c=e.el.find("#"+r.map.id),c.cnt=c.c.find(".panelcnt"),c.tags=c.c.find(".tagscnt"),c.comments=c.c.find(".lastcommentscnt"),c.stacking=c.c.find(".stackingcnt"),c.r=c.c.find(".recommendationscnt"),r.app.platform.clbks.api.actions.subscribe.panelrec=function(){function n(e){s.recommendations(e)}r.app.user.isState(function(e){var t;e?(t=r.sdk.address.pnet().address,r.sdk.users.get(t,function(){var e=deep(r,"sdk.users.storage."+t+".recomendedSubscribes");e&&e.length?r.sdk.users.get(e,function(){n(e)}):n([])})):n([])})},r.app.platform.ws.messages.event.clbks.panel=function(e){"userInfo"==e.mesType&&s._discussions()},r.app.platform.sdk.usersettings.meta.vidgetchat.value&&s._discussions(),r.app.platform.sdk.usersettings.meta.vidgetlastcomments.value&&s.lastcomments(),deep(r.app.platform,"released.vidgets.staking")&&deep(r.app.platform.sdk,"usersettings.meta.vidgetstaking.value")&&s.stacking(),e.clbk(null,e)}}}var r=new nModule,a={};return r.authclbk=function(){_.each(a,function(e){e.authclbk()})},r.run=function(e){var t=r.addEssense(a,n,e);r.init(t,e)},r.stop=function(){_.each(a,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=panel:(app.modules.panel={},app.modules.panel.module=panel);var aboutus=function(){function n(e){return{primary:e=deep(e,"history"),getdata:function(e){e({})},destroy:function(){},init:function(e){e.el.find("#"+a.map.id),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=aboutus:(app.modules.aboutus={},app.modules.aboutus.module=aboutus);var support=function(){function n(e){function t(){n.send()}var o,e=deep(e,"history"),n={send:function(){var e=n.values();e?(o.c.removeClass("showError"),topPreloader(20),a.app.platform.sdk.user.support(e,function(){topPreloader(100),dialog({html:a.app.localization.e("contactSuccess"),class:"one"}),$.each(o.inputs,function(){$(this).val("")})})):o.c.addClass("showError")},values:function(){var n={},a=!0;return $.each(o.inputs,function(){var e=(t=$(this)).val(),t=t.attr("systemId");e?n[t]=e:a=!1}),a?n:null}};return{primary:e,getdata:function(e){e({})},destroy:function(){o={}},init:function(e){(o={}).c=e.el.find("#"+a.map.id),o.send=o.c.find(".send"),o.inputs=o.c.find(".forminput"),o.send.on("click",t),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=support:(app.modules.support={},app.modules.support.module=support);var leftpanel=function(){function n(e){function t(e,t){var n;a.c&&(n="index",parameters().video&&(n="index?video=1"),r.shell({name:"currentsearch",data:{value:e,backlink:n},el:a.currentsearch},function(e){t&&t()}))}var a,e=deep(e,"history"),n=null,o=null,i=null,s={search:function(){var e;parameters().ss&&t(parameters().ss),parameters().sst&&(e=decodeURI(parameters().sst||""),e=_.uniq(_.filter(e.split(/[,.!?;:() \n\r]/g),function(e){return e})),t(_.map(e,function(e){return"#"+e}).join(" ")))},main:function(){a.c&&r.nav.api.load({open:!0,id:"tagcloud",el:a.tags,animation:!1,clbk:function(e,t){n=t}}),a.c&&r.nav.api.load({open:!0,id:"categories",el:a.cats,animation:!1,clbk:function(e,t){o=t}})},sub:function(){a.c&&r.shell({name:"sub",data:{},el:a.subtop},function(e){})},top:function(){var t,n;a.c&&(t=r.app.platform.sdk.node.shares.parameters.get(),(n=parameters().page||0)<0&&(n=0),r.shell({name:"top",data:{ps:t,page:n},el:a.subtop},function(e){ParametersLive(_.toArray(t),e.el),t.period.onChange=function(){n&&(r.nav.api.history.removeParameters(["page"]),s.top()),i.changed&&i.changed()}}))}};return{primary:e,getdata:function(e,t){i=t.settings.essenseData||{},e({})},destroy:function(){n&&(n.destroy(),n=null),o&&(o.destroy(),o=null),a={}},authclbk:function(){},init:function(e){var t;(a={}).c=e.el.find("#"+r.map.id),a.cnt=a.c.find(".leftpanelcnt"),a.tags=a.c.find(".tagscnt"),a.cats=a.c.find(".catscnt"),a.currentsearch=a.c.find(".currentsearchcnt"),a.subtop=a.c.find(".subtop"),(t=parameters()).sst||t.ss?s.search():"sub"!=t.r?"recommended"!=t.r?s.main():s.top():s.sub(),e.clbk(null,e)}}}var r=new nModule,a={};return r.authclbk=function(){_.each(a,function(e){e.authclbk()})},r.run=function(e){var t=r.addEssense(a,n,e);r.init(t,e)},r.stop=function(){_.each(a,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=leftpanel:(app.modules.leftpanel={},app.modules.leftpanel.module=leftpanel);var footer=function(){function n(e){var t,e=deep(e,"history"),n=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),possibleValuesLabels:app.localization.availableMap("name"),format:{right:!0},_onChange:function(e){(e=app.localization.findByName(e))&&e.key!=app.localization.key&&app.localization.set(e.key)}});return{primary:e,getdata:function(e){var t={};t._SEO=_SEO,t.loc=n,e(t)},destroy:function(){t={}},init:function(e){(t={}).c=e.el.find("#"+a.map.id),ParametersLive([n],t.c),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=footer:(app.modules.footer={},app.modules.footer.module=footer);var authorization=function(){function n(e){var a,o,i,n=deep(e,"history"),t="secondary",s=null;n&&(t="primary"),e.inWnd&&(t="window");var r=new Parameter({type:"BOOLEAN",name:"stay",id:"stay",name:c.app.localization.e("e13027"),_onChange:function(e){e||(localStorage.stay="0",localStorage.mnemonic,c.app.user.stay=0)}}),l={login:function(){var t={},e=trim(a.login.val());localStorage.stay=boolToNumber(r.value).toString(),c.user.stay=r.value,c.user.signin(e,function(e){e?(c.app.platform.sdk.registrations.remove(),(e={}).href=o.successHref,!e.href&&n&&(e.href=function(){return c.app.user.validate()?"index":c.app.errors.connection()?"userpage?id=test":"filluserfast"}),e.nav=o.nav,e.clbk=function(){topPreloader(100);var e=deep(i,"container.close");e&&e(),o.signInClbk&&o.signInClbk()},"_this"==deep(o,"successHref")?c.app.reloadModules(function(){var e;c.app.user.validate()?((e=deep(i,"container.close"))&&e(),o.signInClbk&&o.signInClbk()):c.nav.api.loadSameThis("filluser",t)}):c.app.reload(e)):sitemessage(c.app.localization.e("e13028"))})}};return{primary:n,id:t,getdata:function(e,t){t.state&&n?c.nav.api.load({open:!0,href:"index",history:!0}):(r.value=numberToBool(c.app.user.stay),localStorage.mnemonic,e({stay:r,mnemonic:"",fast:deep(t,"settings.essenseData.fast")||!1}))},destroy:function(){a={},s&&(s.destroy(),s=null)},init:function(e){var t,n;(a={}).c=e.el.find("#"+c.map.id),a.login=a.c.find(".loginValue"),a.pwd=a.c.find(".pwdValue"),a.enter=a.c.find(".enter"),a.toRegistration=a.c.find(".toRegistration"),a.forgotPassword=a.c.find(".forgotPassword"),o=e.essenseData||{},t=i=e,a.enter.on("click",l.login),a.toRegistration.on("click",function(){c.nav.api.loadSameThis("registration",t)}),a.c.find(".showformh").on("click",function(){a.c.toggleClass("signinshow")}),initUpload({el:a.c.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:a.c,action:function(e,t){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.debug=!0,qrscanner.q.callback=function(e){console.log("data",e),"error decoding QR Code"==e?sitemessage(c.app.localization.e("filedamaged")):(a.login.val(trim(e)),l.login())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(a.login.val(trim(e[1])),l.login()):sitemessage(c.app.localization.e("filedamaged")))}}),a.c.find(".loginValue").on("focus",function(){a.c.find(".inputTable").addClass("typeactive")}),a.c.find(".loginValue").on("blur",function(){a.c.find(".inputTable").removeClass("typeactive")}),n=parameters(),ParametersLive([r],a.c),n.restore&&l.forgotPassword(),o.fast&&c.nav.api.load({open:!0,id:"filluserfast",el:a.c.find(".filluserform"),essenseData:{inauth:!0,successHref:o.successHref,welcomepart:function(){a.c.addClass("welcomepnet")},signInClbk:function(){var e=deep(i,"container.close");e&&e(),o.signInClbk()}},clbk:function(e,t){s=t}}),e.clbk(null,e)},tooltip:{options:{position:"left",functionPosition:function(e,t,n){return n.coord.top=10,n.coord.left+=10,n}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen authwindow"}}}var c=new nModule,a={};return c.run=function(e){var t=c.addEssense(a,n,e);c.init(t,e)},c.stop=function(){_.each(a,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=authorization:(app.modules.authorization={},app.modules.authorization.module=authorization);var discussions=function(){function n(e){var s,r,l,t,e=deep(e,"history"),n={},a={},o={},c=null,i=!1,d=null,p=null,u={preloader:function(e){s.c&&(e?s.c.addClass("loading"):s.c.removeClass("loading"))},inView:function(e,t,n){var a,o,i;_.toArray(r).length&&s.c&&(a=s.c.find(t||".discussion"),t="offset","fixedin"==c.view&&(t="position"),0<(t=inView(a,{inel:l,offset:0,mode:"part",f:t})).length&&(o={},t=_.map(t,function(e){return e=$(e).attr("chat"),o[e]=!0,r[e]}),n&&(i=[],_.each(r,function(e,t){o[t]||i.push(e)}),n(i)),e&&e(t)))},chatp:function(e){u.preloader(!0),retry(function(){if(a[e]||!n[e])return!0},function(){u.chat(r[e])})},chat:function(e){p=!0,h.app.platform.sdk.chats.save();var t={open:!0,href:"oldchat",animation:!1};"fixedin"==c.view?(t.history=!1,t.el=s.c.find(".chatWrapper"),t.essenseData={view:"fixedin",chat:e,destroyClbk:function(){d&&(p=!1,u.preloader(!0),s.c&&s.c.removeClass("forChat"),t.el.html(""),m.discussions(null,function(){d=null,u.preloader(!1),l.scrollTop(0),setTimeout(function(){u.openInView()},100)}))}},t.clbk=function(e,t){d=t,s.c&&(s.c.addClass("forChat"),u.preloader(!1))}):t.href="oldchat?chatid="+e.chat.id,h.nav.api.load(t)},open:function(e,t){},remove:function(e){u.preloader(!0),u.close(e,function(){u.preloader(!1),h.app.platform.sdk.chats.remove(e),r=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),c.author),s.c.find('.discussion[chat="'+e+'"]').remove(),m.empty()})},openInView:function(e){u.inView(function(e){_.map(e,function(e){return e.chat.id}),_.each(e,function(e){u.open(e)})},".discussion:not(.dempty)",function(e){e=_.map(e,function(e){return e.chat.id}),u.closeMany(e)})},close:function(e,t){o[e]?retry(function(){if(!o[e])return!0},t):(o[e]=!0,retry(function(){if(a[e])return!0},function(){h.app.platform.rtc.destroy(e),delete o[e],delete a[e],delete n[e],t()}))},closeMany:function(e,t){lazyEach({array:e,action:function(e){var t=e.item;n[t]?u.close(t,e.success):e.success()},all:{success:function(){t&&t()}}})},closeAll:function(e){var t=_.map(n,function(e,t){return t});lazyEach({array:t,action:function(e){var t=e.item;u.close(t,e.success)},all:{success:function(){n={},a={},o={},e&&e()}}})}},f={inViewScroll:function(){t=slowMade(function(){p||(f.inView(),u.openInView())},t,200)},inView:function(){i||u.inView(function(e){i=!0,h.app.platform.sdk.discussions.info(e,function(e){m.fdiscussions(e,function(){i=!1}),r=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),c.author)})},".discussion.dempty")},chat:function(){var e=$(this).closest(".discussion").attr("chat");u.chatp(e)},remove:function(){var e=$(this).closest(".discussion").attr("chat");u.remove(e)}},m={empty:function(){_.toArray(r).length?s.c.removeClass("sempty"):s.c.addClass("sempty")},message:function(e,t){h.shell({name:"message",inner:html,el:s.list.find('[chat="'+t+'"] .lastMessage'),data:{message:e}},function(e){})},discussion:function(e,t){var n;s.list&&(n=s.list.find('[chat="'+e.chat.id+'"]'),e.share&&e.author?h.shell({name:"discussion",inner:html,el:n,data:{discussion:e}},function(e){n.removeClass("dempty"),e.el.find(".discussioncnt").on("click",f.chat),e.el.find(".remove").on("click",f.remove),t&&t()}):(n.remove(),t&&t()))},fdiscussions:function(e,t){lazyEach({array:_.toArray(e),action:function(e){var t=e.item;m.discussion(t,e.success)},all:{success:function(){u.openInView(),t&&t()}}})},discussions:function(e,t,n){e=e||r,e=_.toArray(e),e=_.sortBy(e,function(e){return-e.chat.time}),h.shell({name:"discussions",inner:n||html,el:s.list,data:{discussions:e}},function(e){f.inView(),t&&t()})},discussionTemp:function(n,a,o){h.shell({name:"discussions",el:s.temp,data:{discussions:n}},function(e){var t=e.el.find(".discussion");h.app.platform.sdk.discussions.info(n,function(e){h.shell({name:"discussion",inner:html,el:t,data:{discussion:n[0],c:a}},function(e){t.removeClass("dempty"),t.on("click",function(){h.app.platform.sdk.chats.add(n[0].chat.id,"share")}),o&&o()})})})}};return{primary:e,getdata:function(e,t){c=t.settings.essenseData||{},i=!1,t=h.app.platform.sdk.address.pnet().address+"addedtochat",localStorage[t]=!0,h.app.platform.sdk.chats.add("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd","share"),t={},r=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),c.author),t.discussions=r,e(t)},destroy:function(){l&&l.off("scroll",f.inViewScroll),delete h.app.platform.sdk.chats.clbks.discussions,u.closeAll(),d&&(d.destroy(),d=null),s={}},init:function(e){n={},opened={},p=!(a={}),(s={}).c=e.el.find("#"+h.map.id),l="fixedin"==c.view?s.c.find(".discussionsWrapper"):$(window),s.list=s.c.find(".list"),s.temp=s.c.find(".gotoDisscussion"),l.on("scroll",f.inViewScroll),h.app.platform.sdk.chats.clbks.discussions=function(e,t,n){if("removeTemp"==t)return s.temp.html(""),void s.temp.fadeOut(1);var a=_.toArray(h.app.platform.sdk.discussions.fromChats([e]));"add"==t&&(r=h.app.platform.sdk.discussions.fromChats(h.app.platform.sdk.chats.get("share"),c.author),m.empty(),m.discussions(a,function(){u.chatp(a[0].chat.id)},prepend)),"addTemp"==t&&m.discussionTemp(a,n,function(){}),"addtwice"==t&&(m.discussions(),u.chatp(a[0].chat.id))},u.chatp("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),e.clbk(null,e)}}}var h=new nModule,a={};return h.run=function(e){var t=h.addEssense(a,n,e);h.init(t,e)},h.stop=function(){_.each(a,function(e){e.destroy()})},h}();"undefined"!=typeof module?module.exports=discussions:(app.modules.discussions={},app.modules.discussions.module=discussions);var addaccount=function(){function n(e){var n,t,a=deep(e,"history"),o=a?"primary":"secondary";function i(){var e=trim(n.login.val());t.success&&t.success(e),s.closeContainer()}return{primary:a,id:o=e.inWnd?"window":o,getdata:function(e,t){e({})},destroy:function(){n={}},init:function(e){(n={}).c=e.el.find("#"+s.map.id),n.login=n.c.find(".loginValue"),n.enter=n.c.find(".enter"),t=e.essenseData||{},n.enter.on("click",i),n.login.on("focus",function(){n.c.find(".inputTable").addClass("typeactive")}),n.login.on("blur",function(){n.c.find(".inputTable").removeClass("typeactive")}),initUpload({el:n.c.find(".uploadFile"),notexif:!0,ext:["txt","png","jpeg","jpg"],dropZone:n.c,action:function(e,t){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?sitemessage(s.app.localization.e("filedamaged")):(n.login.val(trim(e)),i())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(n.login.val(trim(e[1])),i()):sitemessage(s.app.localization.e("filedamaged")))}}),e.clbk(null,e)},tooltip:{options:{position:"left",functionPosition:function(e,t,n){return n.coord.top=10,n.coord.left+=10,n}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen"}}}var s=new nModule,a={};return s.run=function(e){var t=s.addEssense(a,n,e);s.init(t,e)},s.stop=function(){_.each(a,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=addaccount:(app.modules.addaccount={},app.modules.addaccount.module=addaccount);var complain=function(){function n(e){function i(){l?s.next.removeClass("disabled"):s.next.addClass("disabled")}function t(){u.closeContainer()}function n(){var n,e;!s.next.hasClass("disabled")&&l&&(n=function(e){e&&(u.closeContainer(),c.success&&c.success())},e=r.complain(l),topPreloader(30),u.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){topPreloader(100),e?n(!0):(u.app.platform.errorHandler(t,!0),n())}))}function a(){var e,t=$(this).attr("reason");(e=_.find(d[o],function(e){return(e.gid||e.id)==t}))&&($(this).hasClass("active")||(s.c.find(".reason").removeClass("active"),l=null,$(this).addClass("active"),e.group?p.selector(e):l=e.id,i()))}var s,o,r,l,c,e=deep(e,"history"),d={post:[{name:"Sexual content",gid:1,group:[{name:"Graphic sexual activity",id:"1"},{name:"Nudity",id:"2"},{name:"Suggestive, but without nudity",id:"3"},{name:"Content involving minors",id:"4"},{name:"Abusive title or description",id:"5"},{name:"Other sexual content",id:"6"}]},{name:"Violent or repulsive content",gid:2,group:[{name:"Adults fighting",id:"7"},{name:"Physical attack",id:"8"},{name:"Youth violence",id:"9"},{name:"Animal abuse",id:"10"}]},{name:"Hateful or abusive content",gid:3,group:[{name:"Promotes hatred or violence",id:"11"},{name:"Abusing vulnerable individuals",id:"12"},{name:"Bullying",id:"13"},{name:"Abusive title or description",id:"14"}]},{name:"Harmful dangerous acts",gid:4,group:[{name:"Pharmaceutical or drug abuse",id:"19"},{name:"Abuse of fire or explosives",id:"20"},{name:"Suicide or self injury",id:"21"},{name:"Other dangerous acts",id:"22"}]},{name:"Child abuse",id:"23"},{name:"Promotes terrorism",id:"24"},{name:"Spam or misleading",gid:6,group:[{name:"Mass advertising",id:"25"},{name:"Pharmaceutical drugs for sale",id:"26"},{name:"Misleading text",id:"27"},{name:"Misleading thumbnail",id:"28"},{name:"Scams / fraud",id:"29"}]},{name:"Infringes my rights",gid:7,group:[{name:"Infringes my copyright",id:"30"},{name:"Invades my privacy",id:"31"},{name:"Other legal claim",id:"32"}]}]},p={reasons:function(){u.shell({name:"reasons",inner:html,el:s.reasons,data:{reasons:d[o]}},function(e){e.el.find(".reason").on("click",a)})},selector:function(e){var t=s.c.find('.reason[reason="'+e.gid+'"] .reasongroupIn'),n=_.map(e.group,function(e){return e.name}),a=_.map(e.group,function(e){return e.id}),o=new Parameter({type:"VALUES",name:e.name,id:e.gid,possibleValues:a,possibleValuesLabels:n,placeholder:"Choose one"});o._onChange=function(e){l=e||null,i()},u.shell({name:"selector",inner:html,el:t,data:{selector:o}},function(e){ParametersLive([o],e.el)})}};return{primary:e,getdata:function(e,t){l=null,o=deep(t,"settings.essenseData.item")||"post",r=deep(t,"settings.essenseData.obj")||null,c=t.settings.essenseData||{},r&&e({ess:o})},destroy:function(){s={}},init:function(e){(s={}).c=e.el.find("#"+u.map.id),s.reasons=s.c.find(".reasons"),s.next=s.c.find(".next"),s.c.find(".cancel").on("click",t),s.next.on("click",n),p.reasons(),e.clbk(null,e)},wnd:{class:"withoutButtons transparent small complain"}}}var u=new nModule,a={};return u.run=function(e){var t=u.addEssense(a,n,e);u.init(t,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=complain:(app.modules.complain={},app.modules.complain.module=complain);var socialshare2=function(){var k=new nModule;function n(e){function n(){(c?b:y)()}function a(){c=k.app.settings.get(k.map.id,"notincludedRef")||!1}function i(e,t){return(t+=":\r\n")+e}var t,e=deep(e,"history"),s="",r=(k.app.localization.e("e13171"),k.app.localization.e("e13172")+"\r\n"),l={},o=!1,c=!1,d={},p=deep(window,"plugins.socialsharing"),u={black:new Parameter({name:"Black Theme",id:"black",type:"BOOLEAN",value:"black"===localStorage.getItem("usertheme")}),autoplayvideo:new Parameter({name:"Autoplay Video",id:"black",type:"BOOLEAN",value:!1}),fullscreenvideo:new Parameter({name:"Remove Description",id:"fullscreenvideo",type:"BOOLEAN",value:!1}),onlyvideo:new Parameter({name:"Only video",id:"onlyvideo",type:"BOOLEAN",value:!1}),comments:new Parameter({name:"Include comments",id:"comments",type:"VALUES",defaultValue:"last",possibleValues:["last","all","no"],possibleValuesLabels:["Show Only last comment","Show All comments","Don't show comments"],value:""})},f={post:{settings:function(e){var t=["black","comments"],n=k.app.platform.sdk.node.shares.storage.trx[e];return n&&(n.url&&("youtube"!=(e=app.platform.parseUrl(n.url)).type&&"vimeo"!=e.type&&"bitchute"!=e.type&&"peertube"!=e.type||t.push("fullscreenvideo")),n.itisvideo()&&(t=["onlyvideo"])),Promise.resolve(t)},action:function(e,t){return Promise.resolve("lenta")}},channel:{settings:function(e){return Promise.resolve(["black"])},action:function(e,t){return Promise.resolve("channel")}},comment:{settings:function(e){return Promise.resolve(["black"])},action:function(e,t){return Promise.resolve("comment")},extra:function(e){e.commentPs={commentid:l.embedding.commentid,parentid:l.embedding.parentid}}}},m={sharebuttons:function(){l.sharing&&k.shell({name:"sharebuttons",el:t.c.find(".sharebuttons"),data:{socials:h()}},function(e){v()})},embedding:function(){var e,a;console.log("ED",l),l.embedding&&(e=f[l.embedding.type],a=[],e.settings(l.embedding.id).then(e=>(a={},_.each(e,function(e){a[e]=u[e]}),console.log("settings",a),Promise.resolve())).then(()=>e.action(a,l.embedding.id)).then(n=>{k.shell({name:"embedding",el:t.c.find(".embeddingWrapperCnt"),data:{embeddingcode:m.embeddingcode(n,l.embedding.id,a),embeddingSettings:a}},function(e){function t(){o?e.el.addClass("showedcode"):e.el.removeClass("showedcode")}ParametersLive(a,e.el),_.each(a,function(e){e._onChange=function(){console.log("CHANGE"),m.embedding()}}),t(),e.el.find(".showcode").on("click",function(){o=!o,console.log("showcode",o),t()}),e.el.find(".copycode").on("click",function(){copycleartext(m.embeddingcode(n,l.embedding.id,a,u)),sitemessage(k.app.localization.e("successcopied"))})})}))},embeddingcode:function(e,t,n){var a={};_.each(n,function(e,t){a[t]=e.value});var o=f[l.embedding.type];return o.extra&&o.extra(a),k.app.platform.sdk.address.pnet()?a.ref=k.app.platform.sdk.address.pnet().address:k.app.ref&&(a.ref=k.app.platform.sdk.address.pnet().address=k.app.ref),n.onlyvideo?(o=k.app.platform.sdk.node.shares.storage.trx[t])&&o.url&&e&&t?(n=app.peertubeHandler.parselink(o.url),'<iframe width="640" height="'+(640/(((k.app.platform.sdk.videos.storage[o.url]||k.app.platform.sdk.videos.storage[n.id]||{}).data||{}).aspectRatio||1.77)).toFixed(0)+'" src="https://pocketnet.app/embedVideo.php?embed=true&s='+t+"&host="+n.host+"&id="+n.id+'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'):"":(a=hexEncode(JSON.stringify(a)),e&&t?'<div id="pocketnet_'+s+'"></div><script src="https://'+k.app.options.url+'/js/widgets.js"><\/script><script type="text/javascript">(new window.PNWIDGETS()).make('+s+', "'+e+'", "'+t+'", "'+a+'")<\/script>':"")}},h=function(){return _.filter(g,function(e){if(!e.if||e.if())return!0})},g=[{n:"Email",i:'<i class="far fa-envelope"></i>',t:"email",c:"#f82a53",group:"email"},{n:"Telegram",i:'<i class="fab fa-telegram-plane"></i>',t:"telegram",c:"#0088cc",group:"messenger"},{n:"Viber",i:'<i class="fab fa-viber"></i>',t:"viber",c:"#59267c",group:"messenger"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")},group:"messenger"},{n:"Parler",i:'<img src="img/parlerlogo.png">',t:"parler",c:"#d31f3e",group:"social"},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"social"},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"instagram",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")},group:"social"},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"social"},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700",group:"social"},{n:"Gmail",i:'<i class="fab fa-google"></i>',t:"gmail",c:"#fbbc05",group:"email"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova},group:"messenger"},{n:"VK",i:'<i class="fab fa-vk"></i>',t:"vk",c:"#45668e",group:"social"},{n:"Tumblr",i:'<i class="fab fa-tumblr"></i>',t:"tumblr",c:"#35465c",group:"blog"},{n:"Blogger",i:'<i class="fab fa-blogger-b"></i>',t:"blogger",c:"#f57d00",group:"blog"}],v=function(){t.c.find(".socialsharebtn").each(function(){var e,t,n,a,o=$(this);o.hasClass("s_email")?o.on("click",function(){var e=r+"\r\n\r\n"+trimHtml(l.sharing.text.body,500).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")+"\r\n\r\n"+i(l.url,"Сontinue on Pocketnet");deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var t="";t+="mailto:",t+="?subject="+l.sharing.title,t+="&body=",t+=encodeURIComponent(e),window.location.href=t}):(e=l.sharing.title+": "+l.sharing.text.preview+"\r\n\r\n"+i(l.url,"Сontinue on Pocketnet"),t=o.data("type"),a=t,(t=_.find(g,function(e){return e.t==a}))&&t.s&&window.cordova&&p?(n=t.s,o.on("click",function(){"shareViaFacebook"!=n&&"shareViaTwitter"!=n&&"shareViaWhatsApp"!=n||p[n](e,l.sharing.image,l.url),"shareViaInstagram"==n&&p[n](e,l.sharing.image),"shareViaSMS"==n&&p[n]({message:e+" "+l.url,subject:l.sharing.title,image:l.sharing.image})})):(o.hasClass("s_gmail")&&(e=r+"\r\n\r\n"+l.sharing.text.body+"\r\n\r\n"+i(l.url,"Сontinue on Pocketnet"),deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"))),o.ShareLink({title:l.sharing.title,text:e,image:l.sharing.image,url:l.url,class_prefix:"s_",width:640,height:480})),o.on("click",function(){$(this).data("type")}))})},y=function(){k.app.platform.sdk.address.pnet()?l.url=k.app.nav.api.history.addParametersToHref(l.url,{ref:k.app.platform.sdk.address.pnet().address}):k.app.ref&&(l.url=k.app.nav.api.history.addParametersToHref(l.url,{ref:k.app.ref}))},b=function(){l.url=k.app.nav.api.history.removeParametersFromHref(l.url,["ref"])};return{primary:e,getdata:function(e,t){t.state,l=t.settings.essenseData||{},a(),l.title||(l.title="Pocketnet"),s=rand(1e4,99999),d.reflink=new Parameter({name:"Include Referal Link",id:"reflink",type:"BOOLEAN",value:!c,dbId:"reflink"}),d.reflink._onChange=function(){c=!d.reflink.value,k.app.settings.set(k.map.id,"notincludedRef",c),n(),m.sharebuttons()},l.url||("undefined"!=typeof _Electron||window.cordova?(t=(t=window.location.pathname.split("/"))[t.length-1]||"index",l.url="https://"+k.app.options.url+"/"+t+window.location.search):l.url="https://"+k.app.options.url+"/"+k.app.nav.get.href()||"index"),l.url=k.app.nav.api.history.removeParametersFromHref(l.url,["mpost","msocialshare2"]),n(),e({caption:l.caption,style:l.style||"",eparameters:d})},destroy:function(){t={}},init:function(e){a(),(t={}).c=e.el.find("#"+k.map.id),t.url=t.c.find(".url"),t.c.find(".url").on("click",function(){copycleartext(l.url),sitemessage(k.app.localization.e("urlsuccesscopied"))}),m.sharebuttons(),m.embedding(),ParametersLive(_.toArray(d),t.c),e.clbk(null,e)},wnd:{swipeClose:!0,trueshold:1,swipeCloseDir:"down",header:k.app.localization.e("e13174"),class:"sharingwindow2"}}}console.log("@@@@@@","black"===localStorage.getItem("usertheme"));var a={};return k.run=function(e){var t=k.addEssense(a,n,e);k.init(t,e)},k.stop=function(){_.each(a,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=socialshare2:(app.modules.socialshare2={},app.modules.socialshare2.module=socialshare2);var postscores=function(){function n(e){function n(){var a=$(this).attr("value");l.app.user.isState(function(e){var t;e?(t=$(this).closest(".stars")).attr("value")||(t.attr("value",a),t.addClass("liked"),function(e,n){if(o.address!=l.user.address.value){if(!(e=o.upvote(a)))return l.app.platform.errorHandler("4",!0),n(!1);l.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){topPreloader(100),e?n(!0):(o.myVal=null,l.app.platform.errorHandler(t,!0),n(!1))})}}(0,function(e){e?(o.scnt||(o.scnt=0),o.score||(o.score=0),o.scnt++,o.score=Number(o.score||0)+Number(a),e=Number(o.score)/Number(o.scnt),t.find(".tstarsov").css("width",e/5*100+"%"),t.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),r.stars(),i.push({address:l.user.address.value,value:a}),r.details(),r.userlist(),s.like&&s.like(o)):(t.removeAttr("value"),t.removeClass("liked"))})):l.nav.api.load({open:!0,href:"authorization",history:!0})})}var a,o,i,s,e=deep(e,"history"),r={userlist:function(n){i=_.filter(i,function(e){return 1<=e.value});var e=_.map(i,function(e){return e.address}),t={};_.each(i,function(e){t[e.address]=e.value}),l.nav.api.load({open:!0,id:"userslist",el:a.users,animation:!1,essenseData:{addresses:e,empty:l.app.localization.e("e13151"),caption:l.app.localization.e("e13152"),extra:function(e){return'<div class="userscore">'+t[e]+' <i class="fas fa-star"></i></div>'}},clbk:function(e,t){n&&n(e,t)}})},mystars:function(e){var t;void 0===o.myVal&&(t=[o.txid],l.app.platform.sdk.likes.get(t,function(){r.stars()}))},stars:function(t){l.shell({turi:"lenta",name:"stars",el:a.stars,data:{share:o}},function(e){fastars(e.el.find(".stars")),e.el.find(".stars i").on("click",n),t&&t()})},details:function(t){l.shell({name:"details",el:a.details,data:{share:o,scores:i}},function(e){e.el.find(".line").each(function(){var e=$(this);e.width(e.attr("awidth")+"%")}),t&&t()})}};return{primary:e,getdata:function(t,e){var n=deep(e,"settings.essenseData.share");s=deep(e,"settings.essenseData"),l.app.platform.sdk.node.shares.getbyid([n],function(){var e;(o=l.app.platform.sdk.node.shares.storage.trx[n])||(e=_.find(l.sdk.node.transactions.temp.share,function(e){return e.txid==n}))&&((o=new pShare)._import(e,!0),o.temp=!0,o.address=l.app.platform.sdk.address.pnet().address),o&&l.app.platform.sdk.postscores.get(n,function(){i=l.sdk.postscores.storage[n]||[],t({share:o})})})},destroy:function(){a={}},clearparameters:["p"],init:function(e){(a={}).c=e.el.find("#"+l.map.id),a.stars=a.c.find(".forstars"),a.details=a.c.find(".details"),a.users=a.c.find(".users"),r.stars(function(){r.details(),r.userlist(),r.mystars()}),e.clbk(null,e)},wnd:{class:"postscoreswnd",nooverflow:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,buttons:{}}}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,n,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=postscores:(app.modules.postscores={},app.modules.postscores.module=postscores);var surveyiframe=function(){function n(e){function t(e){"endsurvey"==(e.originalEvent.data||{}).message&&a.closeContainer()}var n;return{primary:e=deep(e,"history"),getdata:function(e){e({})},destroy:function(){n={}},init:function(e){localStorage.survey1=!0,(n={}).c=e.el.find("#"+a.map.id),$(n.c.find("iframe")[0].contentWindow).on("message",t),e.clbk(null,e)},wnd:{class:"allscreen black surveyiframe"}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=surveyiframe:(app.modules.surveyiframe={},app.modules.surveyiframe.module=surveyiframe);var main=function(){function n(e){function a(){E.app.user.isState(function(e){I.panel(),I.leftpanel(),I.addpanel()})}function o(){b=$(this).attr("lenta"),S.currentMode()}var r,n,i,c,s,l=deep(e,"history"),d=null,p=null,u=null,f=!1,m=null,h=null,g="",v=null,y=null,b="common",k=!1,w=null,x=null,C=0,z=/[,.!?;:() \n\r]/g,T=[{mode:"leftshow",icon:"fas fa-hashtag"},{mode:"mainshow",icon:"fas fa-home"},{mode:"rightshow",icon:"fas fa-arrow-right"}],P="mainshow",S={swipe:function(e,t,n){if(t&&n)if("move"!=e&&(w=null),"left"==t||"right"==t){if(!w){var a=_.findIndex(T,function(e){return e.mode==P}),o=null,i=0,s=1;if("move"==e&&("left"==t||"right"==t))return i=n/r.w.width()*100,void r.slwork.css({transform:"translateX("+(s="left"==t?-1:s)*(i=10<i?10:i)+"%)"});r.slwork.css({transform:"translateX(0%)"}),"end"==e&&("right"==t&&(0<a?o=T[a-1].mode:e="cancel"),"left"==t&&(a<T.length-1?o=T[a+1].mode:e="cancel"),o&&I.mobilemode(o))}}else if(r.slwork.css({transform:"translateX(0%)"}),"move"==e&&20<n&&(w=t),"end"==e){if("down"==t){if(console.log("lenta.hasplayingvideos()",p.hasplayingvideos()),p&&p.hasplayingvideos())return;E.app.el.html.removeClass("scrollmodedown")}"up"==t&&200<r.lentacell.scrollTop()&&E.app.el.html.addClass("scrollmodedown")}},refreshSticky:function(){k&&(r.panel.hcSticky("refresh"),r.leftpanel.hcSticky("refresh"))},addbutton:function(){E.app.platform.ui.share()},addbuttonscroll:function(){400<r.w.scrollTop()?r.addbutton.addClass("scrollactive"):r.addbutton.removeClass("scrollactive")},currentMode:function(){"recommended"==b?E.nav.api.history.addParameters({r:"recommended"}):"sub"==b?E.nav.api.history.addParameters({r:"sub"}):E.nav.api.history.removeParameters(["r"]),I.lentawithsearch(),M(),I.smallpanel()},backtolenta:function(){S.backtolentaClear(),_scrollTop(C,null,5)},backtolentaClear:function(){E.nav.api.history.removeParameters(["v"]),r.c.removeClass("opensvishowed"),I.post(null),setTimeout(function(){I.upbutton(),S.refreshSticky()},350),p&&p.update&&p.update()}},A=function(t,e,n){E.app.platform.sdk.search.get(g,"posts",e,n,s,function(e){t(e.data)})},I={addpanel:function(){E.app.user.isState(function(e){e&&(isMobile()?r.addbutton.removeClass("active"):r.addbutton.addClass("active"))})},smallpanel:function(){r.smallpanel.find(".item").removeClass("active"),r.smallpanel.find('.item[lenta="'+b+'"]').addClass("active")},share:function(){isMobile()||f||g||v?r.c.addClass("wshar"):(r.c.removeClass("wshar"),E.nav.api.load({open:!0,id:"share",el:r.share,animation:!1,clbk:function(e,t){u=t,S.refreshSticky()},essenseData:{post:function(){}}}))},topvideos:function(e){var t=r.topvideos;t.removeClass("hasshares"),e?E.app.platform.papi.horizontalLenta(t,function(e,t){x=t,S.refreshSticky()},{caption:E.app.localization.e("Top videos"),video:!0,r:"hot",loaderkey:"recommended",shuffle:!0,period:"4320",page:0,afterload:function(e,t,n){!n&&t.length&&e.page++},ended:function(e){return!e.length},hasshares:function(e){2<e.length&&t.addClass("hasshares")},opensvi:function(e,t){isMobile()&&t?E.nav.api.load({open:!0,href:"post?&s="+e,history:!0,handler:!0}):E.nav.api.load({open:!0,href:"index?video=1&v="+e,history:!0,handler:!0})},compact:!0}):(x&&(x.destroy(),x=null),t.html(""),t.removeClass("hasshares"))},leftpanel:function(){E.nav.api.load({open:!0,id:"leftpanel",el:r.leftpanel,animation:!1,essenseData:{renderclbk:function(){S.refreshSticky()},changed:function(){I.lentawithsearch()}},clbk:function(e,t){i=t}})},panel:function(){f&&!isMobile()||E.nav.api.load({open:!0,id:"panel",el:r.panel,animation:!1,essenseData:{renderclbk:function(){S.refreshSticky()}},clbk:function(e,t){n=t}})},lentawithsearch:function(n,a){var e,t;g?(t=g.replace("tag:","#"),(e=deep(E,"app.modules.menu.module.showsearch"))&&e(t),E.app.platform.sdk.search.get(g,"posts",0,10,null,function(e,t){e.count&&E.app.platform.sdk.activity.addsearch(g),s=t,c={posts:e},I.lenta(n,a)})):(c={},s=null,(e=deep(E,"app.modules.menu.module.showsearch"))&&(v?(e(t=_.map(v,function(e){return"#"+e}).join(" ")),E.app.platform.sdk.activity.addtagsearch(t)):e("")),I.lenta(n,a))},lenta:function(n,e){e=e||{};var t=null,l=!1;p&&p.destroy(),I.addpanel(),g&&(t=function(t){function n(e){e=E.app.platform.sdk.node.shares.transform(e),t&&t(e,null,{count:10})}var e,a,o,i,s,r;l?(e=c.posts.data.length,o=function(e){n(e)},s=c.posts.data.length,r=c.posts.count,e+(a=10)<=s||(e<s&&(i=s-e,e=s,a-=i),(a=r<e+a?r-e:a)<=0||A(function(e){o(e)},e,a))):(l=!0,n(c.posts.data))}),E.nav.api.load({open:!0,id:"lenta",el:r.lenta,animation:!1,mid:"main",essenseData:{hr:"index?",goback:e.goback,searchValue:g||null,search:!!g,tags:v,video:f&&!isMobile(),videomobile:f&&isMobile(),window:isMobile()?r.c.find(".lentacell"):r.w,page:0,afterload:function(e,t,n){isMobile()&&!n&&t.length&&e.page++},opensvi:function(e){C=r.w.scrollTop(),r.c.addClass("opensvishowed"),m&&m.destroy(),h&&h.destroy(),setTimeout(function(){h=E.app.platform.api.upbutton(r.upbackbutton,{top:function(){return"65px"},rightEl:r.c.find(".lentacellsvi"),scrollTop:0,click:function(e){S.backtolenta()},icon:'<i class="fas fa-chevron-left"></i>',class:"bright",text:"Back"})},50),setTimeout(function(){h.apply()},300),I.post(e),E.nav.api.history.addParameters({v:e}),_scrollTop(0,null,5)},renderclbk:function(){},loader:t},clbk:function(e,t){I.upbutton(),S.refreshSticky(),p=t,n&&n()}})},upbutton:function(){m&&m.destroy(),m=E.app.platform.api.upbutton(r.up,{top:function(){return"65px"},rightEl:r.c.find(".leftpanelcell")})},post:function(e){r&&r.c&&(e?E.app.platform.papi.post(e,r.c.find(".renderposthere"),function(e,t){y=t},{video:!0,autoplay:!0,nocommentcaption:!0,r:"recommended",opensvi:function(e){y&&(y.destroy(),y=null),r.c.find(".renderposthere").html(""),I.post(e),_scrollTop(0)}}):(y&&(y.destroy(),y=null),r.c.find(".renderposthere").html("")))},mobilemode:function(e){e&&("mainshow"==P&&(C=r.w.scrollTop(),_scrollTop(0,null,0)),P=e),r.c.attr("mobilemode",P),I.columnnavigation(),setTimeout(function(){E.app.el.html.removeClass("scrollmodedown")},300),"mainshow"==P&&C&&_scrollTop(C,null,0)},columnnavigation:function(){}},M=function(){E.app.user.isState(function(e){e&&(isMobile()||("common"==b?(I.share(),r.c.find(".bgCaption").removeClass("hidden")):(r.share.html(""),r.c.find(".bgCaption").addClass("hidden"))))})};return{primary:l,scrolltopall:function(){r.lentacell&&isMobile()&&(_scrollTop(0,r.lentacell,200),I.mobilemode("mainshow"))},parametersHandler:function(e){var t=b;localStorage.lentakey=parameters().r||"index",parameters().video&&(localStorage.lentakey="video"),t=parameters().r?parameters().r:"common",b!=t&&(b=t),(t=!!parameters().video)!=f&&(f=t),g=parameters().ss||"",t=decodeURI(parameters().sst||""),t=_.uniq(_.filter(t.split(z),function(e){return e})),v=t.length?t:null,I.topvideos("common"==b&&!f&&!g&&!v),f?(r.c.addClass("videomain"),parameters().v||(S.backtolenta(),a())):(r.c.removeClass("videomain"),S.backtolentaClear(),a()),p&&(p.destroy(),p=null),I.lentawithsearch(),I.leftpanel(),M(),S.refreshSticky(),e&&e()},authclbk:function(){void 0!==r&&r.c&&(r.c.find(".bgCaption").removeClass("hidden"),M(),S.refreshSticky())},getdata:function(e,t){k=!1;var n=parameters();b=n.r||"common",beginmaterial=n.s||n.i||n.v||null,E.app.curation()?E.nav.api.load({open:!0,href:"userpage",history:!0}):t.state&&l&&!E.app.user.validate()?E.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):e({})},destroy:function(){r&&r.w&&r.w.off("scroll",S.addbuttonscroll),E.app.el.html.removeClass("scrollmodedown"),I.post(null),k=!1,m&&m.destroy(),m=null,h&&h.destroy(),h=null,d&&d.destroy(),p&&p.destroy(),u&&u.destroy(),n&&n.destroy(),x&&(x.destroy(),x=null),i&&i.destroy(),C=0,f=!(P="mainshow"),w=u=p=d=n=i=null,E.app.el.footer.removeClass("workstation"),E.app.el.html.removeClass("nooverflow"),E.app.el.html.removeClass("showmain"),r={},E.app.scrolling&&_.each(E.app.scrolling.clbks,function(e){e(0)})},init:function(e){var t,n;w=p=d=null,(r={}).c=e.el.find("#"+E.map.id),r.share=r.c.find(".share"),r.lenta=r.c.find(".lentaWrapper"),r.lentacell=r.c.find(".lentacell"),r.panel=r.c.find(".panel"),r.leftpanel=r.c.find(".leftpanel"),r.up=r.c.find(".upbuttonwrapper"),r.upbackbutton=r.c.find(".upbackbuttonwrapper"),r.smallpanel=r.c.find(".smallpanell"),r.addbutton=r.c.find(".addbutton"),r.columnnavigationWrapper=r.c.find(".columnnavigationWrapper"),r.slwork=r.c.find(".maincntwrapper >div.work"),r.topvideos=r.c.find(".topvideosWrapper"),r.w=$(window),E.app.el.footer.addClass("workstation"),isMobile()&&E.app.el.html.addClass("nooverflow"),E.app.el.html.addClass("showmain"),r.w.on("scroll",S.addbuttonscroll),r.smallpanel.find(".item").on("click",o),r.c.find(".backtolenta").on("click",S.backtolenta),r.addbutton.on("click",S.addbutton),isMobile()?E.app.scrolling&&r.lentacell.on("scroll",function(){var t;r.lentacell&&((t=r.lentacell.scrollTop())<200&&E.app.el.html.removeClass("scrollmodedown"),_.each(E.app.scrolling.clbks,function(e){e(t)}))}):(r.leftpanel.hcSticky({stickTo:"#main",top:64,bottom:122}),r.panel.hcSticky({stickTo:"#main",top:76,bottom:122}),k=!0),e.goback||(g=parameters().ss||"",t=decodeURI(parameters().sst||""),n=_.uniq(_.filter(t.split(z),function(e){return e})),v=n.length?n:null,s=null,c={}),(f=!!parameters().video)&&!isMobile()&&r.c.addClass("videomain"),I.mobilemode(),t=function(){e.clbk(null,e)},n=e,localStorage.lentakey=parameters().r||"index",parameters().video&&(localStorage.lentakey="video"),I.lentawithsearch(t,n),M(),a(),I.smallpanel(),"common"!=b||f||g||v||I.topvideos(!0),isMobile()&&r.c.find(".maincntwrapper").swipe({allowPageScroll:"auto",swipeStatus:function(e,t,n,a){if(!E.app.el.html.hasClass("fullvideoshowedanimblock"))return 0<r.topvideos.has(e.target).length||S.swipe(t,n,a),!0}})}}}var E=new nModule,a={};return E.scrolltopall=function(){_.each(a,function(e){e.scrolltopall()})},E.run=function(e){var t=E.addEssense(a,n,e);E.init(t,e)},E.stop=function(){var t=null;return _.each(a,function(e){(e=e.destroy())&&(t=e)}),t},E.authclbk=function(){_.each(a,function(e){e.authclbk()})},E}();"undefined"!=typeof module?module.exports=main:(app.modules.main={},app.modules.main.module=main);var author=function(){function n(e){var s,o,r,n,e=deep(e,"history"),a=null,t=null,l=!1,i=null,c={subscribeLabel:function(){var e,t=v.app.user,n=!1;t.address.value&&s.address==t.address.value||!t.address.value||(e=deep(v.app,"platform.sdk.users.storage."+t.address.value))&&e.relation(s.address,"subscribes")&&(n=!0),r.c&&(e=r.caption.find(".subscribebuttonstop"),n?e.addClass("following"):e.removeClass("following"))},showmoreabout:function(){var e=filterXSS(clearScripts(findAndReplaceLink(deep(s,"data.about"),!0)));r.c.find(".aboutwrapper").html(e),r.c.find(".showmoreabout").remove()},showHideUp:function(){200<r.w.scrollTop()?r.up.addClass("active"):r.up.removeClass("active")},panelTopPosition:function(){var e;isTablet()||(e=$(window).scrollTop(),r.caption.height()+20<e?r.fxd.addClass("dfxd"):r.fxd.removeClass("dfxd"),c.panelPosition())},panelPosition:function(){var e,t,n;isTablet()||(e=r.fxd,n=r.panel.closest(".mwork"),n=(t=$(window).width())-(t=t-(n.offset().left+n.width())+0)-350,e.css("right",t+"px"),e.css("left",n+"px"))},destroy:function(){_.each(p,function(e){e.active=!1,e.module&&e.module.destroy()})}},d={showHideUp:function(){t=slowMade(function(){c.showHideUp()},t,30)},up:function(){_scrollTop(0)},unsubscribe:function(){dialog({html:v.app.localization.e("e13022"),btn1text:v.app.localization.e("unfollow"),btn2text:v.app.localization.e("ucancel"),class:"zindex",success:function(){v.app.platform.api.actions.unsubscribe(s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)})}})},subscribe:function(){v.app.platform.api.actions.subscribeWithDialog(s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)})},subscribePrivate:function(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";v.app.platform.api.actions[e](s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)})}},p={},u={contents:function(n,e){v.app.platform.sdk.contents.get(s.address,function(e){var t=parameters().mt,t={name:"contents",el:n,data:{contents:e,author:s,selected:t}};v.shell(t,function(e){})})},metmenu:function(n){var a={};v.fastTemplate("metmenu",function(e,t){v.app.platform.api.tooltip(n,function(){return a.author=s,t(a)},function(e){e.find(".donate").on("click",function(){c.donate(id),n.tooltipster("hide")}),e.find(".block").on("click",function(){v.app.platform.api.actions.blocking(s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)}),n.tooltipster("hide")}),e.find(".unblock").on("click",function(){v.app.platform.api.actions.unblocking(s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)}),n.tooltipster("hide")})})},a)},panel:function(){var e={};v.user.isItMe(s.address)||(e.author=s.address),v.nav.api.load({open:!0,id:"panel",el:r.panel,animation:!1,essenseData:{discussions:e},clbk:function(e,t){a=t,c.panelPosition(),window.addEventListener("resize",d.panelPosition),window.addEventListener("scroll",c.panelTopPosition)}})},report:function(e,t,n){var a;c.destroy(),!e.active&&e.history&&(a=["mt","s"],"shares"==e.id&&!t||a.push("ss"),n||v.app.nav.api.history.addRemoveParameters(a,{report:e.id})),e.active=!0,u[e.render]&&(u[e.render](r.lenta,e),u.menulight())},menulight:function(){r.menu.find(".usermenuitem").removeClass("active");var e=_.find(p,function(e){return e.active});e&&r.menu.find(".usermenuitem .c"+e.class).addClass("active")},menu:function(e){v.shell({name:"menu",el:r.menu,data:{reports:p}},function(a){a.el.find(".usermenuitem").swipe({tap:function(){var e=$(this).attr("menuitem");p[e]&&p[e].render&&u.report(p[e])}}),_.each(p,function(e,t){var n;e.events&&(n=a.el.find('[menuitem="'+t+'"]'),_.each(e.events,function(e,t){"click"==t&&isTablet()?n.swipe({tap:e}):n.on(t,e)}))}),e&&e()})},userslist:function(e,t,n,a,o){v.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:t,empty:n,caption:a},clbk:function(e,t){o&&o(e,t)}})},info:function(e){v.sdk.ustate.get(s.address,function(){s.state=v.sdk.ustate.storage[s.address],v.shell({name:"info",el:e,data:{author:s},animation:"fadeIn"},function(e){e.el.find(".showmoreabout").on("click",c.showmoreabout),e.el.find(".copyaddress").on("click",function(){copyText($(this)),sitemessage(v.app.localization.e("successcopied"))}),e.el.find(".postcnt").on("click",function(){u.report(p.contents)})})})},followers:function(e,n){var t=_.map(deep(s,"data.subscribers")||[],function(e){return e}),a=deep(s,"data.blocking")||[],t=_.filter(t,function(e){return-1==_.indexOf(a,e)}),o=v.app.localization.e("anofollowers");v.user.isItMe(s.address)&&(o=v.app.localization.e("aynofollowers")),u.userslist(e,t,o,v.app.localization.e("followers"),function(e,t){n.module=t})},following:function(e,n){var t=_.map(deep(s,"data.subscribes")||[],function(e){return e.adddress}),a=deep(s,"data.blocking")||[],t=_.filter(t,function(e){return-1==_.indexOf(a,e)}),o=v.app.localization.e("anofollowing");v.user.isItMe(s.address)&&(o=v.app.localization.e("aynofollowing")),u.userslist(e,t,o,v.app.localization.e("following"),function(e,t){n.module=t})},blocking:function(e,n){var t=_.map(deep(s,"data.blocking")||[],function(e){return e}),a=v.app.localization.e("anoblocked");v.user.isItMe(s.address)&&(a=v.app.localization.e("aynoblocked")),u.userslist(e,t,a,v.app.localization.e("blockedusers"),function(e,t){n.module=t})},post:function(e,t){var a=parameters().mt,n=v.app.platform.sdk.contents.getsorteditems(contents),o=_.map(n,function(e){return e.txid}),i=_.indexOf(o,a),n={currentindex:i+1,allength:o.length,leftid:null,rightid:null};0<i&&(n.leftid=o[i-1]),i<o.length-1&&(n.rightid=o[i+1]),v.shell({name:"post",el:e,data:n},function(n){var e="author?address="+s.address,t=app.platform.api.name(s.address);t&&(e=t.toLowerCase()+"?"),v.app.platform.papi.post(a,n.el.find(".postcnt"),function(e,t){external=t,l&&r.c.find(".contentswrapper").hcSticky("refresh"),n.el.find(".postauarrows").addClass("active")},{hr:e})})},lenta:function(n,a){var t,e,o,i;v.app.curation()&&!v.user.isItMe(s.address)||(t=function(){v.shell({name:"lenta",el:n,data:{}},function(e){var t;v.nav.api.load({open:!0,id:"lenta",el:n.find(".authorlentawrapper"),animation:!1,mid:s.address,essenseData:i,clbk:function(e,t){a.module=t,l&&r.c.find(".contentswrapper").hcSticky("refresh")}}),s.data&&s.data.name&&(t=e.el.find(".authorlentawrappermain"),e.el.find(".authorsearchicon .icon").on("click",function(){t.toggleClass("searchactive"),t.hasClass("searchactive")?t.find(".search input").focus():(t.find(".search input").val(""),m())}),new search(e.el.find(".authorsearch"),{placeholder:"Search on "+s.data.name,clbk:function(e){},last:{get:function(){return[]},tpl:function(e,t){}},events:{search:function(e,t,n,a){e="?report=shares&ssa="+e.replace("#","tag:"),m(!0),v.nav.api.go({href:e,history:!0,open:!0,handler:!0}),t&&t(!0)},clear:function(e){m()}}}),parameters().ssa&&(t.addClass("searchactive"),t.find(".search input").val(parameters().ssa)),isTablet()&&t.addClass("searchactive"))})},e="author?address="+s.address,(o=app.platform.api.name(s.address))&&(e=o.toLowerCase()+"?"),i={author:s.address,byauthor:!0,hr:e,renderclbk:function(){l&&r.c.find(".contentswrapper").hcSticky("refresh")}},"b"==parameters().r?(e=o.toLowerCase()+"?r=b&mt="+parameters().mt,i.beginmaterial=parameters().mt,i.contents=!0,v.app.platform.sdk.contents.get(s.address,function(e){e=v.app.platform.sdk.contents.getsorteditems(e),i.txids=_.map(e,function(e){return e.txid}),t()})):(parameters().ssa&&(i.search=!0,i.searchValue=parameters().ssa,i.loader=function(t){h("posts",deep(f,"data.length")||0,10,function(e){e=v.app.platform.sdk.node.shares.transform(e),t&&t(e,null,{count:10})})}),t()))}},f=null,m=function(e){parameters().ssa&&(v.app.platform.sdk.search.clear(),i=f=null,e||(v.app.nav.api.history.removeParameters(["ssa"]),u.report(p.shares,!0)))},h=function(e,t,n,a){var o,i=0,s=10;f&&(i=f.data.length,s=f.count),t+n<=i||(t<i&&(o=i-t,t=i,n-=o),(n=s<t+n?s-t:n)<=0||g[e](function(e){a&&a(e)},t,n))},g={posts:function(n,e,t){v.app.platform.sdk.search.get(parameters().ssa,"posts",e,t,i||null,function(e,t){i=t,n((f=f||e).data)},s.address)}};return{primary:e,parametersHandler:function(){var e=parameters().report||"shares";u.report(p[e],null,!0),u.menu()},authclbk:function(){var e=_.find(p,function(e){return e.active});e&&"shares"!=e.id&&u.report(e,null,!0),c.subscribeLabel()},getdata:function(t,e){s={},v.app.platform.sdk.search.clear();var n=e.settings.essenseData||{},a=parameters();o=e.state,a.address||(a.address=n.address),l=!1,f=i=null,p={shares:{name:v.app.localization.e("uposts").toUpperCase(),mobile:'<i class="fas fa-align-justify"></i>',id:"shares",render:"lenta",history:!0,if:function(){return!v.app.curation()||v.user.isItMe(s.address)},count:function(){return 0}},post:{if:function(){return!1},id:"post",render:"post",count:function(){return 0}},followers:{name:v.app.localization.e("followers").toUpperCase(),mobile:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,count:function(){var e=_.map(deep(s,"data.subscribers")||[],function(e){return e}),t=deep(s,"data.blocking")||[];return _.filter(e,function(e){return-1==_.indexOf(t,e)}).length}},contents:{name:v.app.localization.e("followers").toUpperCase(),mobile:'<i class="fas fa-users"></i>',id:"contents",render:"contents",history:!0,if:function(){return!1}},following:{name:v.app.localization.e("following").toUpperCase(),id:"following",mobile:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,count:function(){var e=_.map(deep(s,"data.subscribes")||[],function(e){return e.adddress}),t=deep(s,"data.blocking")||[];return _.filter(e,function(e){return-1==_.indexOf(t,e)}).length}},blocking:{name:v.app.localization.e("blockedusers").toUpperCase(),id:"blocking",mobile:'<i class="fas fa-user-slash"></i>',render:"blocking",history:!0,if:function(){if(v.user.isItMe(s.address))return!0},count:function(){return(deep(s,"data.blocking")||[]).length}},share:{name:v.app.localization.e("share").toUpperCase()+' <i class="fas fa-share-alt"></i>',mobile:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){v.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,uid:"authorshare",essenseData:{caption:"Share this author",sharing:s.data.social(v.app),embedding:{type:"channel",id:s.address}}})}}},settings:{name:v.app.localization.e("settings").toUpperCase()+' <i class="fas fa-cog"></i>',mobile:'<i class="fas fa-cog"></i>',id:"settings",href:function(){return v.app.user.validate()?"userpage?id=ustate":"userpage"},class:"tosettings",if:function(){if(v.user.isItMe(s.address)&&!isTablet())return!0}},more:{name:'<i class="fas fa-ellipsis-h"></i>',mobile:'<i class="fas fa-ellipsis-h"></i>',id:"more",class:"more",if:function(){if(!v.user.isItMe(s.address)&&o)return!0},events:{click:function(){u.metmenu($(this))}}},info:{name:v.app.localization.e("info")+' <i class="fas fa-info-circle"></i>',mobile:'<i class="fas fa-info-circle"></i>',id:"info",class:"info",render:"info",history:!0,if:function(){return!1}}},v.sdk.users.addressByName(a.address,function(e){e&&(s.address=e,v.sdk.users.get(s.address,function(){if(v.app.platform.sdk.address.pnet()&&s.address==v.app.platform.sdk.address.pnet().address){if(p.shares.name=v.app.localization.e("myuposts"),!v.app.user.validate())return void v.nav.api.go({href:"userpage?id=test",history:!0,open:!0})}else p.shares.name=v.app.localization.e("uposts");s.data=v.sdk.users.storage[s.address],t({author:s})}))})},destroy:function(){n&&n.destroy(),n=null,a&&a.destroy(),window.removeEventListener("resize",d.panelPosition),window.removeEventListener("scroll",c.panelTopPosition),window.removeEventListener("scroll",d.showHideUp),delete v.app.platform.ws.messages.event.clbks.author,delete v.app.platform.clbks.api.actions.subscribe.author,delete v.app.platform.clbks.api.actions.unsubscribe.author,delete v.app.platform.clbks.api.actions.subscribePrivate.author,c.destroy(),r={}},init:function(e){var t;(r={}).c=e.el.find("#"+v.map.id),r.lenta=r.c.find(".lentaWrapper"),r.menu=r.c.find(".usermenu"),r.panel=r.c.find(".panel"),r.caption=r.c.find(".bgCaption"),r.fxd=r.c.find(".fxd"),r.subscribe=r.c.find(".subscribebuttonstop"),r.up=r.c.find(".upbuttonwrapper"),r.w=$(window),r.contents=r.c.find(".contentswrapper"),r.info=r.c.find(".authorinfoWrapper"),t=parameters().report||"shares",p[t].active=!0,u.report(p[t],null,!0),u.menu(),isTablet()&&u.info(r.c.find(".mobileinfo")),v.app.user.isState(function(e){!e||(e=v.app.platform.sdk.users.storage[v.app.platform.sdk.address.pnet().address])&&e.relation(s.address,"blocking")&&r.caption.addClass("blocking")}),n=v.app.platform.api.upbutton(r.up,{top:function(){return"65px"},class:"light",rightEl:r.c.find(".leftpanelcell")}),isTablet()||u.info(r.info),r.up.on("click",d.up),r.subscribe.find(".subscribe").on("click",d.subscribe),r.subscribe.find(".unsubscribe").on("click",d.unsubscribe),r.c.find(".notificationturn").on("click",d.subscribePrivate),r.caption.find(".unblocking").on("click",function(){dialog({html:v.app.localization.e("e13023"),btn1text:v.app.localization.e("unblock"),btn2text:v.app.localization.e("ucancel"),class:"zindex",success:function(){v.app.platform.api.actions.unblocking(s.address,function(e,t){e||v.app.platform.errorHandler(t,!0)})}})}),v.app.platform.ws.messages.event.clbks.author=function(e){"subscribe"!=e.mesType&&"unsubscribe"!=e.mesType||(r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count()))},v.app.platform.clbks.api.actions.subscribe.author=function(e){e==s.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count())),v.app.user.address.value.toString("hex")==s.address&&(r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count()))},v.app.platform.clbks.api.actions.subscribePrivate.author=function(e){e==s.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").addClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count())),v.app.user.address.value.toString("hex")==s.address&&(r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count()))},v.app.platform.clbks.api.actions.unsubscribe.author=function(e){e==s.address&&(r.subscribe.removeClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count())),v.app.user.address.value.toString("hex")==s.address&&(r.c.find('.toReport[report="followers"] .count').html(p.followers.count()),r.c.find('.toReport[report="following"] .count').html(p.following.count()))},v.app.platform.clbks.api.actions.blocking.author=function(e){e==s.address&&(r.caption.addClass("blocking"),r.c.find(".notificationturn").removeClass("turnon"))},v.app.platform.clbks.api.actions.unblocking.author=function(e){e==s.address&&r.caption.removeClass("blocking")},v.sdk.activity.adduser("visited",s.address),v.user.isItMe(s.address)&&v.app.nav.api.backChainClear(),e.clbk(null,e)}}}var v=new nModule,a={};return v.run=function(e){var t=v.addEssense(a,n,e);v.init(t,e)},v.stop=function(){_.each(a,function(e){e.destroy()})},v.authclbk=function(){_.each(a,function(e){e.authclbk()})},v}();"undefined"!=typeof module?module.exports=author:(app.modules.author={},app.modules.author.module=author);var socialshare=function(){function n(e){function t(){f.shell({name:"sharebuttons",el:i.c.find(".sharebuttons"),data:{socials:o()}},function(e){i.c.find(".socialsharebtn").each(function(){var e,t,n,a,o,i=$(this);i.hasClass("s_email")?i.on("click",function(){var e=(!s||c?"":d||r)+"\r\n"+l.title+"\r\n\r\n"+l.text+"\r\n\r\n\r\n"+l.url;deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var t="";t+="mailto:",t+="?subject="+l.title,t+="&body=",t+=encodeURIComponent(e),window.location.href=t}):(t=l.text,e=l.title,t=trim((!s||c?"":d||r)+" "+t),n=i.data("type"),o=n,(n=_.find(u,function(e){return e.t==o}))&&n.s&&window.cordova&&p?(a=n.s,i.on("click",function(){"shareViaFacebook"!=a&&"shareViaTwitter"!=a&&"shareViaWhatsApp"!=a||p[a](t,l.image,l.url),"shareViaInstagram"==a&&p[a](t,l.image),"shareViaSMS"==a&&p[a]({message:t+" "+l.url,subject:e,image:l.image})})):i.ShareLink({title:e,text:t,image:l.image,url:l.url,class_prefix:"s_",width:640,height:480}),i.on("click",function(){$(this).data("type")}))})})}function n(){f.app.settings.set(f.map.id,"calltoActionNotInclude",c),f.app.settings.set(f.map.id,"calltoActionUserText",d)}function a(){d=f.app.settings.get(f.map.id,"calltoActionUserText")||"",c=f.app.settings.get(f.map.id,"calltoActionNotInclude")||!1}function o(){return _.filter(u,function(e){if(!e.if||e.if())return!0})}var s,i,e=deep(e,"history"),r=(f.app.localization.e("e13171"),f.app.localization.e("e13172")+"\r\n"),l={},c=!1,d="",p=deep(window,"plugins.socialsharing"),u=[{n:"Email",i:'<i class="far fa-envelope"></i> '+f.app.localization.e("e13173"),t:"email",c:"#f82a53"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"instagram",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700"},{n:"Pinterest",i:'<i class="fab fa-pinterest-p"></i>',t:"pinterest",c:"#bd081c"},{n:"LinkedIn",i:'<i class="fab fa-linkedin-in"></i>',t:"linkedin",c:"#0077B5"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}}];return{primary:e,getdata:function(e,t){s=t.state,l=t.settings.essenseData||{},a(),l.title||(l.title="Pocketnet"),l.text||(l.text=f.app.localization.e("e13171")),l.image||(l.image="https://"+f.app.options.url+"/img/logobigpadding.png"),l.url||("undefined"!=typeof _Electron||window.cordova?(t=(t=window.location.pathname.split("/"))[t.length-1],l.url="https://"+f.app.options.url+"/"+t+window.location.search):l.url="https://"+f.app.options.url+"/"+f.app.nav.get.href()),f.app.platform.sdk.address.pnet()&&(l.url=f.app.nav.api.history.addParametersToHref(l.url,{ref:f.app.platform.sdk.address.pnet().address})),e({socials:o(),url:l.url,rescue:l.rescue||!1,caption:l.caption,style:l.style||"",calltoActionUserText:d||r,calltoActionNotInclude:c})},destroy:function(){i={}},init:function(e){a(),(i={}).c=e.el.find("#"+f.map.id),i.url=i.c.find(".url"),i.c.find(".copycell").on("click",function(){copyText(i.url.find(".urlcell")),sitemessage(f.app.localization.e("urlsuccesscopied"))}),i.c.find(".changecallto").on("click",function(){c=!c,$(".additionalwrapper").toggleClass("checked"),c&&i.c.removeClass("textshowed"),n(),t()}),i.c.find(".morecell").on("click",function(){i.c.toggleClass("textshowed"),i.c.closest(".wnd").toggleClass("textshowedwnd")}),i.c.find(".calltoActionUserText").on("keyup",function(){(d=$(this).val())==r&&(d=""),n(),t()}),i.c.find(".calltoActionUserText").on("change",function(){d||i.c.find(".calltoActionUserText").val(r)}),t(),e.clbk(null,e)},wnd:{swipeClose:!0,swipeMintrueshold:30,header:f.app.localization.e("e13174"),class:"sharingwindow"}}}var f=new nModule,a={};return f.run=function(e){var t=f.addEssense(a,n,e);f.init(t,e)},f.stop=function(){_.each(a,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=socialshare:(app.modules.socialshare={},app.modules.socialshare.module=socialshare);var channel=function(){function n(a){function e(){var e=app.platform.api.name(o.address);return e?e+"?":"author?address="+o.address}var n,t=deep(a,"history"),o={},i={followers:{name:s.app.localization.e("followers").toUpperCase(),icon:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,href:function(){return e()+"report=followers"},count:function(){return deep(o,"data.subscribers.length")||0}},reputation:{name:"REPUTATION",icon:'<i class="far fa-star"></i>',id:"reputation",render:"reputation",history:!0,href:e,count:function(){return deep(o,"state.reputation")||0}},following:{name:s.app.localization.e("following").toUpperCase(),id:"following",icon:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,href:function(){return e()+"report=following"},count:function(){return deep(o,"data.subscribes.length")||0}},share:{name:s.app.localization.e("share").toUpperCase(),icon:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){s.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{caption:"Share this author",sharing:o.data.social(s.app),embedding:{type:"channel",id:o.address}}})}}}};return{primary:t,getdata:function(e,t){(n=t.settings.essenseData||{}).id||(n.id="PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),s.sdk.users.get(n.id,function(){s.sdk.ustate.get(n.id,function(){o.data=s.sdk.users.storage[n.id],o.state=s.sdk.ustate.storage[n.id],o.address=n.id,console.log(o),e({author:o,reports:i})})})},destroy:function(){},init:function(e){e.el.find("#"+s.map.id),_.each(i,function(e,t){var n;e.events&&(n=a.el.find('[menuitem="'+t+'"]'),_.each(e.events,function(e,t){"click"==t&&isMobile()?n.swipe({tap:e}):n.on(t,e)}))}),e.clbk(null,e)}}}var s=new nModule,a={};return s.run=function(e){var t=s.addEssense(a,n,e);s.init(t,e)},s.stop=function(){_.each(a,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=channel:(app.modules.channel={},app.modules.channel.module=channel);var scheduler=function(){function n(e){function a(t){return _.find(s,function(e){return e.id==t})}function t(){function e(){r.remove(t)}var t=$(this).closest(".shareTimeWrapper").attr("task"),n=a(t);n&&(n.share.validation()?e():dialog({html:"Do you really want to remove this task?",btn1text:"Yes",btn2text:"No",success:e}))}var o,i,e=deep(e,"history"),s=[],n=null,r={postInterval:function(){n=setInterval(function(){var e=r.taskForTime();l.time(),e.length&&lazyEach({array:e,sync:!0,action:function(e){var t=e.item;d.app.platform.sdk.node.transactions.get.unspent(function(){r.post(t,function(){e.success()})},null,!0)}})},6e4)},missed:function(e){dialog({html:"You have <b>"+e.length+"</b> missed posts. Do you want to share it?",btn1text:"Yes",btn2text:"No",success:function(){_.each(e,function(e){r.post(e)})},fail:function(){_.each(e,function(e){e.time=null,l.task(e,null,!0)})}})},taskForTime:function(){var t=new Date;return _.filter(s,function(e){if(e.time&&e.ready&&t>e.time&&!e.remove)return!0})},post:function(n,a){var e;n.share?(e=n.share.validation())?(sitemessage(e),r.failPost(n.id),a&&a(!1)):d.app.platform.sdk.pool.dumpKey(i,n.address,function(e){var t;e?(t=bitcoin.ECPair.fromPrivateKey(Buffer.from(e,"hex")),e=bitcoin.payments.p2pkh({pubkey:t.publicKey}),n.module.post(function(e,t){e?r.successPost(n.id):(sitemessage(t),r.failPost(n.id)),a&&a(e)},{address:e,keys:t})):sitemessage("noprivateley")}):(sitemessage("error"),r.failPost(n.id),a&&a(!1))},add:function(){var e={time:null,id:makeid(),share:new Share,address:d.app.platform.sdk.address.pnet().address,ready:!1};e.share.on.change.scheduler=function(){c.save()},s.push(e),l.task(e),c.save()},remove:function(e){var t,n=(t=e,findIndex(s,function(e){return e.id==t}));s.splice(n,1),c.save(),o.c.find('.shareAppendWrapper[t="'+e+'"]').remove()},failPost:function(t){var e=a(t);e.time=null,l.task(e,function(){l.ready();var e=o.c.find('.shareAppendWrapper[t="'+t+'"] .result');e.html('<i class="fas fa-exclamation-circle"></i>'),e.addClass("bad")},!0)},successPost:function(e){a(e).remove=!0,(e=o.c.find('.shareAppendWrapper[t="'+e+'"] .result')).html('<i class="far fa-check-circle"></i>'),e.addClass("good"),l.ready(),c.save()}},l={tasks:function(e){lazyEach({array:s,action:function(e){var t=e.item;l.task(t,e.success)},sync:!0,all:{success:e}})},task:function(n,a,e){e||o.tasks.append('<div class="shareAppendWrapper" t="'+n.id+'">'),_el=o.tasks.find('.shareAppendWrapper[t="'+n.id+'"]'),d.shell({name:"task",el:_el,data:{task:n}},function(e){e.el.find(".remove").on("click",t),e=e.el.find('.shareTimeWrapper[task="'+n.id+'"] .shareContainer'),d.nav.api.load({open:!0,id:"share",el:e,animation:!1,_id:n.id,essenseData:{daddress:n.address||d.app.platform.sdk.address.pnet().address,dtype:n.ready,share:n.share,exoprtByTime:!0,pack:i||{},time:n.time,notClear:!0,changeArrange:function(){c.save()},selectTime:function(e){n.time=e,l.ready(),c.save()},address:function(e){n.address=e,l.ready(),c.save()},type:function(e){"p"==e&&r.post(n,function(){}),"t"==e&&(n.ready=!0),"w"==e&&(n.ready=!1),l.time(),l.ready(),c.save()}},clbk:function(e,t){n.module=t,a&&a()}})})},time:function(){var e=new Date;o.c.find(".timeCellWrapper .time").html(e.getHours()+":"+e.getMinutes())},ready:function(){var t=new Date,e=_.filter(s,function(e){if(e.time&&e.ready&&t<e.time&&!e.remove)return!0});o.c.find(".activeTasks .count").html(e.length)}},c={save:function(){var e=_.filter(s,function(e){if(!e.remove)return!0}),e=_.map(e,function(e){var t=null;return{time:t=e.time?dateToStr(e.time):t,id:e.id,share:e.share.export(!0),address:e.address,ready:e.ready}});localStorage.tasks=JSON.stringify(e)},load:function(){var e=JSON.parse(localStorage.tasks||"[]");s=_.map(e,function(e){var t=new Share;t.import(e.share),t.on.change.scheduler=function(){c.save()};var n=null;return{time:n=e.time?strToDate(e.time):n,id:e.id,share:t,address:e.address,ready:e.ready||!1}})}};return{primary:e,getdata:function(e){c.load(),e({tasks:s})},destroy:function(){o={},n&&clearInterval(n),n=null},init:function(e){function t(){l.tasks();var e=r.taskForTime();l.time(),l.ready(),e.length&&r.missed(e)}var n;c.load(),(o={}).c=e.el.find("#"+d.map.id),o.tasks=o.c.find(".shares"),o.add=o.c.find(".addshare"),o.add.on("click",r.add),r.postInterval(),n=d.app.platform.sdk.address.pnet().address,(n=d.app.platform.sdk.pool.getPack(n))?(i=n[0],d.app.platform.sdk.pool.info(i,function(){t()})):t(),e.clbk(null,e)}}}var d=new nModule,a={};return d.run=function(e){var t=d.addEssense(a,n,e);d.init(t,e)},d.stop=function(){_.each(a,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=scheduler:(app.modules.scheduler={},app.modules.scheduler.module=scheduler);var userslist=function(){function n(e){function t(){$(window).scrollTop()+$(window).height()>$(document).height()-400&&!l&&!d&&s()}function n(){var e=$(this).closest(".user").attr("address");dialog({html:f.app.localization.e("e13023"),btn1text:f.app.localization.e("unblock"),btn2text:f.app.localization.e("ucancel"),class:"zindex",success:function(){f.app.platform.api.actions.unblocking(e,function(e,t){e||f.app.platform.errorHandler(t,!0)})}})}function a(){var e=$(this).closest(".user").attr("address");dialog({html:f.app.localization.e("e13022"),btn1text:f.app.localization.e("unsub"),btn2text:f.app.localization.e("ucancel"),class:"zindex",success:function(){f.app.platform.api.actions.unsubscribe(e,function(e,t){e||f.app.platform.errorHandler(t,!0)})}})}function o(){var e=$(this).closest(".user").attr("address");f.app.platform.api.actions.subscribeWithDialog(e,function(e,t){e||f.app.platform.errorHandler(t,!0)})}function i(){var e=$(this).closest(".user").attr("address"),t=$(this).hasClass("turnon");f.app.platform.api.actions[t?"notificationsTurnOff":"notificationsTurnOn"](e,function(e,t){e||f.app.platform.errorHandler(t,!0)})}function s(e){var t,n,a=_.filter(c,function(e,t){if(50*u<=t&&t<50*(u+1))return!0});a.length?(t=a,n=function(){var t=e;f.shell({name:"users",el:r.users,data:{addresses:a,extra:p},inner:append},function(e){t&&t()})},l||(l=!0,topPreloader(80),r.c.addClass("loading"),f.sdk.users.get(t,function(){r.c.removeClass("loading"),l=!1,topPreloader(100),n()})),u++):d=!0}var r,l,e=deep(e,"history"),c=[],d=!1,p=null,u=0;return{primary:e,getdata:function(e,t){u=0,l=d=!1;var n={};c=deep(t.settings,"essenseData.addresses")||[],n.addresses=c,n.empty=deep(t.settings,"essenseData.empty"),n.caption=deep(t.settings,"essenseData.caption"),p=deep(t.settings,"essenseData.extra"),e(n)},destroy:function(){window.removeEventListener("scroll",t),delete f.app.platform.clbks.api.actions.subscribe.userlist,delete f.app.platform.clbks.api.actions.subscribePrivate.userlist,delete f.app.platform.clbks.api.actions.unsubscribe.userlist,delete f.app.platform.clbks.api.actions.blocking.userlist,r={}},init:function(e){(r={}).c=e.el.find("#"+f.map.id),r.users=r.c.find(".users"),f.app.platform.clbks.api.actions.subscribe.userlist=function(e){r.c.find('.user[address="'+e+'"] .subscribebuttonstop').addClass("following"),r.c.find('.user[address="'+e+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.subscribePrivate.userlist=function(e){r.c.find('.user[address="'+e+'"] .subscribebuttonstop').addClass("following"),r.c.find('.user[address="'+e+'"] .notificationturn').addClass("turnon")},f.app.platform.clbks.api.actions.unsubscribe.userlist=function(e){r.c.find('.user[address="'+e+'"] .subscribebuttonstop').removeClass("following"),r.c.find('.user[address="'+e+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.blocking.userlist=function(e){r.c.find('.user[address="'+e+'"] .subscribebuttonstop').addClass("blocking"),r.c.find('.user[address="'+e+'"] .notificationturn').removeClass("turnon")},f.app.platform.clbks.api.actions.unblocking.userlist=function(e){r.c.find('.user[address="'+e+'"] .subscribebuttonstop').removeClass("blocking"),r.c.find('.user[address="'+e+'"]').removeClass("userblocking")},r.c.on("click",".subscribe",o),r.c.on("click",".unsubscribe",a),r.c.on("click",".unblocking",n),r.c.on("click",".notificationturn",i),s(function(){window.addEventListener("scroll",t)}),e.clbk(null,e)}}}var f=new nModule,a={};return f.run=function(e){var t=f.addEssense(a,n,e);f.init(t,e)},f.stop=function(){_.each(a,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=userslist:(app.modules.userslist={},app.modules.userslist.module=userslist),"undefined"==typeof _OpenApi&&(_OpenApi=!1);var post=function(){function n(t){function n(){T.postscores()}function i(){T.repost(g.txid)}function s(){var e=$(this),t=g.txid;S.app.platform.api.metmenu(e,t,T)}function r(e){T.unsubscribe(function(){tx&&h.share.find(".shareTable").removeClass("subscribed")})}function l(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";S.app.platform.api.actions[e](g.address,function(e,t){e||S.app.platform.errorHandler(t,!0)})}function c(e){T.stateAction(function(){S.app.platform.api.actions.subscribeWithDialog(g.address,function(e,t){e?h.share.find(".shareTable").addClass("subscribed"):S.app.platform.errorHandler(t,!0)})},g.txid)}function d(){S.app.platform.sdk.node.transactions.get.tx(g.txid)}function a(){var n=$(this).attr("value");T.stateAction(function(){var t;S.app.platform.sdk.address.pnet()&&g.address!=S.app.platform.sdk.address.pnet().address&&((t=$(this).closest(".stars")).attr("value")||(t.attr("value",n),t.addClass("liked"),T.like(n,function(e){e?(g.scnt||(g.scnt=0),g.score||(g.score=0),g.scnt++,g.score=Number(g.score||0)+Number(n),e=Number(g.score)/Number(g.scnt),t.find(".tstarsov").css("width",e/5*100+"%"),t.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),P.stars(),v.like&&v.like(g)):(t.removeAttr("value"),t.removeClass("liked"))})))},g.txid)}function p(){dialog({html:S.app.localization.e("e13148"),btn1text:S.app.localization.e("dyes"),btn2text:S.app.localization.e("dno"),success:function(){h.share.addClass("complained"),topPreloader(30),T.complain(function(e){topPreloader(100),e||t.removeClass("hidden")})}})}function u(){var e=$(this).attr("i");T.openGalleryRec(e)}function f(){T.sharesocial()}function m(){T.donate()}var h,g,v,o,y=deep(t,"history")||deep(t,"primary"),b="",k=null,w=0,x=null,C=null,z=!1,T={authclbk:function(){z=!0;var e=g.txid;S.app.platform.sdk.node.shares.getbyid(e,function(){delete(g=S.app.platform.sdk.node.shares.storage.trx[e]).myVal,T.subscribeLabel(),P.mystars(function(){z=!1})})},subscribeLabel:function(){var e,t=S.app.user,n=!1;t.address.value&&g.address==t.address.value||!t.address.value||(e=deep(S.app,"platform.sdk.users.storage."+t.address.value))&&e.relation(g.address,"subscribes")&&(n=!0),h.c&&(e=h.share.find(".shareTable"),n?e.addClass("subscribed"):e.removeClass("subscribed"))},stateAction:function(t,e){if(_OpenApi)return e="https://"+S.app.options.url+"/post?openapi=true&s="+e,S.app.ref&&(e+="&ref="+S.app.ref),void window.open(e,"_blank");S.app.user.isState(function(e){e?t():S.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:S.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!z},function(){t&&t()})}}})})},postscores:function(e){S.app.nav.api.load({open:!0,href:"postscores?p="+g.txid,inWnd:!0,history:!0,essenseData:{share:g.txid,like:function(e){P.stars(),v.like&&v.like()}},clbk:function(){e&&e()}})},repost:function(t){T.stateAction(function(){var e="index";isMobile()&&(e="share"),S.closeContainer(),S.nav.api.load({open:!0,href:e+"?repost="+t,history:!0,handler:!0,essenseData:{},clbk:function(e){}})},t)},next:function(){h.wnd.off("scroll");var t=h.c.find(".nextpost");t.html('<div class="loader"><div class="preloader5"><span></span><span></span><span></span></div></div>'),v.next(g.txid,function(e){e?S.nav.api.load({open:!0,href:"post?s="+e,eid:"nextpost"+e,el:t,clbk:function(){},essenseData:{share:e,hr:v.hr,like:v.like,next:v.next,removemargin:!0}}):t.html('<div class="ended">'+S.app.localization.e("e13146")+"</div>")})},sharesocial:function(e){var t="https://"+S.app.options.url+"/"+(v.hr||"index?")+"s="+g.txid+"&mpost=true";parameters().address&&(t+="&address="+(parameters().address||"")),v.video&&(t="https://"+S.app.options.url+"/"+(v.hr||"index?")+"v="+g.txid+"&mpost=true&video=1");var n=g.message;trimHtml(n,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),g.images[0]||!g.url||(a=videoImage(g.url));var a="Post";"a"==g.settings.v&&(a="Article"),S.nav.api.load({open:!0,href:"socialshare2",history:!0,inWnd:!0,essenseData:{url:t,caption:S.app.localization.e("e13133")+" "+a,sharing:g.social(S.app),embedding:{type:"post",id:g.txid}}})},donate:function(e){var t=deep(app,"platform.sdk.usersl.storage."+g.address)||{address:g.address,addresses:[]},n="send?address="+g.address+"&amount=1&message="+hexEncode(S.app.localization.e("postlabel")+" &mdash; "+(g.caption||g.message).substr(0,20)+"...")+"&label="+(t.name||t.address)+"&setammount=true";S.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:S.app.localization.e("dcancel"),clbk:function(e,t){e.find(".pnetdnt").on("click",function(){S.nav.api.load({open:!0,href:n,history:!0}),S.closeContainer(),t.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(S.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:t})},position:function(){var e;isMobile()||y||v.removemargin||(0<(e=($(window).height()-h.wr.height())/2)?h.wr.css("margin-top",e+"px"):h.wr.css("margin-top","0px"))},initVideo:function(n){var e,a,o;S.app.platform.sdk.usersettings.meta.embedvideo&&!S.app.platform.sdk.usersettings.meta.embedvideo.value||(e=h.c.find(".js-player, [data-plyr-provider][data-plyr-embed-id]"),a=!!(g.itisvideo()&&isMobile()||v.autoplay&&e.length<=1),e.length&&(o={resetOnEnd:!0,muted:!1,wautoplay:a,volumeChange:function(e){videosVolume=e,console.log("v",e),S.sdk.videos.volume=videosVolume,S.sdk.videos.save()}},$.each(e,function(e,t){PlyrEx(t,o,e=>{C=e},()=>{a&&(C.play(),C.muted=!1,C.setVolume(S.sdk.videos.volume)),n&&n()})})))},likeWithR:function(e,t){},like:function(e,n){if(!(e=g.upvote(e)))return S.app.platform.errorHandler("4",!0),void(n&&n(!1));S.sdk.node.transactions.create.commonFromUnspent(e,function(e,t){topPreloader(100),e?n&&n(!0):(g.myVal=null,S.app.platform.errorHandler(t,!0),n&&n(!1))})},complain:function(e){S.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:g,success:function(){}},clbk:function(){}})},unsubscribe:function(n){S.app.platform.api.actions.unsubscribe(g.address,function(e,t){e||S.app.platform.errorHandler(t,!0),n&&n(e,t)})},subscribe:function(n){S.app.platform.api.actions.subscribe(g.address,function(e,t){e||S.app.platform.errorHandler(t,!0),n&&n(e,t)})},openGalleryRec:function(n,e){var a=[],o=function(e,t){_.each(e.images,function(e){a.push(e)}),e.repost?S.app.platform.sdk.node.shares.getbyid(e.repost,function(e){(e=e[0])?o(e,t):t&&t()}):t&&t()};o(g,function(){var e=_.map(a,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==n)return!0});S.app.nav.api.load({open:!0,href:"imagegallery?i="+g.txid+"&num="+(t||0),inWnd:!0,history:"true",essenseData:{initialValue:n,idName:"src",images:e}})})},openGallery:function(t){var e=_.map(g.images,function(e){return{src:e}}),n=findIndex(e,function(e){if(e.src==t)return!0});S.app.nav.api.load({open:!0,href:"imagegallery?i="+g.txid+"&num="+(n||0),inWnd:!0,history:"true",essenseData:{initialValue:t,idName:"src",images:e}})},videoShare:function(e){if(!e.url||!e.itisvideo())return sitemessage("Unable to parse a video in the post");var t=S.app.platform.parseUrl(e.url),n="https://"+S.app.options.url+`/embedVideo.php?host=${t.host_name}&id=${t.id}&embed=true&s=${e.txid}`;return"peertube"===t.type?copycleartext(n):copycleartext(e.url),sitemessage(S.app.localization.e("videoCopied"))}},P={comments:function(a){v.repost&&!v.fromempty||"no"==v.comments?a&&a():S.fastTemplate("commentspreview",function(e){var t=h.c.find(".commentsWrapper"),n="";S.app.platform.sdk.address.pnet()&&(n="&ref="+S.app.platform.sdk.address.pnet().address),n="https://"+S.app.options.url+"/"+(v.hr||"index?")+"s="+g.txid+"&mpost=true"+n,parameters().address&&(n+="&address="+(parameters().address||"")),S.nav.api.load({open:!0,id:"comments",el:t,eid:(v.eid||"")+g.txid+"post",essenseData:{hr:n,totop:h.c,caption:v.nocommentcaption?null:e,send:function(){var e=h.c.find(".commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:g.txid,reply:v.reply,showall:!v.fromempty,init:v.fromempty||!1,preview:v.fromempty||!1,fromtop:!v.fromempty,fromempty:v.fromempty,lastComment:v.fromempty?g.lastComment:null,additionalActions:function(){S.closeContainer()}},clbk:function(e,t){T.position(),o=t,a&&a()}})},{share:g})},empty:function(){S.shell({name:"empty",el:h.share},function(e){T.position()})},images:function(e){var t=h.c.find(".image"),n=h.c.find(".images");!n.hasClass("active")&&t.length&&n.length?t.imagesLoaded({background:!0},function(a){"a"!=g.settings.v&&_.each(a.images,function(e,t){var n=e.img,t=(e=$(a.elements[t]).closest(".imagesWrapper")).width();e.height(),n.width,n.height,n.width<e.width()?(e.find(".image").width(n.width),e.find(".image").height(n.height)):e.height(t*(n.height/n.width))}),n.addClass("active"),t.addClass("active"),e&&e()}):e&&e()},share:function(t){var e,n=!1,a=!1,o=0;void 0!==g&&(e=S.app.platform.sdk.videos.storage[g.url||"undefined"]||{},o=deep(e,"data.aspectRatio")||0),console.log("aspectRatio",o),S.shell({turi:"lenta",name:v.video?"sharevideo":"share",el:h.share,additionalActions:function(){S.closeContainer()},data:{share:g,all:!0,mestate:{},repost:v.repost,fromempty:v.fromempty,verticalVideo:n=o<.9&&0!=o||n,squareVideo:a=.9<o&&o<1.25||a}},function(e){h.stars=h.share.find(".forstars"),T.position(),h.wr.addClass("active"),P.stars(function(){P.mystars(function(){}),P.url(function(){P.repost(),T.position(),P.urlContent(function(){T.position(),T.initVideo(),P.images(function(){v.repost||(T.position(),h.share.find(".complain").on("click",p),h.share.on("click",".imagePostOpent",u),h.share.on("click",".forrepost",i),h.share.find(".txid").on("click",d),h.share.find(".donate").on("click",m),h.share.find(".sharesocial").on("click",f),h.share.find(".asubscribe").on("click",c),h.share.find(".aunsubscribe").on("click",r),h.share.find(".metmenu").on("click",s),h.share.find(".notificationturn").on("click",l)),t&&t()}),v.video&&P.showmoreby()})})})})},showmoreby:function(){var t=h.c.find(".showmorelenta");S.app.platform.papi.horizontalLenta(t,function(e,t){x=t},{caption:S.app.localization.e("More videos by this author"),author:g.address,video:!0,shuffle:!0,loaderkey:"getusercontents",filter:function(e){if(g.txid!=e.txid)return!0},hasshares:function(e){2<e.length&&t.addClass("hasshares")},opensvi:function(e){v.opensvi?v.opensvi(e):S.nav.api.load({open:!0,href:"index?video=1&v="+e,history:!0})},compact:!0})},wholike:function(t){var e=g.who||[];S.shell({turi:"lenta",name:"wholike",el:h.share.find(".wholikes"),data:{scores:Number(g.scnt),wholikes:e},bgImages:{}},function(e){e.el.find(".wholikesTable").on("click",n),t&&t()})},mystars:function(e){var t;void 0===g.myVal?(t=[g.txid],S.app.platform.sdk.likes.get(t,function(){P.stars(),P.wholike(e)})):e&&e()},stars:function(t){S.shell({turi:"lenta",name:"stars",el:h.stars,data:{share:g}},function(e){fastars(e.el.find(".stars")),h.share.find(".stars i").on("click",a),t&&t()})},repost:function(e){g.repost&&S.shell({turi:"lenta",name:"repost",el:h.c.find(".repostWrapper"),data:{repost:g.repost,level:w,share:g}},function(e){T.position(),e.el&&e.el.length&&S.app.platform.papi.post(g.repost,e.el.find(".repostShare"),function(e){k=e,T.position()},{repost:!0,eid:b+g.txid,level:w,fromempty:g.isEmpty()})})},url:function(t){var n=g.url,a=S.app.platform.sdk.remote.storage[n];S.app.platform.sdk.videos.paddingplaceholder(n,function(e){S.shell({turi:"share",name:"url",el:h.c.find(".url"),data:{url:n,og:a,share:g},additionalActions:function(){S.closeContainer()}},e)},function(n){var a=n.el.find("img");n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(a[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(a[t]).closest(".image").css("display","none")}),t&&t()})})},urlContent:function(t){var e,n,a=g.url;a?(e=S.app.platform.parseUrl(a),n=S.app.platform.sdk.remote.storage[a],!a||n||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?t&&t():S.app.platform.sdk.remote.get(a,function(e){e?P.url(t):t&&t()})):t&&t()}};return{primary:y,getdata:function(a,o){k=null,b=o.settings.eid||"";var t=deep(o,"settings.essenseData.share")||parameters().s;v=deep(o,"settings.essenseData")||{},g=null,w=(v.level||-1)+1,S.app.platform.sdk.node.shares.getbyid([t],function(){var e;(g=S.app.platform.sdk.node.shares.storage.trx[t])||(e=_.find(S.sdk.node.transactions.temp.share,function(e){return e.txid==t}))&&((g=new pShare)._import(e,!0),g.temp=!0,g.address=S.app.platform.sdk.address.pnet().address),g&&S.app.platform.sdk.node.shares.users([g],function(e,t){var n={ed:deep(o,"settings.essenseData")||{},share:g};S.app.platform.sdk.videos.info([g.url]).then(e=>{a(n)})})})},authclbk:function(){void 0!==h&&h.c&&T.authclbk()},destroy:function(e){h={},x&&(x.destroy(),x=null),S.app.el.menu.find("#menu").removeClass("static"),v.close&&v.close(),o&&o.destroy(),delete S.app.platform.ws.messages.event.clbks.post,delete S.app.platform.ws.messages.transaction.clbks.temppost,delete S.app.platform.clbks.api.actions.subscribePrivate.post,delete S.app.platform.clbks.api.actions.unsubscribe.post,delete S.app.platform.clbks.api.actions.subscribe.post,z=!1,C&&(C.destroy&&C.destroy(),C=null),k&&(k.destroy(),k=null)},clearparameters:["s","commentid","parentid"],init:function(e){(h={}).c=e.el.find("#"+S.map.id),h.share=h.c.find(".share"),h.wr=h.c.find(".postWrapper"),h.wnd=h.c.closest(".wndcontent"),g?P.share(function(){P.comments(function(){})}):P.empty(),e.clbk(null,e),v.video&&S.app.el.menu.find("#menu").addClass("static"),S.app.platform.ws.messages.transaction.clbks.temppost=function(e){e.temp&&g.txid==e.temp.txid&&(g.temp=!1,g.scnt="0",g.score="0",g.myVal=0,P.share())},S.app.platform.ws.messages.event.clbks.post=function(e){"upvoteShare"==e.mesType&&e.share&&g.txid==e.share.txid&&P.stars(function(){})},S.app.platform.clbks.api.actions.subscribePrivate.post=function(e){var t;e==g.address&&(h.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),(t=deep(S.app,"platform.sdk.users.storage."+S.user.address.value.toString("hex")))&&(t=t.relation(e,"subscribes"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"),!t||"true"!=t.private&&!0!==t.private?h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"):h.c.find('.shareTable[address="'+e+'"] .notificationturn').addClass("turnon")))},S.app.platform.clbks.api.actions.subscribe.post=function(e){e==g.address&&(h.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))},S.app.platform.clbks.api.actions.unsubscribe.post=function(e){e==g.address&&(h.c.find(".shareTable").removeClass("subscribed"),h.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))}},wnd:{class:"withoutButtons postwindow",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,close:function(){}}}}var S=new nModule,a={};return S.authclbk=function(){_.each(a,function(e){e.authclbk()})},S.run=function(e){var t=S.addEssense(a,n,e);S.init(t,e)},S.stop=function(){_.each(a,function(e){e.destroy()})},S}();"undefined"!=typeof module?module.exports=post:(app.modules.post={},app.modules.post.module=post);var ustate=function(){function n(e){function t(n){l.app.platform.sdk.user.waitActions(function(t){l.app.platform.sdk.ustate.me(function(e){o=t,s=e,r.uscnt(function(){a.ustatecontent=a.c.find(".ustatecontent"),r.ustatecontent(),r.reputationsteps(),n&&n()})},!0)})}var a,s,o,e=deep(e,"history"),n=makeid(),i={post:{key:"post",vis:"scale",name:l.app.localization.e("spc"),bad:function(e){if(e<=2)return!0}},score:{key:"score",vis:"scale",name:l.app.localization.e("ssc"),bad:function(e){if(e<=10)return!0}},comment:{key:"comment",vis:"scale",name:l.app.localization.e("ccc"),bad:function(e){if(e<=10)return!0}},comment_score:{key:"comment_score",vis:"scale",name:l.app.localization.e("crc"),bad:function(e){if(e<=10)return!0}}},r={gifts:function(e){},currentLevel:function(i){l.app.platform.sdk.processes.get(function(e){var o=l.app.platform.sdk.processes.level(s.reputation);o&&_.each(e,function(e){var t,n,a;e.level&&(n="next",a=(t=i.find('.level[level="'+e.level+'"]')).find(".line"),e.level<o.level&&(n="completed",a.removeAttr("width")),e.level==o.level&&(n="current",a.width(100*o.perc+"%")),e.level>o.level&&(next="next",a.removeAttr("width")),t.attr("state",n))})})},reputationsteps:function(n){l.app.platform.sdk.processes.get(function(e){var t=l.app.platform.sdk.processes.level(s.reputation);l.shell({name:"reputation",el:a.c.find(".ustatecontentrep"),data:{reputation:s.reputation,level:t,levels:e}},function(e){r.currentLevel(e.el),r.gifts(e.el),e.el.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),n&&n()})})},uscnt:function(t){l.shell({name:"uscnt",el:a.c.find(".mwork"),data:{mestate:s,metrics:i}},function(e){t&&t()})},ustatecontent:function(t){l.shell({name:"ustatecontentnew",el:a.ustatecontent,data:{metrics:i,mestate:s,waitActions:o}},function(e){t&&t()})}};return{primary:e,getdata:function(e){e({})},destroy:function(){a={},delete l.app.platform.ws.messages["new block"].clbks.ustate,delete l.app.platform.sdk.ustate.clbks[n]},init:function(e){(a={}).c=e.el.find("#"+l.map.id),l.app.platform.sdk.ustate.clbks[n]=t,t(function(){l.app.platform.ws.messages["new block"].clbks.ustate=function(e){l.app.platform.sdk.user.waitActions(function(e){o=e,r.ustatecontent()})},e.clbk(null,e)})},tooltip:{options:{minWidth:380,position:"left",functionPosition:function(e,t,n){return n.coord.top=10,n.coord.left+=10,n},theme:"tooltipster-light zindex ustatetooltip"}}}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,n,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=ustate:(app.modules.ustate={},app.modules.ustate.module=ustate);var dust=function(){function n(e){function n(){var e=deep(o,"pk.value");o={pk:new Parameter({name:"Private Key",type:"string",id:"pk",placeholder:"Private Key",value:e||""}),reciever:new Parameter({name:r.app.localization.e("wsreciever"),type:"string",id:"reciever",placeholder:r.app.localization.e("wsenter")}),amount:new Parameter({name:r.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:r.app.localization.e("wsamountof"),format:{Precision:6}}),outputs:new Parameter({name:"Count of outputs",id:"outputs",type:"NUMBER",placeholder:"Count of outputs",defaultValue:1,format:{Precision:0,Min:1,Max:200}}),message:new Parameter({name:"Message",id:"message",type:"stringany",placeholder:"Your message",format:{Length:80}})}}var a,e=deep(e,"history"),o={},i={sendWrapper:function(){if(o.reciever.value){var t=!0;try{bitcoin.address.fromBase58Check(o.reciever.value)}catch(e){t=!1}t?o.amount.value?o.pk.value?i.send(o.pk.value):dialog({html:"Do you want to send coins from current acount?",btn1text:"Yes",btn2text:"No, cancel",success:function(){i.send(r.app.user.private.value.toString("hex"))}}):sitemessage("You must enter Amount"):sitemessage("Address is not valid")}else sitemessage("You Must Enter Reciever Address")},send:function(e){a.c.find(".loader").fadeIn(),r.app.platform.sdk.wallet.sendmanyoutputs(e,o.reciever.value,o.amount.value,o.outputs.value,function(e,t){console.log("ERR",e),a.c.find(".loader").fadeOut(),e?r.app.platform.errorHandler(e,!0):(n(),s.parameters(),sitemessage("Success!"))},o.message.value)}},s={parameters:function(){r.shell({name:"parameters",el:a.c.find(".parametersWrapper"),data:{d:{parameters:o}}},function(e){ParametersLive(_.toArray(o),e.el),e.el.find(".sends").on("click",i.sendWrapper)})}};return{primary:e,getdata:function(e){e({})},destroy:function(){a={}},init:function(e){(a={}).c=e.el.find("#"+r.map.id),n(),s.parameters(),e.clbk(null,e)}}}var r=new nModule,a={};return r.run=function(e){var t=r.addEssense(a,n,e);r.init(t,e)},r.stop=function(){_.each(a,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=dust:(app.modules.dust={},app.modules.dust.module=dust);
 /*_____*/ 
 ; window.pocketnetJoinLoaded = true;